var z=Object.defineProperty;var w=Object.getOwnPropertySymbols;var F=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable;var x=(e,t,a)=>t in e?z(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,u=(e,t)=>{for(var a in t||(t={}))F.call(t,a)&&x(e,a,t[a]);if(w)for(var a of w(t))S.call(t,a)&&x(e,a,t[a]);return e};import{_ as f,F as y,K as W,e as E,l as $,b as T,a as D,q as A,t as H,g as R,s as Y,G as L,H as M,z as j}from"./mermaid.core-BR_M6504.chunk.mjs";import{p as q}from"./chunk-4BX2VUAB-BtGBLG5u.chunk.mjs";import{p as G}from"./treemap-75Q7IDZK-8-wf2lXq.chunk.mjs";import"./index-gMaV0V1e.chunk.mjs";import"./emoji-picker-DQhTjoLy.chunk.mjs";import"./NcLoadingIcon-CaRygCDf.chunk.mjs";import"./vue.runtime.esm-UAI8SE-v.chunk.mjs";import"./index-DUrHmx5a.chunk.mjs";import"./_baseUniq-ZSG9L9fo.chunk.mjs";import"./_basePickBy-BWuPEXGi.chunk.mjs";import"./clone-ClcbtaS4.chunk.mjs";var I=M.packet,m,B=(m=class{constructor(){this.packet=[],this.setAccTitle=T,this.getAccTitle=D,this.setDiagramTitle=A,this.getDiagramTitle=H,this.getAccDescription=R,this.setAccDescription=Y}getConfig(){const t=y(u(u({},I),L().packet));return t.showBits&&(t.paddingY+=10),t}getPacket(){return this.packet}pushWord(t){t.length>0&&this.packet.push(t)}clear(){j(),this.packet=[]}},f(m,"PacketDB"),m),K=1e4,N=f((e,t)=>{q(e,t);let a=-1,s=[],n=1;const{bitsPerRow:c}=t.getConfig();for(let{start:r,end:o,bits:l,label:d}of e.blocks){if(r!==void 0&&o!==void 0&&o<r)throw new Error("Packet block ".concat(r," - ").concat(o," is invalid. End must be greater than start."));if(r!=null||(r=a+1),r!==a+1)throw new Error("Packet block ".concat(r," - ").concat(o!=null?o:r," is not contiguous. It should start from ").concat(a+1,"."));if(l===0)throw new Error("Packet block ".concat(r," is invalid. Cannot have a zero bit field."));for(o!=null||(o=r+(l!=null?l:1)-1),l!=null||(l=o-r+1),a=o,$.debug("Packet block ".concat(r," - ").concat(a," with label ").concat(d));s.length<=c+1&&t.getPacket().length<K;){const[p,i]=_({start:r,end:o,bits:l,label:d},n,c);if(s.push(p),p.end+1===n*c&&(t.pushWord(s),s=[],n++),!i)break;({start:r,end:o,bits:l,label:d}=i)}}t.pushWord(s)},"populate"),_=f((e,t,a)=>{if(e.start===void 0)throw new Error("start should have been set during first phase");if(e.end===void 0)throw new Error("end should have been set during first phase");if(e.start>e.end)throw new Error("Block start ".concat(e.start," is greater than block end ").concat(e.end,"."));if(e.end+1<=t*a)return[e,void 0];const s=t*a-1,n=t*a;return[{start:e.start,end:s,label:e.label,bits:s-e.start},{start:n,end:e.end,label:e.label,bits:e.end-n}]},"getNextFittingBlock"),C={parser:{yy:void 0},parse:f(async e=>{var s;const t=await G("packet",e),a=(s=C.parser)==null?void 0:s.yy;if(!(a instanceof B))throw new Error("parser.parser?.yy was not a PacketDB. This is due to a bug within Mermaid, please report this issue at https://github.com/mermaid-js/mermaid/issues.");$.debug(t),N(t,a)},"parse")},O=f((e,t,a,s)=>{const n=s.db,c=n.getConfig(),{rowHeight:r,paddingY:o,bitWidth:l,bitsPerRow:d}=c,p=n.getPacket(),i=n.getDiagramTitle(),h=r+o,b=h*(p.length+1)-(i?0:r),k=l*d+2,g=W(t);g.attr("viewbox","0 0 ".concat(k," ").concat(b)),E(g,b,k,c.useMaxWidth);for(const[v,P]of p.entries())X(g,P,v,c);g.append("text").text(i).attr("x",k/2).attr("y",b-h/2).attr("dominant-baseline","middle").attr("text-anchor","middle").attr("class","packetTitle")},"draw"),X=f((e,t,a,{rowHeight:s,paddingX:n,paddingY:c,bitWidth:r,bitsPerRow:o,showBits:l})=>{const d=e.append("g"),p=a*(s+c)+c;for(const i of t){const h=i.start%o*r+1,b=(i.end-i.start+1)*r-n;if(d.append("rect").attr("x",h).attr("y",p).attr("width",b).attr("height",s).attr("class","packetBlock"),d.append("text").attr("x",h+b/2).attr("y",p+s/2).attr("class","packetLabel").attr("dominant-baseline","middle").attr("text-anchor","middle").text(i.label),!l)continue;const k=i.end===i.start,g=p-2;d.append("text").attr("x",h+(k?b/2:0)).attr("y",g).attr("class","packetByte start").attr("dominant-baseline","auto").attr("text-anchor",k?"middle":"start").text(i.start),k||d.append("text").attr("x",h+b).attr("y",g).attr("class","packetByte end").attr("dominant-baseline","auto").attr("text-anchor","end").text(i.end)}},"drawWord"),J={draw:O},Q={byteFontSize:"10px",startByteColor:"black",endByteColor:"black",labelColor:"black",labelFontSize:"12px",titleColor:"black",titleFontSize:"14px",blockStrokeColor:"black",blockStrokeWidth:"1",blockFillColor:"#efefef"},U=f(({packet:e}={})=>{const t=y(Q,e);return"\n	.packetByte {\n		font-size: ".concat(t.byteFontSize,";\n	}\n	.packetByte.start {\n		fill: ").concat(t.startByteColor,";\n	}\n	.packetByte.end {\n		fill: ").concat(t.endByteColor,";\n	}\n	.packetLabel {\n		fill: ").concat(t.labelColor,";\n		font-size: ").concat(t.labelFontSize,";\n	}\n	.packetTitle {\n		fill: ").concat(t.titleColor,";\n		font-size: ").concat(t.titleFontSize,";\n	}\n	.packetBlock {\n		stroke: ").concat(t.blockStrokeColor,";\n		stroke-width: ").concat(t.blockStrokeWidth,";\n		fill: ").concat(t.blockFillColor,";\n	}\n	")},"styles"),dt={parser:C,get db(){return new B},renderer:J,styles:U};export{dt as diagram};
//# sourceMappingURL=diagram-S2PKOQOG-1S4jg4nT.chunk.mjs.map
