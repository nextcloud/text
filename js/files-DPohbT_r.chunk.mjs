const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=[window.OC.filePath('text', '', 'js/PublicFilesEditor-asVgmi3O.chunk.mjs'),window.OC.filePath('text', '', 'js/modulepreload-polyfill-BbX-W30F.chunk.mjs'),window.OC.filePath('text', '', 'js/emoji-picker-DlAAdvrL.chunk.mjs'),window.OC.filePath('text', '', 'js/NcNoteCard-C6xb7vi0-DTJz1zPW.chunk.mjs'),window.OC.filePath('text', '', 'js/index-DfiDB3im.chunk.mjs'),window.OC.filePath('text', '', 'js/NcLoadingIcon-BcbRVau3.chunk.mjs'),window.OC.filePath('text', '', 'css/NcLoadingIcon-Bs0OvbBQ.chunk.css'),window.OC.filePath('text', '', 'js/vue.runtime.esm-Ccc28AWB.chunk.mjs'),window.OC.filePath('text', '', 'css/NcNoteCard-C6xb7vi0-DvAuxGX_.chunk.css'),window.OC.filePath('text', '', 'js/_plugin-vue2_normalizer-wd1ZAbRr.chunk.mjs'),window.OC.filePath('text', '', 'js/RichWorkspace-kkz-9KYi.chunk.mjs'),window.OC.filePath('text', '', 'js/index-WPXGtsOH.chunk.mjs'),window.OC.filePath('text', '', 'js/Editor.singleton-DczE-iqp.chunk.mjs'),window.OC.filePath('text', '', 'js/RichTextReader-CbiMzrax.chunk.mjs'),window.OC.filePath('text', '', 'js/BaseReader-hFpZNC74.chunk.mjs'),window.OC.filePath('text', '', 'js/EditorOutline-DjueHioJ.chunk.mjs'),window.OC.filePath('text', '', 'js/index-DcFVDg26.chunk.mjs'),window.OC.filePath('text', '', 'js/NcCheckboxRadioSwitch-VeztTzpz-BZp6AR4D.chunk.mjs'),window.OC.filePath('text', '', 'css/NcCheckboxRadioSwitch-VeztTzpz-CdJ-sA3l.chunk.css'),window.OC.filePath('text', '', 'js/index-mgFfDjoT.chunk.mjs'),window.OC.filePath('text', '', 'js/MediaHandler.provider-ve5hcekF.chunk.mjs'),window.OC.filePath('text', '', 'js/logger-DvmA7f2u.chunk.mjs'),window.OC.filePath('text', '', 'css/EditorOutline-BVElmStS.chunk.css'),window.OC.filePath('text', '', 'css/BaseReader-CsLFhfbT.chunk.css'),window.OC.filePath('text', '', 'css/RichTextReader-iDEHOKnF.chunk.css'),window.OC.filePath('text', '', 'css/RichWorkspace-BfZwJ3rL.chunk.css')])))=>i.map(i=>d[i]);
import{_ as u,g as f,e as A}from"./modulepreload-polyfill-BbX-W30F.chunk.mjs";import{g as b,s as k,b as v,p as O}from"./NcNoteCard-C6xb7vi0-DTJz1zPW.chunk.mjs";import{H as I,b as C,N as R,P as h,F as g}from"./index-DcM4_Ja6.chunk.mjs";import{h as F,c as D}from"./index-WPXGtsOH.chunk.mjs";import{l as P}from"./index-DfiDB3im.chunk.mjs";import{b as w}from"./mime-CuxkK4Yj.chunk.mjs";import{s as T}from"./index-DcFVDg26.chunk.mjs";import"./emoji-picker-DlAAdvrL.chunk.mjs";import"./NcLoadingIcon-BcbRVau3.chunk.mjs";import"./vue.runtime.esm-Ccc28AWB.chunk.mjs";import"./index-mgFfDjoT.chunk.mjs";const V='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-text" viewBox="0 0 24 24"><path d="M21,6V8H3V6H21M3,18H12V16H3V18M3,13H21V11H3V13Z" /></svg>',_="Edit with text app",j=()=>{const e=b(),r=document.querySelector("#preview table.files-filestable");if(!e||!r){const s=document.createElement("div");s.id="text-viewer-fallback",document.body.appendChild(s);const l=i=>OCA.Files.fileActions.register(i,_,OC.PERMISSION_UPDATE|OC.PERMISSION_READ,F("core","actions/rename"),p=>{const c=window.FileList.findFile(p);Promise.all([u(()=>import("./vue.runtime.esm-Ccc28AWB.chunk.mjs").then(o=>o.x),[],import.meta.url),u(()=>import("./PublicFilesEditor-asVgmi3O.chunk.mjs"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]),import.meta.url)]).then(o=>{const a=window.FileList.getCurrentDirectory()+"/"+p,m=o[0].default;m.prototype.t=window.t,m.prototype.n=window.n,m.prototype.OCA=window.OCA;const E=o[1].default;new m({render:function(x){const y=this;return x(E,{props:{fileId:c?c.id:null,active:!0,shareToken:e,relativePath:a,mimeType:c.mimetype},on:{close:function(){y.$destroy()}}})}}).$mount(s)})},t("text","Edit"));for(let i=0;i<w.length;i++)l(w[i]),OCA.Files.fileActions.setDefault(w[i],_)}};let d=!1;const z=()=>{const e=t("text","Readme")+"."+P("text","default_file_extension");C({id:"rich-workspace-init",displayName:t("text","Add folder description"),category:R.Other,enabled(r){return Number(r.attributes["rich-workspace-file"])?!1:(r.permissions&h.CREATE)!==0},iconSvgInline:V,async handler(r,s){const l=s.map(a=>a.basename);if(l.includes(e)){k(t("text",'"{name}" already exist!',{name:e}));return}const i=r.encodedSource+"/"+encodeURIComponent(e),p=await D({method:"PUT",url:i,headers:{Overwrite:"F"}}),c=parseInt(p.headers["oc-fileid"]),o=new g({source:r.source+"/"+e,id:c,mtime:new Date,mime:"text/markdown",owner:f()?.uid||null,permissions:h.ALL,root:r?.root||"/files/"+f()?.uid});v(t("text",'Created "{name}"',{name:e})),l.length===0&&(d=o),A("files:node:created",o)}})};let n=null;const G=new I({id:"workspace",order:10,enabled(e,r){return["files","favorites","public-share"].includes(r.id)},async render(e,r,s){n&&(n.$destroy(),n=null);const l=!!r.attributes["rich-workspace-file"]||!!d,i=d?O.dirname(d.path):r.path,p=d?"":r.attributes["rich-workspace"];d=!1;const{default:c}=await u(async()=>{const{default:o}=await import("./RichWorkspace-kkz-9KYi.chunk.mjs");return{default:o}},__vite__mapDeps([10,11,7,1,2,3,4,5,6,8,12,13,14,15,9,16,17,18,19,20,21,22,23,24,25]),import.meta.url);u(()=>import("./vue.runtime.esm-Ccc28AWB.chunk.mjs").then(o=>o.x),[],import.meta.url).then(o=>{e.id="files-workspace-wrapper";const a=o.default;a.prototype.t=window.t,a.prototype.n=window.n,a.prototype.OCA=window.OCA;const m=a.extend(c);n=new m({propsData:{path:i,hasRichWorkspace:l,content:p},store:T}).$mount(e)})},updated(e,r){if(d=!1,!n){console.warn("No vue instance found for FilesWorkspaceHeader");return}const s=!!e.attributes["rich-workspace-file"];n.path=e.path,n.hasRichWorkspace=s,n.content=e.attributes["rich-workspace"]}});export{_ as FILE_ACTION_IDENTIFIER,G as FilesWorkspaceHeader,z as addMenuRichWorkspace,j as registerFileActionFallback};
//# sourceMappingURL=files-DPohbT_r.chunk.mjs.map
