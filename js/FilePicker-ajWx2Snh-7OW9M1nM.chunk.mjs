import{V as R,c as f,t as T,d as $,r as _,y as U,w as ge,o as M,k as Be,n as Pe,i as ze}from"./vue.runtime.esm-DvoDgcXN.chunk.mjs";import{N as q,b as K,E as x,t as S,i as G,s as Q,p as le,e as Ie}from"./public-DvwfOw-3.chunk.mjs";import{e as $e,g as oe,c as ce,f as De,s as Ve,h as J,i as Ae,d as Oe,C as ue,j as Me,k as He}from"./index-ByA3fgh6.chunk.mjs";import{ae as Re,aK as Ee,aL as Te,aM as We,aN as je,aO as Ze,aw as Ue,aP as qe,aQ as Ke,ai as Ge,aR as Qe}from"./RichText-qSiTZKp1.chunk.mjs";import{s as Je,u as Xe,e as Ye,g as et}from"./modulepreload-polyfill-wXdbfrnd.chunk.mjs";import{n as H,G as tt}from"./NcLoadingIcon-DpR-z6I7.chunk.mjs";import{d as it}from"./index-CBm9e71S.chunk.mjs";import{N as ye}from"./NcCheckboxRadioSwitch-BIEYfWtF-DEkQot53.chunk.mjs";import{c as _e,_ as X,U as nt}from"./index-L55dpVfe.chunk.mjs";import{l as be}from"./index-DfiDB3im.chunk.mjs";import{a as W}from"./index-BHQddWzn.chunk.mjs";import"./emoji-picker-DlAAdvrL.chunk.mjs";import"./index-D29f11qk.chunk.mjs";import"./MediaHandler.provider-CzRho588.chunk.mjs";import"./logger-BaSPzHnw.chunk.mjs";import"./_plugin-vue2_normalizer-wd1ZAbRr.chunk.mjs";const rt={name:"ChevronRightIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var at=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon chevron-right-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},st=[],lt=H(rt,at,st,!1,null,null);const ot=lt.exports,ct={name:"NcBreadcrumb",components:{NcActions:q,ChevronRight:ot,NcButton:K},inheritAttrs:!1,props:{name:{type:String,required:!0},title:{type:String,default:null},to:{type:[String,Object],default:void 0},exact:{type:Boolean,default:!1},href:{type:String,default:void 0},icon:{type:String,default:""},forceIconText:{type:Boolean,default:!1},disableDrop:{type:Boolean,default:!1},forceMenu:{type:Boolean,default:!1},open:{type:Boolean,default:!1}},emits:["update:open","dropped"],data(){return{hovering:!1,crumbId:`crumb-id-${tt()}`}},computed:{linkAttributes(){return this.to?{to:this.to,exact:this.exact,...this.$attrs}:this.href?{href:this.href,...this.$attrs}:this.$attrs}},methods:{onOpenChange(e){this.$emit("update:open",e)},dropped(e){return this.disableDrop||(this.$emit("dropped",e,this.to||this.href),this.$parent.$emit("dropped",e,this.to||this.href),this.hovering=!1),!1},dragEnter(e){this.disableDrop||(this.hovering=!0)},dragLeave(e){this.disableDrop||e.target.contains(e.relatedTarget)||this.$refs.crumb.contains(e.relatedTarget)||(this.hovering=!1)}}};var ut=function(){var e=this,i=e._self._c;return i("li",e._b({ref:"crumb",staticClass:"vue-crumb",class:{"vue-crumb--hovered":e.hovering},attrs:{draggable:"false"},on:{dragstart:function(t){return t.preventDefault(),(()=>{}).apply(null,arguments)},drop:function(t){return t.preventDefault(),e.dropped.apply(null,arguments)},dragover:function(t){return t.preventDefault(),(()=>{}).apply(null,arguments)},dragenter:e.dragEnter,dragleave:e.dragLeave}},"li",e._d({},[e.crumbId,""])),[(e.name||e.icon||e.$slots.icon)&&!e.$slots.default?i("NcButton",e._g(e._b({attrs:{"aria-label":e.icon?e.name:void 0,title:e.title,variant:"tertiary"},scopedSlots:e._u([e.$slots.icon||e.icon?{key:"icon",fn:function(){return[e._t("icon",function(){return[i("span",{staticClass:"icon",class:e.icon})]})]},proxy:!0}:null,!(e.$slots.icon||e.icon)||e.forceIconText?{key:"default",fn:function(){return[e._v(" "+e._s(e.name)+" ")]},proxy:!0}:null],null,!0)},"NcButton",e.linkAttributes,!1),e.$listeners)):e._e(),e.$slots.default?i("NcActions",{ref:"actions",attrs:{"force-menu":e.forceMenu,open:e.open,"menu-name":e.name,title:e.title,"force-name":!0,container:`.vue-crumb[${e.crumbId}]`,variant:"tertiary"},on:{"update:open":e.onOpenChange},scopedSlots:e._u([{key:"icon",fn:function(){return[e._t("menu-icon")]},proxy:!0}],null,!0)},[e._t("default")],2):e._e(),i("ChevronRight",{staticClass:"vue-crumb__separator",attrs:{size:20}})],1)},dt=[],pt=H(ct,ut,dt,!1,null,"c55f5445");const we=pt.exports;var j=Symbol(),A=Symbol(),de=Symbol(),pe=Symbol(),Y=function(e){return"frag"in e},ft={get:function(){return this[A]||this.parentElement},configurable:!0},O=function(e,i){A in e||(e[A]=i,Object.defineProperty(e,"parentNode",ft))},mt={get:function(){var e=this.parentNode.childNodes,i=e.indexOf(this);return i>-1&&e[i+1]||null}},E=function(e){de in e||(e[de]=!0,Object.defineProperty(e,"nextSibling",mt))},ht=function(e,i){for(;e.parentNode!==i;){var t=e,n=t.parentNode;n&&(e=n)}return e},Z,Ce=function(e){if(!Z){var i=Object.getOwnPropertyDescriptor(Node.prototype,"childNodes");Z=i.get}var t=Z.apply(e),n=Array.from(t).map(function(r){return ht(r,e)});return n.filter(function(r,a){return r!==n[a-1]})},vt={get:function(){return this.frag||Ce(this)}},gt={get:function(){return this.childNodes[0]||null}};function yt(){return this.childNodes.length>0}var fe=function(e){pe in e||(e[pe]=!0,Object.defineProperties(e,{childNodes:vt,firstChild:gt}),e.hasChildNodes=yt)};function _t(){var e;(e=this.frag[0]).before.apply(e,arguments)}function bt(){var e=this.frag,i=e.splice(0,e.length);i.forEach(function(t){t.remove()})}var wt=function e(i){var t;return(t=Array.prototype).concat.apply(t,i.map(function(n){return Y(n)?e(n.frag):n}))},Ct=function(e,i){var t=e[j];i.before(t),O(t,e),e.frag.unshift(t)};function me(e){if(Y(this)){var i=this.frag.indexOf(e);if(i>-1){var t=this.frag.splice(i,1),n=t[0];this.frag.length===0&&Ct(this,n),e.remove()}}else{var r=Ce(this),a=r.indexOf(e);a>-1&&e.remove()}return e}function he(e,i){var t=this,n=e.frag||[e];if(Y(this)){if(e[A]===this&&e.parentElement)return e;var r=this.frag;if(i){var a=r.indexOf(i);a>-1&&(r.splice.apply(r,[a,0].concat(n)),i.before.apply(i,n))}else{var s=r[r.length-1];r.push.apply(r,n),s.after.apply(s,n)}ke(this)}else i?this.childNodes.includes(i)&&i.before.apply(i,n):this.append.apply(this,n);n.forEach(function(m){O(m,t)});var l=n[n.length-1];return E(l),e}function kt(e){if(e[A]===this&&e.parentElement)return e;var i=this.frag,t=i[i.length-1];return t.after(e),O(e,this),ke(this),i.push(e),e}var ke=function(e){var i=e[j];e.frag[0]===i&&(e.frag.shift(),i.remove())},St={set:function(e){var i=this;if(this.frag[0]!==this[j]&&this.frag.slice().forEach(function(n){return i.removeChild(n)}),e){var t=document.createElement("div");t.innerHTML=e,Array.from(t.childNodes).forEach(function(n){i.appendChild(n)})}},get:function(){return""}},Nt={inserted:function(e){var i=e.parentNode,t=e.nextSibling,n=e.previousSibling,r=Array.from(e.childNodes),a=document.createComment("");r.length===0&&r.push(a),e.frag=r,e[j]=a;var s=document.createDocumentFragment();s.append.apply(s,wt(r)),e.replaceWith(s),r.forEach(function(l){O(l,e),E(l)}),fe(e),Object.assign(e,{remove:bt,appendChild:kt,insertBefore:he,removeChild:me,before:_t}),Object.defineProperty(e,"innerHTML",St),i&&(Object.assign(i,{removeChild:me,insertBefore:he}),O(e,i),fe(i)),t&&E(e),n&&E(n)},unbind:function(e){e.remove()}},Se={name:"Fragment",directives:{frag:Nt},render:function(e){return e("div",{directives:[{name:"frag"}]},this.$slots.default)}};const ve=(e,i,t)=>{if(e!==void 0)for(let n=e.length-1;n>=0;n--){const r=e[n],a=!r.componentOptions&&r.tag&&i.indexOf(r.tag)===-1,s=!!r.componentOptions&&typeof r.componentOptions.tag=="string",l=s&&i.indexOf(r.componentOptions.tag)===-1;(a||!s||l)&&((a||l)&&R.util.warn(`${a?r.tag:r.componentOptions.tag} is not allowed inside the ${t.$options.name} component`,t),e.splice(n,1))}},Ft={name:"FolderIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var xt=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon folder-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Lt=[],Bt=H(Ft,xt,Lt,!1,null,null);const Pt=Bt.exports,F="vue-crumb",zt={name:"NcBreadcrumbs",components:{NcActions:q,NcActionButton:Re,NcActionRouter:Ee,NcActionLink:Te,NcBreadcrumb:we,IconFolder:Pt},props:{rootIcon:{type:String,default:"icon-home"},ariaLabel:{type:String,default:null}},emits:["dropped"],data(){return{hiddenIndices:[],menuBreadcrumbProps:{name:"",forceMenu:!0,disableDrop:!0,open:!1},breadcrumbsRefs:{}}},beforeMount(){ve(this.$slots.default,["NcBreadcrumb"],this)},beforeUpdate(){ve(this.$slots.default,["NcBreadcrumb"],this)},created(){window.addEventListener("resize",it(()=>{this.handleWindowResize()},100)),Je("navigation-toggled",this.delayedResize)},mounted(){this.handleWindowResize()},updated(){this.delayedResize(),this.$nextTick(()=>{this.hideCrumbs()})},beforeDestroy(){window.removeEventListener("resize",this.handleWindowResize),Xe("navigation-toggled",this.delayedResize)},methods:{closeActions(e){this.$refs.actionsBreadcrumb.$el.contains(e.relatedTarget)||(this.menuBreadcrumbProps.open=!1)},async delayedResize(){await this.$nextTick(),this.handleWindowResize()},handleWindowResize(){if(!this.$refs.container)return;const e=Object.values(this.breadcrumbsRefs),i=e.length,t=[],n=this.$refs.container.offsetWidth;let r=this.getTotalWidth(e);this.$refs.breadcrumb__actions&&(r+=this.$refs.breadcrumb__actions.offsetWidth);let a=r-n;a+=a>0?64:0;let s=0;const l=Math.floor(i/2);for(;a>0&&s<i-2;){const m=l+(s%2?s+1:s)/2*Math.pow(-1,s+i%2);a-=this.getWidth(e[m]?.elm,m===e.length-1),t.push(m),s++}this.arraysEqual(this.hiddenIndices,t.sort((m,o)=>m-o))||(this.hiddenIndices=t)},arraysEqual(e,i){if(e.length!==i.length)return!1;if(e===i)return!0;if(e===null||i===null)return!1;for(let t=0;t<e.length;++t)if(e[t]!==i[t])return!1;return!0},getTotalWidth(e){return e.reduce((i,t,n)=>i+this.getWidth(t?.elm,n===e.length-1),0)},getWidth(e,i){if(!e?.classList)return 0;const t=e.classList.contains(`${F}--hidden`);e.style.minWidth="auto",i&&(e.style.maxWidth="210px"),e.classList.remove(`${F}--hidden`);const n=e.offsetWidth;return t&&e.classList.add(`${F}--hidden`),e.style.minWidth="",e.style.maxWidth="",n},preventDefault(e){return e.preventDefault&&e.preventDefault(),!1},dragStart(e){return this.preventDefault(e)},dropped(e,i,t){return t||this.$emit("dropped",e,i),this.menuBreadcrumbProps.open=!1,document.querySelectorAll(`.${F}`).forEach(n=>{n.classList.remove(`${F}--hovered`)}),this.preventDefault(e)},dragOver(e){return this.preventDefault(e)},dragEnter(e,i){if(!i&&e.target.closest){const t=e.target.closest(`.${F}`);t.classList&&t.classList.contains(F)&&(document.querySelectorAll(`.${F}`).forEach(n=>{n.classList.remove(`${F}--hovered`)}),t.classList.add(`${F}--hovered`))}},dragLeave(e,i){if(!i&&!e.target.contains(e.relatedTarget)&&e.target.closest){const t=e.target.closest(`.${F}`);if(t.contains(e.relatedTarget))return;t.classList&&t.classList.contains(F)&&t.classList.remove(`${F}--hovered`)}},hideCrumbs(){Object.values(this.breadcrumbsRefs).forEach((e,i)=>{e?.elm?.classList&&(this.hiddenIndices.includes(i)?e.elm.classList.add(`${F}--hidden`):e.elm.classList.remove(`${F}--hidden`))})},isBreadcrumb(e){return(e?.componentOptions?.tag||e?.tag||"").includes("NcBreadcrumb")}},render(e){const i=[];if(this.$slots.default.forEach(a=>{if(this.isBreadcrumb(a)){i.push(a);return}a?.type===Se&&a?.children?.forEach?.(s=>{this.isBreadcrumb(s)&&i.push(s)})}),i.length===0)return;R.set(i[0].componentOptions.propsData,"icon",this.rootIcon),R.set(i[0].componentOptions.propsData,"ref","breadcrumbs");const t={};i.forEach((a,s)=>{R.set(a,"ref",`crumb-${s}`),t[s]=a});let n=[];if(!this.hiddenIndices.length)n=i;else{n=i.slice(0,Math.round(i.length/2)),n.push(e("NcBreadcrumb",{class:"dropdown",props:this.menuBreadcrumbProps,attrs:{"aria-hidden":!0},ref:"actionsBreadcrumb",key:"actions-breadcrumb-1",nativeOn:{dragstart:this.dragStart,dragenter:()=>{this.menuBreadcrumbProps.open=!0},dragleave:this.closeActions},on:{"update:open":s=>{this.menuBreadcrumbProps.open=s}}},this.hiddenIndices.filter(s=>s<=i.length-1).map(s=>{const l=i[s],m=l.componentOptions.propsData.to,o=l.componentOptions.propsData.href,p=l.componentOptions.propsData.disableDrop,v=l.componentOptions.propsData.title,y=l.componentOptions.propsData.name;let c="NcActionButton",C="";o&&(c="NcActionLink",C=o),m&&(c="NcActionRouter",C=m);const b=e("IconFolder",{props:{size:20},slot:"icon"});return e(c,{class:F,props:{href:o||null,title:v,to:m||null},attrs:{draggable:!1},on:{...l.componentOptions.listeners},nativeOn:{dragstart:this.dragStart,drop:u=>this.dropped(u,C,p),dragover:this.dragOver,dragenter:u=>this.dragEnter(u,p),dragleave:u=>this.dragLeave(u,p)}},[b,y])})));const a=i.slice(Math.round(i.length/2));n=n.concat(a)}const r=[e("nav",{attrs:{"aria-label":this.ariaLabel}},[e("ul",{class:"breadcrumb__crumbs"},[n])])];return this.$slots.actions&&r.push(e("div",{class:"breadcrumb__actions",ref:"breadcrumb__actions"},this.$slots.actions)),this.breadcrumbsRefs=t,e("div",{class:["breadcrumb",{"breadcrumb--collapsed":this.hiddenIndices.length===i.length-2}],ref:"container"},r)}},It=null,$t=null;var Dt=H(zt,It,$t,!1,null,"629bf30f");const Vt=Dt.exports,At={name:"NcDateTime",props:{timestamp:{type:[Date,Number],required:!0},format:{type:Object,default:()=>({timeStyle:"medium",dateStyle:"short"})},relativeTime:{type:[Boolean,String],default:"long",validator:e=>e===!1||["long","short","narrow"].includes(e)},ignoreSeconds:{type:Boolean,default:!1}},setup(e){const i=f(()=>({format:e.format})),t=f(()=>({ignoreSeconds:e.ignoreSeconds,relativeTime:e.relativeTime||"long",update:e.relativeTime!==!1})),n=We(T(e,"timestamp"),i),r=je(T(e,"timestamp"),t);return{formattedTime:f(()=>e.relativeTime?r.value:n.value),title:n}}};var Ot=function(){var e=this,i=e._self._c;return i("span",{staticClass:"nc-datetime",attrs:{"data-timestamp":e.timestamp,title:e.title},domProps:{textContent:e._s(e.formattedTime)}})},Mt=[],Ht=H(At,Ot,Mt,!1,null,null);const Rt=Ht.exports;var Et="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M16.2,16.2L11,13V7H12.5V12.2L17,14.9L16.2,16.2Z",Tt="M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z",Wt="M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z";const jt={name:"FileIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Zt=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon file-icon",attrs:{"aria-hidden":e.title?null:!0,"aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M13,9V3.5L18.5,9M6,2C4.89,2 4,2.89 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2H6Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Ut=[],qt=x(jt,Zt,Ut,!1,null,null);const Ne=qt.exports,Fe=()=>{var e,i,t;const n=be("files","config",null),r=_((e=n?.show_hidden)!=null?e:!0),a=_((i=n?.sort_favorites_first)!=null?i:!0),s=_((t=n?.crop_image_previews)!=null?t:!0);return M(async()=>{var l,m,o,p,v,y;if(G())console.debug("Skip loading files settings - currently on public share");else try{const{data:c}=await _e.get(X("/apps/files/api/v1/configs"));r.value=(m=(l=c?.data)==null?void 0:l.show_hidden)!=null?m:!1,a.value=(p=(o=c?.data)==null?void 0:o.sort_favorites_first)!=null?p:!0,s.value=(y=(v=c?.data)==null?void 0:v.crop_image_previews)!=null?y:!0}catch(c){console.error("Could not load files settings",c),Q(S("Could not load files settings"))}}),{showHiddenFiles:r,sortFavoritesFirst:a,cropImagePreviews:s}},Kt=e=>{var i,t,n,r,a,s,l,m,o,p,v,y;const c=k=>k==="asc"?"ascending":k==="desc"?"descending":"none",C=be("files","viewConfigs",null),b=_({sortBy:(t=(i=C?.files)==null?void 0:i.sorting_mode)!=null?t:"basename",order:c((r=(n=C?.files)==null?void 0:n.sorting_direction)!=null?r:"asc")}),u=_({sortBy:(s=(a=C?.recent)==null?void 0:a.sorting_mode)!=null?s:"basename",order:c((m=(l=C?.recent)==null?void 0:l.sorting_direction)!=null?m:"asc")}),w=_({sortBy:(p=(o=C?.favorites)==null?void 0:o.sorting_mode)!=null?p:"basename",order:c((y=(v=C?.favorites)==null?void 0:v.sorting_direction)!=null?y:"asc")});M(async()=>{var k,B,h,g,z,D,V,I,ee,te,ie,ne,re,ae,se;if(G())console.debug("Skip loading files views - currently on public share");else try{const{data:P}=await _e.get(X("/apps/files/api/v1/views"));b.value={sortBy:(h=(B=(k=P?.data)==null?void 0:k.files)==null?void 0:B.sorting_mode)!=null?h:"basename",order:c((z=(g=P?.data)==null?void 0:g.files)==null?void 0:z.sorting_direction)},w.value={sortBy:(I=(V=(D=P?.data)==null?void 0:D.favorites)==null?void 0:V.sorting_mode)!=null?I:"basename",order:c((te=(ee=P?.data)==null?void 0:ee.favorites)==null?void 0:te.sorting_direction)},u.value={sortBy:(re=(ne=(ie=P?.data)==null?void 0:ie.recent)==null?void 0:ne.sorting_mode)!=null?re:"basename",order:c((se=(ae=P?.data)==null?void 0:ae.recent)==null?void 0:se.sorting_direction)}}catch(P){console.error("Could not load files views",P),Q(S("Could not load files views"))}});const N=f(()=>W(e||"files")==="files"?b.value:W(e)==="recent"?u.value:w.value),L=f(()=>N.value.sortBy),d=f(()=>N.value.order);return{filesViewConfig:b,favoritesViewConfig:w,recentViewConfig:u,currentConfig:N,sortBy:L,order:d}},Gt={name:"MenuUpIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Qt=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon menu-up-icon",attrs:{"aria-hidden":e.title?null:!0,"aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M7,15L12,10L17,15H7Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Jt=[],Xt=x(Gt,Qt,Jt,!1,null,null);const Yt=Xt.exports,ei={name:"MenuDownIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var ti=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon menu-down-icon",attrs:{"aria-hidden":e.title?null:!0,"aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M7,10L12,15L17,10H7Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},ii=[],ni=x(ei,ti,ii,!1,null,null);const ri=ni.exports,xe={"file-picker__file-icon":"_file-picker__file-icon_19mjt_9"},ai=$({__name:"LoadingTableRow",props:{showCheckbox:{type:Boolean}},setup(e){return{__sfc:!0,fileListIconStyles:xe}}});var si=function(){var e=this,i=e._self._c,t=e._self._setupProxy;return i("tr",{staticClass:"file-picker__row loading-row",attrs:{"aria-hidden":"true"}},[e.showCheckbox?i("td",{staticClass:"row-checkbox"},[i("span")]):e._e(),i("td",{staticClass:"row-name"},[i("div",{staticClass:"row-wrapper"},[i("span",{class:t.fileListIconStyles["file-picker__file-icon"]}),i("span")])]),e._m(0),e._m(1)])},li=[function(){var e=this,i=e._self._c;return e._self._setupProxy,i("td",{staticClass:"row-size"},[i("span")])},function(){var e=this,i=e._self._c;return e._self._setupProxy,i("td",{staticClass:"row-modified"},[i("span")])}],oi=x(ai,si,li,!1,null,"15187afc");const ci=oi.exports,ui=new Ze({concurrency:5});function di(e){const{resolve:i,promise:t}=Promise.withResolvers();return ui.add(()=>{const n=new Image;return n.onerror=()=>i(!1),n.onload=()=>i(!0),n.src=e,t}),t}function pi(e,i={}){var t;i={size:32,cropPreview:!1,mimeFallback:!0,...i};try{const n=((t=e.attributes)==null?void 0:t.previewUrl)||X("/core/preview?fileId={fileid}",{fileid:e.fileid});let r;try{r=new URL(n)}catch{r=new URL(n,window.location.origin)}return r.searchParams.set("x","".concat(i.size)),r.searchParams.set("y","".concat(i.size)),r.searchParams.set("mimeFallback","".concat(i.mimeFallback)),r.searchParams.set("a",i.cropPreview===!0?"0":"1"),r.searchParams.set("c","".concat(e.attributes.etag)),r}catch{return null}}const fi=(e,i)=>{const t=_(null),n=_(!1);return ze(()=>{n.value=!1,t.value=pi(W(e),W(i||{})),t.value&&di(t.value.href).then(r=>{n.value=r})}),{previewURL:t,previewLoaded:n}},mi={name:"FolderIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var hi=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon folder-icon",attrs:{"aria-hidden":e.title?null:!0,"aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},vi=[],gi=x(mi,hi,vi,!1,null,null);const Le=gi.exports,yi={name:"FilePreview"},_i=$({...yi,props:{node:null,cropImagePreviews:{type:Boolean}},setup(e){const i=e,t=_(xe),{previewURL:n,previewLoaded:r}=fi(T(i,"node"),f(()=>({cropPreview:i.cropImagePreviews}))),a=f(()=>i.node.type===J.File);return{__sfc:!0,fileListIconStyles:t,props:i,previewURL:n,previewLoaded:r,isFile:a,IconFile:Ne,IconFolder:Le}}});var bi=function(){var e=this,i=e._self._c,t=e._self._setupProxy;return i("div",{class:t.fileListIconStyles["file-picker__file-icon"],style:t.previewLoaded?{backgroundImage:"url(".concat(t.previewURL,")")}:void 0},[t.previewLoaded?e._e():[t.isFile?i(t.IconFile,{attrs:{size:20}}):i(t.IconFolder,{attrs:{size:20}})]],2)},wi=[],Ci=x(_i,bi,wi,!1,null,null);const ki=Ci.exports,Si=$({__name:"FileListRow",props:{allowPickDirectory:{type:Boolean},selected:{type:Boolean},showCheckbox:{type:Boolean},canPick:{type:Boolean},node:null,cropImagePreviews:{type:Boolean}},emits:["update:selected","enter-directory"],setup(e,{emit:i}){const t=e,n=f(()=>{var p;return((p=t.node.attributes)==null?void 0:p.displayName)||t.node.basename.slice(0,t.node.extension?-t.node.extension.length:void 0)}),r=f(()=>t.node.extension),a=f(()=>t.node.type===J.Folder),s=f(()=>t.canPick&&(t.allowPickDirectory||!a.value));function l(){i("update:selected",!t.selected)}function m(){a.value?i("enter-directory",t.node):l()}function o(p){p.key==="Enter"&&m()}return{__sfc:!0,props:t,emit:i,displayName:n,fileExtension:r,isDirectory:a,isPickable:s,toggleSelected:l,handleClick:m,handleKeyDown:o,formatFileSize:He,NcCheckboxRadioSwitch:ye,NcDateTime:Rt,t:S,FilePreview:ki}}});var Ni=function(){var e=this,i=e._self._c,t=e._self._setupProxy;return i("tr",e._g({class:["file-picker__row",{"file-picker__row--selected":e.selected&&!e.showCheckbox}],attrs:{tabindex:e.showCheckbox&&!t.isDirectory?void 0:0,"aria-selected":t.isPickable?e.selected:void 0,"data-filename":e.node.basename,"data-testid":"file-list-row"}},{click:t.handleClick,...!e.showCheckbox||t.isDirectory?{keydown:t.handleKeyDown}:{}}),[e.showCheckbox?i("td",{staticClass:"row-checkbox",on:{click:function(n){return n.stopPropagation(),(()=>{}).apply(null,arguments)}}},[i(t.NcCheckboxRadioSwitch,{attrs:{"aria-label":t.t("Select the row for {nodename}",{nodename:t.displayName}),checked:e.selected,disabled:!t.isPickable,"data-testid":"row-checkbox"},on:{"update:checked":t.toggleSelected}})],1):e._e(),i("td",{staticClass:"row-name"},[i("div",{staticClass:"file-picker__name-container",attrs:{"data-testid":"row-name"}},[i(t.FilePreview,{attrs:{node:e.node,"crop-image-previews":e.cropImagePreviews}}),i("div",{staticClass:"file-picker__file-name",attrs:{title:t.displayName},domProps:{textContent:e._s(t.displayName)}}),i("div",{staticClass:"file-picker__file-extension",domProps:{textContent:e._s(t.fileExtension)}})],1)]),i("td",{staticClass:"row-size"},[e._v(" "+e._s(t.formatFileSize(e.node.size||0))+" ")]),i("td",{staticClass:"row-modified"},[i(t.NcDateTime,{attrs:{timestamp:e.node.mtime,"ignore-seconds":!0}})],1)])},Fi=[],xi=x(Si,Ni,Fi,!1,null,"cb12dccb");const Li=xi.exports,Bi=$({__name:"FileList",props:{currentView:null,multiselect:{type:Boolean},allowPickDirectory:{type:Boolean},loading:{type:Boolean},files:null,selectedFiles:null,path:null},emits:["update:path","update:selectedFiles"],setup(e,{emit:i}){const t=e,n=_(),{currentConfig:r}=Kt(t.currentView),a=f(()=>{var d;return(d=n.value)!=null?d:r.value}),s=f(()=>a.value.sortBy==="basename"?a.value.order==="none"?void 0:a.value.order:void 0),l=f(()=>a.value.sortBy==="size"?a.value.order==="none"?void 0:a.value.order:void 0),m=f(()=>a.value.sortBy==="mtime"?a.value.order==="none"?void 0:a.value.order:void 0),o=d=>{a.value.sortBy===d?a.value.order==="ascending"?n.value={sortBy:a.value.sortBy,order:"descending"}:n.value={sortBy:a.value.sortBy,order:"ascending"}:n.value={sortBy:d,order:"ascending"}},{sortFavoritesFirst:p,cropImagePreviews:v}=Fe(),y=f(()=>Ve(t.files,{sortFoldersFirst:!0,sortFavoritesFirst:p.value,sortingOrder:a.value.order==="descending"?"desc":"asc",sortingMode:a.value.sortBy})),c=f(()=>t.files.filter(d=>t.allowPickDirectory||d.type!==J.Folder)),C=f(()=>!t.loading&&t.selectedFiles.length>0&&t.selectedFiles.length>=c.value.length);function b(){t.selectedFiles.length<c.value.length?i("update:selectedFiles",c.value):i("update:selectedFiles",[])}function u(d){t.selectedFiles.includes(d)?i("update:selectedFiles",t.selectedFiles.filter(k=>k.path!==d.path)):t.multiselect?i("update:selectedFiles",[...t.selectedFiles,d]):i("update:selectedFiles",[d])}function w(d){i("update:path",d.path)}const N=_(4),L=_();{const d=()=>Pe(()=>{var k,B,h,g,z;const D=((B=(k=L.value)==null?void 0:k.parentElement)==null?void 0:B.children)||[];let V=((g=(h=L.value)==null?void 0:h.parentElement)==null?void 0:g.clientHeight)||450;for(let I=0;I<D.length;I++)(z=L.value)!=null&&z.isSameNode(D[I])||(V-=D[I].clientHeight);N.value=Math.max(1,Math.floor((V-50)/50))});M(()=>{window.addEventListener("resize",d),d()}),Be(()=>{window.removeEventListener("resize",d)})}return{__sfc:!0,props:t,emit:i,customSortingConfig:n,filesAppSorting:r,sortingConfig:a,sortByName:s,sortBySize:l,sortByModified:m,toggleSorting:o,sortFavoritesFirst:p,cropImagePreviews:v,sortedFiles:y,selectableFiles:c,allSelected:C,onSelectAll:b,onNodeSelected:u,onChangeDirectory:w,skeletonNumber:N,fileContainer:L,NcButton:K,NcCheckboxRadioSwitch:ye,t:S,IconSortAscending:Yt,IconSortDescending:ri,LoadingTableRow:ci,FileListRow:Li}}});var Pi=function(){var e=this,i=e._self._c,t=e._self._setupProxy;return i("div",{ref:"fileContainer",staticClass:"file-picker__files"},[i("table",[i("thead",[i("tr",[e.multiselect?i("th",{staticClass:"row-checkbox"},[i("span",{staticClass:"hidden-visually"},[e._v(" "+e._s(t.t("Select entry"))+" ")]),e.multiselect?i(t.NcCheckboxRadioSwitch,{attrs:{"aria-label":t.t("Select all entries"),checked:t.allSelected,"data-testid":"select-all-checkbox"},on:{"update:checked":t.onSelectAll}}):e._e()],1):e._e(),i("th",{staticClass:"row-name",attrs:{"aria-sort":t.sortByName}},[i("div",{staticClass:"header-wrapper"},[i("span",{staticClass:"file-picker__header-preview"}),i(t.NcButton,{attrs:{wide:!0,type:"tertiary","data-test":"file-picker_sort-name"},on:{click:function(n){return t.toggleSorting("basename")}},scopedSlots:e._u([{key:"icon",fn:function(){return[t.sortByName==="ascending"?i(t.IconSortAscending,{attrs:{size:20}}):t.sortByName==="descending"?i(t.IconSortDescending,{attrs:{size:20}}):i("span",{staticStyle:{width:"44px"}})]},proxy:!0}])},[e._v(" "+e._s(t.t("Name"))+" ")])],1)]),i("th",{staticClass:"row-size",attrs:{"aria-sort":t.sortBySize}},[i(t.NcButton,{attrs:{wide:!0,type:"tertiary"},on:{click:function(n){return t.toggleSorting("size")}},scopedSlots:e._u([{key:"icon",fn:function(){return[t.sortBySize==="ascending"?i(t.IconSortAscending,{attrs:{size:20}}):t.sortBySize==="descending"?i(t.IconSortDescending,{attrs:{size:20}}):i("span",{staticStyle:{width:"44px"}})]},proxy:!0}])},[e._v(" "+e._s(t.t("Size"))+" ")])],1),i("th",{staticClass:"row-modified",attrs:{"aria-sort":t.sortByModified}},[i(t.NcButton,{attrs:{wide:!0,type:"tertiary"},on:{click:function(n){return t.toggleSorting("mtime")}},scopedSlots:e._u([{key:"icon",fn:function(){return[t.sortByModified==="ascending"?i(t.IconSortAscending,{attrs:{size:20}}):t.sortByModified==="descending"?i(t.IconSortDescending,{attrs:{size:20}}):i("span",{staticStyle:{width:"44px"}})]},proxy:!0}])},[e._v(" "+e._s(t.t("Modified"))+" ")])],1)])]),i("tbody",[e.loading?e._l(t.skeletonNumber,function(n){return i(t.LoadingTableRow,{key:n,attrs:{"show-checkbox":e.multiselect}})}):e._l(t.sortedFiles,function(n){return i(t.FileListRow,{key:n.fileid||n.path,attrs:{"allow-pick-directory":e.allowPickDirectory,"show-checkbox":e.multiselect,"can-pick":e.multiselect||e.selectedFiles.length===0||e.selectedFiles.includes(n),selected:e.selectedFiles.includes(n),node:n,"crop-image-previews":t.cropImagePreviews},on:{"update:selected":function(r){return t.onNodeSelected(n)},"enter-directory":t.onChangeDirectory}})})],2)])])},zi=[],Ii=x(Bi,Pi,zi,!1,null,"006fdbd0");const $i=Ii.exports,Di={name:"HomeIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Vi=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon home-icon",attrs:{"aria-hidden":e.title?null:!0,"aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Ai=[],Oi=x(Di,Vi,Ai,!1,null,null);const Mi=Oi.exports,Hi={name:"PlusIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Ri=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon plus-icon",attrs:{"aria-hidden":e.title?null:!0,"aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Ei=[],Ti=x(Hi,Ri,Ei,!1,null,null);const Wi=Ti.exports,ji=$({__name:"FilePickerBreadcrumbs",props:{path:null,showMenu:{type:Boolean}},emits:["update:path","create-node"],setup(e,{emit:i}){const t=e,n=_(!1),r=_(""),a=_();function s(){var o,p,v,y;const c=r.value.trim(),C=(p=(o=a.value)==null?void 0:o.$el)==null?void 0:p.querySelector("input");let b="";return c.length===0?b=S("Folder name cannot be empty."):c.includes("/")?b=S('"/" is not allowed inside a folder name.'):["..","."].includes(c)?b=S('"{name}" is an invalid folder name.',{name:c}):(v=window.OC.config)!=null&&v.blacklist_files_regex&&c.match((y=window.OC.config)==null?void 0:y.blacklist_files_regex)&&(b=S('"{name}" is not an allowed folder name',{name:c})),C&&C.setCustomValidity(b),b===""}const l=function(){const o=r.value.trim();s()&&(n.value=!1,i("create-node",o),r.value="")},m=f(()=>t.path.split("/").filter(o=>o!=="").map((o,p,v)=>({name:o,path:"/"+v.slice(0,p+1).join("/")})));return{__sfc:!0,props:t,emit:i,actionsOpen:n,newNodeName:r,nameInput:a,validateInput:s,onSubmit:l,pathElements:m,IconFolder:Le,IconHome:Mi,IconPlus:Wi,NcActions:q,NcActionInput:Ke,NcBreadcrumbs:Vt,NcBreadcrumb:we,t:S}}});var Zi=function(){var e=this,i=e._self._c,t=e._self._setupProxy;return i(t.NcBreadcrumbs,{staticClass:"file-picker__breadcrumbs",scopedSlots:e._u([{key:"default",fn:function(){return[i(t.NcBreadcrumb,{attrs:{name:t.t("All files"),title:t.t("Home")},on:{click:function(n){return t.emit("update:path","/")}},scopedSlots:e._u([{key:"icon",fn:function(){return[i(t.IconHome,{attrs:{size:20}})]},proxy:!0}])}),e._l(t.pathElements,function(n){return i(t.NcBreadcrumb,{key:n.path,attrs:{name:n.name,title:n.path},on:{click:function(r){return t.emit("update:path",n.path)}}})})]},proxy:!0},e.showMenu?{key:"actions",fn:function(){return[i(t.NcActions,{attrs:{"aria-label":t.t("Create directory"),"force-menu":!0,"force-name":!0,"menu-name":t.t("New"),open:t.actionsOpen,type:"secondary"},on:{"update:open":function(n){t.actionsOpen=n},close:function(n){t.newNodeName=""}},scopedSlots:e._u([{key:"icon",fn:function(){return[i(t.IconPlus,{attrs:{size:20}})]},proxy:!0}],null,!1,2971667417)},[i(t.NcActionInput,{ref:"nameInput",attrs:{value:t.newNodeName,label:t.t("New folder"),placeholder:t.t("New folder name")},on:{"update:value":function(n){t.newNodeName=n},submit:t.onSubmit,input:t.validateInput},scopedSlots:e._u([{key:"icon",fn:function(){return[i(t.IconFolder,{attrs:{size:20}})]},proxy:!0}],null,!1,1614167509)})],1)]},proxy:!0}:null],null,!0)})},Ui=[],qi=x(ji,Zi,Ui,!1,null,"b357227a");const Ki=qi.exports,Gi={name:"CloseIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Qi=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon close-icon",attrs:{"aria-hidden":e.title?null:!0,"aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Ji=[],Xi=x(Gi,Qi,Ji,!1,null,null);const Yi=Xi.exports,en={name:"MagnifyIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var tn=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon magnify-icon",attrs:{"aria-hidden":e.title?null:!0,"aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},nn=[],rn=x(en,tn,nn,!1,null,null);const an=rn.exports,sn=e=>{const i=[{id:"files",label:S("All files"),icon:Tt},{id:"recent",label:S("Recent"),icon:Et},{id:"favorites",label:S("Favorites"),icon:Wt}],t=e.value?i.filter(({id:n})=>n==="files"):i;return{allViews:i,availableViews:t}},ln=$({__name:"FilePickerNavigation",props:{currentView:null,filterString:null,isCollapsed:{type:Boolean},disabledNavigation:{type:Boolean}},emits:["update:currentView","update:filterString"],setup(e,{emit:i}){const t=e,{availableViews:n}=sn(_(et()===null)),r=f(()=>{var a;return(a=n.filter(s=>s.id===t.currentView)[0])!=null?a:n[0]});return{__sfc:!0,props:t,emit:i,availableViews:n,currentViewObject:r,updateFilterValue:a=>i("update:filterString",a),IconClose:Yi,IconMagnify:an,NcButton:K,NcIconSvgWrapper:Ie,NcSelect:Ge,NcTextField:Qe,Fragment:Se,t:S}}});var on=function(){var e=this,i=e._self._c,t=e._self._setupProxy;return i(t.Fragment,[i(t.NcTextField,{staticClass:"file-picker__filter-input",attrs:{value:e.filterString,label:t.t("Filter file list"),"show-trailing-button":!!e.filterString},on:{"update:value":t.updateFilterValue,"trailing-button-click":function(n){return t.updateFilterValue("")}},scopedSlots:e._u([{key:"trailing-button-icon",fn:function(){return[i(t.IconClose,{attrs:{size:16}})]},proxy:!0}])},[i(t.IconMagnify,{attrs:{size:16}})],1),t.availableViews.length>1&&!e.disabledNavigation?[e.isCollapsed?i(t.NcSelect,{attrs:{"aria-label":t.t("Current view selector"),clearable:!1,searchable:!1,options:t.availableViews,value:t.currentViewObject},on:{input:n=>t.emit("update:currentView",n.id)}}):i("ul",{staticClass:"file-picker__side"},e._l(t.availableViews,function(n){return i("li",{key:n.id},[i(t.NcButton,{attrs:{type:e.currentView===n.id?"primary":"tertiary",wide:!0},on:{click:function(r){return e.$emit("update:currentView",n.id)}},scopedSlots:e._u([{key:"icon",fn:function(){return[i(t.NcIconSvgWrapper,{attrs:{path:n.icon,size:20}})]},proxy:!0}],null,!0)},[e._v(" "+e._s(n.label)+" ")])],1)}),0)]:e._e()],2)},cn=[],un=x(ln,on,cn,!1,null,"b42054b8");const dn=un.exports,pn=function(e,i){const t=G(),n=t?"/":Ae,r=f(()=>t?nt("webdav").replace("/remote.php","/public.php"):$e),a=f(()=>{if(t){const u=document.getElementById("sharingToken").value,w=btoa("".concat(u,":null"));return oe(r.value,{Authorization:"Basic ".concat(w)})}return oe()}),s=u=>Oe(u,n,r.value),l=()=>{const u=new AbortController,w=Math.round(Date.now()/1e3)-60*60*24*14;return new ue(async(N,L,d)=>{d(()=>u.abort());try{const{data:k}=await a.value.search("/",{signal:u.signal,details:!0,data:Me(w)}),B=k.results.map(s);N(B)}catch(k){L(k)}})},m=()=>{const u=new AbortController;return new ue(async(w,N,L)=>{L(()=>u.abort());try{const d=(await a.value.getDirectoryContents("".concat(n).concat(i.value),{signal:u.signal,details:!0,includeSelf:!0,data:ce()})).data.map(s);w({folder:d.find(k=>k.path===i.value),contents:d.filter(k=>k.path!==i.value)})}catch(d){N(d)}})},o=U([]),p=U(null),v=_(!0),y=_(null);async function c(u){const w=le.join(i.value,u);await a.value.createDirectory(le.join(n,w));const N=await C(w);return o.value=[...o.value,N],N}async function C(u,w=void 0){w=w??n;const{data:N}=await a.value.stat("".concat(w).concat(u),{details:!0,data:ce()});return s(N)}async function b(){y.value&&y.value.cancel(),v.value=!0,e.value==="favorites"?y.value=De(a.value,i.value,n):e.value==="recent"?y.value=l():y.value=m();const u=await y.value;"folder"in u?(p.value=u.folder,o.value=u.contents):(p.value=null,o.value=u),y.value=null,v.value=!1}return ge([e,i],()=>b()),M(()=>b()),{isLoading:v,files:o,folder:p,loadFiles:b,createDirectory:c}},fn=function(e){const i=f(()=>e.value.map(t=>t.split("/")));return{isSupportedMimeType:t=>{const n=t.split("/");return i.value.some(([r,a])=>(n[0]===r||r==="*")&&(n[1]===a||a==="*"))}}},mn={name:"FilePicker"},hn=$({...mn,props:{buttons:null,name:null,allowPickDirectory:{type:Boolean,default:!1},disabledNavigation:{type:Boolean,default:!1},container:{default:"body"},filterFn:{default:void 0},mimetypeFilter:{default:()=>[]},multiselect:{type:Boolean,default:!0},path:{default:void 0}},emits:["close"],setup(e,{emit:i}){const t=e,n=_(!0),r=f(()=>{const h=o.value.length===0&&t.allowPickDirectory&&u.value?[u.value]:o.value;return(typeof t.buttons=="function"?t.buttons(h,y.value,l.value):t.buttons).map(g=>({...g,disabled:g.disabled||w.value,callback:()=>{a=!0,s(g.callback,h)}}))});let a=!1;const s=async(h,g)=>{h(g),i("close",g),a=!1},l=_("files"),m=f(()=>l.value==="favorites"?S("Favorites"):l.value==="recent"?S("Recent"):""),o=U([]),p=_(window?.sessionStorage.getItem("NC.FilePicker.LastPath")||"/"),v=_("");ge([v],()=>{t.path===void 0&&v.value&&window.sessionStorage.setItem("NC.FilePicker.LastPath",v.value),o.value=[]});const y=f({get:()=>l.value==="files"?v.value||t.path||p.value:"/",set:h=>{v.value=h}}),c=_(""),{isSupportedMimeType:C}=fn(T(t,"mimetypeFilter")),{files:b,folder:u,isLoading:w,loadFiles:N,createDirectory:L}=pn(l,y);M(()=>N());const{showHiddenFiles:d}=Fe(),k=f(()=>{let h=b.value;return d.value||(h=h.filter(g=>!g.basename.startsWith("."))),t.mimetypeFilter.length>0&&(h=h.filter(g=>g.type==="folder"||g.mime&&C(g.mime))),c.value&&(h=h.filter(g=>g.basename.toLowerCase().includes(c.value.toLowerCase()))),t.filterFn&&(h=h.filter(g=>t.filterFn(g))),h}),B=f(()=>l.value==="files"?S("Upload some content or sync with your devices!"):l.value==="recent"?S("Files and folders you recently modified will show up here."):S("Files and folders you mark as favorite will show up here."));return{__sfc:!0,props:t,emit:i,isOpen:n,dialogButtons:r,isHandlingCallback:a,handleButtonClick:s,currentView:l,viewHeadline:m,selectedFiles:o,savedPath:p,navigatedPath:v,currentPath:y,filterString:c,isSupportedMimeType:C,files:b,currentFolder:u,isLoading:w,loadFiles:N,createDirectory:L,showHiddenFiles:d,filteredFiles:k,noFilesDescription:B,onCreateFolder:async h=>{try{const g=await L(h);v.value=g.path,Ye("files:node:created",b.value.filter(z=>z.basename===h)[0])}catch(g){console.warn("Could not create new folder",{name:h,error:g}),Q(S("Could not create the new folder"))}},handleClose:h=>{!h&&!a&&i("close")},IconFile:Ne,FileList:$i,FilePickerBreadcrumbs:Ki,FilePickerNavigation:dn,NcDialog:Ue,NcEmptyContent:qe,t:S}}});var vn=function(){var e=this,i=e._self._c,t=e._self._setupProxy;return i(t.NcDialog,{attrs:{container:e.container,buttons:t.dialogButtons,name:e.name,size:"large","content-classes":"file-picker__content","dialog-classes":"file-picker","navigation-classes":"file-picker__navigation",open:t.isOpen},on:{"update:open":[function(n){t.isOpen=n},t.handleClose]},scopedSlots:e._u([{key:"navigation",fn:function({isCollapsed:n}){return[i(t.FilePickerNavigation,{attrs:{"is-collapsed":n,"current-view":t.currentView,"filter-string":t.filterString,"disabled-navigation":e.disabledNavigation},on:{"update:currentView":function(r){t.currentView=r},"update:current-view":function(r){t.currentView=r},"update:filterString":function(r){t.filterString=r},"update:filter-string":function(r){t.filterString=r}}})]}}])},[i("div",{staticClass:"file-picker__main"},[t.currentView==="files"?i(t.FilePickerBreadcrumbs,{attrs:{path:t.currentPath,"show-menu":e.allowPickDirectory},on:{"update:path":function(n){t.currentPath=n},"create-node":t.onCreateFolder}}):i("div",{staticClass:"file-picker__view"},[i("h3",[e._v(e._s(t.viewHeadline))])]),t.isLoading||t.filteredFiles.length>0?i(t.FileList,{attrs:{"allow-pick-directory":e.allowPickDirectory,"current-view":t.currentView,files:t.filteredFiles,multiselect:e.multiselect,loading:t.isLoading,path:t.currentPath,"selected-files":t.selectedFiles,name:t.viewHeadline},on:{"update:path":[function(n){t.currentPath=n},function(n){t.currentView="files"}],"update:selectedFiles":function(n){t.selectedFiles=n},"update:selected-files":function(n){t.selectedFiles=n}}}):t.filterString?i(t.NcEmptyContent,{attrs:{name:t.t("No matching files"),description:t.t("No files matching your filter were found.")},scopedSlots:e._u([{key:"icon",fn:function(){return[i(t.IconFile)]},proxy:!0}])}):i(t.NcEmptyContent,{attrs:{name:t.t("No files in here"),description:t.noFilesDescription},scopedSlots:e._u([{key:"icon",fn:function(){return[i(t.IconFile)]},proxy:!0}])})],1)])},gn=[],yn=x(hn,vn,gn,!1,null,"20b719ba");const Vn=yn.exports;export{Vn as default};
//# sourceMappingURL=FilePicker-ajWx2Snh-7OW9M1nM.chunk.mjs.map
