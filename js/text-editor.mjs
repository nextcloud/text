const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=[window.OC.filePath('text', '', 'js/MarkdownContentEditor-DX4uZ6Za.chunk.mjs'),window.OC.filePath('text', '', 'js/Wrapper-C-YbZj5i.chunk.mjs'),window.OC.filePath('text', '', 'js/NcLoadingIcon-CBTC2zMe.chunk.mjs'),window.OC.filePath('text', '', 'js/vue.runtime.esm-B7-PK3p1.chunk.mjs'),window.OC.filePath('text', '', 'js/emoji-picker-hi3Hwbeu.chunk.mjs'),window.OC.filePath('text', '', 'js/index-CdM8BgQf.chunk.mjs'),window.OC.filePath('text', '', 'js/index-DCzdQJ7L.chunk.mjs'),window.OC.filePath('text', '', 'css/NcLoadingIcon-KhuNWNbx.chunk.css'),window.OC.filePath('text', '', 'js/logger-DS8A9d_w.chunk.mjs'),window.OC.filePath('text', '', 'js/index-Bnw2WuIx.chunk.mjs'),window.OC.filePath('text', '', 'js/index-D3wiQe9-.chunk.mjs'),window.OC.filePath('text', '', 'js/preload-helper-BorfeO-5.chunk.mjs'),window.OC.filePath('text', '', 'js/NcCheckboxRadioSwitch-CgbTELjq-BFpDVXaF.chunk.mjs'),window.OC.filePath('text', '', 'css/NcCheckboxRadioSwitch-CgbTELjq-yZHRUesB.chunk.css'),window.OC.filePath('text', '', 'js/NcNoteCard-CwNXZ4vV-Dyi378DT.chunk.mjs'),window.OC.filePath('text', '', 'css/NcNoteCard-CwNXZ4vV-CAMZkS3U.chunk.css'),window.OC.filePath('text', '', 'js/MediaHandler.provider-BoQN9QHH.chunk.mjs'),window.OC.filePath('text', '', 'css/Wrapper-DvM8Zo5N.chunk.css'),window.OC.filePath('text', '', 'js/MenuBar-C6IVBKu2.chunk.mjs'),window.OC.filePath('text', '', 'css/MenuBar-nIM-GMTV.chunk.css'),window.OC.filePath('text', '', 'css/MarkdownContentEditor-Cxcjv1d6.chunk.css'),window.OC.filePath('text', '', 'js/Editor-BPQLTPrK.chunk.mjs'),window.OC.filePath('text', '', 'js/index-kwZOOyqh.chunk.mjs'),window.OC.filePath('text', '', 'css/Editor-WVhMK67-.chunk.css'),window.OC.filePath('text', '', 'js/PlainTableContentEditor-DQ_Mj8Xy.chunk.mjs')])))=>i.map(i=>d[i]);
import{_ as C}from"./preload-helper-BorfeO-5.chunk.mjs";import{s as g,e as U}from"./index-CdM8BgQf.chunk.mjs";import{V as v}from"./vue.runtime.esm-B7-PK3p1.chunk.mjs";import{o as $,A as M,O as j,H as B,a as H,E as R,b as V}from"./MediaHandler.provider-BoQN9QHH.chunk.mjs";import"./emoji-picker-hi3Hwbeu.chunk.mjs";import"./index-D3wiQe9-.chunk.mjs";import"./index-DCzdQJ7L.chunk.mjs";import"./logger-DS8A9d_w.chunk.mjs";import"./index-Bnw2WuIx.chunk.mjs";function O(p){return encodeURIComponent(p).replace(/[!'()*]/g,t=>"%"+t.charCodeAt(0).toString(16).toUpperCase())}const D="1.4";window.OCA.Text={...window.OCA.Text};class b{#t;#n;constructor(t,e){return this.#t=t,this.#n=e,this.#o(),this}#e(){return this.#t.$children[0]}onCreate(t=()=>{}){return this.#t.$on("create:content",e=>{t(e)}),this}onLoaded(t=()=>{}){return this.#t.$on("ready",()=>{t()}),this}onUpdate(t=()=>{}){return this.#t.$on("update:content",e=>{t(e)}),this}onSearch(t=()=>{}){return g("text:editor:search-results",t),this}onTocToggle(t=()=>{}){return g("text:toc:toggled",t),this}onTocPin(t=()=>{}){return g("text:toc:pin",t),this}onAttachmentsUpdated(t=()=>{}){return g("text:editor:attachments:updated",t),this}render(t){t.innerHTML="";const e=document.createElement("div");return t.appendChild(e),this.#t.$mount(e),this}destroy(){this.#t.$destroy(),this.#t.$el.innerHTML=""}setContent(t){return this.#t.$set(this.#n,"content",t),this.#e()?.setContent?.(t),this}getHTML(){return this.#e()?.editor?.getHTML()}setSearchQuery(t,e){this.#e()?.editor?.commands.setSearchQuery(t,e)}searchNext(){this.#e()?.editor?.commands.nextMatch()}searchPrevious(){this.#e()?.editor?.commands.previousMatch()}async save(){return this.#e().save?.()}setShowOutline(t){return U("text:toc:toggle",{visible:t}),this}setReadOnly(t){return this.#t.$set(this.#n,"readOnly",t),this}updateReadonlyBarProps(t){return this.#t.$set(this.#n,"readonlyBarProps",t),this}insertAtCursor(t){this.#e().editor?.chain().insertContent(t).focus().run()}replaceAttachmentFilename(t,e,r){const a=".attachments."+t+"/"+O(e),d=".attachments."+t+"/"+O(r),{view:c,state:s}=this.#e().editor,{doc:n,schema:h,tr:o}=s;let l=!1;n.descendants((m,T)=>{!m.type===h.nodes.image||m.attrs.src!==a||(o.setNodeMarkup(T,void 0,{...m.attrs,src:d,alt:m.attrs.alt.replace(e,r)}),l=!0)}),l&&(c.dispatch(o),this.save())}removeAttachmentReferences(t,e){const r=".attachments."+t+"/"+O(e),{view:a,state:d}=this.#e().editor,{doc:c,schema:s,tr:n}=d;let h=!1;c.descendants((o,l)=>{!o.type===s.nodes.image||o.attrs.src!==r||(n.delete(l,l+o.nodeSize),h=!0)}),h&&(a.dispatch(n),this.save())}focus(){this.#e().editor?.commands.focus()}debugYjs(){const t=this.#e().debugYjsData();console.warn(JSON.stringify(t,null," ")),console.warn(`%c%s
%c%s
%s`,"font-weight: bold;",'Editor Yjs debug data. Copy the object below that starts with "clientId".',"font-weight: normal; font-style: italic;",'- In Chrome, select "Copy" at the end of the line.','- In Firefox, right-click on the object and select "Copy object".')}#o(){window?._oc_debug&&(this.vm=this.#t,window.OCA.Text._debug=[...window.OCA.Text._debug??[],this])}}window.OCA.Text.apiVersion=D,window.OCA.Text.createEditor=async function({el:p,fileId:t=void 0,useSession:e=!0,filePath:r=void 0,shareToken:a=null,content:d="",readOnly:c=!1,autofocus:s=!0,readonlyBar:n={component:null,props:null},onCreate:h=({markdown:u})=>{},onLoaded:o=()=>{},onUpdate:l=({markdown:u})=>{},onTocToggle:m=u=>{},onOutlineToggle:T=u=>{},onTocPin:A=(u,_)=>{},onFileInsert:x=void 0,onMentionSearch:L=void 0,onMentionInsert:P=void 0,openLinkHandler:S=void 0,onSearch:k=void 0,onAttachmentsUpdated:I=({attachmentSrcs:u})=>{}}){const{default:u}=await C(async()=>{const{default:i}=await import("./MarkdownContentEditor-DX4uZ6Za.chunk.mjs");return{default:i}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]),import.meta.url),{default:_}=await C(async()=>{const{default:i}=await import("./Editor-BPQLTPrK.chunk.mjs").then(y=>y.a);return{default:i}},__vite__mapDeps([21,11,5,4,22,2,3,6,7,14,10,9,15,1,8,12,13,16,17,18,19,23]),import.meta.url),w=v.observable({readonlyBarProps:n.props,readOnly:c,content:d}),f=t&&e,E=new v({provide(){return{[V]:x,[R]:!!f,[H]:f?!0:L,[B]:f?!0:P,[j]:{openLink:S||$},[M]:{resolve(i,y){return[{type:"image",url:i}]}}}},data(){return w},render:i=>{const y=n?.component?{readonlyBar:()=>i(n.component,{props:w.readonlyBarProps})}:{};return f?i(_,{props:{fileId:t,relativePath:r,shareToken:a,mime:"text/markdown",active:!0,autofocus:s},scopedSlots:y}):i(u,{props:{fileId:t,content:w.content,relativePath:r,shareToken:a,readOnly:w.readOnly},scopedSlots:y})}});return new b(E,w).onCreate(h).onLoaded(o).onUpdate(l).onSearch(k).onTocToggle(T).onTocToggle(m).onTocPin(A).onAttachmentsUpdated(I).render(p)},window.OCA.Text.createTable=async function({el:p,content:t="",readOnly:e=!1,autofocus:r=!0,onCreate:a=({markdown:s})=>{},onLoaded:d=()=>{},onUpdate:c=({markdown:s})=>{}}){const{default:s}=await C(async()=>{const{default:o}=await import("./PlainTableContentEditor-DQ_Mj8Xy.chunk.mjs");return{default:o}},__vite__mapDeps([24,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,20]),import.meta.url),n=v.observable({readOnly:e,content:t}),h=new v({data(){return n},render:o=>o(s,{props:{content:n.content,readOnly:n.readOnly}})});return new b(h,n).onCreate(a).onLoaded(d).onUpdate(c).render(p)};
//# sourceMappingURL=text-editor.mjs.map
