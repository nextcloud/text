import{e as s,R as d,F as l,U as u,c as p,d as m,p as h,f as c}from"./EditorOutline-Nx6MhnrE.chunk.mjs";import{M as f,R as y,A as g}from"./MenuBar-BJi0mizY.chunk.mjs";import{W as w,M as B,C}from"./Wrapper-tvOPcU_n.chunk.mjs";import{g as O}from"./index-CdM8BgQf.chunk.mjs";import{w as a,p as M}from"./vue.runtime.esm-CmyF5LTP.chunk.mjs";import{A as v}from"./MediaHandler.provider-bE4nrOxZ.chunk.mjs";import{n as R}from"./NcCheckboxRadioSwitch-CX3HXCEk-qnG5ZcLO.chunk.mjs";import"./NcLoadingIcon-DAvEVuxu.chunk.mjs";import"./emoji-picker-hi3Hwbeu.chunk.mjs";import"./index-DCzdQJ7L.chunk.mjs";import"./logger-DS8A9d_w.chunk.mjs";import"./index-Bnw2WuIx.chunk.mjs";import"./index-D3wiQe9-.chunk.mjs";import"./NcNoteCard-CwNXZ4vV-wGY_yume.chunk.mjs";import"./preload-helper-BorfeO-5.chunk.mjs";const $={name:"MarkdownContentEditor",components:{ContentContainer:C,ReadonlyBar:y,MenuBar:f,MainContainer:B,Wrapper:w},provide(){const t={};return Object.defineProperties(t,{[v]:{get:()=>this.$attachmentResolver??null}}),t},props:{fileId:{type:Number,default:null},content:{type:String,required:!0},readOnly:{type:Boolean,default:!1},relativePath:{type:String,default:""},shareToken:{type:String,default:null},showMenuBar:{type:Boolean,default:!0},showOutlineOutside:{type:Boolean,default:!1}},emits:["update:content"],setup(t){const e=[d.configure({extensions:[u]}),l],o=new p({extensions:e}),{setEditable:r,setContent:i}=m(o);return a(()=>t.content,n=>{i(n)}),r(!t.readOnly),a(()=>t.readOnly,n=>{r(!n)}),h(o),M(c,{isPublic:!1,isRichEditor:!0,isRichWorkspace:!1}),{editor:o,setContent:i}},created(){this.setContent(this.content,{addToHistory:!1}),this.editor.on("create",()=>{this.$emit("ready"),this.$parent.$emit("ready")}),this.editor.on("update",({editor:t})=>{const e=s(t.schema).serialize(t.state.doc);this.emit("update:content",{json:t.state.doc,markdown:e})}),this.fileId&&(this.$attachmentResolver=new g({currentDirectory:this.relativePath?.match(/.*\//),user:O(),shareToken:this.shareToken,fileId:this.fileId}))},beforeDestroy(){this.editor.destroy()},methods:{outlineToggled(t){this.emit("outline-toggled",t)},emit(t,e){this.$emit(t,e),this.$parent?.$emit(t,e)}}};var k=function(){var t=this,e=t._self._c;return e("Wrapper",{attrs:{"content-loaded":!0,"show-outline-outside":t.showOutlineOutside},on:{"outline-toggled":t.outlineToggled}},[e("MainContainer",[t.showMenuBar?[t.readOnly?t._t("readonlyBar",function(){return[e("ReadonlyBar")]}):e("MenuBar",{attrs:{autohide:!1}})]:t._e(),e("ContentContainer",{attrs:{"read-only":t.readOnly}})],2)],1)},T=[],b=R($,k,T,!1,null,null);const U=b.exports;export{U as default};
//# sourceMappingURL=MarkdownContentEditor-VojvyeEf.chunk.mjs.map
