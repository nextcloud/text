/*! third party licenses: js/vendor.LICENSE.txt */
import{V as r}from"./vue.runtime.esm-DexIh3sa.chunk.mjs";import{E as l}from"./Editor-BSCdRPCr.chunk.mjs";import{l as a}from"./logger-BVmsFChG.chunk.mjs";import{n as d}from"./_plugin-vue2_normalizer-B6NIcHTa.chunk.mjs";import"./modulepreload-polyfill-BV4VlZ1o.chunk.mjs";import"./emoji-picker-I9E7i3AY.chunk.mjs";import"./index-Ubm2itxG.chunk.mjs";import"./RichText-D-IsVdlm.chunk.mjs";import"./NcNoteCard-CImn6F9p-Cqtx687c.chunk.mjs";import"./index-BLukiyfV.chunk.mjs";import"./index-B-M7oNlN.chunk.mjs";import"./MediaHandler.provider-D-YH1kh0.chunk.mjs";import"./_plugin-vue2_normalizer-Ds4SJl6Q-DQicnQZ3.chunk.mjs";import"./Wrapper-NhHAjDU3.chunk.mjs";import"./_commonjs-dynamic-modules-CSduYUN4.chunk.mjs";import"./index-UmbwO-28.chunk.mjs";const n=r.observable({messages:[],mtime:0}),s=(e,i)=>{a.debug("callMobileMessage ".concat(e),{attributes:i});let o=e;typeof i<"u"&&(o={MessageName:e,Values:i});let t=null;try{t=JSON.stringify(i)}catch{t=null}window.DirectEditingMobileInterface&&typeof window.DirectEditingMobileInterface[e]=="function"&&(t===null||typeof t>"u"?window.DirectEditingMobileInterface[e]():window.DirectEditingMobileInterface[e](t)),window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.DirectEditingMobileInterface&&window.webkit.messageHandlers.DirectEditingMobileInterface.postMessage(o),window.postMessage(o)};window.addEventListener("message",function(e){n.messages.push(e.data),a.debug("postMessage",{message:e})});const c={name:"DirectEditing",components:{Editor:l},data(){return{initial:OCP.InitialState.loadState("text","file"),messages:n.messages,log:n,saving:!1}},computed:{initialSession(){return JSON.parse(this.initial.session)||null},isMobile(){return window.DirectEditingMobileInterface||window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.DirectEditingMobileInterface}},beforeMount(){s("loading")},mounted(){document.querySelector('meta[name="viewport"]').setAttribute("content","width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"),this.$refs.editor.$on("push:forbidden",()=>{a.warn("push was forbidden due to invalidated session"),this.reload()})},methods:{async close(){this.saving=!0,setTimeout(async()=>{await this.$refs.editor.$destroy(),s("close")},0)},share(){s("share")},loaded(){s("loaded")},reload(){s("reload")}}};var m=function(){var e=this,i=e._self._c;return i("div",{class:{"icon-loading":e.saving},attrs:{id:"direct-editor"}},[i("Editor",{ref:"editor",attrs:{"initial-session":e.initialSession,"file-id":e.initial.fileId,active:!0,mime:e.initial.mimetype,"is-direct-editing":!0},on:{ready:e.loaded},scopedSlots:e._u([e.isMobile?{key:"header",fn:function(){return[i("button",{staticClass:"icon-share",on:{click:e.share}}),i("button",{staticClass:"icon-close",on:{click:e.close}})]},proxy:!0}:null],null,!0)})],1)},u=[],w=d(c,m,u,!1,null,"942b8c7a",null,null);const C=w.exports;export{C as default};
