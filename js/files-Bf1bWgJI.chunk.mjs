const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=[window.OC.filePath('text', '', 'js/PublicFilesEditor-B0oSZ-gt.chunk.mjs'),window.OC.filePath('text', '', 'js/modulepreload-polyfill-wXdbfrnd.chunk.mjs'),window.OC.filePath('text', '', 'js/emoji-picker-DlAAdvrL.chunk.mjs'),window.OC.filePath('text', '', 'js/NcNoteCard-C6xb7vi0-TeDNRt7L.chunk.mjs'),window.OC.filePath('text', '', 'js/index-DfiDB3im.chunk.mjs'),window.OC.filePath('text', '', 'js/NcLoadingIcon-B-OrvSvi.chunk.mjs'),window.OC.filePath('text', '', 'css/NcLoadingIcon-Bs0OvbBQ.chunk.css'),window.OC.filePath('text', '', 'js/vue.runtime.esm-BfXGYTpD.chunk.mjs'),window.OC.filePath('text', '', 'css/NcNoteCard-C6xb7vi0-D-4T716L.chunk.css'),window.OC.filePath('text', '', 'js/_plugin-vue2_normalizer-wd1ZAbRr.chunk.mjs'),window.OC.filePath('text', '', 'js/RichWorkspace-CBlAdAS4.chunk.mjs'),window.OC.filePath('text', '', 'js/index-DqmKfNT-.chunk.mjs'),window.OC.filePath('text', '', 'js/Editor.singleton-BwGj-I5H.chunk.mjs'),window.OC.filePath('text', '', 'js/RichTextReader-DJftNqLC.chunk.mjs'),window.OC.filePath('text', '', 'js/BaseReader-D_3inxR6.chunk.mjs'),window.OC.filePath('text', '', 'js/EditorOutline-DRpUVh65.chunk.mjs'),window.OC.filePath('text', '', 'js/index-Dkaptjxg.chunk.mjs'),window.OC.filePath('text', '', 'js/NcCheckboxRadioSwitch-BIEYfWtF-DdtlVj8e.chunk.mjs'),window.OC.filePath('text', '', 'css/NcCheckboxRadioSwitch-BIEYfWtF-CKL5tLCP.chunk.css'),window.OC.filePath('text', '', 'js/index-D29f11qk.chunk.mjs'),window.OC.filePath('text', '', 'js/MediaHandler.provider-BeGtKVfw.chunk.mjs'),window.OC.filePath('text', '', 'js/logger-BaSPzHnw.chunk.mjs'),window.OC.filePath('text', '', 'css/EditorOutline-BrhdVDca.chunk.css'),window.OC.filePath('text', '', 'css/BaseReader-CsLFhfbT.chunk.css'),window.OC.filePath('text', '', 'css/RichTextReader-Dd4cx55Q.chunk.css'),window.OC.filePath('text', '', 'css/RichWorkspace-C7xfGJYb.chunk.css')])))=>i.map(i=>d[i]);
import{_ as f,g as w,e as h}from"./modulepreload-polyfill-wXdbfrnd.chunk.mjs";import{g as y,s as v,a as A}from"./NcNoteCard-C6xb7vi0-TeDNRt7L.chunk.mjs";import{H as g,b as F,N as R,P as _,F as O}from"./index-D9wkNP7i.chunk.mjs";import{h as C,c as D}from"./index-DqmKfNT-.chunk.mjs";import{l as H}from"./index-DfiDB3im.chunk.mjs";import{V as P}from"./vue.runtime.esm-BfXGYTpD.chunk.mjs";import{b as m}from"./mime-CuxkK4Yj.chunk.mjs";import{s as T}from"./index-Dkaptjxg.chunk.mjs";import"./emoji-picker-DlAAdvrL.chunk.mjs";import"./NcLoadingIcon-B-OrvSvi.chunk.mjs";import"./index-D29f11qk.chunk.mjs";const V='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-text" viewBox="0 0 24 24"><path d="M21,6V8H3V6H21M3,18H12V16H3V18M3,13H21V11H3V13Z" /></svg>',k="Edit with text app",z=()=>{const r=y(),e=document.querySelector("#preview table.files-filestable");if(!r||!e){const s=document.createElement("div");s.id="text-viewer-fallback",document.body.appendChild(s);const n=i=>OCA.Files.fileActions.register(i,k,OC.PERMISSION_UPDATE|OC.PERMISSION_READ,C("core","actions/rename"),c=>{const d=window.FileList.findFile(c);Promise.all([f(()=>import("./vue.runtime.esm-BfXGYTpD.chunk.mjs").then(a=>a.y),[],import.meta.url),f(()=>import("./PublicFilesEditor-B0oSZ-gt.chunk.mjs"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]),import.meta.url)]).then(a=>{const b=window.FileList.getCurrentDirectory()+"/"+c,p=a[0].default;p.prototype.t=window.t,p.prototype.n=window.n,p.prototype.OCA=window.OCA;const x=a[1].default;new p({render:function(E){const I=this;return E(x,{props:{fileId:d?d.id:null,active:!0,shareToken:r,relativePath:b,mimeType:d.mimetype},on:{close:function(){I.$destroy()}}})}}).$mount(s)})},t("text","Edit"));for(let i=0;i<m.length;i++)n(m[i]),OCA.Files.fileActions.setDefault(m[i],k)}},G=()=>{const r=t("text","Readme")+"."+H("text","default_file_extension");F({id:"rich-workspace-init",displayName:t("text","Add folder description"),category:R.Other,enabled(e){return Number(e.attributes["rich-workspace-file"])?!1:(e.permissions&_.CREATE)!==0},iconSvgInline:V,async handler(e,s){if(s.map(a=>a.basename).includes(r)){v(t("text",'"{name}" already exist!',{name:r}));return}const n=e.encodedSource+"/"+encodeURIComponent(r),i=await D({method:"PUT",url:n,headers:{Overwrite:"F"}}),c=parseInt(i.headers["oc-fileid"]),d=new O({source:e.source+"/"+r,id:c,mtime:new Date,mime:"text/markdown",owner:w()?.uid||null,permissions:_.ALL,root:e?.root||"/files/"+w()?.uid});A(t("text",'Created "{name}"',{name:r})),e.attributes["rich-workspace-file"]=c,e.attributes["rich-workspace"]="",h("files:node:created",d),h("files:node:updated",e)}})};let u,o,l;const J=new g({id:"workspace",order:10,enabled(r,e){return["files","favorites","public-share"].includes(e.id)},render:async(r,e)=>{l=e,u||(u=(await f(()=>import("./RichWorkspace-CBlAdAS4.chunk.mjs"),__vite__mapDeps([10,11,7,1,2,3,4,5,6,8,12,13,14,15,9,16,17,18,19,20,21,22,23,24,25]),import.meta.url)).default),o&&(o.$destroy(),console.debug("Destroying existing FilesHeaderRichWorkspaceInstance"));const s=!!l.attributes["rich-workspace-file"],n=l.attributes["rich-workspace"]||"",i=l.path||"";o=new P({extends:u,propsData:{content:n,hasRichWorkspace:s,path:i},store:T}).$mount(r),window.FilesHeaderRichWorkspaceInstance=o},updated(r){if(l=r,!o){console.error("No vue instance found for FilesWorkspaceHeader");return}const e=!!r.attributes["rich-workspace-file"];o.hasRichWorkspace=e,o.content=r.attributes["rich-workspace"]||"",o.path=r.path||""}});export{k as FILE_ACTION_IDENTIFIER,J as FilesWorkspaceHeader,G as addMenuRichWorkspace,z as registerFileActionFallback};
//# sourceMappingURL=files-Bf1bWgJI.chunk.mjs.map
