import{a as y,r as C}from"./vue.runtime.esm-B7-PK3p1.chunk.mjs";import{t as p,n as B,G as K,c as T,f as x}from"./NcLoadingIcon-CBTC2zMe.chunk.mjs";import{u as f,K as W,L as H,O as P,Q as F,S as L,V as k,w as S,X as D,Y as A,Z as U,_ as V,$ as j,a0 as z,D as Q,a1 as J,a2 as Y,a3 as Z,a4 as q,a5 as G,m as $,a6 as X,a7 as tt,a8 as et}from"./Wrapper-C-YbZj5i.chunk.mjs";import{u as I}from"./MediaHandler.provider-BoQN9QHH.chunk.mjs";import{n as h,u as it}from"./NcCheckboxRadioSwitch-CgbTELjq-BFpDVXaF.chunk.mjs";import{g,b as st}from"./index-DCzdQJ7L.chunk.mjs";import{g as nt}from"./emoji-picker-hi3Hwbeu.chunk.mjs";import{e as rt,N as ot,u as at}from"./NcNoteCard-CwNXZ4vV-Dyi378DT.chunk.mjs";const N=()=>{const{isRichWorkspace:t}=f(),e=W(),i=H(t);return{assistantMenuEntries:e,menuEntries:i,outlineEntries:L,readOnlyDoneEntries:F,readOnlyEditEntries:P}},ct={name:"NcActionButton",components:{NextcloudVueNcActionButton:S},extends:k,mounted(){this.editor?.on("transaction",()=>this.updateState())},methods:{runAction(){const{actionEntry:t}=this;t.click?t.click(this):t.action(this.editor?.chain().focus(),this.editor)?.run(),this.$nextTick(()=>{this.$emit("trigged",{...t})})}}};var lt=function(){var t=this,e=t._self._c;return e("NextcloudVueNcActionButton",t._g({staticClass:"entry-single-action entry-action entry-action-item",class:t.state.class,attrs:{title:t.listItemTooltip||void 0,disabled:t.state.disabled,"aria-keyshortcuts":t.keyshortcuts||void 0,"data-text-action-entry":t.actionEntry.key,"model-value":t.actionType!=="button"?t.state.active:void 0,"close-after-click":""},on:{click:t.runAction},scopedSlots:t._u([{key:"icon",fn:function(){return[e(t.icon,{tag:"component"})]},proxy:!0}])},t.$listeners),[t._v(" "+t._s(t.label)+" ")])},dt=[],ht=h(ct,lt,dt,!1,null,null);const ut=ht.exports,_t={name:"ActionList",components:{NcActions:rt,NcActionSeparator:A,ActionListItem:ut},extends:k,mixins:[D],props:{forceEnabled:{type:Boolean,default:!1}},data:()=>({visible:!1,hasEnabledChild:!0}),computed:{currentChild(){const{state:t,editor:e,actionEntry:{children:i}}=this;return t.active?i.find(s=>j(s,e)):null},icon(){return this.currentChild?this.currentChild.icon:this.actionEntry.icon},iconKey(){return`${this.actionEntry.key}/${this.activeKey}`},activeKey(){return this.currentChild?.key},children(){return this.actionEntry.children.filter(({visible:t})=>t===void 0?!0:typeof t=="function"?t(this):t)},labelWithSelected(){return this.currentChild?p("text",'{menuItemName}, "{selectedSubMenuItemName}" is selected',{menuItemName:this.actionEntry.label,selectedSubMenuItemName:this.currentChild.label}):this.actionEntry.label},isEnabled(){return this.forceEnabled||this.hasEnabledChild}},mounted(){this.$_updateState=V(this.checkStateOfChildren.bind(this),50),this.editor?.on("update",this.$_updateState),this.editor?.on("selectionUpdate",this.$_updateState)},beforeDestroy(){this.editor?.off("update",this.$_updateState),this.editor?.off("selectionUpdate",this.$_updateState)},methods:{onOpenChange(t){this.visible=t},runAction(){},onTrigger(t){t?.click||(this.editor?.chain().focus().run(),this.$emit("trigged",t))},checkStateOfChildren(){this.hasEnabledChild=this.children.some(t=>this.isChildEnabled(t))},isChildEnabled(t){return!t.isSeparator&&!U(t,this.editor).disabled}}};var bt=function(){var t=this,e=t._self._c;return e("NcActions",t._b({staticClass:"entry-list-action entry-action",attrs:{title:t.tooltip,container:t.menuIDSelector,"aria-label":t.labelWithSelected,variant:t.state.active?"primary":"tertiary","force-menu":!0,"data-text-action-entry":t.actionEntry.key,"data-text-action-active":t.activeKey,disabled:!t.isEnabled},on:{"update:open":t.onOpenChange},scopedSlots:t._u([{key:"icon",fn:function(){return[e(t.icon,{key:t.iconKey,tag:"component"})]},proxy:!0}])},"NcActions",t.state,!1),[t._l(t.children,function(i){return[i.isSeparator?e("NcActionSeparator",{key:`child-${i.key}`}):e("ActionListItem",t._g({key:`child-${i.key}`,attrs:{active:t.currentChild?.key===i.key,"is-item":"","action-entry":i},on:{trigged:t.onTrigger}},t.$listeners))]}),t._t("lastAction",null,null,{visible:t.visible})],2)},pt=[],vt=h(_t,bt,pt,!1,null,null);const O=vt.exports,yt={name:"ActionSingle",components:{NcButton:ot},extends:k,props:{isItem:{type:Boolean,default:!1}},mounted(){this.editor?.on("transaction",()=>this.updateState())},methods:{runAction(){const{actionEntry:t}=this;t.click?t.click(this):t.action(this.editor?.chain().focus(),this.editor)?.run(),this.$nextTick(()=>{this.$emit("trigged",{...t})})}}};var mt=function(){var t=this,e=t._self._c;return e("NcButton",t._g({staticClass:"entry-single-action entry-action",class:t.state.class,attrs:{disabled:t.state.disabled,"aria-keyshortcuts":t.keyshortcuts||void 0,"data-text-action-entry":t.actionEntry.key,"aria-label":t.label,title:t.tooltip,variant:"tertiary",pressed:t.actionType!=="button"?t.state.active:void 0},on:{click:t.runAction},scopedSlots:t._u([{key:"icon",fn:function(){return[e(t.icon,{tag:"component"})]},proxy:!0},t.actionEntry.forceLabel?{key:"default",fn:function(){return[t._v(" "+t._s(t.label)+" ")]},proxy:!0}:null],null,!0)},t.$listeners))},ft=[],kt=h(yt,mt,ft,!1,null,null);const w=kt.exports,R=y({data(){return{activeMenuEntry:0,entries:[]}},computed:{visibleEntries(){return this.entries}},watch:{visibleEntries(){this.$nextTick(()=>{(this.activeMenuEntry>this.visibleEntries.length||this.visibleEntries[this.activeMenuEntry]?.disabled)&&this.setNextMenuEntry()})}},methods:{disableMenuEntry(t,e){const i=this.visibleEntries.findIndex(({key:s})=>s===t);this.visibleEntries[i].disabled=e,e===!1&&this.activeMenuEntry===i&&this.$nextTick(()=>this.setNextMenuEntry())},setNextMenuEntry(){const t=this.visibleEntries.length+(this.$refs.remainingEntries?1:0);do this.activeMenuEntry=(this.activeMenuEntry+1)%t;while(this.activeMenuEntry<this.visibleEntries.length&&this.visibleEntries[this.activeMenuEntry].disabled)},setPreviousMenuEntry(){const t=this.visibleEntries.length+(this.$refs.remainingEntries?1:0);do{const e=this.activeMenuEntry-1;this.activeMenuEntry=(e%t+t)%t}while(this.activeMenuEntry<this.visibleEntries.length&&this.visibleEntries[this.activeMenuEntry].disabled)},handleToolbarNavigation(t){t.key==="ArrowRight"?this.setNextMenuEntry():t.key==="ArrowLeft"&&this.setPreviousMenuEntry(),this.activeMenuEntry===this.visibleEntries.length?this.$refs.remainingEntries?.focusButton?.():[...this.$refs.menuEntries].sort((e,i)=>this.visibleEntries.findIndex(({key:s})=>s===e.$vnode.data.key)-this.visibleEntries.findIndex(({key:s})=>s===i.$vnode.data.key))[this.activeMenuEntry].focusButton()}}}),xt=y({name:"ReadonlyBar",components:{ActionList:O,ActionSingle:w},extends:R,mixins:[I],props:{isHidden:{type:Boolean,default:!1},openReadOnly:{type:Boolean,default:!1}},emits:["update:loaded"],setup(){const{isRichWorkspace:t}=f(),{outlineEntries:e,readOnlyEditEntries:i}=N();return{isRichWorkspace:t,outlineEntries:e,readOnlyEditEntries:i}},data(){return{entries:this.openReadOnly?[...this.readOnlyEditEntries,...this.outlineEntries]:[...this.outlineEntries],isReady:!1}},mounted(){this.$nextTick(()=>{this.isReady=!0,this.$emit("update:loaded",!0)})},methods:{t:p}});var gt=function(){var t=this,e=t._self._c;return t._self._setupProxy,e("div",{staticClass:"text-readonly-bar",class:{"text-readonly-bar--ready":t.isReady,"text-readonly-bar--is-workspace":t.isRichWorkspace,"text-readonly-bar--hide":t.isHidden,"is-mobile":t.$isMobile},attrs:{"data-text-el":"readonly-bar"}},[e("div",{ref:"menubar",staticClass:"text-readonly-bar__entries",attrs:{role:"toolbar","aria-label":t.t("text","Editor actions")}},t._l(t.visibleEntries,function(i,s){return e(i.component?i.component:i.children?"ActionList":"ActionSingle",{key:i.key,ref:"menuEntries",refInFor:!0,tag:"component",attrs:{"action-entry":i,"can-be-focussed":t.activeMenuEntry===s},on:{disabled:function(o){return t.disableMenuEntry(i.key,o)}}})}),1),e("div",{staticClass:"text-readonly-bar__slot"},[t._t("default")],2)])},Et=[],Mt=h(xt,gt,Et,!1,null,"22528807");const _e=Mt.exports,Ct={name:"NcActionCheckbox",mixins:[z],inject:{isInSemanticMenu:{from:"NcActions:isSemanticMenu",default:!1}},model:{prop:"modelValue",event:"update:modelValue"},props:{id:{type:String,default:()=>"action-"+K(),validator:t=>t.trim()!==""},checked:{type:Boolean,default:void 0},modelValue:{type:Boolean,default:!1},value:{type:[String,Number],default:""},disabled:{type:Boolean,default:!1}},emits:["change","check","uncheck","update:checked","update:modelValue","update:model-value"],setup(){return{model:it("checked","update:checked")}},computed:{isFocusable(){return!this.disabled},ariaChecked(){if(this.isInSemanticMenu)return this.model?"true":"false"}},methods:{checkInput(){this.$refs.label.click()},onChange(t){this.model=this.$refs.checkbox.checked,this.$emit("change",t),this.$refs.checkbox.checked?this.$emit("check"):this.$emit("uncheck")}}};var St=function(){var t=this,e=t._self._c;return e("li",{staticClass:"action",class:{"action--disabled":t.disabled},attrs:{role:t.isInSemanticMenu&&"presentation"}},[e("span",{staticClass:"action-checkbox",attrs:{role:t.isInSemanticMenu&&"menuitemcheckbox","aria-checked":t.ariaChecked}},[e("input",{ref:"checkbox",staticClass:"checkbox action-checkbox__checkbox",class:{focusable:t.isFocusable},attrs:{id:t.id,disabled:t.disabled,type:"checkbox"},domProps:{checked:t.model,value:t.value},on:{keydown:function(i){return!i.type.indexOf("key")&&t._k(i.keyCode,"enter",13,i.key,"Enter")||i.ctrlKey||i.shiftKey||i.altKey||i.metaKey?null:(i.preventDefault(),t.checkInput.apply(null,arguments))},change:t.onChange}}),e("label",{ref:"label",staticClass:"action-checkbox__label",attrs:{for:t.id}},[t._v(t._s(t.text))]),t._e()],2)])},At=[],$t=B(Ct,St,At,!1,null,"73edcb0b");const It=$t.exports;var E={},M;function Nt(){return M||(M=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.normalize=void 0;const e=47,i=46,s=a=>{const r=typeof a;if(r!=="string")throw new TypeError(`Expected a string, got a ${r}`)},o=(a,r)=>{let n="",u=0,_=-1,b=0,v;for(let l=0;l<=a.length;++l){if(l<a.length)v=a.charCodeAt(l);else{if(v===e)break;v=e}if(v===e){if(!(_===l-1||b===1))if(_!==l-1&&b===2){if(n.length<2||u!==2||n.charCodeAt(n.length-1)!==i||n.charCodeAt(n.length-2)!==i){if(n.length>2){const m=n.lastIndexOf("/");if(m!==n.length-1){m===-1?(n="",u=0):(n=n.slice(0,m),u=n.length-1-n.lastIndexOf("/")),_=l,b=0;continue}}else if(n.length===2||n.length===1){n="",u=0,_=l,b=0;continue}}r&&(n.length>0?n+="/..":n="..",u=2)}else n.length>0?n+="/"+a.slice(_+1,l):n=a.slice(_+1,l),u=l-_-1;_=l,b=0}else v===i&&b!==-1?++b:b=-1}return n},c=a=>{try{return decodeURIComponent(a)}catch{return a}},d=a=>{s(a);let r=a;if(r.length===0)return".";const n=r.charCodeAt(0)===e,u=r.charCodeAt(r.length-1)===e;return r=c(r),r=o(r,!n),r.length===0&&!n&&(r="."),r.length>0&&u&&(r+="/"),n?"/"+r:r};t.normalize=d,t.default=t.normalize})(E)),E}var Ot=Nt();const wt=nt(Ot);class be{#t;#e;#i;#s;#n;#r;#o=[];constructor({session:e,user:i,shareToken:s,currentDirectory:o,fileId:c}){this.#t=e,this.#e=i,this.#i=s,this.#s=o,this.#n=c??e.documentId,this.#r=this.#a()}async#a(){const e=await T.post(g("/apps/text/attachments"),{documentId:this.#t?.documentId??this.#n,sessionId:this.#t?.id,sessionToken:this.#t?.token,shareToken:this.#i});this.#o=e.data}#c(e){return this.#o.find(i=>i.name===e)}async resolve(e,i=!0){let s;const o=/^\.attachments\.\d+\//;if(e.match(o)){const c=decodeURIComponent(e.replace(o,"").split("?")[0]);if(await this.#r,s=this.#c(c),i&&!s&&(await this.#a(),s=this.#c(c)),s)return s}return Rt(e)?{isImage:!0,name:this.#l(e),previewUrl:e,fullUrl:e}:{isImage:!0,name:this.#l(e),previewUrl:this.#d(e),fullUrl:this.#d(e)}}#l(e){return e.split("/").pop()}#d(e){if(this.#e){const c=this.#e.uid,d=this.#h(e).split("/").map(encodeURIComponent).join("/");return st(`dav/files/${c}${d}`)}const i=this.#h(e).split("/"),s=i.pop(),o=i.join("/");return g("/s/{token}/download?path={dirname}&files={basename}",{token:this.#i,basename:s,dirname:o})}#u(e){return decodeURI(e.split("?")[0])}#h(e){const i=[this.#s,this.#u(e)].join("/");return wt(i)}}function Rt(t){return t.startsWith("http://")||t.startsWith("https://")||t.startsWith("data:")}function Bt(){return navigator?.userAgentData?.mobile!==void 0?navigator.userAgentData.mobile:[/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/playbook/i,/silk/i,/BlackBerry/i,/Windows Phone/i].some(t=>navigator.userAgent.match(t))}const Kt={name:"HelpModal",components:{NcDialog:Q},data(){return{formatted:{bold:!0,italic:!0,strikethrough:!0,heading1:!0,heading6:!0,unorderdList:!0,orderedList:!0,checkList:!0,blockQuote:!0,codeBlock:!0},ctrlOrModKey:J[Y.Mod]}},computed:{isFormatted(){return t=>this.formatted[t]},isMobileCached(){return this.isMobilePlatform()}},methods:{t:p,toggleFormatted(t){this.formatted[t]=!this.formatted[t]},isMobilePlatform:Bt}};var Tt=function(){var t=this,e=t._self._c;return e("NcDialog",{attrs:{size:"large","data-text-el":"formatting-help",name:t.t("text","Formatting and shortcuts"),"close-on-click-outside":!0},on:{closing:function(i){return t.$emit("close")}}},[e("h2",[t._v(t._s(t.t("text","Formatting and shortcuts")))]),e("p",[t._v(t._s(t.t("text","Speed up your writing with simple shortcuts.")))]),t.isMobileCached?e("p",[t._v(" "+t._s(t.t("text","Just type the Markdown syntax from below."))+" ")]):e("p",[t._v(" "+t._s(t.t("text","Just type the Markdown syntax or use keyboard shortcuts from below."))+" ")]),e("table",[e("thead",[e("tr",[e("th",[t._v(t._s(t.t("text","Style")))]),e("th",[t._v(t._s(t.t("text","Syntax")))]),t.isMobileCached?t._e():e("th",[t._v(" "+t._s(t.t("text","Keyboard shortcuts"))+" ")])])]),e("tbody",[e("tr",[e("td",[t._v(t._s(t.t("text","New paragraph")))]),e("td",[e("kbd",[t._v(t._s(t.t("text","Enter")))])]),t.isMobileCached?t._e():e("td")]),e("tr",[e("td",[t._v(t._s(t.t("text","Hard line break")))]),e("td",[e("kbd",[t._v(t._s(t.t("text","Enter")))]),t._v(" "+t._s(t.t("text","followed by"))+" "),e("kbd",[t._v(t._s(t.t("text","Backspace")))])]),t.isMobileCached?t._e():e("td",[e("kbd",[t._v(t._s(t.t("text","Shift")))]),t._v(" + "),e("kbd",[t._v(t._s(t.t("text","Enter")))])])]),e("tr",[e("td",[t._v(t._s(t.t("text","Bold")))]),e("td",[e("code",[t._v("**"+t._s(t.t("text","Bold text"))+"**")])]),t.isMobileCached?t._e():e("td",[e("kbd",[t._v(t._s(t.ctrlOrModKey))]),t._v(" + "),e("kbd",[t._v("B")])])]),e("tr",[e("td",[t._v(t._s(t.t("text","Italic")))]),e("td",[e("code",[t._v("*"+t._s(t.t("text","Italicized text"))+"*")])]),t.isMobileCached?t._e():e("td",[e("kbd",[t._v(t._s(t.ctrlOrModKey))]),t._v(" + "),e("kbd",[t._v("I")])])]),e("tr",[e("td",[t._v(t._s(t.t("text","Strikethrough")))]),e("td",[e("code",[t._v("~~"+t._s(t.t("text","Mistaken text"))+"~~")])]),t.isMobileCached?t._e():e("td",[e("kbd",[t._v(t._s(t.ctrlOrModKey))]),t._v(" + "),e("kbd",[t._v(t._s(t.t("text","Shift")))]),t._v(" + "),e("kbd",[t._v("S")])])]),e("tr",[e("td",[t._v(t._s(t.t("text","Underline")))]),e("td",[e("code",[t._v("__"+t._s(t.t("text","Underlined text"))+"__")])]),t.isMobileCached?t._e():e("td",[e("kbd",[t._v(t._s(t.ctrlOrModKey))]),t._v(" + "),e("kbd",[t._v("U")])])]),e("tr",[e("td",{staticClass:"ellipsis_top"},[t._v(" "+t._s(t.t("text","Heading 1"))+" ")]),e("td",{staticClass:"ellipsis_top"},[e("code",[t._v("# "+t._s(t.t("text","Heading level 1")))])]),t.isMobileCached?t._e():e("td",{staticClass:"ellipsis_top"},[e("kbd",[t._v(t._s(t.ctrlOrModKey))]),t._v(" + "),e("kbd",[t._v(t._s(t.t("text","Shift")))]),t._v(" + "),e("kbd",[t._v("1")])])]),e("tr",[e("td",{staticClass:"noborder ellipsis"},[t._v("…")]),e("td",{staticClass:"noborder ellipsis"},[t._v("…")]),t.isMobileCached?t._e():e("td",{staticClass:"ellipsis noborder"},[t._v("…")])]),e("tr",[e("td",{staticClass:"noborder ellipsis_bottom"},[t._v(" "+t._s(t.t("text","Heading 6"))+" ")]),e("td",{staticClass:"noborder ellipsis_bottom"},[e("code",[t._v("###### "+t._s(t.t("text","Heading level 6")))])]),t.isMobileCached?t._e():e("td",{staticClass:"noborder ellipsis_bottom"},[e("kbd",[t._v(t._s(t.ctrlOrModKey))]),t._v(" + "),e("kbd",[t._v(t._s(t.t("text","Shift")))]),t._v(" + "),e("kbd",[t._v("6")])])]),e("tr",[e("td",[t._v(t._s(t.t("text","Unordered list")))]),e("td",[e("code",[t._v("* "+t._s(t.t("text","An item")))])]),t.isMobileCached?t._e():e("td",[e("kbd",[t._v(t._s(t.ctrlOrModKey))]),t._v(" + "),e("kbd",[t._v(t._s(t.t("text","Shift")))]),t._v(" + "),e("kbd",[t._v("8")])])]),e("tr",[e("td",[t._v(t._s(t.t("text","Ordered list")))]),e("td",[e("code",[t._v("1. "+t._s(t.t("text","First item")))])]),t.isMobileCached?t._e():e("td",[e("kbd",[t._v(t._s(t.ctrlOrModKey))]),t._v(" + "),e("kbd",[t._v(t._s(t.t("text","Shift")))]),t._v(" + "),e("kbd",[t._v("7")])])]),e("tr",[e("td",[t._v(t._s(t.t("text","Checklist")))]),e("td",[e("code",[t._v("* [] "+t._s(t.t("text","To-Do item")))])]),t.isMobileCached?t._e():e("td",[e("kbd",[t._v(t._s(t.ctrlOrModKey))]),t._v(" + "),e("kbd",[t._v(t._s(t.t("text","Shift")))]),t._v(" + "),e("kbd",[t._v("9")])])]),e("tr",[e("td",[t._v(t._s(t.t("text","Blockquote")))]),e("td",[e("code",[t._v("> "+t._s(t.t("text","Quoted text")))])]),t.isMobileCached?t._e():e("td",[e("kbd",[t._v(t._s(t.ctrlOrModKey))]),t._v(" + "),e("kbd",[t._v(">")])])]),e("tr",[e("td",[t._v(t._s(t.t("text","Code block")))]),e("td",[e("code",[t._v("``` "+t._s(t.t("text","Some code")))])]),t.isMobileCached?t._e():e("td")]),e("tr",[e("td",[t._v(t._s(t.t("text","Link")))]),e("td",[e("code",[t._v("[Title](https://example.org)")])]),t.isMobileCached?t._e():e("td",[e("kbd",[t._v(t._s(t.ctrlOrModKey))]),t._v(" + "),e("kbd",[t._v("K")])])]),e("tr",[e("td",[t._v(t._s(t.t("text","Insert emoji")))]),e("td",[e("code",[t._v(":"+t._s(t.t("text","emoji")))])]),t.isMobileCached?t._e():e("td")]),e("tr",[e("td",[t._v(t._s(t.t("text","Mention someone")))]),e("td",[e("code",[t._v("@"+t._s(t.t("text","name")))])]),t.isMobileCached?t._e():e("td")]),e("tr",[e("td",[t._v(t._s(t.t("text","Smart picker")))]),e("td",[e("code",[t._v("/"+t._s(t.t("text","something")))])]),t.isMobileCached?t._e():e("td")])])]),e("table",{attrs:{vif:"!isMobileCached"}},[e("thead",[e("tr",[e("th",[t._v(t._s(t.t("text","Action")))]),e("th",[t._v(t._s(t.t("text","Keyboard shortcuts")))])])]),e("tbody",[e("tr",[e("td",[t._v(t._s(t.t("text","Undo")))]),e("td",[e("kbd",[t._v(t._s(t.ctrlOrModKey))]),t._v(" + "),e("kbd",[t._v("Z")])])]),e("tr",[e("td",[t._v(t._s(t.t("text","Redo")))]),e("td",[e("kbd",[t._v(t._s(t.ctrlOrModKey))]),t._v(" + "),e("kbd",[t._v("Y")])])]),e("tr",[e("td",[t._v(t._s(t.t("text","Toggle outline")))]),e("td",[e("kbd",[t._v(t._s(t.ctrlOrModKey))]),t._v(" + "),e("kbd",[t._v(t._s(t.t("text","Alt")))]),t._v(" + "),e("kbd",[t._v("H")])])])])])])},Wt=[],Ht=h(Kt,Tt,Wt,!1,null,"ee2c50ae");const Pt=Ht.exports,Ft=y({name:"NcActionButton",components:{NextcloudVueNcActionButton:S,Help:Z},methods:{t:p}});var Lt=function(){var t=this,e=t._self._c;return t._self._setupProxy,e("NextcloudVueNcActionButton",t._g({attrs:{"close-after-click":"","data-text-action-entry":"formatting-help"},scopedSlots:t._u([{key:"icon",fn:function(){return[e("Help")]},proxy:!0}])},t.$listeners),[t._v(" "+t._s(t.t("text","Formatting help"))+" ")])},Dt=[],Ut=h(Ft,Lt,Dt,!1,null,null);const Vt=Ut.exports,jt=y({name:"CharacterCount",components:{AlphabeticalVariant:G,NcActionText:q},props:{visible:Boolean},setup(){const{editor:t}=$(),e=C("");return{countString:e,refresh:()=>{const{storage:i,state:s}=t,o=i.characterCount.words({node:s.doc}),c=i.characterCount.characters({node:s.doc}),d=x("text","%n word","%n words",o),a=x("text","%n char","%n chars",c);e.value=[d,a].join(", "),console.debug({wordCount:o,charCount:c,countString:e.value})}}},watch:{visible:"refresh"},created(){this.refresh()}});var zt=function(){var t=this,e=t._self._c;return t._self._setupProxy,e("NcActionText",{attrs:{"data-text-action-entry":"character-count",name:t.countString},scopedSlots:t._u([{key:"icon",fn:function(){return[e("AlphabeticalVariant")]},proxy:!0}])})},Qt=[],Jt=h(jt,zt,Qt,!1,null,null);const Yt=Jt.exports,Zt={__name:"WidthToggle",setup(t){const{canToggleWidth:e,isFullWidth:i,setFullWidth:s}=X();return{__sfc:!0,canToggleWidth:e,isFullWidth:i,setFullWidth:s,t:p,NcActionCheckbox:It}}};var qt=function(){var t=this,e=t._self._c,i=t._self._setupProxy;return i.canToggleWidth?e(i.NcActionCheckbox,{attrs:{checked:i.isFullWidth},on:{"update:checked":i.setFullWidth}},[t._v(" "+t._s(i.t("text","Full width editor"))+" ")]):t._e()},Gt=[],Xt=h(Zt,qt,Gt,!1,null,null);const te=Xt.exports,ee={name:"MenuBar",components:{ActionFormattingHelp:Vt,ActionList:O,ActionSingle:w,HelpModal:Pt,NcActionSeparator:A,CharacterCount:Yt,WidthToggle:te},extends:R,mixins:[I],provide(){const t={};return Object.defineProperties(t,{[et]:{get:()=>this.randomID}}),t},props:{isHidden:{type:Boolean,default:!1},openReadOnly:{type:Boolean,default:!1}},setup(){const t=$(),{isPublic:e,isRichEditor:i,isRichWorkspace:s}=f(),{assistantMenuEntries:o,menuEntries:c,readOnlyDoneEntries:d}=N(),a=C(),{width:r}=at(a);return{assistantMenuEntries:o,editor:t,isPublic:e,isRichEditor:i,isRichWorkspace:s,menubar:a,menuEntries:c,readOnlyDoneEntries:d,width:r}},data(){return{entries:(this.openReadOnly?[...this.readOnlyDoneEntries,...this.menuEntries]:this.isPublic||this.isRichWorkspace?[...this.menuEntries]:[...this.menuEntries,...this.assistantMenuEntries]).filter(t=>!!t),randomID:`menu-bar-${Math.ceil(Math.random()*1e4+500).toString(16)}`,displayHelp:!1,isReady:!1,resize:null}},computed:{visibleEntryKeys(){return this.entries.toSorted((t,e)=>(t.priority??0)-(e.priority??0)).map(t=>t.key).slice(0,this.iconsLimit)},visibleEntries(){return this.entries.filter(t=>this.visibleEntryKeys.includes(t.key))},hiddenEntries(){const t=this.entries.filter(i=>!this.visibleEntryKeys.includes(i.key)),e=t.reduce((i,s,o)=>{const c=s.children??[s];if(c.length>1){const d=i.length&&!i.at(-1).isSeparator?[{key:`separator-before-${s.id}`,isSeparator:!0}]:[],a=o!==t.length-1?[{key:`separator-after-${s.id}`,isSeparator:!0}]:[];return[...i,...d,...c,...a]}return[...i,...c]},[]);return{key:"remain",label:this.t("text","Remaining actions"),icon:tt,children:e}},iconWidth(){const t=(this.menubar&&getComputedStyle(this.menubar))?.getPropertyValue("--default-clickable-area");return parseInt(t)||34},iconsLimit(){const t=this.width-4,e=this.$isMobile?this.iconWidth:this.iconWidth+2;return Math.floor(t/e)-1}},mounted(){this.$nextTick(()=>{this.isReady=!0,this.$emit("update:loaded",!0)})},methods:{showHelp(){this.displayHelp=!0},hideHelp(){this.displayHelp=!1},t:p}};var ie=function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-menubar",class:{"text-menubar--ready":t.isReady,"text-menubar--hide":t.isHidden,"text-menubar--is-workspace":t.isRichWorkspace,"is-mobile":t.$isMobile},attrs:{id:t.randomID,"data-text-el":"menubar",role:"region","aria-label":t.t("text","Editor actions")}},[t.displayHelp?e("HelpModal",{on:{close:t.hideHelp}}):t._e(),t.isRichEditor?e("div",{ref:"menubar",staticClass:"text-menubar__entries",attrs:{role:"toolbar","aria-label":t.t("text","Formatting menu bar")},on:{keyup:[function(i){return!i.type.indexOf("key")&&t._k(i.keyCode,"left",37,i.key,["Left","ArrowLeft"])||"button"in i&&i.button!==0?null:(i.stopPropagation(),t.handleToolbarNavigation.apply(null,arguments))},function(i){return!i.type.indexOf("key")&&t._k(i.keyCode,"right",39,i.key,["Right","ArrowRight"])||"button"in i&&i.button!==2?null:(i.stopPropagation(),t.handleToolbarNavigation.apply(null,arguments))}]}},[t._l(t.visibleEntries,function(i,s){return e(i.component?i.component:i.children?"ActionList":"ActionSingle",{key:i.key,ref:"menuEntries",refInFor:!0,tag:"component",attrs:{"action-entry":i,"can-be-focussed":t.activeMenuEntry===s},on:{disabled:function(o){return t.disableMenuEntry(i.key,o)},click:function(o){t.activeMenuEntry=s}}})}),e("ActionList",{ref:"remainingEntries",attrs:{"action-entry":t.hiddenEntries,"can-be-focussed":t.activeMenuEntry===t.visibleEntries.length,"force-enabled":!0},on:{click:function(i){t.activeMenuEntry="remain"}},scopedSlots:t._u([{key:"lastAction",fn:function({visible:i}){return[e("WidthToggle"),e("ActionFormattingHelp",{on:{click:t.showHelp}}),e("NcActionSeparator"),e("CharacterCount",t._b({},"CharacterCount",{visible:i},!1))]}}],null,!1,4216951189)})],2):t._e(),e("div",{staticClass:"text-menubar__slot"},[t._t("default")],2)],1)},se=[],ne=h(ee,ie,se,!1,null,"5b854183");const pe=ne.exports;export{be as A,pe as M,_e as R};
//# sourceMappingURL=MenuBar-C6IVBKu2.chunk.mjs.map
