{"version":3,"file":"SessionList-BXxPQM5m.chunk.mjs","sources":["../src/components/Editor/SessionList.vue"],"sourcesContent":["<!--\r\n  - SPDX-FileCopyrightText: 2019 Nextcloud GmbH and Nextcloud contributors\r\n  - SPDX-License-Identifier: AGPL-3.0-or-later\r\n-->\r\n\r\n<template>\r\n\t<NcPopover class=\"session-list\" placement=\"bottom\">\r\n\t\t<template #trigger=\"{ attrs }\">\r\n\t\t\t<div>\r\n\t\t\t\t<button :title=\"label\"\r\n\t\t\t\t\t:aria-label=\"label\"\r\n\t\t\t\t\tclass=\"avatar-list\"\r\n\t\t\t\t\tv-bind=\"attrs\">\r\n\t\t\t\t\t<div class=\"avatardiv icon-group\" />\r\n\t\t\t\t\t<AvatarWrapper v-for=\"session in sessionsVisible\"\r\n\t\t\t\t\t\t:key=\"session.id\"\r\n\t\t\t\t\t\t:session=\"session\"\r\n\t\t\t\t\t\t:size=\"30\" />\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t</template>\r\n\t\t<template #default>\r\n\t\t\t<div class=\"session-menu\">\r\n\t\t\t\t<slot name=\"lastSaved\" />\r\n\t\t\t\t<ul>\r\n\t\t\t\t\t<slot />\r\n\t\t\t\t\t<li v-for=\"session in participantsPopover\"\r\n\t\t\t\t\t\t:key=\"session.id\"\r\n\t\t\t\t\t\t:style=\"avatarStyle(session)\">\r\n\t\t\t\t\t\t<AvatarWrapper :session=\"session\" :size=\"36\" />\r\n\t\t\t\t\t\t<span class=\"session-label\">\r\n\t\t\t\t\t\t\t{{\r\n\t\t\t\t\t\t\t\tsession.userId ? session.displayName : (session.guestName ? session.guestName : t('text', 'Guest'))\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t<span v-if=\"session.userId === null\" class=\"guest-label\">({{ t('text', 'guest') }})</span>\r\n\t\t\t\t\t</li>\r\n\t\t\t\t\t<li>\r\n\t\t\t\t\t\t<NcCheckboxRadioSwitch :checked=\"isFullWidth\" @update:checked=\"onWidthToggle\">\r\n\t\t\t\t\t\t\t{{ t('text', 'Full width editor') }}\r\n\t\t\t\t\t\t</NcCheckboxRadioSwitch>\r\n\t\t\t\t\t</li>\r\n\t\t\t\t</ul>\r\n\t\t\t</div>\r\n\t\t</template>\r\n\t</NcPopover>\r\n</template>\r\n\r\n<script>\r\nimport { NcCheckboxRadioSwitch, NcPopover } from '@nextcloud/vue'\r\nimport AvatarWrapper from './AvatarWrapper.vue'\r\nimport { COLLABORATOR_DISCONNECT_TIME, COLLABORATOR_IDLE_TIME } from '../../services/SyncService.js'\r\nimport { loadState } from '@nextcloud/initial-state'\r\nimport axios from '@nextcloud/axios'\r\nimport { generateUrl } from '@nextcloud/router'\r\n\r\nexport default {\r\n\tname: 'SessionList',\r\n\tcomponents: {\r\n\t\tAvatarWrapper,\r\n\t\tNcPopover,\r\n\t\tNcCheckboxRadioSwitch,\r\n\t},\r\n\tprops: {\r\n\t\tsessions: {\r\n\t\t\ttype: Object,\r\n\t\t\tdefault: () => {\r\n\t\t\t\treturn {}\r\n\t\t\t},\r\n\t\t},\r\n\t},\r\n\tdata() {\r\n\t\tconst isFullWidth = loadState('text', 'is_full_width_editor', false)\r\n\t\treturn {\r\n\t\t\tmyName: '',\r\n\t\t\tisFullWidth,\r\n\t\t}\r\n\t},\r\n\tcomputed: {\r\n\t\tlabel() {\r\n\t\t\treturn t('text', 'Active people')\r\n\t\t},\r\n\t\tparticipantsPopover() {\r\n\t\t\tif (this.currentSession?.guestName) {\r\n\t\t\t\treturn this.participantsWithoutCurrent\r\n\t\t\t}\r\n\t\t\treturn this.participants\r\n\t\t},\r\n\t\tparticipantsWithoutCurrent() {\r\n\t\t\treturn this.participants.filter((session) => !session.isCurrent)\r\n\t\t},\r\n\t\tparticipants() {\r\n\t\t\treturn Object.values(this.sessions).filter((session) =>\r\n\t\t\t\tsession.lastContact > Date.now() / 1000 - COLLABORATOR_DISCONNECT_TIME\r\n\t\t\t\t&& (session.userId !== null || session.guestName !== null),\r\n\t\t\t).sort((a, b) => a.lastContact < b.lastContact)\r\n\t\t},\r\n\t\tcurrentSession() {\r\n\t\t\treturn Object.values(this.sessions).find((session) => session.isCurrent)\r\n\t\t},\r\n\t\tavatarStyle() {\r\n\t\t\treturn (session) => {\r\n\t\t\t\treturn {\r\n\t\t\t\t\topacity: session.lastContact > Date.now() / 1000 - COLLABORATOR_IDLE_TIME ? 1 : 0.5,\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tsessionsVisible() {\r\n\t\t\treturn this.participantsWithoutCurrent.slice(0, 3)\r\n\t\t},\r\n\t},\r\n\tmethods: {\r\n\t\tonWidthToggle(checked) {\r\n\t\t\tthis.isFullWidth = checked\r\n\t\t\tthis.$emit('editor-width-change', checked ? '100%' : '80ch')\r\n\r\n\t\t\taxios.post(generateUrl('/apps/text/settings'), {\r\n\t\t\t\tkey: 'is_full_width_editor',\r\n\t\t\t\tvalue: checked ? '1' : '0',\r\n\t\t\t})\r\n\t\t},\r\n\t},\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.session-list {\r\n\theight: var(--default-clickable-area);\r\n}\r\n\r\n.avatar-list {\r\n\tborder: none;\r\n\tbackground-color: var(--color-main-background);\r\n\tpadding: 0;\r\n\tmargin: 0;\r\n\tpadding-left: 3px;\r\n\tdisplay: inline-flex;\r\n\tflex-direction: row-reverse;\r\n\r\n\t.avatar-wrapper {\r\n\t\tmargin: 0 -12px 0 0;\r\n\t\tz-index: 1;\r\n\t\tborder-radius: 50%;\r\n\t\toverflow: hidden;\r\n\t\tbox-sizing: content-box !important;\r\n\t\theight: calc(var(--default-clickable-area) - 4px);\r\n\t\twidth: calc(var(--default-clickable-area) - 4px);\r\n\t}\r\n\r\n\t.icon-more, .icon-group, .icon-settings-dark {\r\n\t\twidth: var(--default-clickable-area);\r\n\t\theight: var(--default-clickable-area);\r\n\t\tmargin: 0 3px 0 0;\r\n\r\n\t\t&:hover {\r\n\t\t\tbackground-color: var(--color-background-hover);\r\n\t\t}\r\n\t}\r\n}\r\n\r\n.session-menu {\r\n\tmax-width: 280px;\r\n\tpadding-top: 6px;\r\n\tpadding-bottom: 6px;\r\n\r\n\tul li {\r\n\t\talign-items: center;\r\n\t\tdisplay: flex;\r\n\t\tpadding: 6px;\r\n\r\n\t\t.avatar-wrapper {\r\n\t\t\theight: 36px;\r\n\t\t\twidth: 36px;\r\n\t\t\tmargin-right: 6px;\r\n\t\t}\r\n\r\n\t\t.session-label {\r\n\t\t\tpadding-right: 3px;\r\n\t\t}\r\n\r\n\t\t.guest-label {\r\n\t\t\tpadding-left: 3px;\r\n\t\t\tcolor: var(--color-text-maxcontrast);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nlabel {\r\n\tdisplay: block;\r\n\tmargin: 8px;\r\n}\r\n\r\n.hint {\r\n\tmargin: 8px;\r\n\tcolor: var(--color-text-maxcontrast);\r\n}\r\n</style>\r\n"],"names":["_sfc_main","AvatarWrapper","NcPopover","NcCheckboxRadioSwitch","loadState","_a","session","COLLABORATOR_DISCONNECT_TIME","a","b","COLLABORATOR_IDLE_TIME","checked","axios","generateUrl"],"mappings":"4yBAwDA,MAAAA,EAAA,CACA,KAAA,cACA,WAAA,CACA,cAAAC,EACA,UAAAC,EACA,sBAAAC,CACA,EACA,MAAA,CACA,SAAA,CACA,KAAA,OACA,QAAA,KACA,CAAA,EAEA,CACA,EACA,MAAA,CAEA,MAAA,CACA,OAAA,GACA,YAHAC,EAAA,OAAA,uBAAA,EAAA,CAIA,CACA,EACA,SAAA,CACA,OAAA,CACA,OAAA,EAAA,OAAA,eAAA,CACA,EACA,qBAAA,OACA,OAAAC,EAAA,KAAA,iBAAA,MAAAA,EAAA,UACA,KAAA,2BAEA,KAAA,YACA,EACA,4BAAA,CACA,OAAA,KAAA,aAAA,OAAAC,GAAA,CAAAA,EAAA,SAAA,CACA,EACA,cAAA,CACA,OAAA,OAAA,OAAA,KAAA,QAAA,EAAA,OAAAA,GACAA,EAAA,YAAA,KAAA,IAAA,EAAA,IAAAC,IACAD,EAAA,SAAA,MAAAA,EAAA,YAAA,KACA,EAAA,KAAA,CAAAE,EAAAC,IAAAD,EAAA,YAAAC,EAAA,WAAA,CACA,EACA,gBAAA,CACA,OAAA,OAAA,OAAA,KAAA,QAAA,EAAA,KAAAH,GAAAA,EAAA,SAAA,CACA,EACA,aAAA,CACA,OAAAA,IACA,CACA,QAAAA,EAAA,YAAA,KAAA,IAAA,EAAA,IAAAI,EAAA,EAAA,EACA,EAEA,EACA,iBAAA,CACA,OAAA,KAAA,2BAAA,MAAA,EAAA,CAAA,CACA,CACA,EACA,QAAA,CACA,cAAAC,EAAA,CACA,KAAA,YAAAA,EACA,KAAA,MAAA,sBAAAA,EAAA,OAAA,MAAA,EAEAC,EAAA,KAAAC,EAAA,qBAAA,EAAA,CACA,IAAA,uBACA,MAAAF,EAAA,IAAA,GACA,CAAA,CACA,CACA,CACA"}