/*! For license information please see src_components_Editor_provider_js-src_store_index_js-src_components_ViewerComponent_vue.js.LICENSE.txt */
"use strict";(self.webpackChunk_nextcloud_text=self.webpackChunk_nextcloud_text||[]).push([["src_components_Editor_provider_js-src_store_index_js-src_components_ViewerComponent_vue"],{73590:(e,t,n)=>{n.d(t,{CB:()=>A,GH:()=>m,HE:()=>w,PW:()=>d,_S:()=>x,bk:()=>v,c9:()=>p,f_:()=>r,ir:()=>h,l5:()=>_,lV:()=>s,o:()=>c,pN:()=>g,qS:()=>i,wn:()=>l,yS:()=>a,yu:()=>f});var o=n(79843);const i=Symbol("tiptap:editor"),d=Symbol("editor:file"),r=Symbol("attachment:resolver"),a=Symbol("editor:is-mobile"),s=Symbol("editor:is-public"),l=Symbol("editor:is-rich-editor"),c=Symbol("editor:is-rich-woskapace"),m=Symbol("sync:service"),u=Symbol("editor:upload"),A=(Symbol("hook:mention-search"),Symbol("hook:mention-insert"),{inject:{$editor:{from:i,default:null}}}),_={inject:{$syncService:{from:m,default:null}}},h={inject:{$isPublic:{from:s,default:!1}}},p={inject:{$isRichWorkspace:{from:c,default:!1}}},f={inject:{$isRichEditor:{from:l,default:!1}}},v={inject:{$isMobile:{from:a,default:!1}}},g={inject:{$file:{from:d,default:()=>({fileId:0,relativePath:null,document:null})}}},w={inject:{$attachmentResolver:{from:r,default:{resolve:e=>(o.v.warn("No attachment resolver provided. Some attachment sources cannot be resolved."),[e])}}}},x={inject:{$editorUpload:{from:u,default:!0}}}},72150:(e,t,n)=>{n.d(t,{default:()=>v,M:()=>f});var o=n(85471),i=n(95353),d=n(59097),r=n(63814),a=n(70715);const s="SET_VIEW_WIDTH",l="SET_SHOW_AUTHOR_ANNOTATIONS",c="SET_HEADINGS",m="SET_ATTACHMENT_LIST";var u=n(17334),A=n.n(u);const _=()=>document.documentElement.clientWidth,h=e=>{let{commit:t}=e;const n=A()((()=>{t(`text/${s}`,_())}),100);window.addEventListener("resize",n)},p=(0,d.getBuilder)("text").persist().build();o.default.use(i.Ay);const f={state:{showAuthorAnnotations:"true"===p.getItem("showAuthorAnnotations"),viewWidth:_(),headings:Object.freeze([]),attachmentList:[]},getters:{imageAttachments:e=>e.attachmentList.filter((e=>e.isImage)),findAttachment:e=>t=>e.attachmentList.find((e=>e.name===t))},mutations:{[s](e,t){e.viewWidth=t},[l](e,t){e.showAuthorAnnotations=t,p.setItem("showAuthorAnnotations",""+t)},[c](e,t){if(e.headings.length!==t.length)return void(e.headings=Object.freeze(t));const n=e.headings,o=t.map(((e,t)=>{const o=n[t].level;return Object.freeze({...e,previous:o})}));e.headings=Object.freeze(o)},[m](e,t){e.attachmentList=t}},actions:{setShowAuthorAnnotations(e,t){let{commit:n}=e;n(l,t)},setHeadings(e,t){let{commit:n}=e;n(c,t)},async setAttachmentList(e,t){let{commit:n}=e,{documentId:o,session:i,shareToken:d}=t;const s=await a.Ay.post((0,r.Jv)("/apps/text/attachments"),{documentId:i?.documentId??o,sessionId:i?.id,sessionToken:i?.token,shareToken:d});n(m,s.data)}}},v=new i.il({plugins:[h],modules:{text:{namespaced:!0,...f}}})},72081:(e,t,n)=>{n.d(t,{A:()=>a});var o=n(71354),i=n.n(o),d=n(76314),r=n.n(d)()(i());r.push([e.id,".text-editor[data-v-2ca56bde]:not(.viewer__file--hidden){overflow:scroll;top:0;width:100%;max-width:100%;height:100%;left:0;margin:0 auto;position:relative;background-color:var(--color-main-background)}.text-editor:not(.viewer__file--hidden).source-viewer[data-v-2ca56bde]{display:block}.text-editor:not(.viewer__file--hidden).source-viewer .text-editor__content-wrapper[data-v-2ca56bde]{margin-top:var(--header-height)}.text-editor:not(.viewer__file--hidden).source-viewer .toggle-interactive[data-v-2ca56bde]{position:sticky;bottom:0;right:0;z-index:1;margin-left:auto;margin-right:0}.text-editor:not(.viewer__file--hidden).text-editor--embedding[data-v-2ca56bde]{min-height:400px}","",{version:3,sources:["webpack://./src/components/ViewerComponent.vue"],names:[],mappings:"AACA,yDACC,eAAA,CACA,KAAA,CACA,UAAA,CACA,cAAA,CACA,WAAA,CACA,MAAA,CACA,aAAA,CACA,iBAAA,CACA,6CAAA,CAEA,uEACC,aAAA,CAEA,qGACC,+BAAA,CAGD,2FACC,eAAA,CACA,QAAA,CACA,OAAA,CACA,SAAA,CACA,gBAAA,CACA,cAAA,CAIF,gFACC,gBAAA",sourcesContent:["\n.text-editor:not(.viewer__file--hidden) {\n\toverflow: scroll;\n\ttop: 0;\n\twidth: 100%;\n\tmax-width: 100%;\n\theight: 100%;\n\tleft: 0;\n\tmargin: 0 auto;\n\tposition: relative;\n\tbackground-color: var(--color-main-background);\n\n\t&.source-viewer {\n\t\tdisplay: block;\n\n\t\t.text-editor__content-wrapper {\n\t\t\tmargin-top: var(--header-height);\n\t\t}\n\n\t\t.toggle-interactive {\n\t\t\tposition: sticky;\n\t\t\tbottom: 0;\n\t\t\tright: 0;\n\t\t\tz-index: 1;\n\t\t\tmargin-left: auto;\n\t\t\tmargin-right: 0;\n\t\t}\n\t}\n\n\t&.text-editor--embedding {\n\t\tmin-height: 400px;\n\t}\n\n}\n"],sourceRoot:""}]);const a=r},95573:(e,t,n)=>{n.d(t,{A:()=>a});var o=n(71354),i=n.n(o),d=n(76314),r=n.n(d)()(i());r.push([e.id,":root{--text-editor-max-width: 670px }@media only screen and (max-width: 512px){.text-editor{top:auto}}.viewer[data-handler=text] .modal-wrapper .modal-container{bottom:0}","",{version:3,sources:["webpack://./src/css/variables.scss","webpack://./src/components/ViewerComponent.vue"],names:[],mappings:"AAAA,MACC,+BAAA,CCCD,0CAEC,aACC,QAAA,CAAA,CAIF,2DACC,QAAA",sourcesContent:[":root {\n\t--text-editor-max-width: 670px\n}\n\n","\n@import './../css/variables';\n@media only screen and (max-width: 512px) {\n\t// on mobile, modal-container has top: 50px\n\t.text-editor {\n\t\ttop: auto;\n\t}\n}\n\n.viewer[data-handler='text'] .modal-wrapper .modal-container {\n\tbottom: 0;\n}\n"],sourceRoot:""}]);const a=r},57847:(e,t,n)=>{n.d(t,{A:()=>l});var o=n(75111),i=n(70580),d=n.n(i),r=n(61395),a=n(78841);const s={name:"PlainTextReader",components:{BaseReader:r.A},provide:{renderHtml:e=>"<pre>"+d()(e)+"</pre>",extensions:()=>[a.Ks,o.Ay]},props:{content:{type:String,required:!0}}};const l=(0,n(14486).A)(s,(function(){return(0,this._self._c)("BaseReader",{attrs:{content:this.content}})}),[],!1,null,null,null).exports},53550:(e,t,n)=>{n.r(t),n.d(t,{default:()=>k});var o=n(85471),i=n(70715),d=n(2413),r=n(70995),a=n(57847),s=n(66104),l=n(53334);o.default.prototype.t=l.Tl,o.default.prototype.n=l.zw;const c={name:"ViewerComponent",components:{NcButton:o.default.extend(r.A),PencilIcon:o.default.extend(d.A),RichTextReader:o.default.extend(s.A),PlainTextReader:o.default.extend(a.A),Editor:async function(){if(!window._nc_text_editor_instance){if(window._nc_text_editor_importing)return await new Promise((e=>{const t=setInterval((()=>{window._nc_text_editor_instance&&(e(window._nc_text_editor_instance),clearInterval(t))}),200)}));window._nc_text_editor_importing=!0;const e=await Promise.all([n.e("mermaid"),n.e("vendors-node_modules_nextcloud_vue_dist_index_mjs"),n.e("vendors-node_modules_braintree_sanitize-url_dist_index_js-node_modules_quartzy_markdown-it-me-60d959"),n.e("vendors-node_modules_node-polyfill-webpack-plugin_node_modules_path-browserify_index_js-node_-752ce4"),n.e("vendors-node_modules_nextcloud_logger_dist_index_js"),n.e("vendors-node_modules_path-normalize_lib_index_js-node_modules_proxy-polyfill_src_index_js-nod-852d39"),n.e("src_components_RichTextReader_vue-data_image_svg_xml_3c_21--_20-_20SPDX-FileCopyrightText_202-663d28"),n.e("editor")]).then(n.bind(n,39492)),{default:t}=await Promise.resolve().then(n.bind(n,85471));t.prototype.t=window.t,t.prototype.OCA=window.OCA;const o=t.extend(e.default);window._nc_text_editor_instance=o}return window._nc_text_editor_instance}},provide(){return{isEmbedded:this.isEmbedded}},props:{filename:{type:String,default:null},fileid:{type:Number,default:null},active:{type:Boolean,default:!1},autofocus:{type:Boolean,default:!0},shareToken:{type:String,default:()=>document.getElementById("sharingToken")?document.getElementById("sharingToken").value:null},mime:{type:String,default:null},showOutlineOutside:{type:Boolean,default:!1},permissions:{type:String,default:""},source:{type:String,default:void 0},isEmbedded:{type:Boolean,default:!1}},data:()=>({content:"",hasToggledInteractiveEmbedding:!1}),computed:{useSourceView(){return this.source&&(this.fileVersion||!this.fileid||this.isEmbedded)&&!this.hasToggledInteractiveEmbedding},readerComponent(){return"text/markdown"===this.mime?s.A:a.A}},watch:{source(){this.loadFileContent()}},mounted(){this.loadFileContent()},methods:{t:l.Tl,async loadFileContent(){if(this.useSourceView){const e=await i.Ay.get(this.source);this.content=e.data,this.contentLoaded=!0}this.$emit("update:loaded",!0)},toggleEdit(){this.hasToggledInteractiveEmbedding=!0}}};var m=n(85072),u=n.n(m),A=n(97825),_=n.n(A),h=n(77659),p=n.n(h),f=n(55056),v=n.n(f),g=n(10540),w=n.n(g),x=n(41113),C=n.n(x),b=n(72081),y={};y.styleTagTransform=C(),y.setAttributes=v(),y.insert=p().bind(null,"head"),y.domAPI=_(),y.insertStyleElement=w();u()(b.A,y);b.A&&b.A.locals&&b.A.locals;var S=n(95573),E={};E.styleTagTransform=C(),E.setAttributes=v(),E.insert=p().bind(null,"head"),E.domAPI=_(),E.insertStyleElement=w();u()(S.A,E);S.A&&S.A.locals&&S.A.locals;const k=(0,n(14486).A)(c,(function(){var e=this,t=e._self._c;return e.useSourceView?t("div",{staticClass:"text-editor source-viewer",attrs:{id:"editor-container","data-text-el":"editor-container"}},[t(e.readerComponent,{tag:"Component",attrs:{content:e.content}}),e._v(" "),e.isEmbedded?t("NcButton",{staticClass:"toggle-interactive",on:{click:e.toggleEdit},scopedSlots:e._u([{key:"icon",fn:function(){return[t("PencilIcon")]},proxy:!0}],null,!1,411976917)},[e._v("\n\t\t"+e._s(e.t("text","Edit"))+"\n\t\t")]):e._e()],1):t("Editor",{class:{"text-editor--embedding":e.isEmbedded},attrs:{"file-id":e.fileid,"relative-path":e.filename,active:e.active||e.isEmbedded,autofocus:e.autofocus,"share-token":e.shareToken,mime:e.mime,"show-outline-outside":e.showOutlineOutside}})}),[],!1,null,"2ca56bde",null).exports}}]);
//# sourceMappingURL=src_components_Editor_provider_js-src_store_index_js-src_components_ViewerComponent_vue.js.map?v=87cd0440d71c3018123c