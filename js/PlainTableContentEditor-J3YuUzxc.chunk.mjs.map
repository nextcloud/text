{"version":3,"file":"PlainTableContentEditor-J3YuUzxc.chunk.mjs","sources":["../src/components/Editor/PlainTableContentEditor.vue"],"sourcesContent":["<!--\n  - SPDX-FileCopyrightText: 2025 Nextcloud GmbH and Nextcloud contributors\n  - SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n<template>\n\t<Wrapper :content-loaded=\"true\" :show-outline-outside=\"false\">\n\t\t<MainContainer>\n\t\t\t<ContentContainer :read-only=\"readOnly\" />\n\t\t</MainContainer>\n\t</Wrapper>\n</template>\n\n<script>\nimport { Editor } from '@tiptap/core'\nimport History from '@tiptap/extension-history'\nimport MainContainer from './MainContainer.vue'\nimport Wrapper from './Wrapper.vue'\nimport ContentContainer from './ContentContainer.vue'\nimport { PlainTable } from '../../extensions/index.js'\nimport { createMarkdownSerializer } from '../../extensions/Markdown.js'\nimport { EDITOR, IS_PUBLIC, IS_RICH_EDITOR, IS_RICH_WORKSPACE, EDITOR_UPLOAD } from '../Editor.provider.js'\nimport markdownit from '../../markdownit/index.js'\n\nexport default {\n\tname: 'PlainTableContentEditor',\n\tcomponents: { ContentContainer, MainContainer, Wrapper },\n\n\tprovide() {\n\t\tconst val = {}\n\t\tObject.defineProperties(val, {\n\t\t\t[EDITOR]: { get: () => this.$editor },\n\t\t\t[IS_PUBLIC]: { get: () => false },\n\t\t\t[IS_RICH_EDITOR]: { get: () => false },\n\t\t\t[IS_RICH_WORKSPACE]: { get: () => false },\n\t\t\t[EDITOR_UPLOAD]: { get: () => false },\n\t\t})\n\t\treturn val\n\t},\n\n\tprops: {\n\t\tcontent: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\treadOnly: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\n\temits: ['update:content', 'ready', 'create:content'],\n\n\tcomputed: {\n\t\teditor() {\n\t\t\treturn this.$editor\n\t\t},\n\t},\n\n\tcreated() {\n\t\tconst html = markdownit.render(this.content)\n\t\tconst extensions = [PlainTable, History]\n\n\t\tthis.$editor = new Editor({\n\t\t\tcontent: html,\n\t\t\textensions,\n\t\t\teditable: !this.readOnly,\n\t\t})\n\n\t\tthis.$editor.on('create', () => {\n\t\t\tthis.$emit('ready')\n\t\t\tthis.$parent.$emit('ready')\n\n\t\t\ttry {\n\t\t\t\tconst markdown = createMarkdownSerializer(this.$editor.schema).serialize(this.$editor.state.doc)\n\t\t\t\tthis.emit('create:content', {\n\t\t\t\t\tjson: this.$editor.state.doc,\n\t\t\t\t\tmarkdown,\n\t\t\t\t})\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error('Error serializing table:', error)\n\t\t\t}\n\t\t})\n\n\t\tthis.$editor.on('update', ({ editor }) => {\n\t\t\ttry {\n\t\t\t\tconst markdown = createMarkdownSerializer(editor.schema).serialize(editor.state.doc)\n\t\t\t\tthis.emit('update:content', {\n\t\t\t\t\tjson: editor.state.doc,\n\t\t\t\t\tmarkdown,\n\t\t\t\t})\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error('Error serializing table:', error)\n\t\t\t}\n\t\t})\n\t},\n\n\tupdated() {\n\t\tthis.$editor.setEditable(!this.readOnly)\n\t},\n\n\tbeforeDestroy() {\n\t\tthis.$editor.destroy()\n\t},\n\n\tmethods: {\n\t\t/**\n\t\t * Wrapper to emit events on our own and the parent component\n\t\t *\n\t\t * @param {string} event The event name\n\t\t * @param {any} data The data to pass along\n\t\t */\n\t\temit(event, data) {\n\t\t\tthis.$emit(event, data)\n\t\t\tthis.$parent?.$emit(event, data)\n\t\t},\n\t},\n}\n</script>\n\n<style scoped>\n\n</style>\n"],"names":["_sfc_main","ContentContainer","MainContainer","Wrapper","val","EDITOR","IS_PUBLIC","IS_RICH_EDITOR","IS_RICH_WORKSPACE","EDITOR_UPLOAD","html","markdownit","extensions","PlainTable","History","Editor","markdown","createMarkdownSerializer","error","editor","event","data"],"mappings":"yyBAuBA,MAAAA,EAAA,CACA,KAAA,0BACA,WAAA,CAAA,iBAAAC,EAAA,cAAAC,EAAA,QAAAC,CAAA,EAEA,SAAA,CACA,MAAAC,EAAA,CAAA,EACA,cAAA,iBAAAA,EAAA,CACA,CAAAC,CAAA,EAAA,CAAA,IAAA,IAAA,KAAA,OAAA,EACA,CAAAC,CAAA,EAAA,CAAA,IAAA,IAAA,EAAA,EACA,CAAAC,CAAA,EAAA,CAAA,IAAA,IAAA,EAAA,EACA,CAAAC,CAAA,EAAA,CAAA,IAAA,IAAA,EAAA,EACA,CAAAC,CAAA,EAAA,CAAA,IAAA,IAAA,EAAA,CACA,CAAA,EACAL,CACA,EAEA,MAAA,CACA,QAAA,CACA,KAAA,OACA,QAAA,EACA,EACA,SAAA,CACA,KAAA,QACA,QAAA,EACA,CACA,EAEA,MAAA,CAAA,iBAAA,QAAA,gBAAA,EAEA,SAAA,CACA,QAAA,CACA,OAAA,KAAA,OACA,CACA,EAEA,SAAA,CACA,MAAAM,EAAAC,EAAA,OAAA,KAAA,OAAA,EACAC,EAAA,CAAAC,EAAAC,CAAA,EAEA,KAAA,QAAA,IAAAC,EAAA,CACA,QAAAL,EACA,WAAAE,EACA,SAAA,CAAA,KAAA,QACA,CAAA,EAEA,KAAA,QAAA,GAAA,SAAA,IAAA,CACA,KAAA,MAAA,OAAA,EACA,KAAA,QAAA,MAAA,OAAA,EAEA,GAAA,CACA,MAAAI,EAAAC,EAAA,KAAA,QAAA,MAAA,EAAA,UAAA,KAAA,QAAA,MAAA,GAAA,EACA,KAAA,KAAA,iBAAA,CACA,KAAA,KAAA,QAAA,MAAA,IACA,SAAAD,CACA,CAAA,CACA,OAAAE,EAAA,CACA,QAAA,MAAA,2BAAAA,CAAA,CACA,CACA,CAAA,EAEA,KAAA,QAAA,GAAA,SAAA,CAAA,CAAA,OAAAC,CAAA,IAAA,CACA,GAAA,CACA,MAAAH,EAAAC,EAAAE,EAAA,MAAA,EAAA,UAAAA,EAAA,MAAA,GAAA,EACA,KAAA,KAAA,iBAAA,CACA,KAAAA,EAAA,MAAA,IACA,SAAAH,CACA,CAAA,CACA,OAAAE,EAAA,CACA,QAAA,MAAA,2BAAAA,CAAA,CACA,CACA,CAAA,CACA,EAEA,SAAA,CACA,KAAA,QAAA,YAAA,CAAA,KAAA,QAAA,CACA,EAEA,eAAA,CACA,KAAA,QAAA,QAAA,CACA,EAEA,QAAA,CAOA,KAAAE,EAAAC,EAAA,CACA,KAAA,MAAAD,EAAAC,CAAA,EACA,KAAA,SAAA,MAAAD,EAAAC,CAAA,CACA,CACA,CACA"}