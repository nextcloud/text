/*! third party licenses: js/vendor.LICENSE.txt */
var pt=e=>{throw TypeError(e)};var it=(e,s,i)=>s.has(e)||pt("Cannot "+i);var o=(e,s,i)=>(it(e,s,"read from private field"),i?i.call(e):s.get(e)),h=(e,s,i)=>s.has(e)?pt("Cannot add the same private member more than once"):s instanceof WeakSet?s.add(e):s.set(e,i),c=(e,s,i,n)=>(it(e,s,"write to private field"),n?n.call(e,i):s.set(e,i),i),u=(e,s,i)=>(it(e,s,"access private method"),i);var mt=(e,s,i,n)=>({set _(r){c(e,s,r,i)},get _(){return o(e,s,n)}});import{d as tt}from"./vue.runtime.esm--3IrasGI.mjs";import{ae as dt,a7 as yt,a9 as gt,af as xt,ag as Ft,ah as Lt,ai as Ut,aj as Bt,ak as Vt,al as Ht,am as jt,an as Wt,ao as Kt,ap as zt,aq as qt,ar as Jt,as as Qt,at as Yt}from"./RichText-e7v3Bhpw.mjs";import{n as C}from"./_plugin-vue2_normalizer-BWKvF6pj.mjs";import{c as kt,_ as Ct,U as Gt}from"./index-nj76ns_2.mjs";import{g as Xt}from"./emoji-picker-I9E7i3AY.mjs";import{d as Et,s as At,m as Zt}from"./index-Bau49HhQ.mjs";import{N as ut,f as te,d as vt,g as ee}from"./NcTextArea-XCi8a16Y-xy5piwna.mjs";import{a as se,N as ie,u as ne,z as nt}from"./NcNoteCard-e7-Bxio8-BnwS39A_.mjs";import{e as wt,l as oe}from"./modulepreload-polyfill-BrDrXBsj.mjs";import{l as re}from"./index-Ubm2itxG.mjs";import{u as et,e as ae,c as St,g as Ot,h as ce,d as le,A as he,m as de,n as ue,o as pe}from"./MediaHandler.provider-DfMqJNPv.mjs";import{l as f}from"./logger-9THuRb7E.mjs";const me={name:"NcActionButton",components:{NextcloudVueNcActionButton:ut},extends:dt,mounted(){this.$editor.on("transaction",()=>this.updateState())},methods:{runAction(){var s;const{actionEntry:e}=this;e.click?e.click(this):(s=e.action(this.$editor.chain().focus()))==null||s.run(),this.$nextTick(()=>{this.$emit("trigged",{...e})})}}};var ve=function(){var e=this,s=e._self._c;return s("NextcloudVueNcActionButton",e._g({staticClass:"entry-single-action entry-action entry-action-item",class:e.state.class,attrs:{disabled:e.state.disabled,"aria-keyshortcuts":e.keyshortcuts||void 0,"data-text-action-entry":e.actionEntry.key,type:e.state.type,"model-value":e.state.type!=="button"?e.state.active:void 0,"close-after-click":""},on:{click:e.runAction},scopedSlots:e._u([{key:"icon",fn:function(){return[s(e.icon,{tag:"component"})]},proxy:!0}])},e.$listeners),[e._v(" "+e._s(e.label)+" ")])},_e=[],fe=C(me,ve,_e,!1,null,null,null,null);const be=fe.exports,ye={name:"ActionList",components:{NcActions:se,NcActionSeparator:yt,ActionListItem:be},extends:dt,mixins:[gt,xt,Ft],props:{forceEnabled:{type:Boolean,default:!1}},data:()=>({visible:!1,hasEnabledChild:!0}),computed:{currentChild(){const{state:e,$editor:s,actionEntry:{children:i}}=this;return e.active?i.find(n=>Lt(n,s)):null},icon(){return this.currentChild?this.currentChild.icon:this.actionEntry.icon},iconKey(){return"".concat(this.actionEntry.key,"/").concat(this.activeKey)},activeKey(){var e;return(e=this.currentChild)==null?void 0:e.key},children(){return this.actionEntry.children.filter(({visible:e})=>e===void 0?!0:typeof e=="function"?e(this):e)},labelWithSelected(){return this.currentChild?t("text",'{menuItemName}, "{selectedSubMenuItemName}" is selected',{menuItemName:this.actionEntry.label,selectedSubMenuItemName:this.currentChild.label}):this.actionEntry.label},isEnabled(){return this.forceEnabled||this.hasEnabledChild}},mounted(){this.$_updateState=Et(this.checkStateOfChildren.bind(this),50),this.$editor.on("update",this.$_updateState),this.$editor.on("selectionUpdate",this.$_updateState)},beforeDestroy(){this.$editor.off("update",this.$_updateState),this.$editor.off("selectionUpdate",this.$_updateState)},methods:{onOpenChange(e){this.visible=e},runAction(){},onTrigger(e){e!=null&&e.click||(this.$editor.chain().focus().run(),this.$emit("trigged",e))},checkStateOfChildren(){this.hasEnabledChild=this.children.some(e=>this.isChildEnabled(e))},isChildEnabled(e){return!e.isSeparator&&!Ut(e,this.$editor).disabled}}};var ge=function(){var e=this,s=e._self._c;return s("NcActions",e._b({staticClass:"entry-list-action entry-action",attrs:{title:e.tooltip,container:e.menuIDSelector,"aria-label":e.labelWithSelected,type:e.state.active?"primary":"tertiary","force-menu":!0,"data-text-action-entry":e.actionEntry.key,"data-text-action-active":e.activeKey,disabled:!e.isEnabled},on:{"update:open":e.onOpenChange},scopedSlots:e._u([{key:"icon",fn:function(){return[s(e.icon,{key:e.iconKey,tag:"component"})]},proxy:!0}])},"NcActions",e.state,!1),[e._l(e.children,function(i){var n;return[i.isSeparator?s("NcActionSeparator",{key:"child-".concat(i.key)}):s("ActionListItem",e._g({key:"child-".concat(i.key),attrs:{active:((n=e.currentChild)==null?void 0:n.key)===i.key,"is-item":"","action-entry":i},on:{trigged:e.onTrigger}},e.$listeners))]}),e._t("lastAction",null,null,{visible:e.visible})],2)},xe=[],ke=C(ye,ge,xe,!1,null,null,null,null);const It=ke.exports,Ce={name:"ActionSingle",components:{NcButton:ie},extends:dt,props:{isItem:{type:Boolean,default:!1}},mounted(){this.$editor.on("transaction",()=>this.updateState())},methods:{runAction(){var s;const{actionEntry:e}=this;e.click?e.click(this):(s=e.action(this.$editor.chain().focus()))==null||s.run(),this.$nextTick(()=>{this.$emit("trigged",{...e})})}}};var Ee=function(){var e=this,s=e._self._c;return s("NcButton",e._g({staticClass:"entry-single-action entry-action",class:e.state.class,attrs:{disabled:e.state.disabled,"aria-keyshortcuts":e.keyshortcuts||void 0,"data-text-action-entry":e.actionEntry.key,"aria-label":e.label,title:e.tooltip,type:"tertiary",pressed:e.state.type!=="button"?e.state.active:void 0},on:{click:e.runAction},scopedSlots:e._u([{key:"icon",fn:function(){return[s(e.icon,{tag:"component"})]},proxy:!0},e.actionEntry.forceLabel?{key:"default",fn:function(){return[e._v(" "+e._s(e.label)+" ")]},proxy:!0}:null],null,!0)},e.$listeners))},Ae=[],we=C(Ce,Ee,Ae,!1,null,null,null,null);const $t=we.exports,Nt=tt({data(){return{activeMenuEntry:0,entries:[]}},computed:{visibleEntries(){return this.entries}},watch:{visibleEntries(){this.$nextTick(()=>{var e;(this.activeMenuEntry>this.visibleEntries.length||(e=this.visibleEntries[this.activeMenuEntry])!=null&&e.disabled)&&this.setNextMenuEntry()})}},methods:{disableMenuEntry(e,s){const i=this.visibleEntries.findIndex(({key:n})=>n===e);this.visibleEntries[i].disabled=s,s===!1&&this.activeMenuEntry===i&&this.$nextTick(()=>this.setNextMenuEntry())},setNextMenuEntry(){const e=this.visibleEntries.length+(this.$refs.remainingEntries?1:0);do this.activeMenuEntry=(this.activeMenuEntry+1)%e;while(this.activeMenuEntry<this.visibleEntries.length&&this.visibleEntries[this.activeMenuEntry].disabled)},setPreviousMenuEntry(){const e=this.visibleEntries.length+(this.$refs.remainingEntries?1:0);do{const s=this.activeMenuEntry-1;this.activeMenuEntry=(s%e+e)%e}while(this.activeMenuEntry<this.visibleEntries.length&&this.visibleEntries[this.activeMenuEntry].disabled)},handleToolbarNavigation(e){var s,i;e.key==="ArrowRight"?this.setNextMenuEntry():e.key==="ArrowLeft"&&this.setPreviousMenuEntry(),this.activeMenuEntry===this.visibleEntries.length?(i=(s=this.$refs.remainingEntries)==null?void 0:s.focusButton)==null||i.call(s):[...this.$refs.menuEntries].sort((n,r)=>this.visibleEntries.findIndex(({key:a})=>a===n.$vnode.data.key)-this.visibleEntries.findIndex(({key:a})=>a===r.$vnode.data.key))[this.activeMenuEntry].focusButton()}}}),Se=tt({name:"ReadonlyBar",components:{ActionList:It,ActionSingle:$t},extends:Nt,data(){return{entries:Bt}}});var Oe=function(){var e=this,s=e._self._c;return e._self._setupProxy,s("div",{staticClass:"text-readonly-bar",attrs:{"data-text-el":"readonly-bar"}},[s("div",{ref:"menubar",staticClass:"text-readonly-bar__entries",attrs:{role:"toolbar","aria-label":e.t("text","Editor actions")}},e._l(e.visibleEntries,function(i,n){return s(i.component?i.component:i.children?"ActionList":"ActionSingle",{key:i.key,ref:"menuEntries",refInFor:!0,tag:"component",attrs:{"action-entry":i,"can-be-focussed":e.activeMenuEntry===n},on:{disabled:function(r){return e.disableMenuEntry(i.key,r)}}})}),1),s("div",{staticClass:"text-menubar__slot"},[e._t("default")],2)])},Ie=[],$e=C(Se,Oe,Ie,!1,null,"c35c5130",null,null);const js=$e.exports;function Ne(e){return{all:e=e||new Map,on:function(s,i){var n=e.get(s);n?n.push(i):e.set(s,[i])},off:function(s,i){var n=e.get(s);n&&(i?n.splice(n.indexOf(i)>>>0,1):e.set(s,[]))},emit:function(s,i){var n=e.get(s);n&&n.slice().map(function(r){r(i)}),(n=e.get("*"))&&n.slice().map(function(r){r(s,i)})}}}class Me extends Error{constructor(s="Close has already been called on the connection",...i){super(s,...i)}}var w,X,Mt;class Te{constructor(s={}){h(this,X);h(this,w);c(this,w,s)}open({fileId:s,baseVersionEtag:i}){return kt.put(u(this,X,Mt).call(this,"session/".concat(s,"/create")),{fileId:s,baseVersionEtag:i,filePath:o(this,w).filePath,token:o(this,w).shareToken,guestName:o(this,w).guestName,forceRecreate:o(this,w).forceRecreate}).then(n=>new Tt(n,o(this,w)))}}w=new WeakMap,X=new WeakSet,Mt=function(s){const i=!!o(this,w).shareToken;return G(s,i)};var W,ht,L,m,g,Z,K,S,p,R,N,F;class Tt{constructor(s,i){h(this,p);h(this,W);h(this,ht);h(this,L);h(this,m);h(this,g);h(this,Z);h(this,K);h(this,S);const{document:n,session:r,lock:a,readOnly:v,content:A,documentState:T}=s.data;c(this,m,n),c(this,g,r),c(this,Z,a),c(this,K,v),c(this,W,A),c(this,L,T),c(this,S,i),this.isPublic=!!i.shareToken,this.closed=!1}get session(){return o(this,g)}get document(){return o(this,m)}get docStateVersion(){return o(this,L)?o(this,m).lastSavedVersion:0}get state(){return{document:{...o(this,m),readOnly:o(this,K)},session:o(this,g),documentSource:o(this,W)||"",documentState:o(this,L)}}sync({version:s}){return u(this,p,N).call(this,u(this,p,F).call(this,"session/".concat(o(this,m).id,"/sync")),{...o(this,p,R),filePath:o(this,S).filePath,baseVersionEtag:o(this,m).baseVersionEtag,version:s})}save({version:s,autosaveContent:i,documentState:n,force:r,manualSave:a}){return u(this,p,N).call(this,u(this,p,F).call(this,"session/".concat(o(this,m).id,"/save")),{...o(this,p,R),filePath:o(this,S).filePath,baseVersionEtag:o(this,m).baseVersionEtag,version:s,autosaveContent:i,documentState:n,force:r,manualSave:a})}push({steps:s,version:i,awareness:n}){return u(this,p,N).call(this,u(this,p,F).call(this,"session/".concat(o(this,m).id,"/push")),{...o(this,p,R),filePath:o(this,S).filePath,baseVersionEtag:o(this,m).baseVersionEtag,steps:s,version:i,awareness:n})}update(s){return u(this,p,N).call(this,u(this,p,F).call(this,"session/".concat(o(this,m).id,"/session")),{...o(this,p,R),guestName:s}).then(({data:i})=>{c(this,g,i)})}uploadAttachment(s){const i=new FormData;i.append("file",s);const n=G("attachment/upload")+"?documentId="+encodeURIComponent(o(this,m).id)+"&sessionId="+encodeURIComponent(o(this,g).id)+"&sessionToken="+encodeURIComponent(o(this,g).token)+"&shareToken="+encodeURIComponent(o(this,S).shareToken||"");return u(this,p,N).call(this,n,i,{headers:{"Content-Type":"multipart/form-data"}})}insertAttachmentFile(s){return u(this,p,N).call(this,G("attachment/filepath"),{documentId:o(this,m).id,sessionId:o(this,g).id,sessionToken:o(this,g).token,filePath:s})}close(){const s=u(this,p,N).call(this,u(this,p,F).call(this,"session/".concat(o(this,m).id,"/close")),o(this,p,R));return this.closed=!0,s}setBaseVersionEtag(s){o(this,m).baseVersionEtag=s}}W=new WeakMap,ht=new WeakMap,L=new WeakMap,m=new WeakMap,g=new WeakMap,Z=new WeakMap,K=new WeakMap,S=new WeakMap,p=new WeakSet,R=function(){return{documentId:o(this,m).id,sessionId:o(this,g).id,sessionToken:o(this,g).token,token:o(this,S).shareToken}},N=function(...s){return this.closed?Promise.reject(new Me):kt.post(...s)},F=function(s){const i=!!o(this,p,R).token;return G(s,i)};function G(e,s=!1){const i=Ct("/apps/text");return s?"".concat(i,"/public/").concat(e):"".concat(i,"/").concat(e)}const _t=300,Re=5e3,Pe=5e3,De=3e4,Rt=6e4,Fe=5,Le=Rt*1.5;var _,z,U,E,P,B,D;class Ue{constructor(s,i){h(this,_);h(this,z);h(this,U);h(this,E);h(this,P);h(this,B);h(this,D);c(this,_,s),c(this,z,i),c(this,E,_t),c(this,P,0),c(this,U,0)}connect(){if(this.fetcher>0){console.error("Trying to connect, but already connected");return}c(this,D,!1),this.fetcher=setInterval(this._fetchSteps.bind(this),50),document.addEventListener("visibilitychange",this.visibilitychange.bind(this))}async _fetchSteps(){if(o(this,B))return;const s=Date.now();if(!(o(this,U)>s-o(this,E))){if(!this.fetcher){console.error("No inverval but triggered");return}c(this,B,!0),f.debug("[PollingBackend] Fetching steps",o(this,_).version),await o(this,z).sync({version:o(this,_).version}).then(this._handleResponse.bind(this),this._handleError.bind(this)),c(this,U,Date.now()),c(this,B,!1)}}_handleResponse({data:s}){const{document:i,sessions:n}=s;if(c(this,P,0),o(this,_).emit("change",{document:i,sessions:n}),o(this,_)._receiveSteps(s),s.steps.length===0){if(o(this,D)||c(this,D,!0),o(this,_).checkIdle())return;const r=Date.now()-Le,a=n.filter(v=>v.lastContact*1e3>r);o(this,_).connection.state.document.readOnly?this.maximumReadOnlyTimer():a.length<2?this.maximumRefetchTimer():this.increaseRefetchTimer(),o(this,_).emit("stateChange",{initialLoading:!0});return}o(this,D)&&this.resetRefetchTimer()}_handleError(s){!s.response||s.code==="ECONNABORTED"?mt(this,P)._++>=Fe?(f.error("[PollingBackend:fetchSteps] Network error when fetching steps, emitting CONNECTION_FAILED"),o(this,_).emit("error",{type:x.CONNECTION_FAILED,data:{}})):f.error("[PollingBackend:fetchSteps] Network error when fetching steps, retry ".concat(o(this,P))):s.response.status===409?(this._handleResponse(s.response),f.error("Conflict during file save, please resolve"),o(this,_).emit("error",{type:x.SAVE_COLLISSION,data:{outsideChange:s.response.data.outsideChange}})):s.response.status===412?(o(this,_).emit("error",{type:x.LOAD_ERROR,data:s.response}),this.disconnect()):s.response.status===403?(o(this,_).emit("error",{type:x.SOURCE_NOT_FOUND,data:{}}),this.disconnect()):s.response.status===404?(o(this,_).emit("error",{type:x.SOURCE_NOT_FOUND,data:{}}),this.disconnect()):s.response.status===503?(this.increaseRefetchTimer(),o(this,_).emit("error",{type:x.CONNECTION_FAILED,data:{}}),f.error("Failed to fetch steps due to unavailable service",{error:s})):(this.disconnect(),o(this,_).emit("error",{type:x.CONNECTION_FAILED,data:{}}),f.error("Failed to fetch steps due to other reason",{error:s}))}disconnect(){clearInterval(this.fetcher),this.fetcher=0,document.removeEventListener("visibilitychange",this.visibilitychange.bind(this))}resetRefetchTimer(){c(this,E,_t)}increaseRefetchTimer(){c(this,E,Math.min(o(this,E)*2,Re))}maximumRefetchTimer(){c(this,E,Pe)}maximumReadOnlyTimer(){c(this,E,De)}visibilitychange(){document.visibilityState==="hidden"?c(this,E,Rt):this.resetRefetchTimer()}}_=new WeakMap,z=new WeakMap,U=new WeakMap,E=new WeakMap,P=new WeakMap,B=new WeakMap,D=new WeakMap;const Be=1440,Ve=3e4,Ws=60,He=90,x={SAVE_COLLISSION:0,PUSH_FAILURE:1,LOAD_ERROR:2,CONNECTION_FAILED:3,SOURCE_NOT_FOUND:4};var M;class Ks{constructor({baseVersionEtag:s,serialize:i,getDocumentState:n,...r}){h(this,M);return this._bus=Ne(),this.serialize=i,this.getDocumentState=n,this._api=new Te(r),this.connection=null,this.stepClientIDs=[],this.lastStepPush=Date.now(),this.version=null,this.baseVersionEtag=s,this.sending=!1,c(this,M,null),this.autosave=Et(this._autosave.bind(this),Ve),this}async open({fileId:s,initialSession:i}){const n=i?Promise.resolve(new Tt({data:i},{})):this._api.open({fileId:s,baseVersionEtag:this.baseVersionEtag}).catch(r=>this._emitError(r));this.connection=await n,this.connection&&(this.backend=new Ue(this,this.connection),this.version=this.connection.docStateVersion,this.baseVersionEtag=this.connection.document.baseVersionEtag,this.emit("opened",{...this.connection.state,version:this.version}),this.emit("loaded",{...this.connection.state,version:this.version}))}startSync(){this.backend.connect()}syncUp(){this.backend.resetRefetchTimer()}_emitError(s){!s.response||s.code==="ECONNABORTED"?this.emit("error",{type:x.CONNECTION_FAILED,data:{}}):this.emit("error",{type:x.LOAD_ERROR,data:s.response})}updateSession(s){return this.connection.isPublic?this.connection.update(s).catch(i=>(f.error("Failed to update the session",{error:i}),Promise.reject(i))):Promise.reject(new Error)}sendSteps(s){if(!o(this,M))return new Promise((i,n)=>{c(this,M,setInterval(()=>{this.connection&&!this.sending&&this.sendStepsNow(s).then(i).catch(n)},200))})}sendStepsNow(s){this.sending=!0,clearInterval(o(this,M)),c(this,M,null);const i=s();return i.steps.length>0&&this.emit("stateChange",{dirty:!0}),this.connection.push(i).then(n=>{this.sending=!1,this.emit("sync",{steps:[],document:this.connection.document,version:this.version})}).catch(n=>{var v;const{response:r,code:a}=n;throw this.sending=!1,(!r||a==="ECONNABORTED")&&this.emit("error",{type:x.CONNECTION_FAILED,data:{}}),(r==null?void 0:r.status)===412?this.emit("error",{type:x.LOAD_ERROR,data:r}):(r==null?void 0:r.status)===403&&(i.document||f.error("failed to write to document - not allowed"),((v=r.data.document)==null?void 0:v.currentVersion)===this.version&&(this.emit("error",{type:x.PUSH_FAILURE,data:{}}),OC.Notification.showTemporary("Changes could not be sent yet"))),new Error("Failed to apply steps. Retry!",{cause:n})})}_receiveSteps({steps:s,document:i,sessions:n}){const r=[...n.filter(a=>a.lastContact>Math.floor(Date.now()/1e3)-He).filter(a=>a.lastAwarenessMessage).map(a=>({step:a.lastAwarenessMessage,clientId:a.clientId}))];for(let a=0;a<s.length;a++){const v=s[a].data;if(this.version<s[a].version&&(this.version=s[a].version),!Array.isArray(v)){f.error("Invalid step data, skipping step",{step:s[a]});continue}v.forEach(A=>{r.push({step:A,clientID:s[a].sessionId})})}this.lastStepPush=Date.now(),this.emit("sync",{steps:r,document:this.connection.document,version:this.version})}checkIdle(){return(Date.now()-this.lastStepPush)/1e3/60>Be?(f.debug("[SyncService] Document is idle for ".concat(this.IDLE_TIMEOUT," minutes, suspending connection")),this.emit("idle"),!0):!1}_getContent(){return this.serialize()}async save({force:s=!1,manualSave:i=!0}={}){f.debug("[SyncService] saving",arguments[0]);try{const n=await this.connection.save({version:this.version,autosaveContent:this._getContent(),documentState:this.getDocumentState(),force:s,manualSave:i});this.emit("stateChange",{dirty:!1}),this.connection.document.lastSavedVersionTime=Date.now()/1e3,f.debug("[SyncService] saved",n);const{document:r,sessions:a}=n.data;this.emit("save",{document:r,sessions:a}),this.autosave.clear()}catch(n){throw f.error("Failed to save document.",{error:n}),n}}forceSave(){return this.save({force:!0})}_autosave(){return this.save({manualSave:!1}).catch(s=>{f.error("Failed to autosave document.",{error:s})})}async close(){var s;return this.autosave.clear(),(s=this.backend)==null||s.disconnect(),this._close()}_close(){return this.connection===null?Promise.resolve():(this.backend.disconnect(),this.connection.close())}uploadAttachment(s){return this.connection.uploadAttachment(s)}insertAttachmentFile(s){return this.connection.insertAttachmentFile(s)}on(s,i){return this._bus.on(s,i),this}off(s,i){return this._bus.off(s,i),this}emit(s,i){this._bus.emit(s,i)}}M=new WeakMap;var ot={exports:{}};(function(e,s){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;function i(y){"@babel/helpers - typeof";return i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(d){return typeof d}:function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d},i(y)}var n=47,r=46,a=function(y){var d=i(y);if(d!=="string")throw new TypeError("Expected a string, got a ".concat(d))},v=function(y,d){for(var l="",O=0,I=-1,$=0,j,k=0;k<=y.length;++k){if(k<y.length)j=y.charCodeAt(k);else{if(j===n)break;j=n}if(j===n){if(!(I===k-1||$===1))if(I!==k-1&&$===2){if(l.length<2||O!==2||l.charCodeAt(l.length-1)!==r||l.charCodeAt(l.length-2)!==r){if(l.length>2){var st=l.lastIndexOf("/");if(st!==l.length-1){st===-1?(l="",O=0):(l=l.slice(0,st),O=l.length-1-l.lastIndexOf("/")),I=k,$=0;continue}}else if(l.length===2||l.length===1){l="",O=0,I=k,$=0;continue}}d&&(l.length>0?l+="/..":l="..",O=2)}else l.length>0?l+="/"+y.slice(I+1,k):l=y.slice(I+1,k),O=k-I-1;I=k,$=0}else j===r&&$!==-1?++$:$=-1}return l},A=function(y){try{return decodeURIComponent(y)}catch{return y}},T=function(y){a(y);var d=y;if(d.length===0)return".";var l=d.charCodeAt(0)===n,O=d.charCodeAt(d.length-1)===n;return d=A(d),d=v(d,!l),d.length===0&&!l&&(d="."),d.length>0&&O&&(d+="/"),l?"/"+d:d},Dt=T;s.default=Dt,e.exports=s.default})(ot,ot.exports);var je=ot.exports;const We=Xt(je),Ke=e=>At.dispatch("text/setAttachmentList",e),ft=At.getters["text/findAttachment"];var q,V,H,J,Q,Y,b,rt,at,ct,Pt,lt;class zs{constructor({session:s,user:i,shareToken:n,currentDirectory:r,fileId:a}){h(this,b);h(this,q);h(this,V);h(this,H);h(this,J);h(this,Q);h(this,Y);c(this,q,s),c(this,V,i),c(this,H,n),c(this,J,r),c(this,Q,a!=null?a:s.documentId),c(this,Y,u(this,b,rt).call(this))}async resolve(s,i=!0){let n;const r=/^\.attachments\.\d+\//;if(s.match(r)){const a=decodeURIComponent(s.replace(r,"").split("?")[0]);if(await o(this,Y),n=ft(a),i&&!n&&(await u(this,b,rt).call(this),n=ft(a)),n)return n}return ze(s)?{isImage:!0,name:u(this,b,at).call(this,s),previewUrl:s,fullUrl:s}:{isImage:!0,name:u(this,b,at).call(this,s),previewUrl:u(this,b,ct).call(this,s),fullUrl:u(this,b,ct).call(this,s)}}}q=new WeakMap,V=new WeakMap,H=new WeakMap,J=new WeakMap,Q=new WeakMap,Y=new WeakMap,b=new WeakSet,rt=async function(){return Ke({documentId:o(this,Q),session:o(this,q),shareToken:o(this,H)})},at=function(s){return s.split("/").pop()},ct=function(s){if(o(this,V)){const a=o(this,V).uid,v=u(this,b,lt).call(this,s).split("/").map(encodeURIComponent).join("/");return Gt("dav/files/".concat(a).concat(v))}const i=u(this,b,lt).call(this,s).split("/"),n=i.pop(),r=i.join("/");return Ct("/s/{token}/download?path={dirname}&files={basename}",{token:o(this,H),basename:n,dirname:r})},Pt=function(s){return decodeURI(s.split("?")[0])},lt=function(s){const i=[o(this,J),u(this,b,Pt).call(this,s)].join("/");return We(i)};function ze(e){return e.startsWith("http://")||e.startsWith("https://")||e.startsWith("data:")}const qe=tt({name:"NcActionButton",components:{NextcloudVueNcActionButton:ut,Help:Vt}});var Je=function(){var e=this,s=e._self._c;return e._self._setupProxy,s("NextcloudVueNcActionButton",e._g({attrs:{"close-after-click":"","data-text-action-entry":"formatting-help"},scopedSlots:e._u([{key:"icon",fn:function(){return[s("Help")]},proxy:!0}])},e.$listeners),[e._v(" "+e._s(e.t("text","Formatting help"))+" ")])},Qe=[],Ye=C(qe,Je,Qe,!1,null,null,null,null);const Ge=Ye.exports,Xe=tt({name:"CharacterCount",components:{AlphabeticalVariant:Ht,NcActionText:te},mixins:[et],props:{visible:Boolean},data:()=>({wordCount:0,charCount:0}),computed:{countString(){return"".concat(vt("text","%n word","%n words",this.wordCount),", ").concat(vt("text","%n char","%n chars",this.charCount))}},watch:{visible:"refresh"},created(){this.refresh()},methods:{refresh(){this.wordCount=this.$editor.storage.characterCount.words(),this.charCount=this.$editor.storage.characterCount.characters()}}});var Ze=function(){var e=this,s=e._self._c;return e._self._setupProxy,s("NcActionText",{attrs:{"data-text-action-entry":"character-count"},scopedSlots:e._u([{key:"icon",fn:function(){return[s("AlphabeticalVariant")]},proxy:!0},{key:"default",fn:function(){return[e._v(" "+e._s(e.countString)+" ")]},proxy:!0}])})},ts=[],es=C(Xe,Ze,ts,!1,null,null,null,null);const ss=es.exports;function is(){var e;return((e=navigator==null?void 0:navigator.userAgentData)==null?void 0:e.mobile)!==void 0?navigator.userAgentData.mobile:[/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/playbook/i,/silk/i,/BlackBerry/i,/Windows Phone/i].some(s=>navigator.userAgent.match(s))}const ns={name:"HelpModal",components:{NcDialog:ee},data(){return{formatted:{bold:!0,italic:!0,strikethrough:!0,heading1:!0,heading6:!0,unorderdList:!0,orderedList:!0,checkList:!0,blockQuote:!0,codeBlock:!0}}},computed:{isFormatted(){return e=>this.formatted[e]},isMobileCached(){return this.isMobilePlatform()}},methods:{toggleFormatted(e){this.formatted[e]=!this.formatted[e]},isMobilePlatform:is}};var os=function(){var e=this,s=e._self._c;return s("NcDialog",{attrs:{size:"normal","data-text-el":"formatting-help",name:e.t("text","Formatting and shortcuts"),"close-on-click-outside":!0},on:{closing:function(i){return e.$emit("close")}}},[s("h2",[e._v(e._s(e.t("text","Formatting and shortcuts")))]),s("p",[e._v(e._s(e.t("text","Speed up your writing with simple shortcuts.")))]),e.isMobileCached?s("p",[e._v(" "+e._s(e.t("text","Just type the Markdown syntax from below."))+" ")]):s("p",[e._v(" "+e._s(e.t("text","Just type the Markdown syntax or use keyboard shortcuts from below."))+" ")]),s("table",[s("thead",[s("tr",[s("th",[e._v(e._s(e.t("text","Style")))]),s("th",[e._v(e._s(e.t("text","Syntax")))]),e.isMobileCached?e._e():s("th",[e._v(" "+e._s(e.t("text","Keyboard shortcuts"))+" ")])])]),s("tbody",[s("tr",[s("td",[e._v(e._s(e.t("text","New paragraph")))]),s("td",[s("kbd",[e._v(e._s(e.t("text","Enter")))])]),e.isMobileCached?e._e():s("td")]),s("tr",[s("td",[e._v(e._s(e.t("text","Hard line break")))]),s("td",[s("kbd",[e._v(e._s(e.t("text","Enter")))]),e._v(" "+e._s(e.t("text","followed by"))+" "),s("kbd",[e._v(e._s(e.t("text","Backspace")))])]),e.isMobileCached?e._e():s("td",[s("kbd",[e._v(e._s(e.t("text","Shift")))]),e._v(" + "),s("kbd",[e._v(e._s(e.t("text","Enter")))])])]),s("tr",[s("td",[e._v(e._s(e.t("text","Bold")))]),s("td",[s("code",[e._v("**"+e._s(e.t("text","Bold text"))+"**")])]),e.isMobileCached?e._e():s("td",[s("kbd",[e._v(e._s(e.t("text","Ctrl")))]),e._v(" + "),s("kbd",[e._v("B")])])]),s("tr",[s("td",[e._v(e._s(e.t("text","Italic")))]),s("td",[s("code",[e._v("*"+e._s(e.t("text","Italicized text"))+"*")])]),e.isMobileCached?e._e():s("td",[s("kbd",[e._v(e._s(e.t("text","Ctrl")))]),e._v(" + "),s("kbd",[e._v("I")])])]),s("tr",[s("td",[e._v(e._s(e.t("text","Strikethrough")))]),s("td",[s("code",[e._v("~~"+e._s(e.t("text","Mistaken text"))+"~~")])]),e.isMobileCached?e._e():s("td",[s("kbd",[e._v(e._s(e.t("text","Ctrl")))]),e._v(" + "),s("kbd",[e._v(e._s(e.t("text","Shift")))]),e._v(" + "),s("kbd",[e._v("S")])])]),s("tr",[s("td",[e._v(e._s(e.t("text","Underline")))]),s("td",[s("code",[e._v("__"+e._s(e.t("text","Underlined text"))+"__")])]),e.isMobileCached?e._e():s("td",[s("kbd",[e._v(e._s(e.t("text","Ctrl")))]),e._v(" + "),s("kbd",[e._v("U")])])]),s("tr",[s("td",{staticClass:"ellipsis_top"},[e._v(" "+e._s(e.t("text","Heading 1"))+" ")]),s("td",{staticClass:"ellipsis_top"},[s("code",[e._v("# "+e._s(e.t("text","Heading level 1")))])]),e.isMobileCached?e._e():s("td",{staticClass:"ellipsis_top"},[s("kbd",[e._v(e._s(e.t("text","Ctrl")))]),e._v(" + "),s("kbd",[e._v(e._s(e.t("text","Shift")))]),e._v(" + "),s("kbd",[e._v("1")])])]),s("tr",[s("td",{staticClass:"noborder ellipsis"},[e._v(" … ")]),s("td",{staticClass:"noborder ellipsis"},[e._v(" … ")]),e.isMobileCached?e._e():s("td",{staticClass:"ellipsis noborder"},[e._v(" … ")])]),s("tr",[s("td",{staticClass:"noborder ellipsis_bottom"},[e._v(" "+e._s(e.t("text","Heading 6"))+" ")]),s("td",{staticClass:"noborder ellipsis_bottom"},[s("code",[e._v("###### "+e._s(e.t("text","Heading level 6")))])]),e.isMobileCached?e._e():s("td",{staticClass:"noborder ellipsis_bottom"},[s("kbd",[e._v(e._s(e.t("text","Ctrl")))]),e._v(" + "),s("kbd",[e._v(e._s(e.t("text","Shift")))]),e._v(" + "),s("kbd",[e._v("6")])])]),s("tr",[s("td",[e._v(e._s(e.t("text","Unordered list")))]),s("td",[s("code",[e._v("* "+e._s(e.t("text","An item")))])]),e.isMobileCached?e._e():s("td",[s("kbd",[e._v(e._s(e.t("text","Ctrl")))]),e._v(" + "),s("kbd",[e._v(e._s(e.t("text","Shift")))]),e._v(" + "),s("kbd",[e._v("8")])])]),s("tr",[s("td",[e._v(e._s(e.t("text","Ordered list")))]),s("td",[s("code",[e._v("1. "+e._s(e.t("text","First item")))])]),e.isMobileCached?e._e():s("td",[s("kbd",[e._v(e._s(e.t("text","Ctrl")))]),e._v(" + "),s("kbd",[e._v(e._s(e.t("text","Shift")))]),e._v(" + "),s("kbd",[e._v("7")])])]),s("tr",[s("td",[e._v(e._s(e.t("text","Checklist")))]),s("td",[s("code",[e._v("* [] "+e._s(e.t("text","To-Do item")))])]),e.isMobileCached?e._e():s("td")]),s("tr",[s("td",[e._v(e._s(e.t("text","Blockquote")))]),s("td",[s("code",[e._v("> "+e._s(e.t("text","Quoted text")))])]),e.isMobileCached?e._e():s("td",[s("kbd",[e._v(e._s(e.t("text","Ctrl")))]),e._v(" + "),s("kbd",[e._v(">")])])]),s("tr",[s("td",[e._v(e._s(e.t("text","Code block")))]),s("td",[s("code",[e._v("``` "+e._s(e.t("text","Some code")))])]),e.isMobileCached?e._e():s("td")]),s("tr",[s("td",[e._v(e._s(e.t("text","Link")))]),s("td",[s("code",[e._v("[Title](https://example.org)")])]),e.isMobileCached?e._e():s("td")]),s("tr",[s("td",[e._v(e._s(e.t("text","Insert emoji")))]),s("td",[s("code",[e._v(":"+e._s(e.t("text","emoji")))])]),e.isMobileCached?e._e():s("td")]),s("tr",[s("td",[e._v(e._s(e.t("text","Mention someone")))]),s("td",[s("code",[e._v("@"+e._s(e.t("text","name")))])]),e.isMobileCached?e._e():s("td")]),s("tr",[s("td",[e._v(e._s(e.t("text","Smart picker")))]),s("td",[s("code",[e._v("/"+e._s(e.t("text","something")))])]),e.isMobileCached?e._e():s("td")])])]),s("table",{attrs:{vif:"!isMobileCached"}},[s("thead",[s("tr",[s("th",[e._v(e._s(e.t("text","Action")))]),s("th",[e._v(e._s(e.t("text","Keyboard shortcuts")))])])]),s("tbody",[s("tr",[s("td",[e._v(e._s(e.t("text","Undo")))]),s("td",[s("kbd",[e._v(e._s(e.t("text","Ctrl")))]),e._v(" + "),s("kbd",[e._v("Z")])])]),s("tr",[s("td",[e._v(e._s(e.t("text","Redo")))]),s("td",[s("kbd",[e._v(e._s(e.t("text","Ctrl")))]),e._v(" + "),s("kbd",[e._v("Y")])])]),s("tr",[s("td",[e._v(e._s(e.t("text","Toggle outline")))]),s("td",[s("kbd",[e._v(e._s(e.t("text","Ctrl")))]),e._v(" + "),s("kbd",[e._v(e._s(e.t("text","Alt")))]),e._v(" + "),s("kbd",[e._v("H")])])])])])])},rs=[],as=C(ns,os,rs,!1,null,"bdf077d8",null,null);const cs=as.exports,ls={name:"MenuBar",components:{ActionFormattingHelp:Ge,ActionList:It,ActionSingle:$t,HelpModal:cs,NcActionSeparator:yt,NcActionButton:ut,CharacterCount:ss,TranslateVariant:jt},extends:Nt,mixins:[et,ae,St,Ot],provide(){const e={};return Object.defineProperties(e,{[zt]:{get:()=>this.randomID}}),e},props:{isHidden:{type:Boolean,default:!1}},data(){return{entries:[...Wt],randomID:"menu-bar-".concat(Math.ceil(Math.random()*1e4+500).toString(16)),displayHelp:!1,isReady:!1,canTranslate:re("text","translation_languages",[]).length>0,resize:null,iconsLimit:4}},computed:{visibleEntries(){return this.entries.filter(({priority:e})=>e===void 0||e<=this.iconsLimit)},hiddenEntries(){const e=this.entries.filter(({priority:i})=>i!==void 0&&i>this.iconsLimit),s=e.reduce((i,n,r)=>{var v;const a=(v=n.children)!=null?v:[n];if(a.length>1){const A=i.length&&!i.at(-1).isSeparator?[{key:"separator-before-".concat(n.id),isSeparator:!0}]:[],T=r!==e.length-1?[{key:"separator-after-".concat(n.id),isSeparator:!0}]:[];return[...i,...A,...a,...T]}return[...i,...a]},[]);return{key:"remain",label:this.t("text","Remaining actions"),icon:Kt,children:s}}},mounted(){this.resize=ne(this.$refs.menubar,this.onResize),this.$nextTick(()=>{this.isReady=!0,this.$emit("update:loaded",!0)})},beforeDestroy(){var e;(e=this.resize)==null||e.stop()},methods:{onResize(e){window.requestAnimationFrame(()=>{const s=e[0],{width:i}=s.contentRect,n=i-4,r=this.$isMobile?44:46,a=Math.floor(n/r);this.iconsLimit=a-1})},showHelp(){this.displayHelp=!0},hideHelp(){this.displayHelp=!1},showTranslate(){const{from:e,to:s}=this.$editor.view.state.selection;let i=this.$editor.view.state.doc.textBetween(e,s," ");i.trim().length||(this.$editor.commands.selectAll(),i=this.$editor.view.state.doc.textContent),console.debug("translation click",this.$editor.view.state.selection,i),wt("text:translate-modal:show",{content:i})}}};var hs=function(){var e=this,s=e._self._c;return s("div",{staticClass:"text-menubar",class:{"text-menubar--ready":e.isReady,"text-menubar--hide":e.isHidden,"text-menubar--is-workspace":e.$isRichWorkspace},attrs:{id:e.randomID,"data-text-el":"menubar",role:"region","aria-label":e.t("text","Editor actions")}},[e.displayHelp?s("HelpModal",{on:{close:e.hideHelp}}):e._e(),e.$isRichEditor?s("div",{ref:"menubar",staticClass:"text-menubar__entries",attrs:{role:"toolbar","aria-label":e.t("text","Formatting menu bar")},on:{keydown:[function(i){return!i.type.indexOf("key")&&e._k(i.keyCode,"left",37,i.key,["Left","ArrowLeft"])||"button"in i&&i.button!==0?null:(i.stopPropagation(),e.handleToolbarNavigation.apply(null,arguments))},function(i){return!i.type.indexOf("key")&&e._k(i.keyCode,"right",39,i.key,["Right","ArrowRight"])||"button"in i&&i.button!==2?null:(i.stopPropagation(),e.handleToolbarNavigation.apply(null,arguments))}]}},[e._l(e.visibleEntries,function(i,n){return s(i.component?i.component:i.children?"ActionList":"ActionSingle",{key:i.key,ref:"menuEntries",refInFor:!0,tag:"component",attrs:{"action-entry":i,"can-be-focussed":e.activeMenuEntry===n},on:{disabled:function(r){return e.disableMenuEntry(i.key,r)},click:function(r){e.activeMenuEntry=n}}})}),s("ActionList",{ref:"remainingEntries",attrs:{"action-entry":e.hiddenEntries,"can-be-focussed":e.activeMenuEntry===e.visibleEntries.length,"force-enabled":!0},on:{click:function(i){e.activeMenuEntry="remain"}},scopedSlots:e._u([{key:"lastAction",fn:function({visible:i}){return[e.canTranslate?s("NcActionButton",{attrs:{"close-after-click":""},on:{click:e.showTranslate},scopedSlots:e._u([{key:"icon",fn:function(){return[s("TranslateVariant")]},proxy:!0}],null,!0)},[e._v(" "+e._s(e.t("text","Translate"))+" ")]):e._e(),s("ActionFormattingHelp",{on:{click:e.showHelp}}),s("NcActionSeparator"),s("CharacterCount",e._b({},"CharacterCount",{visible:i},!1))]}}],null,!1,2316723924)})],2):e._e(),s("div",{staticClass:"text-menubar__slot"},[e._t("default")],2)],1)},ds=[],us=C(ls,hs,ds,!1,null,"9c068df0",null,null);const qs=us.exports,ps={name:"ContentContainer",components:{EditorContent:qt,EditorOutline:Jt},mixins:[et,xt],computed:{showOutline(){return this.$outlineState.visible}}};var ms=function(){var e=this,s=e._self._c;return s("div",{staticClass:"content-wrapper text-editor__content-wrapper",class:{"--show-outline":e.showOutline},attrs:{"data-text-el":"editor-content-wrapper"}},[e.showOutline?s("div",{staticClass:"text-editor__content-wrapper__left"},[s("EditorOutline")],1):e._e(),e._t("default"),s("EditorContent",{staticClass:"editor__content text-editor__content",attrs:{role:"document",editor:e.$editor}}),s("div",{staticClass:"text-editor__content-wrapper__right"})],2)},vs=[],_s=C(ps,ms,vs,!1,null,"a3b97a85",null,null);const Js=_s.exports,bt=e=>e.split("/").slice(0,-1).join("/"),fs={name:"MediaHandler",mixins:[et,ce,le],provide(){const e={};return Object.defineProperties(e,{[he]:{get:()=>this.showAttachmentPrompt},[de]:{get:()=>this.chooseLocalFile},[ue]:{get:()=>this.state}}),e},data(){return{lastFilePath:null,draggedOver:!1,state:{isUploadingAttachments:!1}}},computed:{initialFilePath(){var e,s,i;return(i=this.lastFilePath)!=null?i:bt((s=(e=this.$file)==null?void 0:e.relativePath)!=null?s:"/")}},methods:{setDraggedOver(e){this.draggedOver=e},onPaste(e){this.uploadAttachmentFiles(e.detail.files)},onEditorDrop(e){this.uploadAttachmentFiles(e.detail.files,e.detail.position),this.draggedOver=!1},onAttachmentUploadFilePicked(e){this.uploadAttachmentFiles(e.target.files),e.target.value=""},chooseLocalFile(){this.$refs.attachmentFileInput.click()},async uploadAttachmentFiles(e,s=null){if(!e)return;this.state.isUploadingAttachments=!0;const i=[...e].map(n=>this.uploadAttachmentFile(n,s));return Promise.all(i).catch(n=>{var r,a;f.error("Uploading multiple images failed",{error:n}),nt(((a=(r=n==null?void 0:n.response)==null?void 0:r.data)==null?void 0:a.error)||n.message)}).then(()=>{this.state.isUploadingAttachments=!1})},async uploadAttachmentFile(e,s=null){return this.state.isUploadingAttachments=!0,this.$syncService.uploadAttachment(e).then(i=>{var n,r,a;this.insertAttachment((n=i.data)==null?void 0:n.name,(r=i.data)==null?void 0:r.id,e.type,s,(a=i.data)==null?void 0:a.dirname)}).catch(i=>{var n,r;f.error("Uploading image failed",{error:i}),nt((r=(n=i==null?void 0:i.response)==null?void 0:n.data)==null?void 0:r.error)}).then(()=>{this.state.isUploadingAttachments=!1})},showAttachmentPrompt(){oe()&&OC.dialogs.filepicker(t("text","Insert an attachment"),e=>{this.insertFromPath(e)},!1,[],!0,void 0,this.initialFilePath)},insertFromPath(e){return this.lastFilePath=bt(e),this.state.isUploadingAttachments=!0,this.$syncService.insertAttachmentFile(e).then(s=>{var i,n,r,a;this.insertAttachment((i=s.data)==null?void 0:i.name,(n=s.data)==null?void 0:n.id,(r=s.data)==null?void 0:r.mimetype,null,(a=s.data)==null?void 0:a.dirname)}).catch(s=>{var i,n;f.error("Failed to insert image path",{error:s}),nt(((n=(i=s==null?void 0:s.response)==null?void 0:i.data)==null?void 0:n.error)||s.message)}).then(()=>{this.state.isUploadingAttachments=!1})},insertAttachment(e,s,i,n=null,r=""){const a=r+"/"+encodeURIComponent(e).replace(/[!'()*]/g,T=>"%"+T.charCodeAt(0).toString(16).toUpperCase()),v=e.replaceAll(/[[\]]/g,"");(n?this.$editor.chain().focus(n):this.$editor.chain()).setImage({src:a,alt:v}).run();const A=this.$editor.view.state.selection;A.empty||this.$editor.commands.focus(A.to),this.$editor.commands.scrollIntoView(),wt("text:image-node:add",null)}}};var bs=function(){var e=this,s=e._self._c;return s("div",{staticClass:"editor editor-media-handler",class:{draggedOver:e.draggedOver},attrs:{"data-text-el":"editor-media-handler"},on:{"image-paste":e.onPaste,dragover:function(i){return i.preventDefault(),i.stopPropagation(),e.setDraggedOver(!0)},dragleave:function(i){return i.preventDefault(),i.stopPropagation(),e.setDraggedOver(!1)},"file-drop":e.onEditorDrop}},[s("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"attachmentFileInput",attrs:{"data-text-el":"attachment-file-input",type:"file",accept:"*/*",multiple:""},on:{change:e.onAttachmentUploadFilePicked}}),e._t("default")],2)},ys=[],gs=C(fs,bs,ys,!1,null,null,null,null);const xs=gs.exports,ks={name:"MainContainer",components:{MediaHandler:xs},mixins:[pe]};var Cs=function(){var e=this,s=e._self._c;return s("div",{staticClass:"editor"},[e.$editorUpload?s("MediaHandler",{staticClass:"text-editor__main"},[e._t("default")],2):e._t("default")],2)},Es=[],As=C(ks,Cs,Es,!1,null,"f2d30048",null,null);const Qs=As.exports,ws={name:"Wrapper",mixins:[gt,St,Ot],provide(){const e={};return Object.defineProperties(e,{[Qt]:{get:()=>this.outline},[Yt]:{get:()=>({toggle:this.outlineToggle})}}),e},props:{syncError:{type:Object,default:null},hasConnectionIssue:{type:Boolean,default:!1},contentLoaded:{type:Boolean,default:!0},showAuthorAnnotations:{type:Boolean,default:!1},showOutlineOutside:{type:Boolean,default:!1}},data:()=>({outline:{visible:!1,enable:!1}}),computed:{...Zt({viewWidth:e=>e.text.viewWidth}),hasSyncCollission(){return this.syncError&&this.syncError.type===x.SAVE_COLLISSION},showOutline(){return this.isAbleToShowOutline?this.outline.visible:!1},isAbleToShowOutline(){return this.$isRichWorkspace?!1:this.viewWidth>1265}},watch:{showOutlineOutside(){this.outline.visible=this.showOutlineOutside}},mounted(){this.outline.enable=this.isAbleToShowOutline,this.$watch(()=>this.isAbleToShowOutline,e=>{Object.assign(this.outline,{enable:e})}),document.addEventListener("keydown",this.handleKeyDown)},beforeDestroy(){document.removeEventListener("keydown",this.handleKeyDown)},methods:{outlineToggle(){this.outline.visible=!this.outline.visible,this.$emit("outline-toggled",this.outline.visible)},handleKeyDown(e){e.ctrlKey&&e.altKey&&e.key==="h"&&this.outlineToggle()}}};var Ss=function(){var e=this,s=e._self._c;return s("div",{staticClass:"text-editor__wrapper",class:{"has-conflicts":e.hasSyncCollission,"is-rich-workspace":e.$isRichWorkspace,"is-rich-editor":e.$isRichEditor,"show-color-annotations":e.showAuthorAnnotations}},[e._t("default")],2)},Os=[],Is=C(ws,Ss,Os,!1,null,"7803d9a5",null,null);const Ys=Is.exports;export{zs as A,Js as C,x as E,Be as I,Qs as M,js as R,Ks as S,Ys as W,qs as a,He as b,Ws as c};
