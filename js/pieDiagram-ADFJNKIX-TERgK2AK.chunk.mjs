import{Q as w,T as F,aG as Q,_ as u,g as _,s as j,a as I,b as J,t as U,q as X,l as O,c as Y,F as Z,K as ee,a4 as te,e as ae,z as ie,H as re}from"./mermaid.core-DbSdpsx7.chunk.mjs";import{p as ne}from"./chunk-4BX2VUAB-BpB8UdOe.chunk.mjs";import{p as le}from"./treemap-75Q7IDZK-DtLdDsOc.chunk.mjs";import{d as P}from"./arc-f5fxssCd.chunk.mjs";import{o as se}from"./ordinal-JciKjLuy.chunk.mjs";import"./index-gMaV0V1e.chunk.mjs";import"./emoji-picker-DQhTjoLy.chunk.mjs";import"./NcLoadingIcon-pzx-bM2e.chunk.mjs";import"./vue.runtime.esm-UAI8SE-v.chunk.mjs";import"./index-DUrHmx5a.chunk.mjs";import"./_baseUniq-DEMNBe0y.chunk.mjs";import"./_basePickBy-NBVa2JDr.chunk.mjs";import"./clone-CKfRO2Jx.chunk.mjs";import"./init-CbUY40dC.chunk.mjs";function oe(e,a){return a<e?-1:a>e?1:a>=e?0:NaN}function pe(e){return e}function ce(){var e=pe,a=oe,m=null,s=w(0),o=w(F),y=w(0);function l(t){var r,p=(t=Q(t)).length,d,S,x=0,c=new Array(p),n=new Array(p),f=+s.apply(this,arguments),v=Math.min(F,Math.max(-F,o.apply(this,arguments)-f)),h,T=Math.min(Math.abs(v)/p,y.apply(this,arguments)),C=T*(v<0?-1:1),g;for(r=0;r<p;++r)(g=n[c[r]=r]=+e(t[r],r,t))>0&&(x+=g);for(a!=null?c.sort(function(b,A){return a(n[b],n[A])}):m!=null&&c.sort(function(b,A){return m(t[b],t[A])}),r=0,S=x?(v-p*C)/x:0;r<p;++r,f=h)d=c[r],g=n[d],h=f+(g>0?g*S:0)+C,n[d]={data:t[d],index:r,value:g,startAngle:f,endAngle:h,padAngle:T};return n}return l.value=function(t){return arguments.length?(e=typeof t=="function"?t:w(+t),l):e},l.sortValues=function(t){return arguments.length?(a=t,m=null,l):a},l.sort=function(t){return arguments.length?(m=t,a=null,l):m},l.startAngle=function(t){return arguments.length?(s=typeof t=="function"?t:w(+t),l):s},l.endAngle=function(t){return arguments.length?(o=typeof t=="function"?t:w(+t),l):o},l.padAngle=function(t){return arguments.length?(y=typeof t=="function"?t:w(+t),l):y},l}var ue=re.pie,R={sections:new Map,showData:!1},D=R.sections,W=R.showData,de=structuredClone(ue),ge=u(()=>structuredClone(de),"getConfig"),fe=u(()=>{D=new Map,W=R.showData,ie()},"clear"),me=u(({label:e,value:a})=>{if(a<0)throw new Error('"'.concat(e,'" has invalid value: ').concat(a,". Negative values are not allowed in pie charts. All slice values must be >= 0."));D.has(e)||(D.set(e,a),O.debug("added new section: ".concat(e,", with value: ").concat(a)))},"addSection"),he=u(()=>D,"getSections"),xe=u(e=>{W=e},"setShowData"),we=u(()=>W,"getShowData"),V={getConfig:ge,clear:fe,setDiagramTitle:X,getDiagramTitle:U,setAccTitle:J,getAccTitle:I,setAccDescription:j,getAccDescription:_,addSection:me,getSections:he,setShowData:xe,getShowData:we},ye=u((e,a)=>{ne(e,a),a.setShowData(e.showData),e.sections.map(a.addSection)},"populateDb"),Se={parse:u(async e=>{const a=await le("pie",e);O.debug(a),ye(a,V)},"parse")},ve=u(e=>"\n  .pieCircle{\n    stroke: ".concat(e.pieStrokeColor,";\n    stroke-width : ").concat(e.pieStrokeWidth,";\n    opacity : ").concat(e.pieOpacity,";\n  }\n  .pieOuterCircle{\n    stroke: ").concat(e.pieOuterStrokeColor,";\n    stroke-width: ").concat(e.pieOuterStrokeWidth,";\n    fill: none;\n  }\n  .pieTitleText {\n    text-anchor: middle;\n    font-size: ").concat(e.pieTitleTextSize,";\n    fill: ").concat(e.pieTitleTextColor,";\n    font-family: ").concat(e.fontFamily,";\n  }\n  .slice {\n    font-family: ").concat(e.fontFamily,";\n    fill: ").concat(e.pieSectionTextColor,";\n    font-size:").concat(e.pieSectionTextSize,";\n    // fill: white;\n  }\n  .legend text {\n    fill: ").concat(e.pieLegendTextColor,";\n    font-family: ").concat(e.fontFamily,";\n    font-size: ").concat(e.pieLegendTextSize,";\n  }\n"),"getStyles"),$e=ve,be=u(e=>{const a=[...e.values()].reduce((s,o)=>s+o,0),m=[...e.entries()].map(([s,o])=>({label:s,value:o})).filter(s=>s.value/a*100>=1).sort((s,o)=>o.value-s.value);return ce().value(s=>s.value)(m)},"createPieArcs"),Ae=u((e,a,m,s)=>{O.debug("rendering pie chart\n"+e);const o=s.db,y=Y(),l=Z(o.getConfig(),y.pie),t=40,r=18,p=4,d=450,S=d,x=ee(a),c=x.append("g");c.attr("transform","translate("+S/2+","+d/2+")");const{themeVariables:n}=y;let[f]=te(n.pieOuterStrokeWidth);f!=null||(f=2);const v=l.textPosition,h=Math.min(S,d)/2-t,T=P().innerRadius(0).outerRadius(h),C=P().innerRadius(h*v).outerRadius(h*v);c.append("circle").attr("cx",0).attr("cy",0).attr("r",h+f/2).attr("class","pieOuterCircle");const g=o.getSections(),b=be(g),A=[n.pie1,n.pie2,n.pie3,n.pie4,n.pie5,n.pie6,n.pie7,n.pie8,n.pie9,n.pie10,n.pie11,n.pie12];let k=0;g.forEach(i=>{k+=i});const E=b.filter(i=>(i.data.value/k*100).toFixed(0)!=="0"),M=se(A);c.selectAll("mySlices").data(E).enter().append("path").attr("d",T).attr("fill",i=>M(i.data.label)).attr("class","pieCircle"),c.selectAll("mySlices").data(E).enter().append("text").text(i=>(i.data.value/k*100).toFixed(0)+"%").attr("transform",i=>"translate("+C.centroid(i)+")").style("text-anchor","middle").attr("class","slice"),c.append("text").text(o.getDiagramTitle()).attr("x",0).attr("y",-400/2).attr("class","pieTitleText");const N=[...g.entries()].map(([i,$])=>({label:i,value:$})),z=c.selectAll(".legend").data(N).enter().append("g").attr("class","legend").attr("transform",(i,$)=>{const L=r+p,G=L*N.length/2,H=12*r,K=$*L-G;return"translate("+H+","+K+")"});z.append("rect").attr("width",r).attr("height",r).style("fill",i=>M(i.label)).style("stroke",i=>M(i.label)),z.append("text").attr("x",r+p).attr("y",r-p).text(i=>o.getShowData()?"".concat(i.label," [").concat(i.value,"]"):i.label);const q=Math.max(...z.selectAll("text").nodes().map(i=>{var $;return($=i==null?void 0:i.getBoundingClientRect().width)!=null?$:0})),B=S+t+r+p+q;x.attr("viewBox","0 0 ".concat(B," ").concat(d)),ae(x,d,B,l.useMaxWidth)},"draw"),Te={draw:Ae},Ve={parser:Se,db:V,renderer:Te,styles:$e};export{Ve as diagram};
//# sourceMappingURL=pieDiagram-ADFJNKIX-TERgK2AK.chunk.mjs.map
