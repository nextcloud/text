import{V as $,d as I,r as b,c as y,s as T,w as le,t as ce,o as z,n as Fe,b as Le,e as Ie}from"./vue.runtime.esm-D5oVStfN.chunk.mjs";import{n as S,t as k,s as j,p as E}from"./_plugin-vue2_normalizer-D_fqBVIr-Ct9rrVcA.chunk.mjs";import{s as Ve,f as Be}from"./index-B67V3Qwk.chunk.mjs";import{n as W,f as Z,C as He,m as q,G as Pe,i as ue,c as de,_ as U,o as pe,p as V}from"./index-D9k5bC65.chunk.mjs";import{b as ze,c as Ae,d as $e,e as De,f as Ee,g as Me,h as Oe,i as Te,N as fe,j as Re}from"./isDarkTheme-C_WHy9lG.chunk.mjs";import{l as he}from"./index-DfiDB3im.chunk.mjs";import{g as je}from"./emoji-picker-_ZUJ6YnW.chunk.mjs";import{u as We,s as Ze,e as qe,a as Ue}from"./index-HQWwoT4K.chunk.mjs";import{N as Ge}from"./NcDialog-I_9fyJVt-C1bSD2l_.chunk.mjs";import{g as Ye,b as Ke,d as G,c as B,C as me,e as Je,f as Y,h as ve}from"./dav-Co9y-hkg-0RnPpkTn.chunk.mjs";const Qe={name:"NcBreadcrumb",components:{NcActions:q,ChevronRight:He,NcButton:Z},inheritAttrs:!1,props:{name:{type:String,required:!0},title:{type:String,default:null},to:{type:[String,Object],default:void 0},exact:{type:Boolean,default:!1},href:{type:String,default:void 0},icon:{type:String,default:""},forceIconText:{type:Boolean,default:!1},disableDrop:{type:Boolean,default:!1},forceMenu:{type:Boolean,default:!1},open:{type:Boolean,default:!1}},emits:["update:open","dropped"],data(){return{hovering:!1,crumbId:`crumb-id-${Pe()}`}},computed:{linkAttributes(){return this.to?{to:this.to,exact:this.exact,...this.$attrs}:this.href?{href:this.href,...this.$attrs}:this.$attrs}},methods:{onOpenChange(e){this.$emit("update:open",e)},dropped(e){return this.disableDrop||(this.$emit("dropped",e,this.to||this.href),this.$parent.$emit("dropped",e,this.to||this.href),this.hovering=!1),!1},dragEnter(e){this.disableDrop||(this.hovering=!0)},dragLeave(e){this.disableDrop||e.target.contains(e.relatedTarget)||this.$refs.crumb.contains(e.relatedTarget)||(this.hovering=!1)}}};var Xe=function(){var e=this,i=e._self._c;return i("li",e._b({ref:"crumb",staticClass:"vue-crumb",class:{"vue-crumb--hovered":e.hovering},attrs:{draggable:"false"},on:{dragstart:function(t){return t.preventDefault(),(()=>{}).apply(null,arguments)},drop:function(t){return t.preventDefault(),e.dropped.apply(null,arguments)},dragover:function(t){return t.preventDefault(),(()=>{}).apply(null,arguments)},dragenter:e.dragEnter,dragleave:e.dragLeave}},"li",e._d({},[e.crumbId,""])),[(e.name||e.icon||e.$slots.icon)&&!e.$slots.default?i("NcButton",e._g(e._b({attrs:{title:e.title,"aria-label":e.icon?e.name:void 0,type:"tertiary"},scopedSlots:e._u([e.$slots.icon||e.icon?{key:"icon",fn:function(){return[e._t("icon",function(){return[i("span",{staticClass:"icon",class:e.icon})]})]},proxy:!0}:null,!(e.$slots.icon||e.icon)||e.forceIconText?{key:"default",fn:function(){return[e._v(" "+e._s(e.name)+" ")]},proxy:!0}:null],null,!0)},"NcButton",e.linkAttributes,!1),e.$listeners)):e._e(),e.$slots.default?i("NcActions",{ref:"actions",attrs:{type:"tertiary","force-menu":e.forceMenu,open:e.open,"menu-name":e.name,title:e.title,"force-name":!0,container:`.vue-crumb[${e.crumbId}]`},on:{"update:open":e.onOpenChange},scopedSlots:e._u([{key:"icon",fn:function(){return[e._t("menu-icon")]},proxy:!0}],null,!0)},[e._t("default")],2):e._e(),i("ChevronRight",{staticClass:"vue-crumb__separator",attrs:{size:20}})],1)},et=[],tt=W(Qe,Xe,et,!1,null,"cfe13af3");const ge=tt.exports;var M=Symbol(),H=Symbol(),J=Symbol(),Q=Symbol(),K=function(e){return"frag"in e},it={get:function(){return this[H]||this.parentElement},configurable:!0},P=function(e,i){H in e||(e[H]=i,Object.defineProperty(e,"parentNode",it))},rt={get:function(){var e=this.parentNode.childNodes,i=e.indexOf(this);return i>-1&&e[i+1]||null}},D=function(e){J in e||(e[J]=!0,Object.defineProperty(e,"nextSibling",rt))},nt=function(e,i){for(;e.parentNode!==i;){var t=e,r=t.parentNode;r&&(e=r)}return e},O,ye=function(e){if(!O){var i=Object.getOwnPropertyDescriptor(Node.prototype,"childNodes");O=i.get}var t=O.apply(e),r=Array.from(t).map(function(n){return nt(n,e)});return r.filter(function(n,s){return n!==r[s-1]})},st={get:function(){return this.frag||ye(this)}},ot={get:function(){return this.childNodes[0]||null}};function at(){return this.childNodes.length>0}var X=function(e){Q in e||(e[Q]=!0,Object.defineProperties(e,{childNodes:st,firstChild:ot}),e.hasChildNodes=at)};function lt(){var e;(e=this.frag[0]).before.apply(e,arguments)}function ct(){var e=this.frag,i=e.splice(0,e.length);i.forEach(function(t){t.remove()})}var ut=function e(i){var t;return(t=Array.prototype).concat.apply(t,i.map(function(r){return K(r)?e(r.frag):r}))},dt=function(e,i){var t=e[M];i.before(t),P(t,e),e.frag.unshift(t)};function ee(e){if(K(this)){var i=this.frag.indexOf(e);if(i>-1){var t=this.frag.splice(i,1),r=t[0];this.frag.length===0&&dt(this,r),e.remove()}}else{var n=ye(this),s=n.indexOf(e);s>-1&&e.remove()}return e}function te(e,i){var t=this,r=e.frag||[e];if(K(this)){if(e[H]===this&&e.parentElement)return e;var n=this.frag;if(i){var s=n.indexOf(i);s>-1&&(n.splice.apply(n,[s,0].concat(r)),i.before.apply(i,r))}else{var a=n[n.length-1];n.push.apply(n,r),a.after.apply(a,r)}_e(this)}else i?this.childNodes.includes(i)&&i.before.apply(i,r):this.append.apply(this,r);r.forEach(function(l){P(l,t)});var c=r[r.length-1];return D(c),e}function pt(e){if(e[H]===this&&e.parentElement)return e;var i=this.frag,t=i[i.length-1];return t.after(e),P(e,this),_e(this),i.push(e),e}var _e=function(e){var i=e[M];e.frag[0]===i&&(e.frag.shift(),i.remove())},ft={set:function(e){var i=this;if(this.frag[0]!==this[M]&&this.frag.slice().forEach(function(r){return i.removeChild(r)}),e){var t=document.createElement("div");t.innerHTML=e,Array.from(t.childNodes).forEach(function(r){i.appendChild(r)})}},get:function(){return""}},ht={inserted:function(e){var i=e.parentNode,t=e.nextSibling,r=e.previousSibling,n=Array.from(e.childNodes),s=document.createComment("");n.length===0&&n.push(s),e.frag=n,e[M]=s;var a=document.createDocumentFragment();a.append.apply(a,ut(n)),e.replaceWith(a),n.forEach(function(c){P(c,e),D(c)}),X(e),Object.assign(e,{remove:ct,appendChild:pt,insertBefore:te,removeChild:ee,before:lt}),Object.defineProperty(e,"innerHTML",ft),i&&(Object.assign(i,{removeChild:ee,insertBefore:te}),P(e,i),X(i)),t&&D(e),r&&D(r)},unbind:function(e){e.remove()}},be={name:"Fragment",directives:{frag:ht},render:function(e){return e("div",{directives:[{name:"frag"}]},this.$slots.default)}};const ie=(e,i,t)=>{if(e!==void 0)for(let r=e.length-1;r>=0;r--){const n=e[r],s=!n.componentOptions&&n.tag&&i.indexOf(n.tag)===-1,a=!!n.componentOptions&&typeof n.componentOptions.tag=="string",c=a&&i.indexOf(n.componentOptions.tag)===-1;(s||!a||c)&&((s||c)&&$.util.warn(`${s?n.tag:n.componentOptions.tag} is not allowed inside the ${t.$options.name} component`,t),e.splice(r,1))}},mt={name:"FolderIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var vt=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon folder-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},gt=[],yt=W(mt,vt,gt,!1,null,null);const _t=yt.exports,x="vue-crumb",bt={name:"NcBreadcrumbs",components:{NcActions:q,NcActionButton:$e,NcActionRouter:Ae,NcActionLink:ze,NcBreadcrumb:ge,IconFolder:_t},props:{rootIcon:{type:String,default:"icon-home"},ariaLabel:{type:String,default:null}},emits:["dropped"],data(){return{hiddenIndices:[],menuBreadcrumbProps:{name:"",forceMenu:!0,disableDrop:!0,open:!1},breadcrumbsRefs:{}}},beforeMount(){ie(this.$slots.default,["NcBreadcrumb"],this)},beforeUpdate(){ie(this.$slots.default,["NcBreadcrumb"],this)},created(){window.addEventListener("resize",De(()=>{this.handleWindowResize()},100)),Ze("navigation-toggled",this.delayedResize)},mounted(){this.handleWindowResize()},updated(){this.delayedResize(),this.$nextTick(()=>{this.hideCrumbs()})},beforeDestroy(){window.removeEventListener("resize",this.handleWindowResize),We("navigation-toggled",this.delayedResize)},methods:{closeActions(e){this.$refs.actionsBreadcrumb.$el.contains(e.relatedTarget)||(this.menuBreadcrumbProps.open=!1)},async delayedResize(){await this.$nextTick(),this.handleWindowResize()},handleWindowResize(){if(!this.$refs.container)return;const e=Object.values(this.breadcrumbsRefs),i=e.length,t=[],r=this.$refs.container.offsetWidth;let n=this.getTotalWidth(e);this.$refs.breadcrumb__actions&&(n+=this.$refs.breadcrumb__actions.offsetWidth);let s=n-r;s+=s>0?64:0;let a=0;const c=Math.floor(i/2);for(;s>0&&a<i-2;){const l=c+(a%2?a+1:a)/2*Math.pow(-1,a+i%2);s-=this.getWidth(e[l]?.elm,l===e.length-1),t.push(l),a++}this.arraysEqual(this.hiddenIndices,t.sort((l,o)=>l-o))||(this.hiddenIndices=t)},arraysEqual(e,i){if(e.length!==i.length)return!1;if(e===i)return!0;if(e===null||i===null)return!1;for(let t=0;t<e.length;++t)if(e[t]!==i[t])return!1;return!0},getTotalWidth(e){return e.reduce((i,t,r)=>i+this.getWidth(t?.elm,r===e.length-1),0)},getWidth(e,i){if(!e?.classList)return 0;const t=e.classList.contains(`${x}--hidden`);e.style.minWidth="auto",i&&(e.style.maxWidth="210px"),e.classList.remove(`${x}--hidden`);const r=e.offsetWidth;return t&&e.classList.add(`${x}--hidden`),e.style.minWidth="",e.style.maxWidth="",r},preventDefault(e){return e.preventDefault&&e.preventDefault(),!1},dragStart(e){return this.preventDefault(e)},dropped(e,i,t){return t||this.$emit("dropped",e,i),this.menuBreadcrumbProps.open=!1,document.querySelectorAll(`.${x}`).forEach(r=>{r.classList.remove(`${x}--hovered`)}),this.preventDefault(e)},dragOver(e){return this.preventDefault(e)},dragEnter(e,i){if(!i&&e.target.closest){const t=e.target.closest(`.${x}`);t.classList&&t.classList.contains(x)&&(document.querySelectorAll(`.${x}`).forEach(r=>{r.classList.remove(`${x}--hovered`)}),t.classList.add(`${x}--hovered`))}},dragLeave(e,i){if(!i&&!e.target.contains(e.relatedTarget)&&e.target.closest){const t=e.target.closest(`.${x}`);if(t.contains(e.relatedTarget))return;t.classList&&t.classList.contains(x)&&t.classList.remove(`${x}--hovered`)}},hideCrumbs(){Object.values(this.breadcrumbsRefs).forEach((e,i)=>{e?.elm?.classList&&(this.hiddenIndices.includes(i)?e.elm.classList.add(`${x}--hidden`):e.elm.classList.remove(`${x}--hidden`))})},isBreadcrumb(e){return(e?.componentOptions?.tag||e?.tag||"").includes("NcBreadcrumb")}},render(e){const i=[];if(this.$slots.default.forEach(s=>{if(this.isBreadcrumb(s)){i.push(s);return}s?.type===be&&s?.children?.forEach?.(a=>{this.isBreadcrumb(a)&&i.push(a)})}),i.length===0)return;$.set(i[0].componentOptions.propsData,"icon",this.rootIcon),$.set(i[0].componentOptions.propsData,"ref","breadcrumbs");const t={};i.forEach((s,a)=>{$.set(s,"ref",`crumb-${a}`),t[a]=s});let r=[];if(!this.hiddenIndices.length)r=i;else{r=i.slice(0,Math.round(i.length/2)),r.push(e("NcBreadcrumb",{class:"dropdown",props:this.menuBreadcrumbProps,attrs:{"aria-hidden":!0},ref:"actionsBreadcrumb",key:"actions-breadcrumb-1",nativeOn:{dragstart:this.dragStart,dragenter:()=>{this.menuBreadcrumbProps.open=!0},dragleave:this.closeActions},on:{"update:open":a=>{this.menuBreadcrumbProps.open=a}}},this.hiddenIndices.filter(a=>a<=i.length-1).map(a=>{const c=i[a],l=c.componentOptions.propsData.to,o=c.componentOptions.propsData.href,u=c.componentOptions.propsData.disableDrop,p=c.componentOptions.propsData.title,f=c.componentOptions.propsData.name;let h="NcActionButton",g="";o&&(h="NcActionLink",g=o),l&&(h="NcActionRouter",g=l);const d=e("IconFolder",{props:{size:20},slot:"icon"});return e(h,{class:x,props:{href:o||null,title:p,to:l||null},attrs:{draggable:!1},on:{...c.componentOptions.listeners},nativeOn:{dragstart:this.dragStart,drop:w=>this.dropped(w,g,u),dragover:this.dragOver,dragenter:w=>this.dragEnter(w,u),dragleave:w=>this.dragLeave(w,u)}},[d,f])})));const s=i.slice(Math.round(i.length/2));r=r.concat(s)}const n=[e("nav",{attrs:{"aria-label":this.ariaLabel}},[e("ul",{class:"breadcrumb__crumbs"},[r])])];return this.$slots.actions&&n.push(e("div",{class:"breadcrumb__actions",ref:"breadcrumb__actions"},this.$slots.actions)),this.breadcrumbsRefs=t,e("div",{class:["breadcrumb",{"breadcrumb--collapsed":this.hiddenIndices.length===i.length-2}],ref:"container"},n)}},wt=null,Ct=null;var kt=W(bt,wt,Ct,!1,null,"629bf30f");const xt=kt.exports;var re="M15,14C12.33,14 7,15.33 7,18V20H23V18C23,15.33 17.67,14 15,14M6,10V7H4V10H1V12H4V15H6V12H9V10M15,12A4,4 0 0,0 19,8A4,4 0 0,0 15,4A4,4 0 0,0 11,8A4,4 0 0,0 15,12Z",St="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M16.2,16.2L11,13V7H12.5V12.2L17,14.9L16.2,16.2Z",Nt="M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z",Ft="M1,1V5H2V19H1V23H5V22H19V23H23V19H22V5H23V1H19V2H5V1M5,4H19V5H20V19H19V20H5V19H4V5H5M6,6V14H9V18H18V9H14V6M8,8H12V12H8M14,11H16V16H11V14H14",Lt="M3.9,12C3.9,10.29 5.29,8.9 7,8.9H11V7H7A5,5 0 0,0 2,12A5,5 0 0,0 7,17H11V15.1H7C5.29,15.1 3.9,13.71 3.9,12M8,13H16V11H8V13M17,7H13V8.9H17C18.71,8.9 20.1,10.29 20.1,12C20.1,13.71 18.71,15.1 17,15.1H13V17H17A5,5 0 0,0 22,12A5,5 0 0,0 17,7Z",It="M12,17A2,2 0 0,0 14,15C14,13.89 13.1,13 12,13A2,2 0 0,0 10,15A2,2 0 0,0 12,17M18,8A2,2 0 0,1 20,10V20A2,2 0 0,1 18,22H6A2,2 0 0,1 4,20V10C4,8.89 4.9,8 6,8H7V6A5,5 0 0,1 12,1A5,5 0 0,1 17,6V8H18M12,3A3,3 0 0,0 9,6V8H15V6A3,3 0 0,0 12,3Z",Vt="M17,3A2,2 0 0,1 19,5V15A2,2 0 0,1 17,17H13V19H14A1,1 0 0,1 15,20H22V22H15A1,1 0 0,1 14,23H10A1,1 0 0,1 9,22H2V20H9A1,1 0 0,1 10,19H11V17H7C5.89,17 5,16.1 5,15V5A2,2 0 0,1 7,3H17Z",Bt="M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z",Ht="M5.5,7A1.5,1.5 0 0,1 4,5.5A1.5,1.5 0 0,1 5.5,4A1.5,1.5 0 0,1 7,5.5A1.5,1.5 0 0,1 5.5,7M21.41,11.58L12.41,2.58C12.05,2.22 11.55,2 11,2H4C2.89,2 2,2.89 2,4V11C2,11.55 2.22,12.05 2.59,12.41L11.58,21.41C11.95,21.77 12.45,22 13,22C13.55,22 14.05,21.77 14.41,21.41L21.41,14.41C21.78,14.05 22,13.55 22,13C22,12.44 21.77,11.94 21.41,11.58Z",R=(e=>(e[e.User=0]="User",e[e.Group=1]="Group",e[e.Link=3]="Link",e[e.Email=4]="Email",e[e.Remote=6]="Remote",e[e.Team=7]="Team",e[e.Guest=8]="Guest",e[e.RemoteGroup=9]="RemoteGroup",e[e.Room=10]="Room",e[e.Deck=12]="Deck",e[e.FederatedGroup=14]="FederatedGroup",e[e.ScienceMesh=15]="ScienceMesh",e))(R||{}),ne={exports:{}},se;function Pt(){return se||(se=1,function(e){var i=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function n(l,o,u){this.fn=l,this.context=o,this.once=u||!1}function s(l,o,u,p,f){if(typeof u!="function")throw new TypeError("The listener must be a function");var h=new n(u,p||l,f),g=t?t+o:o;return l._events[g]?l._events[g].fn?l._events[g]=[l._events[g],h]:l._events[g].push(h):(l._events[g]=h,l._eventsCount++),l}function a(l,o){--l._eventsCount===0?l._events=new r:delete l._events[o]}function c(){this._events=new r,this._eventsCount=0}c.prototype.eventNames=function(){var l=[],o,u;if(this._eventsCount===0)return l;for(u in o=this._events)i.call(o,u)&&l.push(t?u.slice(1):u);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(o)):l},c.prototype.listeners=function(l){var o=t?t+l:l,u=this._events[o];if(!u)return[];if(u.fn)return[u.fn];for(var p=0,f=u.length,h=new Array(f);p<f;p++)h[p]=u[p].fn;return h},c.prototype.listenerCount=function(l){var o=t?t+l:l,u=this._events[o];return u?u.fn?1:u.length:0},c.prototype.emit=function(l,o,u,p,f,h){var g=t?t+l:l;if(!this._events[g])return!1;var d=this._events[g],w=arguments.length,N,v;if(d.fn){switch(d.once&&this.removeListener(l,d.fn,void 0,!0),w){case 1:return d.fn.call(d.context),!0;case 2:return d.fn.call(d.context,o),!0;case 3:return d.fn.call(d.context,o,u),!0;case 4:return d.fn.call(d.context,o,u,p),!0;case 5:return d.fn.call(d.context,o,u,p,f),!0;case 6:return d.fn.call(d.context,o,u,p,f,h),!0}for(v=1,N=new Array(w-1);v<w;v++)N[v-1]=arguments[v];d.fn.apply(d.context,N)}else{var F=d.length,_;for(v=0;v<F;v++)switch(d[v].once&&this.removeListener(l,d[v].fn,void 0,!0),w){case 1:d[v].fn.call(d[v].context);break;case 2:d[v].fn.call(d[v].context,o);break;case 3:d[v].fn.call(d[v].context,o,u);break;case 4:d[v].fn.call(d[v].context,o,u,p);break;default:if(!N)for(_=1,N=new Array(w-1);_<w;_++)N[_-1]=arguments[_];d[v].fn.apply(d[v].context,N)}}return!0},c.prototype.on=function(l,o,u){return s(this,l,o,u,!1)},c.prototype.once=function(l,o,u){return s(this,l,o,u,!0)},c.prototype.removeListener=function(l,o,u,p){var f=t?t+l:l;if(!this._events[f])return this;if(!o)return a(this,f),this;var h=this._events[f];if(h.fn)h.fn===o&&(!p||h.once)&&(!u||h.context===u)&&a(this,f);else{for(var g=0,d=[],w=h.length;g<w;g++)(h[g].fn!==o||p&&!h[g].once||u&&h[g].context!==u)&&d.push(h[g]);d.length?this._events[f]=d.length===1?d[0]:d:a(this,f)}return this},c.prototype.removeAllListeners=function(l){var o;return l?(o=t?t+l:l,this._events[o]&&a(this,o)):(this._events=new r,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=t,c.EventEmitter=c,e.exports=c}(ne)),ne.exports}var zt=Pt();const At=je(zt);class we extends Error{constructor(i){super(i),this.name="TimeoutError"}}class $t extends Error{constructor(i){super(),this.name="AbortError",this.message=i}}const oe=e=>globalThis.DOMException===void 0?new $t(e):new DOMException(e),ae=e=>{const i=e.reason===void 0?oe("This operation was aborted."):e.reason;return i instanceof Error?i:oe(i)};function Dt(e,i){const{milliseconds:t,fallback:r,message:n,customTimers:s={setTimeout,clearTimeout}}=i;let a,c;const l=new Promise((o,u)=>{if(typeof t!="number"||Math.sign(t)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${t}\``);if(i.signal){const{signal:f}=i;f.aborted&&u(ae(f)),c=()=>{u(ae(f))},f.addEventListener("abort",c,{once:!0})}if(t===Number.POSITIVE_INFINITY){e.then(o,u);return}const p=new we;a=s.setTimeout.call(void 0,()=>{if(r){try{o(r())}catch(f){u(f)}return}typeof e.cancel=="function"&&e.cancel(),n===!1?o():n instanceof Error?u(n):(p.message=n??`Promise timed out after ${t} milliseconds`,u(p))},t),(async()=>{try{o(await e)}catch(f){u(f)}})()}).finally(()=>{l.clear(),c&&i.signal&&i.signal.removeEventListener("abort",c)});return l.clear=()=>{s.clearTimeout.call(void 0,a),a=void 0},l}function Et(e,i,t){let r=0,n=e.length;for(;n>0;){const s=Math.trunc(n/2);let a=r+s;t(e[a],i)<=0?(r=++a,n-=s+1):n=s}return r}class Mt{#e=[];enqueue(i,t){t={priority:0,...t};const r={priority:t.priority,id:t.id,run:i};if(this.size===0||this.#e[this.size-1].priority>=t.priority){this.#e.push(r);return}const n=Et(this.#e,r,(s,a)=>a.priority-s.priority);this.#e.splice(n,0,r)}setPriority(i,t){const r=this.#e.findIndex(s=>s.id===i);if(r===-1)throw new ReferenceError(`No promise function with the id "${i}" exists in the queue.`);const[n]=this.#e.splice(r,1);this.enqueue(n.run,{priority:t,id:i})}dequeue(){return this.#e.shift()?.run}filter(i){return this.#e.filter(t=>t.priority===i.priority).map(t=>t.run)}get size(){return this.#e.length}}class Ot extends At{#e;#o;#s=0;#f;#a;#h=0;#i;#l;#t;#m;#r=0;#c;#n;#v;#_=1n;timeout;constructor(i){if(super(),i={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:Mt,...i},!(typeof i.intervalCap=="number"&&i.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${i.intervalCap?.toString()??""}\` (${typeof i.intervalCap})`);if(i.interval===void 0||!(Number.isFinite(i.interval)&&i.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${i.interval?.toString()??""}\` (${typeof i.interval})`);this.#e=i.carryoverConcurrencyCount,this.#o=i.intervalCap===Number.POSITIVE_INFINITY||i.interval===0,this.#f=i.intervalCap,this.#a=i.interval,this.#t=new i.queueClass,this.#m=i.queueClass,this.concurrency=i.concurrency,this.timeout=i.timeout,this.#v=i.throwOnTimeout===!0,this.#n=i.autoStart===!1}get#b(){return this.#o||this.#s<this.#f}get#w(){return this.#r<this.#c}#C(){this.#r--,this.#u(),this.emit("next")}#k(){this.#y(),this.#g(),this.#l=void 0}get#x(){const i=Date.now();if(this.#i===void 0){const t=this.#h-i;if(t<0)this.#s=this.#e?this.#r:0;else return this.#l===void 0&&(this.#l=setTimeout(()=>{this.#k()},t)),!0}return!1}#u(){if(this.#t.size===0)return this.#i&&clearInterval(this.#i),this.#i=void 0,this.emit("empty"),this.#r===0&&this.emit("idle"),!1;if(!this.#n){const i=!this.#x;if(this.#b&&this.#w){const t=this.#t.dequeue();return t?(this.emit("active"),t(),i&&this.#g(),!0):!1}}return!1}#g(){this.#o||this.#i!==void 0||(this.#i=setInterval(()=>{this.#y()},this.#a),this.#h=Date.now()+this.#a)}#y(){this.#s===0&&this.#r===0&&this.#i&&(clearInterval(this.#i),this.#i=void 0),this.#s=this.#e?this.#r:0,this.#d()}#d(){for(;this.#u(););}get concurrency(){return this.#c}set concurrency(i){if(!(typeof i=="number"&&i>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${i}\` (${typeof i})`);this.#c=i,this.#d()}async#S(i){return new Promise((t,r)=>{i.addEventListener("abort",()=>{r(i.reason)},{once:!0})})}setPriority(i,t){this.#t.setPriority(i,t)}async add(i,t={}){return t.id??=(this.#_++).toString(),t={timeout:this.timeout,throwOnTimeout:this.#v,...t},new Promise((r,n)=>{this.#t.enqueue(async()=>{this.#r++,this.#s++;try{t.signal?.throwIfAborted();let s=i({signal:t.signal});t.timeout&&(s=Dt(Promise.resolve(s),{milliseconds:t.timeout})),t.signal&&(s=Promise.race([s,this.#S(t.signal)]));const a=await s;r(a),this.emit("completed",a)}catch(s){if(s instanceof we&&!t.throwOnTimeout){r();return}n(s),this.emit("error",s)}finally{this.#C()}},t),this.emit("add"),this.#u()})}async addAll(i,t){return Promise.all(i.map(async r=>this.add(r,t)))}start(){return this.#n?(this.#n=!1,this.#d(),this):this}pause(){this.#n=!0}clear(){this.#t=new this.#m}async onEmpty(){this.#t.size!==0&&await this.#p("empty")}async onSizeLessThan(i){this.#t.size<i||await this.#p("next",()=>this.#t.size<i)}async onIdle(){this.#r===0&&this.#t.size===0||await this.#p("idle")}async#p(i,t){return new Promise(r=>{const n=()=>{t&&!t()||(this.off(i,n),r())};this.on(i,n)})}get size(){return this.#t.size}sizeBy(i){return this.#t.filter(i).length}get pending(){return this.#r}get isPaused(){return this.#n}}const Tt={name:"FileIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Rt=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon file-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M13,9V3.5L18.5,9M6,2C4.89,2 4,2.89 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2H6Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},jt=[],Wt=S(Tt,Rt,jt,!1,null,null);const Ce=Wt.exports,ke=()=>{const e=he("files","config",null),i=b(e?.show_hidden??!0),t=b(e?.sort_favorites_first??!0),r=b(e?.crop_image_previews??!0);return z(async()=>{if(ue())console.debug("Skip loading files settings - currently on public share");else try{const{data:n}=await de.get(U("/apps/files/api/v1/configs"));i.value=n?.data?.show_hidden??!1,t.value=n?.data?.sort_favorites_first??!0,r.value=n?.data?.crop_image_previews??!0}catch(n){console.error("Could not load files settings",n),j(k("Could not load files settings"))}}),{showHiddenFiles:i,sortFavoritesFirst:t,cropImagePreviews:r}},Zt=e=>{const i=o=>o==="asc"?"ascending":o==="desc"?"descending":"none",t=he("files","viewConfigs",null),r=b({sortBy:t?.files?.sorting_mode??"basename",order:i(t?.files?.sorting_direction??"asc")}),n=b({sortBy:t?.recent?.sorting_mode??"basename",order:i(t?.recent?.sorting_direction??"asc")}),s=b({sortBy:t?.favorites?.sorting_mode??"basename",order:i(t?.favorites?.sorting_direction??"asc")});z(async()=>{if(ue())console.debug("Skip loading files views - currently on public share");else try{const{data:o}=await de.get(U("/apps/files/api/v1/views"));r.value={sortBy:o?.data?.files?.sorting_mode??"basename",order:i(o?.data?.files?.sorting_direction)},s.value={sortBy:o?.data?.favorites?.sorting_mode??"basename",order:i(o?.data?.favorites?.sorting_direction)},n.value={sortBy:o?.data?.recent?.sorting_mode??"basename",order:i(o?.data?.recent?.sorting_direction)}}catch(o){console.error("Could not load files views",o),j(k("Could not load files views"))}});const a=y(()=>V(e||"files")==="files"?r.value:V(e)==="recent"?n.value:s.value),c=y(()=>a.value.sortBy),l=y(()=>a.value.order);return{filesViewConfig:r,favoritesViewConfig:s,recentViewConfig:n,currentConfig:a,sortBy:c,order:l}},qt={name:"MenuUpIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Ut=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon menu-up-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M7,15L12,10L17,15H7Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Gt=[],Yt=S(qt,Ut,Gt,!1,null,null);const Kt=Yt.exports,Jt={name:"MenuDownIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Qt=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon menu-down-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M7,10L12,15L17,10H7Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Xt=[],ei=S(Jt,Qt,Xt,!1,null,null);const ti=ei.exports,xe={"file-picker__file-icon":"_file-picker__file-icon_3v9zx_9","file-picker__file-icon--primary":"_file-picker__file-icon--primary_3v9zx_21","file-picker__file-icon-overlay":"_file-picker__file-icon-overlay_3v9zx_25"},ii=I({__name:"LoadingTableRow",props:{showCheckbox:{type:Boolean}},setup(e){return{__sfc:!0,fileListIconStyles:xe}}});var ri=function(){var e=this,i=e._self._c,t=e._self._setupProxy;return i("tr",{staticClass:"file-picker__row loading-row",attrs:{"aria-hidden":"true"}},[e.showCheckbox?i("td",{staticClass:"row-checkbox"},[i("span")]):e._e(),i("td",{staticClass:"row-name"},[i("div",{staticClass:"row-wrapper"},[i("span",{class:t.fileListIconStyles["file-picker__file-icon"]}),i("span")])]),e._m(0),e._m(1)])},ni=[function(){var e=this,i=e._self._c;return e._self._setupProxy,i("td",{staticClass:"row-size"},[i("span")])},function(){var e=this,i=e._self._c;return e._self._setupProxy,i("td",{staticClass:"row-modified"},[i("span")])}],si=S(ii,ri,ni,!1,null,"15187afc");const oi=si.exports,ai=new Ot({concurrency:5});function li(e){const{resolve:i,promise:t}=Promise.withResolvers();return ai.add(()=>{const r=new Image;return r.onerror=()=>i(!1),r.onload=()=>i(!0),r.src=e,t}),t}function ci(e,i={}){i={size:32,cropPreview:!1,mimeFallback:!0,...i};try{const t=e.attributes?.previewUrl||U("/core/preview?fileId={fileid}",{fileid:e.fileid});let r;try{r=new URL(t)}catch{r=new URL(t,window.location.origin)}return r.searchParams.set("x",`${i.size}`),r.searchParams.set("y",`${i.size}`),r.searchParams.set("mimeFallback",`${i.mimeFallback}`),r.searchParams.set("a",i.cropPreview===!0?"0":"1"),r.searchParams.set("c",`${e.attributes.etag}`),r}catch{return null}}const ui=(e,i)=>{const t=b(null),r=b(!1);return Ie(()=>{r.value=!1,t.value=ci(V(e),V(i||{})),t.value&&V(e).type===B.File&&li(t.value.href).then(n=>{r.value=n})}),{previewURL:t,previewLoaded:r}},di={name:"FolderIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var pi=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon folder-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},fi=[],hi=S(di,pi,fi,!1,null,null);const Se=hi.exports,mi={name:"FilePreview"},vi=I({...mi,props:{node:null,cropImagePreviews:{type:Boolean}},setup(e){const i=e,t=b(xe),{previewURL:r,previewLoaded:n}=ui(ce(i,"node"),y(()=>({cropPreview:i.cropImagePreviews}))),s=y(()=>i.node.type===B.File),a=y(()=>{if(i.node.type!==B.Folder)return null;if(i.node.attributes?.["is-encrypted"]===1)return It;if(i.node.attributes?.["is-tag"])return Ht;const c=Object.values(i.node.attributes?.["share-types"]||{}).flat();if(c.some(l=>l===R.Link||l===R.Email))return Lt;if(c.length>0)return re;switch(i.node.attributes?.["mount-type"]){case"external":case"external-session":return Vt;case"group":return Ft;case"shared":return re}return null});return{__sfc:!0,fileListIconStyles:t,props:i,previewURL:r,previewLoaded:n,isFile:s,folderDecorationIcon:a,NcIconSvgWrapper:pe,IconFile:Ce,IconFolder:Se}}});var gi=function(){var e=this,i=e._self._c,t=e._self._setupProxy;return i("div",{class:t.fileListIconStyles["file-picker__file-icon"],style:t.previewLoaded?{backgroundImage:`url(${t.previewURL})`}:void 0},[t.previewLoaded?e._e():[t.isFile?i(t.IconFile,{attrs:{size:32}}):[t.folderDecorationIcon?i(t.NcIconSvgWrapper,{class:t.fileListIconStyles["file-picker__file-icon-overlay"],attrs:{inline:"",path:t.folderDecorationIcon,size:16}}):e._e(),i(t.IconFolder,{class:t.fileListIconStyles["file-picker__file-icon--primary"],attrs:{size:32}})]]],2)},yi=[],_i=S(vi,gi,yi,!1,null,null);const bi=_i.exports,wi=I({__name:"FileListRow",props:{allowPickDirectory:{type:Boolean},selected:{type:Boolean},showCheckbox:{type:Boolean},canPick:{type:Boolean},node:null,cropImagePreviews:{type:Boolean}},emits:["update:selected","enter-directory"],setup(e,{emit:i}){const t=e,r=y(()=>t.node.attributes?.displayName||t.node.basename.slice(0,t.node.extension?-t.node.extension.length:void 0)),n=y(()=>t.node.extension),s=y(()=>t.node.type===B.Folder),a=y(()=>t.canPick&&(t.allowPickDirectory||!s.value));function c(){i("update:selected",!t.selected)}function l(){s.value?i("enter-directory",t.node):c()}function o(u){u.key==="Enter"&&l()}return{__sfc:!0,props:t,emit:i,displayName:r,fileExtension:n,isDirectory:s,isPickable:a,toggleSelected:c,handleClick:l,handleKeyDown:o,formatFileSize:Be,NcCheckboxRadioSwitch:fe,NcDateTime:Re,t:k,FilePreview:bi}}});var Ci=function(){var e=this,i=e._self._c,t=e._self._setupProxy;return i("tr",e._g({class:["file-picker__row",{"file-picker__row--selected":e.selected&&!e.showCheckbox}],attrs:{tabindex:e.showCheckbox&&!t.isDirectory?void 0:0,"aria-selected":t.isPickable?e.selected:void 0,"data-filename":e.node.basename,"data-testid":"file-list-row"}},{click:t.handleClick,...!e.showCheckbox||t.isDirectory?{keydown:t.handleKeyDown}:{}}),[e.showCheckbox?i("td",{staticClass:"row-checkbox",on:{click:function(r){return r.stopPropagation(),(()=>{}).apply(null,arguments)}}},[i(t.NcCheckboxRadioSwitch,{attrs:{"aria-label":t.t("Select the row for {nodename}",{nodename:t.displayName}),disabled:!t.isPickable,"data-testid":"row-checkbox","model-value":e.selected},on:{"update:model-value":t.toggleSelected}})],1):e._e(),i("td",{staticClass:"row-name"},[i("div",{staticClass:"file-picker__name-container",attrs:{"data-testid":"row-name"}},[i(t.FilePreview,{attrs:{node:e.node,"crop-image-previews":e.cropImagePreviews}}),i("div",{staticClass:"file-picker__file-name",attrs:{title:t.displayName},domProps:{textContent:e._s(t.displayName)}}),i("div",{staticClass:"file-picker__file-extension",domProps:{textContent:e._s(t.fileExtension)}})],1)]),i("td",{staticClass:"row-size"},[e._v(" "+e._s(t.formatFileSize(e.node.size||0))+" ")]),i("td",{staticClass:"row-modified"},[i(t.NcDateTime,{attrs:{timestamp:e.node.mtime,"ignore-seconds":!0}})],1)])},ki=[],xi=S(wi,Ci,ki,!1,null,"4892c2a0");const Si=xi.exports,Ni=I({__name:"FileList",props:{currentView:null,multiselect:{type:Boolean},allowPickDirectory:{type:Boolean},loading:{type:Boolean},files:null,selectedFiles:null,path:null},emits:["update:path","update:selectedFiles"],setup(e,{emit:i}){const t=e,r=b(),{currentConfig:n}=Zt(t.currentView),s=y(()=>r.value??n.value),a=y(()=>s.value.sortBy==="basename"?s.value.order==="none"?void 0:s.value.order:void 0),c=y(()=>s.value.sortBy==="size"?s.value.order==="none"?void 0:s.value.order:void 0),l=y(()=>s.value.sortBy==="mtime"?s.value.order==="none"?void 0:s.value.order:void 0),o=_=>{s.value.sortBy===_?s.value.order==="ascending"?r.value={sortBy:s.value.sortBy,order:"descending"}:r.value={sortBy:s.value.sortBy,order:"ascending"}:r.value={sortBy:_,order:"ascending"}},{sortFavoritesFirst:u,cropImagePreviews:p}=ke(),f=y(()=>Ve(t.files,{sortFoldersFirst:!0,sortFavoritesFirst:u.value,sortingOrder:s.value.order==="descending"?"desc":"asc",sortingMode:s.value.sortBy})),h=y(()=>t.files.filter(_=>t.allowPickDirectory||_.type!==B.Folder)),g=y(()=>!t.loading&&t.selectedFiles.length>0&&t.selectedFiles.length>=h.value.length);function d(){t.selectedFiles.length<h.value.length?i("update:selectedFiles",h.value):i("update:selectedFiles",[])}function w(_){t.selectedFiles.includes(_)?i("update:selectedFiles",t.selectedFiles.filter(L=>L.path!==_.path)):t.multiselect?i("update:selectedFiles",[...t.selectedFiles,_]):i("update:selectedFiles",[_])}function N(_){i("update:path",_.path)}const v=b(4),F=b();{const _=()=>Fe(()=>{const L=F.value?.parentElement?.children||[];let A=F.value?.parentElement?.clientHeight||450;for(let m=0;m<L.length;m++)F.value?.isSameNode(L[m])||(A-=L[m].clientHeight);v.value=Math.max(1,Math.floor((A-50)/50))});z(()=>{window.addEventListener("resize",_),_()}),Le(()=>{window.removeEventListener("resize",_)})}return{__sfc:!0,props:t,emit:i,customSortingConfig:r,filesAppSorting:n,sortingConfig:s,sortByName:a,sortBySize:c,sortByModified:l,toggleSorting:o,sortFavoritesFirst:u,cropImagePreviews:p,sortedFiles:f,selectableFiles:h,allSelected:g,onSelectAll:d,onNodeSelected:w,onChangeDirectory:N,skeletonNumber:v,fileContainer:F,NcButton:Z,NcCheckboxRadioSwitch:fe,t:k,IconSortAscending:Kt,IconSortDescending:ti,LoadingTableRow:oi,FileListRow:Si}}});var Fi=function(){var e=this,i=e._self._c,t=e._self._setupProxy;return i("div",{ref:"fileContainer",staticClass:"file-picker__files"},[i("table",[i("thead",[i("tr",[e.multiselect?i("th",{staticClass:"row-checkbox"},[i("span",{staticClass:"hidden-visually"},[e._v(" "+e._s(t.t("Select entry"))+" ")]),e.multiselect?i(t.NcCheckboxRadioSwitch,{attrs:{"aria-label":t.t("Select all entries"),"data-testid":"select-all-checkbox","model-value":t.allSelected},on:{"update:model-value":t.onSelectAll}}):e._e()],1):e._e(),i("th",{staticClass:"row-name",attrs:{"aria-sort":t.sortByName}},[i("div",{staticClass:"header-wrapper"},[i("span",{staticClass:"file-picker__header-preview"}),i(t.NcButton,{attrs:{wide:!0,type:"tertiary","data-test":"file-picker_sort-name"},on:{click:function(r){return t.toggleSorting("basename")}},scopedSlots:e._u([{key:"icon",fn:function(){return[t.sortByName==="ascending"?i(t.IconSortAscending,{attrs:{size:20}}):t.sortByName==="descending"?i(t.IconSortDescending,{attrs:{size:20}}):i("span",{staticStyle:{width:"44px"}})]},proxy:!0}])},[e._v(" "+e._s(t.t("Name"))+" ")])],1)]),i("th",{staticClass:"row-size",attrs:{"aria-sort":t.sortBySize}},[i(t.NcButton,{attrs:{wide:!0,type:"tertiary"},on:{click:function(r){return t.toggleSorting("size")}},scopedSlots:e._u([{key:"icon",fn:function(){return[t.sortBySize==="ascending"?i(t.IconSortAscending,{attrs:{size:20}}):t.sortBySize==="descending"?i(t.IconSortDescending,{attrs:{size:20}}):i("span",{staticStyle:{width:"44px"}})]},proxy:!0}])},[e._v(" "+e._s(t.t("Size"))+" ")])],1),i("th",{staticClass:"row-modified",attrs:{"aria-sort":t.sortByModified}},[i(t.NcButton,{attrs:{wide:!0,type:"tertiary"},on:{click:function(r){return t.toggleSorting("mtime")}},scopedSlots:e._u([{key:"icon",fn:function(){return[t.sortByModified==="ascending"?i(t.IconSortAscending,{attrs:{size:20}}):t.sortByModified==="descending"?i(t.IconSortDescending,{attrs:{size:20}}):i("span",{staticStyle:{width:"44px"}})]},proxy:!0}])},[e._v(" "+e._s(t.t("Modified"))+" ")])],1)])]),i("tbody",[e.loading?e._l(t.skeletonNumber,function(r){return i(t.LoadingTableRow,{key:r,attrs:{"show-checkbox":e.multiselect}})}):e._l(t.sortedFiles,function(r){return i(t.FileListRow,{key:r.fileid||r.path,attrs:{"allow-pick-directory":e.allowPickDirectory,"show-checkbox":e.multiselect,"can-pick":e.multiselect||e.selectedFiles.length===0||e.selectedFiles.includes(r),selected:e.selectedFiles.includes(r),node:r,"crop-image-previews":t.cropImagePreviews},on:{"update:selected":function(n){return t.onNodeSelected(r)},"enter-directory":t.onChangeDirectory}})})],2)])])},Li=[],Ii=S(Ni,Fi,Li,!1,null,"4f5d2a56");const Vi=Ii.exports,Bi={name:"HomeIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Hi=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon home-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Pi=[],zi=S(Bi,Hi,Pi,!1,null,null);const Ai=zi.exports,$i={name:"PlusIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Di=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon plus-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Ei=[],Mi=S($i,Di,Ei,!1,null,null);const Oi=Mi.exports,Ti=I({__name:"FilePickerBreadcrumbs",props:{path:null,showMenu:{type:Boolean}},emits:["update:path","create-node"],setup(e,{emit:i}){const t=e,r=b(!1),n=b(""),s=b();function a(){const o=n.value.trim(),u=s.value?.$el?.querySelector("input");let p="";return o.length===0?p=k("Folder name cannot be empty."):o.includes("/")?p=k('"/" is not allowed inside a folder name.'):["..","."].includes(o)?p=k('"{name}" is an invalid folder name.',{name:o}):window.OC.config?.blacklist_files_regex&&o.match(window.OC.config?.blacklist_files_regex)&&(p=k('"{name}" is not an allowed folder name',{name:o})),u&&u.setCustomValidity(p),p===""}const c=function(){const o=n.value.trim();a()&&(r.value=!1,i("create-node",o),n.value="")},l=y(()=>t.path.split("/").filter(o=>o!=="").map((o,u,p)=>({name:o,path:"/"+p.slice(0,u+1).join("/")})));return{__sfc:!0,props:t,emit:i,actionsOpen:r,newNodeName:n,nameInput:s,validateInput:a,onSubmit:c,pathElements:l,IconFolder:Se,IconHome:Ai,IconPlus:Oi,NcActions:q,NcActionInput:Te,NcBreadcrumbs:xt,NcBreadcrumb:ge,t:k}}});var Ri=function(){var e=this,i=e._self._c,t=e._self._setupProxy;return i(t.NcBreadcrumbs,{staticClass:"file-picker__breadcrumbs",scopedSlots:e._u([{key:"default",fn:function(){return[i(t.NcBreadcrumb,{attrs:{name:t.t("All files"),title:t.t("Home")},on:{click:function(r){return t.emit("update:path","/")}},scopedSlots:e._u([{key:"icon",fn:function(){return[i(t.IconHome,{attrs:{size:20}})]},proxy:!0}])}),e._l(t.pathElements,function(r){return i(t.NcBreadcrumb,{key:r.path,attrs:{name:r.name,title:r.path},on:{click:function(n){return t.emit("update:path",r.path)}}})})]},proxy:!0},e.showMenu?{key:"actions",fn:function(){return[i(t.NcActions,{attrs:{open:t.actionsOpen,"aria-label":t.t("Create directory"),"force-menu":!0,"force-name":!0,"menu-name":t.t("New"),type:"secondary"},on:{"update:open":function(r){t.actionsOpen=r},close:function(r){t.newNodeName=""}},scopedSlots:e._u([{key:"icon",fn:function(){return[i(t.IconPlus,{attrs:{size:20}})]},proxy:!0}],null,!1,2971667417)},[i(t.NcActionInput,{ref:"nameInput",attrs:{value:t.newNodeName,label:t.t("New folder"),placeholder:t.t("New folder name")},on:{"update:value":function(r){t.newNodeName=r},submit:t.onSubmit,"update:model-value":t.validateInput},scopedSlots:e._u([{key:"icon",fn:function(){return[i(t.IconFolder,{attrs:{size:20}})]},proxy:!0}],null,!1,1614167509)})],1)]},proxy:!0}:null],null,!0)})},ji=[],Wi=S(Ti,Ri,ji,!1,null,"ec4d392b");const Zi=Wi.exports,qi={name:"CloseIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Ui=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon close-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Gi=[],Yi=S(qi,Ui,Gi,!1,null,null);const Ki=Yi.exports,Ji={name:"MagnifyIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Qi=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon magnify-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Xi=[],er=S(Ji,Qi,Xi,!1,null,null);const tr=er.exports,ir=e=>{const i=[{id:"files",label:k("All files"),icon:Nt},{id:"recent",label:k("Recent"),icon:St},{id:"favorites",label:k("Favorites"),icon:Bt}],t=e.value?i.filter(({id:r})=>r==="files"):i;return{allViews:i,availableViews:t}},rr=I({__name:"FilePickerNavigation",props:{currentView:null,filterString:null,isCollapsed:{type:Boolean},disabledNavigation:{type:Boolean}},emits:["update:currentView","update:filterString"],setup(e,{emit:i}){const t=e,{availableViews:r}=ir(b(Ue()===null)),n=y(()=>r.filter(s=>s.id===t.currentView)[0]??r[0]);return{__sfc:!0,props:t,emit:i,availableViews:r,currentViewObject:n,updateFilterValue:s=>i("update:filterString",s),IconClose:Ki,IconMagnify:tr,NcButton:Z,NcIconSvgWrapper:pe,NcSelect:Oe,NcTextField:Me,Fragment:be,t:k}}});var nr=function(){var e=this,i=e._self._c,t=e._self._setupProxy;return i(t.Fragment,[i(t.NcTextField,{staticClass:"file-picker__filter-input",attrs:{label:t.t("Filter file list"),"show-trailing-button":!!e.filterString,"model-value":e.filterString},on:{"update:model-value":t.updateFilterValue,"trailing-button-click":function(r){return t.updateFilterValue("")}},scopedSlots:e._u([{key:"trailing-button-icon",fn:function(){return[i(t.IconClose,{attrs:{size:16}})]},proxy:!0}])},[i(t.IconMagnify,{attrs:{size:16}})],1),t.availableViews.length>1&&!e.disabledNavigation?[e.isCollapsed?i(t.NcSelect,{attrs:{"aria-label":t.t("Current view selector"),clearable:!1,searchable:!1,options:t.availableViews,"model-value":t.currentViewObject},on:{"update:model-value":function(r){return t.emit("update:currentView",r.id)}}}):i("ul",{staticClass:"file-picker__side"},e._l(t.availableViews,function(r){return i("li",{key:r.id},[i(t.NcButton,{attrs:{type:e.currentView===r.id?"primary":"tertiary",wide:!0},on:{click:function(n){return e.$emit("update:currentView",r.id)}},scopedSlots:e._u([{key:"icon",fn:function(){return[i(t.NcIconSvgWrapper,{attrs:{path:r.icon,size:20}})]},proxy:!0}],null,!0)},[e._v(" "+e._s(r.label)+" ")])],1)}),0)]:e._e()],2)},sr=[],or=S(rr,nr,sr,!1,null,"f5975252");const ar=or.exports;function lr(e){const i=new AbortController,t=Math.round(Date.now()/1e3)-60*60*24*14;return new me(async(r,n,s)=>{s(()=>i.abort());try{const{data:a}=await e.search("/",{signal:i.signal,details:!0,data:Je(t)}),c=a.results.map(l=>Y(l));r(c)}catch(a){n(a)}})}function cr(e,i){const t=new AbortController;return new me(async(r,n,s)=>{s(()=>t.abort());try{const a=(await e.getDirectoryContents(E.join(G,i),{signal:t.signal,details:!0,includeSelf:!0,data:ve()})).data.map(c=>Y(c));r({contents:a.filter(({path:c})=>c!==i),folder:a.find(({path:c})=>c===i)})}catch(a){n(a)}})}async function ur(e,i){const{data:t}=await e.stat(E.join(G,i),{details:!0,data:ve()});return Y(t)}const dr=function(e,i){const t=Ye(),r=T([]),n=T(null),s=b(!0),a=b(null);async function c(o){const u=E.join(i.value,o);await t.createDirectory(E.join(G,u));const p=await ur(t,u);return r.value=[...r.value,p],p}async function l(){a.value&&a.value.cancel(),s.value=!0,e.value==="favorites"?a.value=Ke(t,i.value):e.value==="recent"?a.value=lr(t):a.value=cr(t,i.value);const o=await a.value;"folder"in o?(n.value=o.folder,r.value=o.contents):(n.value=null,r.value=o),a.value=null,s.value=!1}return le([e,i],()=>l()),z(()=>l()),{isLoading:s,files:r,folder:n,loadFiles:l,createDirectory:c}},pr=function(e){const i=y(()=>e.value.map(t=>t.split("/")));return{isSupportedMimeType:t=>{const r=t.split("/");return i.value.some(([n,s])=>(r[0]===n||n==="*")&&(r[1]===s||s==="*"))}}},fr={name:"FilePicker"},hr=I({...fr,props:{buttons:null,name:null,allowPickDirectory:{type:Boolean,default:!1},disabledNavigation:{type:Boolean,default:!1},container:{default:"body"},filterFn:{default:void 0},mimetypeFilter:{default:()=>[]},multiselect:{type:Boolean,default:!0},path:{default:void 0}},emits:["close"],setup(e,{emit:i}){const t=e,r=b(!0),n=y(()=>{const m=o.value.length===0&&t.allowPickDirectory&&w.value?[w.value]:o.value;return(typeof t.buttons=="function"?t.buttons(m,f.value,c.value):t.buttons).map(C=>({...C,disabled:C.disabled||N.value,callback:()=>{s=!0,a(C.callback,m)}}))});let s=!1;const a=async(m,C)=>{m(C),i("close",C),s=!1},c=b("files"),l=y(()=>c.value==="favorites"?k("Favorites"):c.value==="recent"?k("Recent"):""),o=T([]),u=b(window?.sessionStorage.getItem("NC.FilePicker.LastPath")||"/"),p=b("");le([p],()=>{t.path===void 0&&p.value&&window.sessionStorage.setItem("NC.FilePicker.LastPath",p.value),o.value=[]});const f=y({get:()=>c.value==="files"?p.value||t.path||u.value:"/",set:m=>{p.value=m}}),h=b(""),{isSupportedMimeType:g}=pr(ce(t,"mimetypeFilter")),{files:d,folder:w,isLoading:N,loadFiles:v,createDirectory:F}=dr(c,f);z(()=>v());const{showHiddenFiles:_}=ke(),L=y(()=>{let m=d.value;return _.value||(m=m.filter(C=>!C.basename.startsWith("."))),t.mimetypeFilter.length>0&&(m=m.filter(C=>C.type==="folder"||C.mime&&g(C.mime))),h.value&&(m=m.filter(C=>C.basename.toLowerCase().includes(h.value.toLowerCase()))),t.filterFn&&(m=m.filter(C=>t.filterFn(C))),m}),A=y(()=>c.value==="files"?k("Upload some content or sync with your devices!"):c.value==="recent"?k("Files and folders you recently modified will show up here."):k("Files and folders you mark as favorite will show up here."));return{__sfc:!0,props:t,emit:i,isOpen:r,dialogButtons:n,isHandlingCallback:s,handleButtonClick:a,currentView:c,viewHeadline:l,selectedFiles:o,savedPath:u,navigatedPath:p,currentPath:f,filterString:h,isSupportedMimeType:g,files:d,currentFolder:w,isLoading:N,loadFiles:v,createDirectory:F,showHiddenFiles:_,filteredFiles:L,noFilesDescription:A,onCreateFolder:async m=>{try{const C=await F(m);p.value=C.path,qe("files:node:created",d.value.filter(Ne=>Ne.basename===m)[0])}catch(C){console.warn("Could not create new folder",{name:m,error:C}),j(k("Could not create the new folder"))}},handleClose:m=>{!m&&!s&&i("close")},IconFile:Ce,FileList:Vi,FilePickerBreadcrumbs:Zi,FilePickerNavigation:ar,NcDialog:Ge,NcEmptyContent:Ee,t:k}}});var mr=function(){var e=this,i=e._self._c,t=e._self._setupProxy;return i(t.NcDialog,{attrs:{open:t.isOpen,container:e.container,buttons:t.dialogButtons,name:e.name,size:"large","content-classes":"file-picker__content","dialog-classes":"file-picker","navigation-classes":"file-picker__navigation"},on:{"update:open":[function(r){t.isOpen=r},t.handleClose]},scopedSlots:e._u([{key:"navigation",fn:function({isCollapsed:r}){return[i(t.FilePickerNavigation,{attrs:{"current-view":t.currentView,"filter-string":t.filterString,"is-collapsed":r,"disabled-navigation":e.disabledNavigation},on:{"update:currentView":function(n){t.currentView=n},"update:current-view":function(n){t.currentView=n},"update:filterString":function(n){t.filterString=n},"update:filter-string":function(n){t.filterString=n}}})]}}])},[i("div",{staticClass:"file-picker__main"},[t.currentView==="files"?i(t.FilePickerBreadcrumbs,{attrs:{path:t.currentPath,"show-menu":e.allowPickDirectory},on:{"update:path":function(r){t.currentPath=r},"create-node":t.onCreateFolder}}):i("div",{staticClass:"file-picker__view"},[i("h3",[e._v(e._s(t.viewHeadline))])]),t.isLoading||t.filteredFiles.length>0?i(t.FileList,{attrs:{path:t.currentPath,"selected-files":t.selectedFiles,"allow-pick-directory":e.allowPickDirectory,"current-view":t.currentView,files:t.filteredFiles,multiselect:e.multiselect,loading:t.isLoading,name:t.viewHeadline},on:{"update:path":[function(r){t.currentPath=r},function(r){t.currentView="files"}],"update:selectedFiles":function(r){t.selectedFiles=r},"update:selected-files":function(r){t.selectedFiles=r}}}):t.filterString?i(t.NcEmptyContent,{attrs:{name:t.t("No matching files"),description:t.t("No files matching your filter were found.")},scopedSlots:e._u([{key:"icon",fn:function(){return[i(t.IconFile)]},proxy:!0}])}):i(t.NcEmptyContent,{attrs:{name:t.t("No files in here"),description:t.noFilesDescription},scopedSlots:e._u([{key:"icon",fn:function(){return[i(t.IconFile)]},proxy:!0}])})],1)])},vr=[],gr=S(hr,mr,vr,!1,null,"552cc2f5");const Lr=gr.exports;export{Lr as default};
//# sourceMappingURL=FilePicker-Bp973DaS-Ct_rMvyN.chunk.mjs.map
