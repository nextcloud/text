{"version":3,"file":"src_extensions_CollaborationCursor_js-src_extensions_FocusTrap_js-src_extensions_Keymap_js-sr-076c3e.js?v=3cf760c1438278452b52","mappings":"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","sources":["webpack:///text/src/components/Editor/Wrapper.provider.js","webpack://text/./src/components/Menu/ActionEntry.scss?c415","webpack:///text/src/components/Menu/BaseActionEntry.js","webpack:///text/src/components/Menu/MenuBar.provider.js","webpack:///text/src/components/Menu/EmojiPickerAction.vue","webpack:///text/src/components/Menu/EmojiPickerAction.vue?vue&type=script&lang=js","webpack://text/./src/components/Menu/EmojiPickerAction.vue?ec5c","webpack://text/./src/components/Menu/EmojiPickerAction.vue?b768","webpack://text/./src/components/Menu/ActionAttachmentUpload.vue?c12b","webpack:///text/src/components/Menu/ActionAttachmentUpload.vue","webpack:///text/src/components/Menu/ActionAttachmentUpload.vue?vue&type=script&lang=js","webpack://text/./src/components/Menu/ActionAttachmentUpload.vue?3a53","webpack://text/./src/components/Menu/ActionInsertLink.vue?b231","webpack:///text/src/components/Menu/ActionInsertLink.vue","webpack:///text/src/components/Menu/ActionInsertLink.vue?vue&type=script&lang=js","webpack://text/./src/components/Menu/ActionInsertLink.vue?340a","webpack://text/./src/components/Menu/ActionInsertLink.vue?7891","webpack:///text/src/components/Menu/entries.js","webpack:///text/src/components/Menu/keys.js","webpack:///text/src/components/Menu/utils.js","webpack:///text/src/components/Suggestion/suggestions.js","webpack:///text/src/components/icons.js","webpack:///text/src/extensions/CollaborationCursor.js","webpack:///text/src/extensions/Emoji.js","webpack:///text/src/extensions/FocusTrap.js","webpack:///text/src/extensions/KeepSyntax.js","webpack:///text/src/extensions/Keymap.js","webpack:///text/src/extensions/transformPastedHTML.js","webpack:///text/src/extensions/Markdown.js","webpack:///text/src/extensions/Mention.vue","webpack:///text/src/extensions/Mention.vue?vue&type=script&lang=js","webpack://text/./src/extensions/Mention.vue?d8a7","webpack://text/./src/extensions/Mention.vue?f3fc","webpack://text/./src/extensions/Mention.vue?ec9d","webpack:///text/src/extensions/Mention.js","webpack:///text/src/nodes/PlainTextDocument.js","webpack:///text/src/extensions/PlainText.js","webpack:///text/src/nodes/BulletList.js","webpack:///text/src/commands/listInputRule.js","webpack:///text/src/nodes/Callout.vue","webpack:///text/src/nodes/Callout.vue?vue&type=script&lang=js","webpack://text/./src/nodes/Callout.vue?96dd","webpack://text/./src/nodes/Callout.vue?8e96","webpack://text/./src/nodes/Callout.vue?30d8","webpack:///text/src/nodes/Callouts.js","webpack:///text/src/mixins/CopyToClipboardMixin.js","webpack:///text/src/nodes/CodeBlockView.vue?vue&type=script&lang=js","webpack:///text/src/nodes/CodeBlockView.vue","webpack://text/./src/nodes/CodeBlockView.vue?4ea7","webpack://text/./src/nodes/CodeBlockView.vue?0dcc","webpack://text/./src/nodes/CodeBlockView.vue?efd6","webpack:///text/src/nodes/CodeBlock.js","webpack:///text/src/components/Suggestion/Emoji/EmojiList.vue","webpack:///text/src/components/Suggestion/Emoji/EmojiList.vue?vue&type=script&lang=js","webpack://text/./src/components/Suggestion/Emoji/EmojiList.vue?6dd4","webpack://text/./src/components/Suggestion/Emoji/EmojiList.vue?e850","webpack://text/./src/components/Suggestion/Emoji/EmojiList.vue?a16f","webpack:///text/src/nodes/FrontMatter.js","webpack:///text/src/nodes/HardBreak.js","webpack:///text/src/plugins/extractHeadings.js","webpack:///text/src/plugins/headingAnchor.js","webpack:///text/src/nodes/Heading.js","webpack:///text/src/components/ImageView/ShowImageModal.vue","webpack:///text/src/components/ImageView/ShowImageModal.vue?vue&type=script&lang=js","webpack://text/./src/components/ImageView/ShowImageModal.vue?be22","webpack://text/./src/components/ImageView/ShowImageModal.vue?7335","webpack://text/./src/components/ImageView/ShowImageModal.vue?6fbd","webpack:///text/src/nodes/ImageView.vue","webpack:///text/src/nodes/ImageView.vue?vue&type=script&lang=js","webpack://text/./src/nodes/ImageView.vue?81ae","webpack://text/./src/nodes/ImageView.vue?efcd","webpack://text/./src/nodes/ImageView.vue?969a","webpack:///text/src/nodes/Image.js","webpack:///text/src/nodes/ImageInline.js","webpack:///text/src/components/Suggestion/LinkPicker/LinkPickerList.vue","webpack:///text/src/components/Suggestion/LinkPicker/LinkPickerList.vue?vue&type=script&lang=js","webpack://text/./src/components/Suggestion/LinkPicker/LinkPickerList.vue?6201","webpack://text/./src/components/Suggestion/LinkPicker/LinkPickerList.vue?0ed6","webpack://text/./src/components/Suggestion/LinkPicker/LinkPickerList.vue?bf2d","webpack:///text/src/components/Suggestion/LinkPicker/suggestions.js","webpack:///text/src/extensions/LinkPicker.js","webpack:///text/src/helpers/links.js","webpack://text/./src/components/Link/LinkBubbleView.vue?4df3","webpack:///text/src/components/Link/LinkBubbleView.vue","webpack:///text/src/components/Link/LinkBubbleView.vue?vue&type=script&lang=js","webpack://text/./src/components/Link/LinkBubbleView.vue?ec6b","webpack://text/./src/components/Link/LinkBubbleView.vue?b205","webpack:///text/src/plugins/LinkBubblePluginView.js","webpack:///text/src/plugins/linkHelpers.js","webpack:///text/src/plugins/links.js","webpack:///text/src/extensions/LinkBubble.js","webpack:///text/src/plugins/extractLinkParagraphs.js","webpack:///text/src/components/Editor/PreviewOptions.vue","webpack:///text/src/components/Editor/PreviewOptions.vue?vue&type=script&lang=js","webpack://text/./src/components/Editor/PreviewOptions.vue?4510","webpack://text/./src/components/Editor/PreviewOptions.vue?3f2f","webpack://text/./src/components/Editor/PreviewOptions.vue?a0c2","webpack:///text/src/plugins/previewOptions.js","webpack:///text/src/nodes/Paragraph.js","webpack:///text/src/nodes/Preview.vue","webpack:///text/src/nodes/Preview.vue?vue&type=script&lang=js","webpack://text/./src/nodes/Preview.vue?dcd1","webpack://text/./src/nodes/Preview.vue?7921","webpack://text/./src/nodes/Preview.vue?2e3b","webpack:///text/src/nodes/Preview.js","webpack:///text/src/nodes/Table.js","webpack:///text/src/helpers/prosemirrorUtils.js","webpack:///text/src/nodes/TaskItem.js","webpack:///text/src/nodes/TaskList.js","webpack:///text/src/nodes/TrailingNode.js","webpack:///text/src/marks/Link.js","webpack:///text/src/marks/Strike.js","webpack:///text/src/marks/Strong.js","webpack:///text/src/marks/Underline.js","webpack:///text/src/marks/index.js","webpack:///text/src/extensions/RichText.js","webpack:///text/src/components/Suggestion/Emoji/suggestions.js","webpack:///text/src/extensions/tracking/models.js","webpack:///text/src/extensions/tracking/TrackState.js","webpack:///text/src/extensions/UserColor.js","webpack:///text/src/markdownit/callouts.js","webpack:///text/src/markdownit/splitMixedLists.js","webpack:///text/src/markdownit/preview.js","webpack:///text/src/markdownit/index.js","webpack:///text/src/markdownit/underline.js","webpack:///text/src/markdownit/hardbreak.js","webpack:///text/src/markdownit/keepSyntax.js","webpack:///text/src/mixins/store.js","webpack:///text/src/nodes/Table/TableView.vue","webpack:///text/src/nodes/Table/TableView.vue?vue&type=script&lang=js","webpack://text/./src/nodes/Table/TableView.vue?ea41","webpack://text/./src/nodes/Table/TableView.vue?5b22","webpack://text/./src/nodes/Table/TableView.vue?c31b","webpack:///text/src/nodes/Table/TableCellView.vue","webpack:///text/src/nodes/Table/TableCellView.vue?vue&type=script&lang=js","webpack://text/./src/nodes/Table/TableCellView.vue?544d","webpack://text/./src/nodes/Table/TableCellView.vue?bec9","webpack://text/./src/nodes/Table/TableCellView.vue?f05f","webpack:///text/src/nodes/Table/TableHeaderView.vue","webpack:///text/src/nodes/Table/TableHeaderView.vue?vue&type=script&lang=js","webpack://text/./src/nodes/Table/TableHeaderView.vue?59ce","webpack://text/./src/nodes/Table/TableHeaderView.vue?7377","webpack://text/./src/nodes/Table/TableHeaderView.vue?09cc","webpack:///text/src/nodes/EditableTable.js","webpack:///text/src/nodes/PlainTableDocument.js","webpack:///text/src/nodes/Table/Table.js","webpack:///text/src/nodes/Table/TableCaption.js","webpack:///text/src/nodes/Table/TableCell.js","webpack:///text/src/nodes/Table/TableHeadRow.js","webpack:///text/src/nodes/Table/TableHeader.js","webpack:///text/src/nodes/Table/TableRow.js","webpack:///text/src/components/Menu/ActionEntry.scss","webpack:///text/src/components/Editor/EditorOutline.vue?vue&type=style&index=0&id=2e01a79b&prod&lang=scss&scoped=true","webpack:///text/src/components/Editor/PreviewOptions.vue?vue&type=style&index=0&id=3eac6396&prod&lang=scss&scoped=true","webpack:///text/src/components/Editor/TableOfContents.vue?vue&type=style&index=0&id=2abb93ae&prod&lang=scss","webpack:///text/src/components/ImageView/ShowImageModal.vue?vue&type=style&index=0&id=403f8ff2&prod&scoped=true&lang=scss","webpack:///text/src/components/Link/LinkBubbleView.vue?vue&type=style&index=0&id=fb46e0ea&prod&lang=scss&scoped=true","webpack:///text/src/components/Suggestion/Emoji/EmojiList.vue?vue&type=style&index=0&id=74f9a54a&prod&scoped=true&lang=scss","webpack:///text/src/components/Suggestion/LinkPicker/LinkPickerList.vue?vue&type=style&index=0&id=11ad0ffc&prod&lang=scss&scoped=true","webpack:///text/src/components/Suggestion/SuggestionListWrapper.vue?vue&type=style&index=0&id=721c3a10&prod&scoped=true&lang=scss","webpack:///text/src/nodes/Callout.vue?vue&type=style&index=0&id=4387ae9f&prod&lang=scss&scoped=true","webpack:///text/src/nodes/CodeBlockView.vue?vue&type=style&index=0&id=3451a47c&prod&lang=scss&scoped=true","webpack:///text/src/nodes/ImageView.vue?vue&type=style&index=0&id=42761165&prod&scoped=true&lang=scss","webpack:///text/src/nodes/Preview.vue?vue&type=style&index=0&id=26ba0d31&prod&lang=scss&scoped=true","webpack:///text/src/nodes/Table/TableCellView.vue?vue&type=style&index=0&id=2f56cd8c&prod&scoped=true&lang=scss","webpack:///text/src/nodes/Table/TableHeaderView.vue?vue&type=style&index=0&id=a456a642&prod&scoped=true&lang=scss","webpack:///text/src/nodes/Table/TableView.vue?vue&type=style&index=0&id=048279dc&prod&scoped=true&lang=scss","webpack:///text/src/components/Menu/ActionInsertLink.vue?vue&type=style&index=0&id=a0f3b418&prod&scoped=true&lang=css","webpack:///text/src/extensions/Mention.vue?vue&type=style&index=0&id=297bb5fa&prod&scoped=true&lang=css","webpack://text/./src/components/Editor/EditorOutline.vue?ec9a","webpack:///text/src/components/Editor/TableOfContents.vue","webpack:///text/src/components/Editor/TableOfContents.vue?vue&type=script&lang=js","webpack://text/./src/components/Editor/TableOfContents.vue?b96e","webpack://text/./src/components/Editor/TableOfContents.vue?196c","webpack://text/./src/components/Editor/TableOfContents.vue?a843","webpack:///text/src/components/Editor/EditorOutline.vue","webpack:///text/src/components/Editor/EditorOutline.vue?vue&type=script&lang=js","webpack://text/./src/components/Editor/EditorOutline.vue?f746","webpack://text/./src/components/Editor/EditorOutline.vue?99f8","webpack://text/./src/components/Suggestion/SuggestionListWrapper.vue?7088","webpack:///text/src/components/Suggestion/SuggestionListWrapper.vue","webpack:///text/src/components/Suggestion/SuggestionListWrapper.vue?vue&type=script&lang=js","webpack://text/./src/components/Suggestion/SuggestionListWrapper.vue?2c1c","webpack://text/./src/components/Suggestion/SuggestionListWrapper.vue?9941"],"sourcesContent":["export const OUTLINE_STATE = Symbol('wrapper:outline-state')\nexport const OUTLINE_ACTIONS = Symbol('wrapper:outline-actions')\n\nexport const useOutlineStateMixin = {\n\tinject: {\n\t\t$outlineState: {\n\t\t\tfrom: OUTLINE_STATE,\n\t\t\tdefault: {\n\t\t\t\tvisible: false,\n\t\t\t\tenable: false,\n\t\t\t},\n\t\t},\n\t},\n}\n\nexport const useOutlineActions = {\n\tinject: {\n\t\t$outlineActions: {\n\t\t\tfrom: OUTLINE_ACTIONS,\n\t\t\tdefault: {\n\t\t\t\ttoggle: () => {},\n\t\t\t},\n\t\t},\n\t},\n}\n","\n      import API from \"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/sass-loader/dist/cjs.js!./ActionEntry.scss\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/sass-loader/dist/cjs.js!./ActionEntry.scss\";\n       export default content && content.locals ? content.locals : undefined;\n","/*\n * @copyright Copyright (c) 2022 Vinicius Reis <vinicius@nextcloud.com>\n *\n * @author Vinicius Reis <vinicius@nextcloud.com>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n/* eslint-disable jsdoc/valid-types */\n\nimport debounce from 'debounce'\n\nimport { useEditorMixin, useIsMobileMixin } from '../Editor.provider.js'\nimport { useOutlineActions, useOutlineStateMixin } from '../Editor/Wrapper.provider.js'\nimport { getActionState, getKeys, getKeyshortcuts } from './utils.js'\nimport useStore from '../../mixins/store.js'\n\nimport './ActionEntry.scss'\n\n/**\n * @type {import(\"vue\").ComponentOptions} BaseActionEntry\n */\nconst BaseActionEntry = {\n\tmixins: [useEditorMixin, useIsMobileMixin, useStore, useOutlineActions, useOutlineStateMixin],\n\tprops: {\n\t\tactionEntry: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tcanBeFocussed: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tstate: getActionState(this.actionEntry, this.$editor),\n\t\t}\n\t},\n\tcomputed: {\n\t\tlabel() {\n\t\t\tconst { label } = this.actionEntry\n\n\t\t\treturn typeof label === 'function'\n\t\t\t\t? label(this)\n\t\t\t\t: label\n\t\t},\n\t\ticon() {\n\t\t\treturn this.actionEntry.icon\n\t\t},\n\t\tkeyshortcuts() {\n\t\t\treturn getKeyshortcuts(this.actionEntry)\n\t\t},\n\t\ttooltip() {\n\t\t\treturn [\n\t\t\t\tthis.label,\n\t\t\t\tgetKeys(this.$isMobile, this.actionEntry),\n\t\t\t].join(' ')\n\t\t},\n\t},\n\twatch: {\n\t\t/** Handle tabindex for menu toolbar */\n\t\tcanBeFocussed() {\n\t\t\tthis.setTabIndexOnButton()\n\t\t},\n\t},\n\tmounted() {\n\t\tthis.$_updateState = debounce(this.updateState.bind(this), 50)\n\t\tthis.$editor.on('update', this.$_updateState)\n\t\tthis.$editor.on('selectionUpdate', this.$_updateState)\n\t\t// Initially emit the disabled event to set the state in parent\n\t\tthis.$emit('disabled', this.state.disabled)\n\t\t// Initially set the tabindex\n\t\tthis.setTabIndexOnButton()\n\t},\n\tbeforeDestroy() {\n\t\tthis.$editor.off('update', this.$_updateState)\n\t\tthis.$editor.off('selectionUpdate', this.$_updateState)\n\t},\n\tmethods: {\n\t\tupdateState() {\n\t\t\tthis.state = getActionState(this.actionEntry, this.$editor)\n\t\t\tthis.$emit('disabled', this.state.disabled)\n\t\t},\n\t\tsetTabIndexOnButton() {\n\t\t\t/** @type {HTMLButtonElement} */\n\t\t\tconst button = this.$el.tagName.toLowerCase() === 'button' ? this.$el : this.$el.querySelector('button')\n\n\t\t\tif (this.canBeFocussed === null) {\n\t\t\t\tbutton.removeAttribute('tabindex')\n\t\t\t} else {\n\t\t\t\tbutton.setAttribute('tabindex', this.canBeFocussed ? '0' : '-1')\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Focus the inner button of this action\n\t\t */\n\t\tfocusButton() {\n\t\t\t/** @type {HTMLButtonElement} */\n\t\t\tconst button = this.$el.tagName.toLowerCase() === 'button' ? this.$el : this.$el.querySelector('button')\n\t\t\tbutton.focus()\n\t\t},\n\t},\n}\n\nexport { BaseActionEntry }\n","export const MENU_ID = Symbol('menu::id')\n\nexport const useMenuIDMixin = {\n\tinject: {\n\t\t$menuID: { from: MENU_ID, default: null },\n\t},\n\tcomputed: {\n\t\tmenuIDSelector() {\n\t\t\treturn `#${this.$menuID}`\n\t\t},\n\t},\n}\n","<!--\n  - @copyright Copyright (c) 2022 Vinicius Reis <vinicius@nextcloud.com>\n  -\n  - @author Vinicius Reis <vinicius@nextcloud.com>\n  -\n  - @license GNU AGPL version 3 or any later version\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\n  -\n  -->\n<template>\n\t<NcEmojiPicker class=\"entry-action entry-action__emoji\"\n\t\t:data-text-action-entry=\"actionEntry.key\"\n\t\t:container=\"menuIDSelector\"\n\t\t@select-data=\"addEmoji\">\n\t\t<div>\n\t\t\t<NcButton class=\"entry-action__button\"\n\t\t\t\trole=\"menu\"\n\t\t\t\t:title=\"actionEntry.label\"\n\t\t\t\t:aria-label=\"actionEntry.label\">\n\t\t\t\t<template #icon>\n\t\t\t\t\t<component :is=\"icon\" />\n\t\t\t\t</template>\n\t\t\t</NcButton>\n\t\t</div>\n\t</NcEmojiPicker>\n</template>\n\n<script>\nimport { BaseActionEntry } from './BaseActionEntry.js'\nimport { NcEmojiPicker, NcButton } from '@nextcloud/vue'\nimport { useMenuIDMixin } from './MenuBar.provider.js'\n\nexport default {\n\tname: 'EmojiPickerAction',\n\tcomponents: {\n\t\tNcEmojiPicker,\n\t\tNcButton,\n\t},\n\textends: BaseActionEntry,\n\tmixins: [useMenuIDMixin],\n\tmethods: {\n\t\taddEmoji({ id, native }) {\n\t\t\tthis.actionEntry\n\t\t\t\t.action(this.$editor.chain(), { id, native })\n\t\t\t\t.focus()\n\t\t\t\t.run()\n\t\t},\n\t},\n}\n</script>\n","import mod from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./EmojiPickerAction.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./EmojiPickerAction.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./EmojiPickerAction.vue?vue&type=template&id=7a95ebd4\"\nimport script from \"./EmojiPickerAction.vue?vue&type=script&lang=js\"\nexport * from \"./EmojiPickerAction.vue?vue&type=script&lang=js\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('NcEmojiPicker',{staticClass:\"entry-action entry-action__emoji\",attrs:{\"data-text-action-entry\":_vm.actionEntry.key,\"container\":_vm.menuIDSelector},on:{\"select-data\":_vm.addEmoji}},[_c('div',[_c('NcButton',{staticClass:\"entry-action__button\",attrs:{\"role\":\"menu\",\"title\":_vm.actionEntry.label,\"aria-label\":_vm.actionEntry.label},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c(_vm.icon,{tag:\"component\"})]},proxy:true}])})],1)])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('NcActions',{staticClass:\"entry-action entry-action__image-upload\",attrs:{\"data-text-action-entry\":_vm.actionEntry.key,\"name\":_vm.actionEntry.label,\"title\":_vm.actionEntry.label,\"aria-label\":_vm.actionEntry.label,\"container\":_vm.menuIDSelector},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c(_vm.icon,{tag:\"component\",attrs:{\"name\":_vm.actionEntry.label,\"aria-label\":_vm.actionEntry.label}})]},proxy:true}])},[_vm._v(\" \"),(_vm.$editorUpload)?_c('NcActionButton',{attrs:{\"close-after-click\":\"\",\"disabled\":_vm.isUploadingAttachments,\"data-text-action-entry\":`${_vm.actionEntry.key}-upload`},on:{\"click\":_vm.$callChooseLocalAttachment},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c('Upload')]},proxy:true}],null,false,933298848)},[_vm._v(\"\\n\\t\\t\"+_vm._s(_vm.t('text', 'Upload from computer'))+\"\\n\\t\")]):_vm._e(),_vm._v(\" \"),(!_vm.$isPublic)?_c('NcActionButton',{attrs:{\"close-after-click\":\"\",\"disabled\":_vm.isUploadingAttachments,\"data-text-action-entry\":`${_vm.actionEntry.key}-insert`},on:{\"click\":_vm.$callAttachmentPrompt},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c('Folder')]},proxy:true}],null,false,2750733237)},[_vm._v(\"\\n\\t\\t\"+_vm._s(_vm.t('text', 'Insert from Files'))+\"\\n\\t\")]):_vm._e()],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<!--\n  - @copyright Copyright (c) 2022 Vinicius Reis <vinicius@nextcloud.com>\n  -\n  - @author Vinicius Reis <vinicius@nextcloud.com>\n  -\n  - @license GNU AGPL version 3 or any later version\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\n  -\n  -->\n<template>\n\t<NcActions class=\"entry-action entry-action__image-upload\"\n\t\t:data-text-action-entry=\"actionEntry.key\"\n\t\t:name=\"actionEntry.label\"\n\t\t:title=\"actionEntry.label\"\n\t\t:aria-label=\"actionEntry.label\"\n\t\t:container=\"menuIDSelector\">\n\t\t<template #icon>\n\t\t\t<component :is=\"icon\"\n\t\t\t\t:name=\"actionEntry.label\"\n\t\t\t\t:aria-label=\"actionEntry.label\" />\n\t\t</template>\n\t\t<NcActionButton v-if=\"$editorUpload\"\n\t\t\tclose-after-click\n\t\t\t:disabled=\"isUploadingAttachments\"\n\t\t\t:data-text-action-entry=\"`${actionEntry.key}-upload`\"\n\t\t\t@click=\"$callChooseLocalAttachment\">\n\t\t\t<template #icon>\n\t\t\t\t<Upload />\n\t\t\t</template>\n\t\t\t{{ t('text', 'Upload from computer') }}\n\t\t</NcActionButton>\n\t\t<NcActionButton v-if=\"!$isPublic\"\n\t\t\tclose-after-click\n\t\t\t:disabled=\"isUploadingAttachments\"\n\t\t\t:data-text-action-entry=\"`${actionEntry.key}-insert`\"\n\t\t\t@click=\"$callAttachmentPrompt\">\n\t\t\t<template #icon>\n\t\t\t\t<Folder />\n\t\t\t</template>\n\t\t\t{{ t('text', 'Insert from Files') }}\n\t\t</NcActionButton>\n\t</NcActions>\n</template>\n\n<script>\nimport { NcActions, NcActionButton } from '@nextcloud/vue'\nimport { Loading, Folder, Upload } from '../icons.js'\nimport { useIsPublicMixin, useEditorUpload } from '../Editor.provider.js'\nimport { BaseActionEntry } from './BaseActionEntry.js'\nimport { useMenuIDMixin } from './MenuBar.provider.js'\nimport {\n\tuseActionAttachmentPromptMixin,\n\tuseUploadingStateMixin,\n\tuseActionChooseLocalAttachmentMixin,\n} from '../Editor/MediaHandler.provider.js'\n\nexport default {\n\tname: 'ActionAttachmentUpload',\n\tcomponents: {\n\t\tNcActions,\n\t\tNcActionButton,\n\t\tLoading,\n\t\tFolder,\n\t\tUpload,\n\t},\n\textends: BaseActionEntry,\n\tmixins: [\n\t\tuseIsPublicMixin,\n\t\tuseEditorUpload,\n\t\tuseActionAttachmentPromptMixin,\n\t\tuseUploadingStateMixin,\n\t\tuseActionChooseLocalAttachmentMixin,\n\t\tuseMenuIDMixin,\n\t],\n\tcomputed: {\n\t\ticon() {\n\t\t\treturn this.isUploadingAttachments\n\t\t\t\t? Loading\n\t\t\t\t: this.actionEntry.icon\n\t\t},\n\t\tisUploadingAttachments() {\n\t\t\treturn this.$uploadingState.isUploadingAttachments\n\t\t},\n\t},\n}\n</script>\n","import mod from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ActionAttachmentUpload.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ActionAttachmentUpload.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./ActionAttachmentUpload.vue?vue&type=template&id=4fee2adb\"\nimport script from \"./ActionAttachmentUpload.vue?vue&type=script&lang=js\"\nexport * from \"./ActionAttachmentUpload.vue?vue&type=script&lang=js\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('NcActions',{staticClass:\"entry-action entry-action__insert-link\",class:_vm.activeClass,attrs:{\"title\":_vm.actionEntry.label,\"aria-label\":_vm.actionEntry.label,\"container\":_vm.menuIDSelector,\"data-text-action-entry\":_vm.actionEntry.key,\"name\":_vm.actionEntry.label,\"open\":_vm.menuOpen},on:{\"update:open\":(open) => { _vm.menuOpen = _vm.menuOpen || open }},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c(_vm.icon,{tag:\"component\",attrs:{\"name\":_vm.actionEntry.label,\"aria-label\":_vm.actionEntry.label}})]},proxy:true}])},[_vm._v(\" \"),(_vm.state.active)?_c('NcActionButton',{attrs:{\"data-text-action-entry\":`${_vm.actionEntry.key}-remove`},on:{\"click\":_vm.removeLink},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c('LinkOff')]},proxy:true}],null,false,3589828876)},[_vm._v(\"\\n\\t\\t\"+_vm._s(_vm.t('text', 'Remove link'))+\"\\n\\t\")]):_vm._e(),_vm._v(\" \"),(!_vm.isUsingDirectEditing)?_c('NcActionButton',{ref:\"buttonFile\",attrs:{\"data-text-action-entry\":`${_vm.actionEntry.key}-file`},on:{\"click\":_vm.linkFile},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c('Document')]},proxy:true}],null,false,1149029676)},[_vm._v(\"\\n\\t\\t\"+_vm._s(_vm.t('text', 'Link to file or folder'))+\"\\n\\t\")]):_vm._e(),_vm._v(\" \"),(_vm.isInputMode)?_c('NcActionInput',{attrs:{\"type\":\"text\",\"value\":_vm.href,\"data-text-action-entry\":`${_vm.actionEntry.key}-input`},on:{\"update:value\":function($event){_vm.href=$event},\"submit\":_vm.linkWebsite},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c('Web')]},proxy:true}],null,false,1844845715)},[_vm._v(\"\\n\\t\\t\"+_vm._s(_vm.t('text', 'Link to website'))+\"\\n\\t\")]):_c('NcActionButton',{attrs:{\"data-text-action-entry\":`${_vm.actionEntry.key}-website`},on:{\"click\":_vm.linkWebsite},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c('Web')]},proxy:true}])},[_vm._v(\"\\n\\t\\t\"+_vm._s(_vm.state.active ? _vm.t('text', 'Update link') : _vm.t('text', 'Link to website'))+\"\\n\\t\")]),_vm._v(\" \"),_c('NcActionButton',{attrs:{\"data-text-action-entry\":`${_vm.actionEntry.key}-picker`},on:{\"click\":_vm.linkPicker},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c('Shape')]},proxy:true}])},[_vm._v(\"\\n\\t\\t\"+_vm._s(_vm.t('text', 'Open the Smart Picker'))+\"\\n\\t\")])],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<!--\n  - @copyright Copyright (c) 2022\n  -\n  - @license AGPL-3.0-or-later\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\n  -\n  -->\n<template>\n\t<NcActions class=\"entry-action entry-action__insert-link\"\n\t\t:title=\"actionEntry.label\"\n\t\t:aria-label=\"actionEntry.label\"\n\t\t:class=\"activeClass\"\n\t\t:container=\"menuIDSelector\"\n\t\t:data-text-action-entry=\"actionEntry.key\"\n\t\t:name=\"actionEntry.label\"\n\t\t:open=\"menuOpen\"\n\t\t@update:open=\"(open) => { menuOpen = menuOpen || open }\">\n\t\t<template #icon>\n\t\t\t<component :is=\"icon\"\n\t\t\t\t:name=\"actionEntry.label\"\n\t\t\t\t:aria-label=\"actionEntry.label\" />\n\t\t</template>\n\t\t<NcActionButton v-if=\"state.active\"\n\t\t\t:data-text-action-entry=\"`${actionEntry.key}-remove`\"\n\t\t\t@click=\"removeLink\">\n\t\t\t<template #icon>\n\t\t\t\t<LinkOff />\n\t\t\t</template>\n\t\t\t{{ t('text', 'Remove link') }}\n\t\t</NcActionButton>\n\t\t<NcActionButton v-if=\"!isUsingDirectEditing\"\n\t\t\tref=\"buttonFile\"\n\t\t\t:data-text-action-entry=\"`${actionEntry.key}-file`\"\n\t\t\t@click=\"linkFile\">\n\t\t\t<template #icon>\n\t\t\t\t<Document />\n\t\t\t</template>\n\t\t\t{{ t('text', 'Link to file or folder') }}\n\t\t</NcActionButton>\n\t\t<NcActionInput v-if=\"isInputMode\"\n\t\t\ttype=\"text\"\n\t\t\t:value.sync=\"href\"\n\t\t\t:data-text-action-entry=\"`${actionEntry.key}-input`\"\n\t\t\t@submit=\"linkWebsite\">\n\t\t\t<template #icon>\n\t\t\t\t<Web />\n\t\t\t</template>\n\t\t\t{{ t('text', 'Link to website') }}\n\t\t</NcActionInput>\n\t\t<NcActionButton v-else\n\t\t\t:data-text-action-entry=\"`${actionEntry.key}-website`\"\n\t\t\t@click=\"linkWebsite\">\n\t\t\t<template #icon>\n\t\t\t\t<Web />\n\t\t\t</template>\n\t\t\t{{ state.active ? t('text', 'Update link') : t('text', 'Link to website') }}\n\t\t</NcActionButton>\n\t\t<NcActionButton :data-text-action-entry=\"`${actionEntry.key}-picker`\"\n\t\t\t@click=\"linkPicker\">\n\t\t\t<template #icon>\n\t\t\t\t<Shape />\n\t\t\t</template>\n\t\t\t{{ t('text', 'Open the Smart Picker') }}\n\t\t</NcActionButton>\n\t</NcActions>\n</template>\n\n<script>\nimport { NcActions, NcActionButton, NcActionInput } from '@nextcloud/vue'\nimport { getLinkWithPicker } from '@nextcloud/vue/dist/Components/NcRichText.js'\nimport { getFilePickerBuilder } from '@nextcloud/dialogs'\nimport { generateUrl } from '@nextcloud/router'\nimport { loadState } from '@nextcloud/initial-state'\n\nimport { getMarkAttributes, isActive } from '@tiptap/core'\n\nimport { Document, Loading, LinkOff, Web, Shape } from '../icons.js'\nimport { BaseActionEntry } from './BaseActionEntry.js'\nimport { useFileMixin } from '../Editor.provider.js'\nimport { useMenuIDMixin } from './MenuBar.provider.js'\n\nexport default {\n\tname: 'ActionInsertLink',\n\tcomponents: {\n\t\tNcActions,\n\t\tNcActionButton,\n\t\tNcActionInput,\n\t\tDocument,\n\t\tLoading,\n\t\tLinkOff,\n\t\tWeb,\n\t\tShape,\n\t},\n\textends: BaseActionEntry,\n\tmixins: [\n\t\tuseFileMixin,\n\t\tuseMenuIDMixin,\n\t],\n\tdata: () => {\n\t\treturn {\n\t\t\thref: '',\n\t\t\tisInputMode: false,\n\t\t\tstartPath: null,\n\t\t\t/** Open state of the actions menu */\n\t\t\tmenuOpen: false,\n\t\t\tisUsingDirectEditing: loadState('text', 'directEditingToken', null) !== null,\n\t\t}\n\t},\n\tcomputed: {\n\t\tactiveClass() {\n\t\t\treturn this.state.active ? 'is-active' : ''\n\t\t},\n\t\trelativePath() {\n\t\t\treturn this.$file?.relativePath ?? '/'\n\t\t},\n\t},\n\tmethods: {\n\t\t/**\n\t\t * Open dialog and ask user which file to link to\n\t\t * Triggered by the \"link file\" button\n\t\t */\n\t\tlinkFile() {\n\t\t\tif (this.startPath === null) {\n\t\t\t\tthis.startPath = this.relativePath.split('/').slice(0, -1).join('/')\n\t\t\t}\n\n\t\t\tconst filePicker = getFilePickerBuilder(t('text', 'Select file or folder to link to'))\n\t\t\t\t.startAt(this.startPath)\n\t\t\t\t.allowDirectories(true)\n\t\t\t\t.setMultiSelect(false)\n\t\t\t\t.setButtonFactory((nodes, path) => {\n\t\t\t\t\tconst buttons = []\n\t\t\t\t\tconst node = nodes?.[0]?.attributes?.displayName || nodes?.[0]?.basename\n\t\t\t\t\tconst isRoot = nodes?.[0]?.root === nodes?.[0]?.attributes?.filename\n\t\t\t\t\tlet label = t('text', 'Choose')\n\n\t\t\t\t\tif (nodes.length === 1 && !isRoot) {\n\t\t\t\t\t\tlabel = t('text', 'Choose {file}', { file: node })\n\t\t\t\t\t}\n\n\t\t\t\t\tbuttons.push({\n\t\t\t\t\t\tcallback: () => {},\n\t\t\t\t\t\ttype: 'primary',\n\t\t\t\t\t\tlabel,\n\t\t\t\t\t\tdisabled: isRoot,\n\t\t\t\t\t})\n\n\t\t\t\t\treturn buttons\n\t\t\t\t})\n\t\t\t\t.build()\n\n\t\t\tfilePicker.pick()\n\t\t\t\t.then((file) => {\n\t\t\t\t\tconst client = OC.Files.getClient()\n\t\t\t\t\tclient.getFileInfo(file).then((_status, fileInfo) => {\n\t\t\t\t\t\tconst url = new URL(generateUrl(`/f/${fileInfo.id}`), window.origin)\n\t\t\t\t\t\tthis.setLink(url.href, fileInfo.name)\n\t\t\t\t\t\tthis.startPath = fileInfo.path + (fileInfo.type === 'dir' ? `/${fileInfo.name}/` : '')\n\t\t\t\t\t})\n\t\t\t\t\tthis.menuOpen = false\n\t\t\t\t})\n\t\t\t\t.catch(() => {\n\t\t\t\t\t// do not close menu but keep focus\n\t\t\t\t\tthis.$refs.buttonFile.$el.focus()\n\t\t\t\t})\n\t\t},\n\t\t/**\n\t\t * Allow user to enter an URL manually\n\t\t * Triggered when by the \"link url\" button\n\t\t *\n\t\t * @param {Event} event Triggering event\n\t\t */\n\t\tlinkWebsite(event) {\n\t\t\tif (event?.type === 'submit') {\n\t\t\t\tconst href = [...event.target.elements].filter(e => e?.type === 'text')[0].value\n\t\t\t\tthis.menuOpen = false\n\t\t\t\tthis.isInputMode = false\n\t\t\t\tthis.href = ''\n\t\t\t\treturn this.setLink(href, href)\n\t\t\t}\n\n\t\t\tif (isActive(this.$editor.state, 'link')) {\n\t\t\t\tconst attrs = getMarkAttributes(this.$editor.state, 'link')\n\t\t\t\tthis.href = attrs.href\n\t\t\t}\n\t\t\tthis.isInputMode = true\n\t\t},\n\t\t/**\n\t\t * Save user entered URL as a link markup\n\t\t * Triggered when the user submits the ActionInput\n\t\t *\n\t\t * @param {string} url href attribute of the link\n\t\t * @param {string} text Text part of the link\n\t\t */\n\t\tsetLink(url, text) {\n\t\t\t// Heuristics for determining if we need a https:// prefix.\n\t\t\tconst noPrefixes = [\n\t\t\t\t/^[a-zA-Z]+:/, // url with protocol (\"mailTo:email@domain.tld\")\n\t\t\t\t/^\\//, // absolute path\n\t\t\t\t/\\?fileId=/, // relative link with fileId\n\t\t\t\t/^\\.\\.?\\//, // relative link starting with ./ or ../\n\t\t\t\t/^[^.]*[/$]/, // no dots before first '/' - not a domain name\n\t\t\t\t/^#/, // url fragment\n\t\t\t]\n\t\t\tif (url && !noPrefixes.find(regex => url.match(regex))) {\n\t\t\t\turl = 'https://' + url\n\t\t\t}\n\n\t\t\t// Avoid issues when parsing urls later on in markdown that might be entered in an invalid format (e.g. \"mailto: example@example.com\")\n\t\t\tconst href = url.replaceAll(' ', '%20')\n\t\t\tconst chain = this.$editor.chain()\n\t\t\t// Check if any text is selected, if not insert the link using the given text property\n\t\t\tif (this.$editor.view.state?.selection.empty) {\n\t\t\t\tchain.insertContent({\n\t\t\t\t\ttype: 'paragraph',\n\t\t\t\t\tcontent: [{\n\t\t\t\t\t\ttype: 'text',\n\t\t\t\t\t\tmarks: [{\n\t\t\t\t\t\t\ttype: 'link',\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\thref,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t}],\n\t\t\t\t\t\ttext,\n\t\t\t\t\t}],\n\t\t\t\t})\n\t\t\t} else {\n\t\t\t\tchain.setLink({ href })\n\t\t\t}\n\t\t\tchain.focus().run()\n\t\t},\n\t\t/**\n\t\t * Remove link markup at current position\n\t\t * Triggered by the \"remove link\" button\n\t\t */\n\t\tremoveLink() {\n\t\t\tthis.$editor.chain().unsetLink().focus().run()\n\t\t\tthis.menuOpen = false\n\t\t},\n\t\tlinkPicker() {\n\t\t\tgetLinkWithPicker(null, true)\n\t\t\t\t.then(link => {\n\t\t\t\t\tconst chain = this.$editor.chain()\n\t\t\t\t\tif (this.$editor.view.state?.selection.empty) {\n\t\t\t\t\t\tchain.focus().insertPreview(link).run()\n\t\t\t\t\t} else {\n\t\t\t\t\t\tchain.setLink({ href: link }).focus().run()\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch(error => {\n\t\t\t\t\tconsole.error('Smart picker promise rejected', error)\n\t\t\t\t})\n\t\t},\n\t},\n}\n</script>\n\n<style scoped>\n\t.action {\n\t\t/* to unify width of ActionInput and ActionButton */\n\t\tmin-width: 218px;\n\t}\n</style>\n","import mod from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ActionInsertLink.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ActionInsertLink.vue?vue&type=script&lang=js\"","\n      import API from \"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ActionInsertLink.vue?vue&type=style&index=0&id=a0f3b418&prod&scoped=true&lang=css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ActionInsertLink.vue?vue&type=style&index=0&id=a0f3b418&prod&scoped=true&lang=css\";\n       export default content && content.locals ? content.locals : undefined;\n","import { render, staticRenderFns } from \"./ActionInsertLink.vue?vue&type=template&id=a0f3b418&scoped=true\"\nimport script from \"./ActionInsertLink.vue?vue&type=script&lang=js\"\nexport * from \"./ActionInsertLink.vue?vue&type=script&lang=js\"\nimport style0 from \"./ActionInsertLink.vue?vue&type=style&index=0&id=a0f3b418&prod&scoped=true&lang=css\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"a0f3b418\",\n  null\n  \n)\n\nexport default component.exports","/*\n * @copyright Copyright (c) 2019 Julius Hrtl <jus@bitgrid.net>\n *\n * @author Julius Hrtl <jus@bitgrid.net>\n * @author Grigorii K. Shartsev <me@shgk.me>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport {\n\tUndo,\n\tRedo,\n\tCodeTags,\n\tDanger,\n\tEmoticon,\n\tFormatBold,\n\tFormatItalic,\n\tFormatUnderline,\n\tFormatStrikethrough,\n\tFormatHeader1,\n\tFormatHeader2,\n\tFormatHeader3,\n\tFormatHeader4,\n\tFormatHeader5,\n\tFormatHeader6,\n\tFormatListNumbered,\n\tFormatListBulleted,\n\tFormatListCheckbox,\n\tFormatQuote,\n\tImages,\n\tInfo,\n\tLinkIcon,\n\tPositive,\n\tTable,\n\tWarn,\n} from '../icons.js'\nimport EmojiPickerAction from './EmojiPickerAction.vue'\nimport ActionAttachmentUpload from './ActionAttachmentUpload.vue'\nimport ActionInsertLink from './ActionInsertLink.vue'\n\nimport { MODIFIERS } from './keys.js'\n\nexport const ReadonlyEntries = [{\n\tkey: 'outline',\n\tforceLabel: true,\n\ticon: FormatListBulleted,\n\tclick: ({ $outlineActions }) => $outlineActions.toggle(),\n\tlabel: ({ $outlineState }) => {\n\t\treturn $outlineState.visible\n\t\t\t? t('text', 'Hide outline')\n\t\t\t: t('text', 'Show outline')\n\t},\n}]\n\nexport default [\n\t{\n\t\tkey: 'undo',\n\t\tlabel: t('text', 'Undo'),\n\t\tkeyChar: 'z',\n\t\tkeyModifiers: [MODIFIERS.Mod],\n\t\ticon: Undo,\n\t\taction: (command) => command.undo(),\n\t\tpriority: 6,\n\t},\n\t{\n\t\tkey: 'redo',\n\t\tlabel: t('text', 'Redo'),\n\t\tkeyChar: 'y',\n\t\tkeyModifiers: [MODIFIERS.Mod],\n\t\ticon: Redo,\n\t\taction: (command) => command.redo(),\n\t\tpriority: 12,\n\t},\n\t{\n\t\tkey: 'bold',\n\t\tlabel: t('text', 'Bold'),\n\t\tkeyChar: 'b',\n\t\tkeyModifiers: [MODIFIERS.Mod],\n\t\ticon: FormatBold,\n\t\tisActive: 'strong',\n\t\taction: (command) => {\n\t\t\treturn command.toggleBold()\n\t\t},\n\t\tpriority: 7,\n\t},\n\t{\n\t\tkey: 'italic',\n\t\tlabel: t('text', 'Italic'),\n\t\tkeyChar: 'i',\n\t\tkeyModifiers: [MODIFIERS.Mod],\n\t\ticon: FormatItalic,\n\t\tisActive: 'em',\n\t\taction: (command) => {\n\t\t\treturn command.toggleItalic()\n\t\t},\n\t\tpriority: 8,\n\t},\n\t{\n\t\tkey: 'underline',\n\t\tlabel: t('text', 'Underline'),\n\t\tkeyChar: 'u',\n\t\tkeyModifiers: [MODIFIERS.Mod],\n\t\ticon: FormatUnderline,\n\t\tisActive: 'underline',\n\t\taction: (command) => {\n\t\t\treturn command.toggleUnderline()\n\t\t},\n\t\tpriority: 15,\n\t},\n\t{\n\t\tkey: 'strikethrough',\n\t\tlabel: t('text', 'Strikethrough'),\n\t\tkeyChar: 's',\n\t\tkeyModifiers: [MODIFIERS.Mod, MODIFIERS.Shift],\n\t\ticon: FormatStrikethrough,\n\t\tisActive: 'strike',\n\t\taction: (command) => {\n\t\t\treturn command.toggleStrike()\n\t\t},\n\t\tpriority: 16,\n\t},\n\t{\n\t\tkey: 'headings',\n\t\tlabel: t('text', 'Headings'),\n\t\tkeyChar: '16',\n\t\tkeyModifiers: [MODIFIERS.Mod, MODIFIERS.Shift],\n\t\ticon: FormatHeader1,\n\t\tisActive: 'heading',\n\t\tchildren: [\n\t\t\t{\n\t\t\t\tkey: 'headings-h1',\n\t\t\t\tlabel: t('text', 'Heading 1'),\n\t\t\t\ticon: FormatHeader1,\n\t\t\t\tisActive: ['heading', { level: 1 }],\n\t\t\t\taction: (command) => {\n\t\t\t\t\treturn command.toggleHeading({ level: 1 })\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tkey: 'headings-h2',\n\t\t\t\tlabel: t('text', 'Heading 2'),\n\t\t\t\ticon: FormatHeader2,\n\t\t\t\tisActive: ['heading', { level: 2 }],\n\t\t\t\taction: (command) => {\n\t\t\t\t\treturn command.toggleHeading({ level: 2 })\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tkey: 'headings-h3',\n\t\t\t\tlabel: t('text', 'Heading 3'),\n\t\t\t\ticon: FormatHeader3,\n\t\t\t\tisActive: ['heading', { level: 3 }],\n\t\t\t\taction: (command) => {\n\t\t\t\t\treturn command.toggleHeading({ level: 3 })\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tkey: 'headings-h4',\n\t\t\t\tlabel: t('text', 'Heading 4'),\n\t\t\t\tisActive: ['heading', { level: 4 }],\n\t\t\t\ticon: FormatHeader4,\n\t\t\t\taction: (command) => {\n\t\t\t\t\treturn command.toggleHeading({ level: 4 })\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tkey: 'headings-h5',\n\t\t\t\tlabel: t('text', 'Heading 5'),\n\t\t\t\tisActive: ['heading', { level: 5 }],\n\t\t\t\ticon: FormatHeader5,\n\t\t\t\taction: (command) => {\n\t\t\t\t\treturn command.toggleHeading({ level: 5 })\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tkey: 'headings-h6',\n\t\t\t\tlabel: t('text', 'Heading 6'),\n\t\t\t\tisActive: ['heading', { level: 6 }],\n\t\t\t\ticon: FormatHeader6,\n\t\t\t\taction: (command) => {\n\t\t\t\t\treturn command.toggleHeading({ level: 6 })\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tkey: 'headings-separator',\n\t\t\t\tisSeparator: true,\n\t\t\t\tvisible: ({ $outlineState }) => {\n\t\t\t\t\treturn $outlineState.enable\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tkey: 'outline',\n\t\t\t\ticon: FormatListBulleted,\n\t\t\t\tclick: ({ $outlineActions }) => $outlineActions.toggle(),\n\t\t\t\tvisible: ({ $outlineState }) => {\n\t\t\t\t\treturn $outlineState.enable\n\t\t\t\t},\n\t\t\t\tlabel: ({ $outlineState }) => {\n\t\t\t\t\treturn $outlineState.visible\n\t\t\t\t\t\t? t('text', 'Hide outline')\n\t\t\t\t\t\t: t('text', 'Show outline')\n\t\t\t\t},\n\t\t\t},\n\t\t],\n\t\tpriority: 1,\n\t},\n\t{\n\t\tkey: 'unordered-list',\n\t\tlabel: t('text', 'Unordered list'),\n\t\tkeyChar: '8',\n\t\tkeyModifiers: [MODIFIERS.Mod, MODIFIERS.Shift],\n\t\tisActive: 'bulletList',\n\t\ticon: FormatListBulleted,\n\t\taction: (command) => {\n\t\t\treturn command.toggleBulletList()\n\t\t},\n\t\tpriority: 9,\n\t},\n\t{\n\t\tkey: 'ordered-list',\n\t\tlabel: t('text', 'Ordered list'),\n\t\tkeyChar: '7',\n\t\tkeyModifiers: [MODIFIERS.Mod, MODIFIERS.Shift],\n\t\tisActive: 'orderedList',\n\t\ticon: FormatListNumbered,\n\t\taction: (command) => {\n\t\t\treturn command.toggleOrderedList()\n\t\t},\n\t\tpriority: 10,\n\t},\n\t{\n\t\tkey: 'task-list',\n\t\tlabel: t('text', 'To-Do list'),\n\t\tkeyChar: '9',\n\t\tkeyModifiers: [MODIFIERS.Mod, MODIFIERS.Shift],\n\t\tisActive: 'taskList',\n\t\ticon: FormatListCheckbox,\n\t\taction: (command) => command.toggleTaskList(),\n\t\tpriority: 11,\n\t},\n\t{\n\t\tkey: 'insert-link',\n\t\tlabel: t('text', 'Insert link'),\n\t\tisActive: 'link',\n\t\ticon: LinkIcon,\n\t\tcomponent: ActionInsertLink,\n\t\tpriority: 2,\n\t},\n\t{\n\t\tkey: 'blockquote',\n\t\tlabel: t('text', 'Blockquote'),\n\t\tkeyChar: 'b',\n\t\tkeyModifiers: [MODIFIERS.Mod, MODIFIERS.Shift],\n\t\tisActive: 'blockquote',\n\t\ticon: FormatQuote,\n\t\taction: (command) => {\n\t\t\treturn command.toggleBlockquote()\n\t\t},\n\t\tpriority: 13,\n\t},\n\t{\n\t\tkey: 'callouts',\n\t\tlabel: t('text', 'Callouts'),\n\t\tvisible: false,\n\t\ticon: Info,\n\t\tisActive: 'callout',\n\t\tchildren: [\n\t\t\t{\n\t\t\t\tkey: 'callout-info',\n\t\t\t\tlabel: t('text', 'Info'),\n\t\t\t\tisActive: ['callout', { type: 'info' }],\n\t\t\t\ticon: Info,\n\t\t\t\taction: (command) => {\n\t\t\t\t\treturn command.toggleCallout({ type: 'info' })\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tkey: 'callout-success',\n\t\t\t\tlabel: t('text', 'Success'),\n\t\t\t\tisActive: ['callout', { type: 'success' }],\n\t\t\t\ticon: Positive,\n\t\t\t\taction: (command) => {\n\t\t\t\t\treturn command.toggleCallout({ type: 'success' })\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tkey: 'callout-warn',\n\t\t\t\tlabel: t('text', 'Warning'),\n\t\t\t\tisActive: ['callout', { type: 'warn' }],\n\t\t\t\ticon: Warn,\n\t\t\t\taction: (command) => {\n\t\t\t\t\treturn command.toggleCallout({ type: 'warn' })\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tkey: 'callout-error',\n\t\t\t\tlabel: t('text', 'Danger'),\n\t\t\t\tisActive: ['callout', { type: 'error' }],\n\t\t\t\ticon: Danger,\n\t\t\t\taction: (command) => {\n\t\t\t\t\treturn command.toggleCallout({ type: 'error' })\n\t\t\t\t},\n\t\t\t},\n\t\t],\n\t\tpriority: 6,\n\t},\n\t{\n\t\tkey: 'code-block',\n\t\tlabel: t('text', 'Code block'),\n\t\tkeyChar: 'c',\n\t\tkeyModifiers: [MODIFIERS.Mod, MODIFIERS.Alt],\n\t\tisActive: 'codeBlock',\n\t\ticon: CodeTags,\n\t\taction: (command) => {\n\t\t\treturn command.toggleCodeBlock()\n\t\t},\n\t\tpriority: 14,\n\t},\n\t{\n\t\tkey: 'table',\n\t\tlabel: t('text', 'Table'),\n\t\tisActive: 'table',\n\t\ticon: Table,\n\t\taction: (command) => {\n\t\t\treturn command.insertTable()\n\t\t},\n\t\tpriority: 17,\n\t},\n\t{\n\t\tkey: 'emoji-picker',\n\t\tlabel: t('text', 'Insert emoji'),\n\t\ticon: Emoticon,\n\t\tcomponent: EmojiPickerAction,\n\t\taction: (command, emojiObject = {}) => {\n\t\t\treturn command.emoji(emojiObject)\n\t\t},\n\t\tpriority: 3,\n\t},\n\t{\n\t\tkey: 'insert-attachment',\n\t\tlabel: t('text', 'Insert attachment'),\n\t\ticon: Images,\n\t\tcomponent: ActionAttachmentUpload,\n\t\tpriority: 1,\n\t},\n]\n","const isMac = (navigator.userAgent.includes('Mac'))\n\nconst MODIFIERS = {\n\tMod: isMac ? 'Meta' : 'Control',\n\tAlt: 'Alt', // Option key, on Apple computers.\n\tControl: 'Control',\n\tShift: 'Shift',\n\n\t// unused\n\t// AltGraph: 'AltGraph',\n\t// Meta: 'Meta', // Command key on Apple computers\n}\n\nconst TRANSLATIONS = {\n\t[MODIFIERS.Mod]: isMac ? t('text', 'Command') : t('text', 'Control'),\n\t[MODIFIERS.Control]: t('text', 'Ctrl'),\n\t[MODIFIERS.Alt]: t('text', isMac ? 'Option' : 'Alt'),\n\t[MODIFIERS.Shift]: t('text', 'Shift'),\n}\n\nexport {\n\tMODIFIERS,\n\tTRANSLATIONS,\n}\n","/*\n * @copyright Copyright (c) 2022 Vinicius Reis <vinicius@nextcloud.com>\n *\n * @author Vinicius Reis <vinicius@nextcloud.com>\n * @author Grigorii K. Shartsev <me@shgk.me>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport {\n\tTRANSLATIONS,\n\tMODIFIERS,\n} from './keys.js'\n\nconst getEntryClasses = (actionEntry, isActive) => {\n\treturn {\n\t\t'is-active': isActive,\n\t\t[`action-menu-${actionEntry.key}`]: true,\n\t}\n}\n\nconst keysString = (keyChar, modifiers = []) => {\n\treturn modifiers\n\t\t.map(mod => TRANSLATIONS[mod])\n\t\t.concat(keyChar.toUpperCase())\n\t\t.join('+')\n}\n\nconst getKeyshortcuts = ({ keyChar, keyModifiers = [] }) => {\n\treturn keyModifiers\n\t\t.map(mod => MODIFIERS[mod])\n\t\t.concat(keyChar)\n\t\t.join('+')\n}\n\nconst getKeys = (isMobile, { keyChar, keyModifiers }) => {\n\treturn (!isMobile && keyChar)\n\t\t? `(${keysString(keyChar, keyModifiers)})`\n\t\t: ''\n}\n\nconst isDisabled = (actionEntry, $editor) => {\n\treturn actionEntry.action && !actionEntry.action($editor.can())\n}\n\nconst getIsActive = ({ isActive }, $editor) => {\n\tif (!isActive) {\n\t\treturn false\n\t}\n\n\tconst args = Array.isArray(isActive)\n\t\t? isActive\n\t\t: [isActive]\n\n\treturn $editor.isActive(...args)\n}\n\nconst getType = (actionEntry) => {\n\t// isActive stores the value changing on active state change (on click)\n\n\t// If it is an array, the button is one of the list of alternative values for a specific option\n\t// Like ['heading', { level: 1 }]\n\tif (Array.isArray(actionEntry.isActive)) {\n\t\treturn 'radio'\n\t}\n\n\t// If it is a string, it toggles a specific option like a checkbox\n\tif (typeof actionEntry.isActive === 'string') {\n\t\treturn 'checkbox'\n\t}\n\n\t// Otherwise it is just a button\n\treturn 'button'\n}\n\nconst getActionState = (actionEntry, $editor) => {\n\tconst active = getIsActive(actionEntry, $editor)\n\n\treturn {\n\t\tdisabled: isDisabled(actionEntry, $editor),\n\t\tclass: getEntryClasses(actionEntry, active),\n\t\tactive,\n\t\ttype: getType(actionEntry),\n\t}\n}\n\nexport {\n\tisDisabled,\n\tgetIsActive,\n\tgetKeys,\n\tgetKeyshortcuts,\n\tgetEntryClasses,\n\tgetActionState,\n}\n","/*\n* @copyright Copyright (c) 2022 Julius Hrtl <jus@bitgrid.net>\n*\n* @author Julius Hrtl <jus@bitgrid.net>\n*\n* @license GNU AGPL version 3 or any later version\n*\n* This program is free software: you can redistribute it and/or modify\n* it under the terms of the GNU Affero General Public License as\n* published by the Free Software Foundation, either version 3 of the\n* License, or (at your option) any later version.\n*\n* This program is distributed in the hope that it will be useful,\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n* GNU Affero General Public License for more details.\n*\n* You should have received a copy of the GNU Affero General Public License\n* along with this program. If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport tippy from 'tippy.js'\nimport { VueRenderer } from '@tiptap/vue-2'\n\nexport default ({\n\tlistComponent,\n\titems = () => {},\n\tcommand = ({ editor, range, props }) => {},\n}) => ({\n\titems,\n\tcommand,\n\trender: () => {\n\t\tlet component\n\t\tlet popup\n\n\t\treturn {\n\t\t\tonStart: props => {\n\t\t\t\tcomponent = new VueRenderer(listComponent, {\n\t\t\t\t\tparent: this,\n\t\t\t\t\tpropsData: props,\n\t\t\t\t})\n\n\t\t\t\tif (!props.clientRect) {\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\tpopup = tippy('body', {\n\t\t\t\t\tgetReferenceClientRect: props.clientRect,\n\t\t\t\t\tappendTo: () => document.body,\n\t\t\t\t\tcontent: component.element,\n\t\t\t\t\tshowOnCreate: true,\n\t\t\t\t\tinteractive: true,\n\t\t\t\t\ttrigger: 'manual',\n\t\t\t\t\tplacement: 'bottom-start',\n\t\t\t\t})\n\n\t\t\t\tcomponent.ref.$on('select', () => {\n\t\t\t\t\tpopup.length > 0 && popup[0].hide()\n\t\t\t\t})\n\t\t\t},\n\n\t\t\tonUpdate(props) {\n\t\t\t\tcomponent.updateProps(props)\n\n\t\t\t\tif (!props.clientRect || !popup) {\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\tpopup[0].setProps({\n\t\t\t\t\tgetReferenceClientRect: props.clientRect,\n\t\t\t\t})\n\t\t\t},\n\n\t\t\tonKeyDown(props) {\n\t\t\t\tif (!popup) {\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\tif (props.event.key === 'Escape') {\n\t\t\t\t\tpopup[0].hide()\n\t\t\t\t\tpopup[0].destroy()\n\t\t\t\t\tcomponent.destroy()\n\t\t\t\t\tpopup = null\n\n\t\t\t\t\treturn true\n\t\t\t\t}\n\n\t\t\t\treturn component.ref?.onKeyDown?.(props)\n\t\t\t},\n\n\t\t\tonExit() {\n\t\t\t\tif (!popup) {\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tpopup[0].destroy()\n\t\t\t\tcomponent.destroy()\n\t\t\t},\n\t\t}\n\t},\n})\n","/* eslint-disable camelcase */\n/*\n * @copyright Copyright (c) 2022 Vinicius Reis <vinicius@nextcloud.com>\n *\n * @author Vinicius Reis <vinicius@nextcloud.com>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport MDI_AlphabeticalVariant from 'vue-material-design-icons/AlphabeticalVariant.vue'\nimport MDI_Close from 'vue-material-design-icons/Close.vue'\nimport MDI_Check from 'vue-material-design-icons/Check.vue'\nimport MDI_CircleMedium from 'vue-material-design-icons/CircleMedium.vue'\nimport MDI_CodeTags from 'vue-material-design-icons/CodeTags.vue'\nimport MDI_Danger from 'vue-material-design-icons/AlertDecagram.vue'\nimport MDI_Delete from 'vue-material-design-icons/Delete.vue'\nimport MDI_Document from 'vue-material-design-icons/FileDocument.vue'\nimport MDI_DotsHorizontal from 'vue-material-design-icons/DotsHorizontal.vue'\nimport MDI_Emoticon from 'vue-material-design-icons/EmoticonOutline.vue'\nimport MDI_Folder from 'vue-material-design-icons/Folder.vue'\nimport MDI_FormatBold from 'vue-material-design-icons/FormatBold.vue'\nimport MDI_AlignHorizontalCenter from 'vue-material-design-icons/AlignHorizontalCenter.vue'\nimport MDI_AlignHorizontalLeft from 'vue-material-design-icons/AlignHorizontalLeft.vue'\nimport MDI_AlignHorizontalRight from 'vue-material-design-icons/AlignHorizontalRight.vue'\nimport MDI_FormatHeader1 from 'vue-material-design-icons/FormatHeader1.vue'\nimport MDI_FormatHeader2 from 'vue-material-design-icons/FormatHeader2.vue'\nimport MDI_FormatHeader3 from 'vue-material-design-icons/FormatHeader3.vue'\nimport MDI_FormatHeader4 from 'vue-material-design-icons/FormatHeader4.vue'\nimport MDI_FormatHeader5 from 'vue-material-design-icons/FormatHeader5.vue'\nimport MDI_FormatHeader6 from 'vue-material-design-icons/FormatHeader6.vue'\nimport MDI_FormatItalic from 'vue-material-design-icons/FormatItalic.vue'\nimport MDI_FormatListBulleted from 'vue-material-design-icons/FormatListBulleted.vue'\nimport MDI_FormatListCheckbox from 'vue-material-design-icons/FormatListCheckbox.vue'\nimport MDI_FormatListNumbered from 'vue-material-design-icons/FormatListNumbered.vue'\nimport MDI_FormatQuote from 'vue-material-design-icons/FormatQuoteClose.vue'\nimport MDI_FormatStrikethrough from 'vue-material-design-icons/FormatStrikethrough.vue'\nimport MDI_FormatUnderline from 'vue-material-design-icons/FormatUnderline.vue'\nimport MDI_Help from 'vue-material-design-icons/HelpCircle.vue'\nimport MDI_Image from 'vue-material-design-icons/ImageOutline.vue'\nimport MDI_Images from 'vue-material-design-icons/ImageMultipleOutline.vue'\nimport MDI_Info from 'vue-material-design-icons/Information.vue'\nimport MDI_Link from 'vue-material-design-icons/Link.vue'\nimport MDI_LinkOff from 'vue-material-design-icons/LinkOff.vue'\nimport MDI_LinkVariantPlus from 'vue-material-design-icons/LinkVariantPlus.vue'\nimport MDI_Loading from 'vue-material-design-icons/Loading.vue'\nimport MDI_Lock from 'vue-material-design-icons/Lock.vue'\nimport MDI_Positive from 'vue-material-design-icons/CheckboxMarkedCircle.vue'\nimport MDI_Redo from 'vue-material-design-icons/ArrowURightTop.vue'\nimport MDI_Shape from 'vue-material-design-icons/Shape.vue'\nimport MDI_Table from 'vue-material-design-icons/Table.vue'\nimport MDI_TableAddColumnAfter from 'vue-material-design-icons/TableColumnPlusAfter.vue'\nimport MDI_TableAddColumnBefore from 'vue-material-design-icons/TableColumnPlusBefore.vue'\nimport MDI_TableAddRowAfter from 'vue-material-design-icons/TableRowPlusAfter.vue'\nimport MDI_TableAddRowBefore from 'vue-material-design-icons/TableRowPlusBefore.vue'\nimport MDI_TableSettings from 'vue-material-design-icons/TableCog.vue'\nimport MDI_TrashCan from 'vue-material-design-icons/TrashCan.vue'\nimport MDI_Undo from 'vue-material-design-icons/ArrowULeftTop.vue'\nimport MDI_Upload from 'vue-material-design-icons/Upload.vue'\nimport MDI_Warn from 'vue-material-design-icons/Alert.vue'\nimport MDI_Web from 'vue-material-design-icons/Web.vue'\nimport MDI_TranslateVariant from 'vue-material-design-icons/TranslateVariant.vue'\n\nconst DEFAULT_ICON_SIZE = 20\n\nconst makeIcon = (original) => ({\n\tfunctional: true,\n\trender(h, { data, props }) {\n\t\treturn h(original, {\n\t\t\tdata,\n\t\t\tkey: data.key,\n\t\t\tstaticClass: data.staticClass,\n\t\t\tprops: { size: DEFAULT_ICON_SIZE, ...props },\n\t\t})\n\t},\n})\n\nexport const Loading = {\n\tfunctional: true,\n\trender(h, { data, props }) {\n\t\treturn h(MDI_Loading, {\n\t\t\tdata,\n\t\t\tstaticClass: 'animation-rotate',\n\t\t\tprops: { size: DEFAULT_ICON_SIZE, ...props },\n\t\t})\n\t},\n}\n\nexport const AlphabeticalVariant = makeIcon(MDI_AlphabeticalVariant)\nexport const AlignHorizontalCenter = makeIcon(MDI_AlignHorizontalCenter)\nexport const AlignHorizontalLeft = makeIcon(MDI_AlignHorizontalLeft)\nexport const AlignHorizontalRight = makeIcon(MDI_AlignHorizontalRight)\nexport const Close = makeIcon(MDI_Close)\nexport const Check = makeIcon(MDI_Check)\nexport const CodeTags = makeIcon(MDI_CodeTags)\nexport const CircleMedium = makeIcon(MDI_CircleMedium)\nexport const Danger = makeIcon(MDI_Danger)\nexport const Delete = makeIcon(MDI_Delete)\nexport const Document = makeIcon(MDI_Document)\nexport const DotsHorizontal = makeIcon(MDI_DotsHorizontal)\nexport const Emoticon = makeIcon(MDI_Emoticon)\nexport const Folder = makeIcon(MDI_Folder)\nexport const FormatBold = makeIcon(MDI_FormatBold)\nexport const FormatHeader1 = makeIcon(MDI_FormatHeader1)\nexport const FormatHeader2 = makeIcon(MDI_FormatHeader2)\nexport const FormatHeader3 = makeIcon(MDI_FormatHeader3)\nexport const FormatHeader4 = makeIcon(MDI_FormatHeader4)\nexport const FormatHeader5 = makeIcon(MDI_FormatHeader5)\nexport const FormatHeader6 = makeIcon(MDI_FormatHeader6)\nexport const FormatItalic = makeIcon(MDI_FormatItalic)\nexport const FormatListBulleted = makeIcon(MDI_FormatListBulleted)\nexport const FormatListCheckbox = makeIcon(MDI_FormatListCheckbox)\nexport const FormatListNumbered = makeIcon(MDI_FormatListNumbered)\nexport const FormatQuote = makeIcon(MDI_FormatQuote)\nexport const FormatStrikethrough = makeIcon(MDI_FormatStrikethrough)\nexport const FormatUnderline = makeIcon(MDI_FormatUnderline)\nexport const Help = makeIcon(MDI_Help)\nexport const Image = makeIcon(MDI_Image)\nexport const Images = makeIcon(MDI_Images)\nexport const Info = makeIcon(MDI_Info)\nexport const LinkIcon = makeIcon(MDI_Link)\nexport const LinkOff = makeIcon(MDI_LinkOff)\nexport const LinkVariantPlus = makeIcon(MDI_LinkVariantPlus)\nexport const Lock = makeIcon(MDI_Lock)\nexport const Positive = makeIcon(MDI_Positive)\nexport const Redo = makeIcon(MDI_Redo)\nexport const Shape = makeIcon(MDI_Shape)\nexport const Table = makeIcon(MDI_Table)\nexport const TableAddColumnAfter = makeIcon(MDI_TableAddColumnAfter)\nexport const TableAddColumnBefore = makeIcon(MDI_TableAddColumnBefore)\nexport const TableAddRowAfter = makeIcon(MDI_TableAddRowAfter)\nexport const TableAddRowBefore = makeIcon(MDI_TableAddRowBefore)\nexport const TableSettings = makeIcon(MDI_TableSettings)\nexport const TrashCan = makeIcon(MDI_TrashCan)\nexport const TranslateVariant = makeIcon(MDI_TranslateVariant)\nexport const Undo = makeIcon(MDI_Undo)\nexport const Upload = makeIcon(MDI_Upload)\nexport const Warn = makeIcon(MDI_Warn)\nexport const Web = makeIcon(MDI_Web)\n","import { CollaborationCursor as TiptapCollaborationCursor } from '@tiptap/extension-collaboration-cursor'\n\n/**\n * Show cursor for client ID\n * Wait 50ms for cases where the cursor gets re-rendered\n *\n * @param {number} clientId The Yjs client ID\n */\nfunction showCursorLabel(clientId) {\n\tsetTimeout(() => {\n\t\tconst el = document.getElementById(`collaboration-cursor__label__${clientId}`)\n\t\tif (!el) {\n\t\t\treturn\n\t\t}\n\n\t\tel.classList.add('collaboration-cursor__label__active')\n\t\tsetTimeout(() => {\n\t\t\tel?.classList.remove('collaboration-cursor__label__active')\n\t\t}, 50)\n\t}, 50)\n}\n\n/**\n * Unix timestamp in seconds.\n */\nfunction getTimestamp() {\n\treturn Math.floor(Date.now() / 1000)\n}\n\nconst CollaborationCursor = TiptapCollaborationCursor.extend({\n\taddOptions() {\n\t\treturn {\n\t\t\tprovider: null,\n\t\t\tuser: {\n\t\t\t\tname: null,\n\t\t\t\tclientId: null,\n\t\t\t\tcolor: null,\n\t\t\t\tlastUpdate: getTimestamp(),\n\t\t\t},\n\t\t\trender: user => {\n\t\t\t\tconst cursor = document.createElement('span')\n\n\t\t\t\tcursor.classList.add('collaboration-cursor__caret')\n\t\t\t\tcursor.setAttribute('style', `border-color: ${user.color}`)\n\n\t\t\t\tconst label = document.createElement('div')\n\n\t\t\t\tlabel.classList.add('collaboration-cursor__label')\n\t\t\t\tlabel.id = `collaboration-cursor__label__${user.clientId}`\n\t\t\t\tlabel.setAttribute('style', `background-color: ${user.color}`)\n\t\t\t\tlabel.insertBefore(document.createTextNode(user.name), null)\n\t\t\t\tcursor.insertBefore(label, null)\n\n\t\t\t\treturn cursor\n\t\t\t},\n\t\t}\n\t},\n\n\tonCreate() {\n\t\tthis.options.provider.awareness.on('change', ({ added, removed, updated }, origin) => {\n\t\t\tif (origin !== 'local') {\n\t\t\t\tfor (const clientId of [...added, ...updated]) {\n\t\t\t\t\tif (clientId !== this.options.user.clientId) {\n\t\t\t\t\t\tshowCursorLabel(clientId)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t},\n\n\t// Flag own cursor as active on undoable changes to the document state\n\tonTransaction({ transaction }) {\n\t\tconst { updated, meta } = transaction\n\t\tif (updated && (meta.addToHistory ?? true) && !meta.pointer) {\n\t\t\tthis.options.user.lastUpdate = getTimestamp()\n\t\t\tthis.options.provider.awareness.setLocalStateField('user', this.options.user)\n\t\t}\n\t},\n})\n\nexport default CollaborationCursor\n","/*\n * @copyright Copyright (c) 2021 Jonas <jonas@freesources.org>\n *\n * @author Jonas <jonas@freesources.org>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport { Node } from '@tiptap/core'\nimport { PluginKey } from '@tiptap/pm/state'\n// eslint-disable-next-line import/no-named-as-default\nimport Suggestion from '@tiptap/suggestion'\n\nexport const EmojiPluginKey = new PluginKey('emoji')\n\nconst Emoji = Node.create({\n\tname: 'emoji',\n\n\taddOptions() {\n\t\treturn {\n\t\t\tHTMLAttributes: {},\n\t\t\tsuggestion: {\n\t\t\t\tchar: ':',\n\t\t\t\tallowedPrefixes: [' '],\n\t\t\t\tpluginKey: EmojiPluginKey,\n\t\t\t},\n\t\t}\n\t},\n\n\tcontent: 'text*',\n\n\taddCommands() {\n\t\treturn {\n\t\t\temoji: (emojiObject) => ({ commands }) => {\n\t\t\t\treturn commands.insertContent(emojiObject.native + ' ')\n\t\t\t},\n\t\t}\n\t},\n\n\taddProseMirrorPlugins() {\n\t\treturn [\n\t\t\tSuggestion({\n\t\t\t\teditor: this.editor,\n\t\t\t\t...this.options.suggestion,\n\t\t\t}),\n\t\t]\n\t},\n})\n\nexport default Emoji\n","import { Extension } from '@tiptap/core'\n\nlet ownPaused = false\n\nconst toggleFocusTrap = ({ editor }) => {\n\tconst trapStack = window._nc_focus_trap ?? []\n\tconst activeTrap = trapStack[trapStack.length - 1]\n\n\tconst possibleEditorTabCommand = editor.can().sinkListItem('listItem')\n\t\t|| editor.can().goToNextCell()\n\t\t|| editor.can().goToPreviousCell()\n\n\tif (possibleEditorTabCommand) {\n\t\tactiveTrap?.pause()\n\t\townPaused = true\n\t} else {\n\t\tif (ownPaused) {\n\t\t\townPaused = false\n\t\t\tactiveTrap?.unpause()\n\t\t}\n\t}\n}\n\nconst unpauseFocusTrap = ({ editor }) => {\n\tconst trapStack = window._nc_focus_trap ?? []\n\tconst activeTrap = trapStack[trapStack.length - 1]\n\n\tactiveTrap?.unpause()\n}\n\n/**\n * The viewer focus trap needs to be paused on the fly in order to properly handle tab commands in the editor,\n * as we have no control over if a tab key event is reaching the editor otherwise. This is because the focus trap\n * registeres a capture listener (https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener#capture), so whenever we reach a tab command in the editor the focus trap will already have captured the event.\n *\n * We also cannot work around this by pushing our own focus trap to the stack, as the focus trap package does not offer any reliable way to programmatically focus the next element of the parent trap if we allow tabbing out of the editor.\n */\nconst FocusTrap = Extension.create({\n\tname: 'focustrap',\n\tonFocus: toggleFocusTrap,\n\tonBlur: unpauseFocusTrap,\n\tonSelectionUpdate: toggleFocusTrap,\n\tonTransaction: toggleFocusTrap,\n\tonUpdate: toggleFocusTrap,\n})\n\nexport default FocusTrap\n","import { Mark } from '@tiptap/core'\n\n/**\n * Keep markdown untouched\n */\nconst KeepSyntax = Mark.create({\n\tname: 'keep-syntax',\n\tparseHTML() {\n\t\treturn [\n\t\t\t{\n\t\t\t\ttag: 'span.keep-md',\n\t\t\t},\n\t\t]\n\t},\n\trenderHTML() {\n\t\treturn ['span', { class: 'keep-md' }, 0]\n\t},\n\ttoMarkdown: {\n\t\topen: '',\n\t\tclose: '',\n\t\tmixable: true,\n\t\tescape: false,\n\t\texpelEnclosingWhitespace: true,\n\t},\n\n\t/**\n\t * Remove mark if there were manual changes\n\t */\n\tonUpdate() {\n\t\tconst tr = this.editor.state.tr\n\n\t\tthis.editor.state.doc.descendants((node, pos, parent, index) => {\n\t\t\tif (node.marks.findIndex(mark => mark.type.name === this.name) !== -1) {\n\t\t\t\tif (node.type.name !== 'text' || node.text.length !== 1) {\n\t\t\t\t\ttr.removeMark(pos, pos + node.nodeSize, this.type)\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t\tif (tr.docChanged) {\n\t\t\ttr.setMeta('addToHistory', false)\n\t\t\ttr.setMeta('preventUpdate', true)\n\t\t\tthis.editor.view.dispatch(tr)\n\t\t}\n\t},\n})\n\nexport default KeepSyntax\n","/*\n * @copyright Copyright (c) 2019 Julius Hrtl <jus@bitgrid.net>\n *\n * @author Julius Hrtl <jus@bitgrid.net>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport { Extension } from '@tiptap/core'\nimport { Plugin } from '@tiptap/pm/state'\n\nconst Keymap = Extension.create({\n\n\tname: 'customkeymap',\n\n\taddKeyboardShortcuts() {\n\t\treturn this.options\n\t},\n\n\taddProseMirrorPlugins() {\n\t\treturn [\n\t\t\tnew Plugin({\n\t\t\t\tprops: {\n\t\t\t\t\thandleKeyDown(view, event) {\n\t\t\t\t\t\tconst key = event.key || event.keyCode\n\t\t\t\t\t\tif ((event.ctrlKey || event.metaKey) && !event.shiftKey && (key === 'f' || key === 70)) {\n\t\t\t\t\t\t\t// We need to stop propagation and dispatch the event on the window\n\t\t\t\t\t\t\t// in order to force triggering the browser native search in the text editor\n\t\t\t\t\t\t\tevent.stopPropagation()\n\t\t\t\t\t\t\twindow.dispatchEvent(event)\n\t\t\t\t\t\t\treturn true\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (event.key === 'Delete' && event.ctrlKey === true) {\n\t\t\t\t\t\t\t// Prevent deleting the file, by core Viewer.vue\n\t\t\t\t\t\t\tevent.stopPropagation()\n\t\t\t\t\t\t\twindow.dispatchEvent(event)\n\t\t\t\t\t\t\treturn true\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t}),\n\t\t]\n\t},\n\n})\n\nexport default Keymap\n","/**\n * @copyright Copyright (c) 2023 Max <max@nextcloud.com>\n *\n * @author Max <max@nextcloud.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n/**\n *\n * Prepare pasted html for insertion into tiptap\n *\n * We render paragraphs with `white-space: pre-wrap`\n * so newlines are visible and preserved.\n *\n * Pasted html may contain newlines inside tags with a different `white-space` style.\n * They are not visible in the source.\n * Strip them so the pasted result wraps nicely.\n *\n * At the same time we need to preserve whitespace inside `<pre>` tags\n * and the like.\n *\n * @param {string} html Pasted html content\n */\nexport default function(html) {\n\tconst parser = new DOMParser()\n\tconst doc = parser.parseFromString(html, 'text/html')\n\tforAllTextNodes(doc, textNode => {\n\t\tif (collapseWhiteSpace(textNode)) {\n\t\t\ttextNode.textContent = textNode.textContent.replaceAll('\\n', ' ')\n\t\t}\n\t})\n\treturn doc.body.innerHTML\n}\n\n/**\n *\n * Run function for all text nodes in the document.\n *\n * @param {Document} doc Html document to process\n * @param {Function} fn Function to run\n *\n */\nfunction forAllTextNodes(doc, fn) {\n\tconst nodeIterator = doc.createNodeIterator(\n\t\tdoc.body,\n\t\tNodeFilter.SHOW_TEXT,\n\t)\n\tlet currentNode = nodeIterator.nextNode()\n\twhile (currentNode) {\n\t\tfn(currentNode)\n\t\tcurrentNode = nodeIterator.nextNode()\n\t}\n}\n\n/**\n *\n * Check if newlines need to be collapsed based on the applied style\n *\n * @param {Text} textNode Text to check the style for\n *\n */\nfunction collapseWhiteSpace(textNode) {\n\t// Values of `white-space` css that will collapse newline whitespace\n\t// See https://developer.mozilla.org/en-US/docs/Web/CSS/white-space#values\n\tconst COLLAPSING_WHITE_SPACE_VALUES = ['normal', 'nowrap']\n\tlet ancestor = textNode.parentElement\n\twhile (ancestor) {\n\t\t// Chrome does not support getComputedStyle on detached dom\n\t\t// https://lists.w3.org/Archives/Public/www-style/2018May/0031.html\n\t\t// Therefore the following logic only works on Firefox\n\t\tconst style = getComputedStyle(ancestor)\n\t\tconst whiteSpace = style?.getPropertyValue('white-space')\n\t\tif (whiteSpace) {\n\t\t\t// Returns false if white-space has a value not listed in COLLAPSING_WHITE_SPACE_VALUES\n\t\t\treturn COLLAPSING_WHITE_SPACE_VALUES.includes(whiteSpace)\n\t\t}\n\n\t\t// Check for `tagName` as fallback on Chrome\n\t\tif (ancestor.tagName === 'PRE') {\n\t\t\treturn false\n\t\t}\n\t\tancestor = ancestor.parentElement\n\t}\n\treturn true\n}\n","/**\n * @copyright Copyright (c) 2022 Max <max@nextcloud.com>\n *\n * @author Max <max@nextcloud.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n/*\n * Tiptap extension to ease customize the serialization to markdown\n *\n * Most markdown serialization can be handled by `prosemirror-markdown`.\n * In order to make it easier to add custom markdown rendering\n * this extension will extend the prosemirror schema for nodes and marks\n * with a `toMarkdown` specification if that is defined in a tiptap extension.\n *\n * For nodes `toMarkown` should be function\n * that take a serializer state and such a node, and serializes the node.\n *\n * For marks `toMarkdown` is an object with open and close properties,\n * which hold the strings that should appear before and after.\n *\n * For more details see\n * https://github.com/ProseMirror/prosemirror-markdown#class-markdownserializer\n */\n\nimport { Extension, getExtensionField } from '@tiptap/core'\nimport { Plugin, PluginKey } from '@tiptap/pm/state'\nimport { MarkdownSerializer, defaultMarkdownSerializer } from '@tiptap/pm/markdown'\nimport { DOMParser } from '@tiptap/pm/model'\nimport markdownit from '../markdownit/index.js'\nimport transformPastedHTML from './transformPastedHTML.js'\n\nconst Markdown = Extension.create({\n\n\tname: 'markdown',\n\n\textendMarkSchema(extension) {\n\t\tconst context = {\n\t\t\tname: extension.name,\n\t\t\toptions: extension.options,\n\t\t\tstorage: extension.storage,\n\t\t}\n\t\treturn {\n\t\t\ttoMarkdown: getExtensionField(extension, 'toMarkdown', context),\n\t\t}\n\t},\n\n\textendNodeSchema(extension) {\n\t\tconst context = {\n\t\t\tname: extension.name,\n\t\t\toptions: extension.options,\n\t\t\tstorage: extension.storage,\n\t\t}\n\t\treturn {\n\t\t\ttoMarkdown: getExtensionField(extension, 'toMarkdown', context),\n\t\t}\n\t},\n\n\taddProseMirrorPlugins() {\n\t\tlet shiftKey = false\n\n\t\treturn [\n\t\t\t// Parse markdown unless Mod+Shift+V is pressed for text clipboard content\n\t\t\tnew Plugin({\n\t\t\t\tkey: new PluginKey('pasteEventHandler'),\n\t\t\t\tprops: {\n\t\t\t\t\thandleDOMEvents: {\n\t\t\t\t\t\tmouseup(_, event) {\n\t\t\t\t\t\t\tshiftKey = event.shiftKey\n\t\t\t\t\t\t\treturn false\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\thandleKeyDown(_, event) {\n\t\t\t\t\t\tshiftKey = event.shiftKey\n\t\t\t\t\t\treturn false\n\t\t\t\t\t},\n\t\t\t\t\tclipboardTextParser(str, $context, _, view) {\n\t\t\t\t\t\tconst parser = DOMParser.fromSchema(view.state.schema)\n\t\t\t\t\t\tconst doc = document.cloneNode(false)\n\t\t\t\t\t\tconst dom = doc.createElement('div')\n\t\t\t\t\t\tif (shiftKey) {\n\t\t\t\t\t\t\t// Treat double newlines as paragraph breaks when pasting as plaintext\n\t\t\t\t\t\t\tfor (const part of str.split('\\n\\n')) {\n\t\t\t\t\t\t\t\tconst para = doc.createElement('p')\n\t\t\t\t\t\t\t\t// Treat single newlines as linebreaks\n\t\t\t\t\t\t\t\tpara.innerText = part\n\t\t\t\t\t\t\t\tdom.append(para)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdom.innerHTML = markdownit.render(str)\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn parser.parseSlice(dom, { preserveWhitespace: true, context: $context })\n\t\t\t\t\t},\n\t\t\t\t\tclipboardTextSerializer: (slice) => {\n\t\t\t\t\t\tconst traverseNodes = (slice) => {\n\t\t\t\t\t\t\tif (slice.content.childCount > 1) {\n\t\t\t\t\t\t\t\treturn clipboardSerializer(this.editor.schema).serialize(slice.content)\n\t\t\t\t\t\t\t} else if (slice.isLeaf) {\n\t\t\t\t\t\t\t\treturn slice.textContent\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\treturn traverseNodes(slice.content.firstChild)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn traverseNodes(slice)\n\t\t\t\t\t},\n\t\t\t\t\ttransformPastedHTML,\n\t\t\t\t},\n\t\t\t}),\n\t\t]\n\t},\n})\n\nconst createMarkdownSerializer = ({ nodes, marks }) => {\n\treturn {\n\t\tserializer: new MarkdownSerializer(\n\t\t\textractNodesToMarkdown(nodes),\n\t\t\textractMarksToMarkdown(marks),\n\t\t),\n\t\tserialize(content, options) {\n\t\t\treturn this.serializer.serialize(content, { ...options, tightLists: true })\n\t\t},\n\t}\n}\n\nconst clipboardSerializer = ({ nodes, marks }) => {\n\treturn {\n\t\tserializer: new MarkdownSerializer(\n\t\t\textractNodesToMarkdown(nodes),\n\t\t\textractToPlaintext(marks),\n\t\t),\n\t\tserialize(content, options) {\n\t\t\treturn this.serializer.serialize(content, { ...options, tightLists: true })\n\t\t},\n\t}\n}\n\nconst extractToPlaintext = (marks) => {\n\tconst blankMark = { open: '', close: '', mixable: true, expelEnclosingWhitespace: true }\n\tconst defaultMarks = convertNames(defaultMarkdownSerializer.marks)\n\tconst markEntries = Object.entries({ ...defaultMarks, ...marks })\n\t\t.map(([name, _mark]) => [name, blankMark])\n\n\treturn Object.fromEntries(markEntries)\n}\n\nconst extractToMarkdown = (nodesOrMarks) => {\n\tconst nodeOrMarkEntries = Object\n\t\t.entries(nodesOrMarks)\n\t\t.map(([name, nodeOrMark]) => [name, nodeOrMark.spec.toMarkdown])\n\t\t.filter(([, toMarkdown]) => toMarkdown)\n\n\treturn Object.fromEntries(nodeOrMarkEntries)\n}\n\nconst extractNodesToMarkdown = (nodes) => {\n\tconst defaultNodes = convertNames(defaultMarkdownSerializer.nodes)\n\tconst nodesToMarkdown = extractToMarkdown(nodes)\n\treturn { ...defaultNodes, ...nodesToMarkdown }\n}\n\nconst extractMarksToMarkdown = (marks) => {\n\tconst defaultMarks = convertNames(defaultMarkdownSerializer.marks)\n\tconst marksToMarkdown = extractToMarkdown(marks)\n\treturn { ...defaultMarks, ...marksToMarkdown }\n}\n\nconst convertNames = (object) => {\n\tconst convert = (name) => {\n\t\treturn name.replace(/_(\\w)/g, (_m, letter) => letter.toUpperCase())\n\t}\n\treturn Object.fromEntries(\n\t\tObject.entries(object)\n\t\t\t.map(([name, value]) => [convert(name), value]),\n\t)\n}\n\nexport { createMarkdownSerializer }\nexport default Markdown\n","<template>\n\t<NodeViewWrapper as=\"span\" class=\"mention\" contenteditable=\"false\">\n\t\t<NcUserBubble :user=\"node.attrs.id\"\n\t\t\t:display-name=\"username\"\n\t\t\t:primary=\"isCurrentUser\"\n\t\t\tclass=\"mention-user-bubble\">\n\t\t\t@{{ username }}\n\t\t</NcUserBubble>\n\t</NodeViewWrapper>\n</template>\n\n<script>\nimport { NcUserBubble } from '@nextcloud/vue'\nimport { NodeViewWrapper } from '@tiptap/vue-2'\nimport { getCurrentUser } from '@nextcloud/auth'\n\nexport default {\n\tname: 'Mention',\n\tcomponents: {\n\t\tNcUserBubble,\n\t\tNodeViewWrapper,\n\t},\n\tprops: {\n\t\tupdateAttributes: {\n\t\t\ttype: Function,\n\t\t\trequired: true,\n\t\t},\n\n\t\tnode: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tusername: this.node.attrs.label,\n\t\t}\n\t},\n\tcomputed: {\n\t\tisCurrentUser() {\n\t\t\treturn this.node.attrs.id === getCurrentUser()?.uid\n\t\t},\n\t},\n}\n</script>\n<style scoped>\n/* This is required to properly render the bubble text (which seems linke a browser bug) */\n.text-editor__wrapper div.ProseMirror .mention[contenteditable=false] :deep(*) {\n\t-webkit-user-modify: read-only !important;\n}\n</style>\n","import mod from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Mention.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Mention.vue?vue&type=script&lang=js\"","\n      import API from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Mention.vue?vue&type=style&index=0&id=297bb5fa&prod&scoped=true&lang=css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Mention.vue?vue&type=style&index=0&id=297bb5fa&prod&scoped=true&lang=css\";\n       export default content && content.locals ? content.locals : undefined;\n","import { render, staticRenderFns } from \"./Mention.vue?vue&type=template&id=297bb5fa&scoped=true\"\nimport script from \"./Mention.vue?vue&type=script&lang=js\"\nexport * from \"./Mention.vue?vue&type=script&lang=js\"\nimport style0 from \"./Mention.vue?vue&type=style&index=0&id=297bb5fa&prod&scoped=true&lang=css\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"297bb5fa\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('NodeViewWrapper',{staticClass:\"mention\",attrs:{\"as\":\"span\",\"contenteditable\":\"false\"}},[_c('NcUserBubble',{staticClass:\"mention-user-bubble\",attrs:{\"user\":_vm.node.attrs.id,\"display-name\":_vm.username,\"primary\":_vm.isCurrentUser}},[_vm._v(\"\\n\\t\\t@\"+_vm._s(_vm.username)+\"\\n\\t\")])],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import TipTapMention from '@tiptap/extension-mention'\nimport Mention from './Mention.vue'\nimport { VueNodeViewRenderer } from '@tiptap/vue-2'\nimport { mergeAttributes } from '@tiptap/core'\n\nexport default TipTapMention.extend({\n\tparseHTML() {\n\t\treturn [\n\t\t\t{\n\t\t\t\ttag: 'span[data-type=\"user\"]',\n\t\t\t\tgetAttrs: element => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tid: decodeURIComponent(element.getAttribute('data-id')),\n\t\t\t\t\t\tlabel: element.innerText || element.textContent || element.getAttribute('data-label'),\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tpriority: 100,\n\t\t\t},\n\t\t]\n\t},\n\n\trenderHTML({ node, HTMLAttributes }) {\n\t\treturn [\n\t\t\t'span',\n\t\t\tmergeAttributes({ 'data-type': 'user', class: 'mention' }, this.options.HTMLAttributes, HTMLAttributes),\n\t\t\tthis.options.renderHTML({\n\t\t\t\toptions: this.options,\n\t\t\t\tnode,\n\t\t\t}),\n\t\t]\n\t},\n\n\taddNodeView() {\n\t\treturn VueNodeViewRenderer(Mention)\n\t},\n\n\ttoMarkdown(state, node) {\n\t\tstate.write(`@[${node.attrs.label}](mention://user/${encodeURIComponent(node.attrs.id)})`)\n\t},\n})\n","/*\n * @copyright Copyright (c) 2019 Julius Hrtl <jus@bitgrid.net>\n *\n * @author Julius Hrtl <jus@bitgrid.net>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport { Node } from '@tiptap/core'\n\nexport default Node.create({\n\tname: 'doc',\n\tcontent: 'block',\n\taddKeyboardShortcuts() {\n\t\treturn {\n\t\t\tTab: () => this.editor.commands.insertContent('\\t'),\n\t\t}\n\t},\n\n})\n","/*\n * @copyright Copyright (c) 2022 Max <max@nextcloud.com>\n *\n * @author Max <max@nextcloud.com>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n*/\n\nimport { Extension } from '@tiptap/core'\n\n/* eslint-disable import/no-named-as-default */\nimport Text from '@tiptap/extension-text'\nimport PlainTextDocument from './../nodes/PlainTextDocument.js'\n\nexport default Extension.create({\n\tname: 'PlainText',\n\n\taddExtensions() {\n\t\treturn [\n\t\t\tPlainTextDocument,\n\t\t\tText,\n\t\t]\n\t},\n\n})\n","/*\n * @copyright Copyright (c) 2020 Julius Hrtl <jus@bitgrid.net>\n *\n * @author Julius Hrtl <jus@bitgrid.net>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport TiptapBulletList from '@tiptap/extension-bullet-list'\nimport { listInputRule } from '../commands/index.js'\n\n/* We want to allow for `* [ ]` as an input rule for bullet lists.\n * Therefore the list input rules need to check the input\n * until the first char after the space.\n * Only there we know the user is not trying to create a task list.\n */\nconst BulletList = TiptapBulletList.extend({\n\tparseHTML() {\n\t\treturn this.parent().map(rule => Object.assign(rule, { preserveWhitespace: true }))\n\t},\n\n\taddAttributes() {\n\t\treturn {\n\t\t\t...this.parent?.(),\n\t\t\tbullet: {\n\t\t\t\tdefault: '-',\n\t\t\t\trendered: false,\n\t\t\t\tisRequired: true,\n\t\t\t\tparseHTML: (el) => el.getAttribute('data-bullet'),\n\t\t\t},\n\t\t}\n\t},\n\n\taddInputRules() {\n\t\treturn [\n\t\t\tlistInputRule(\n\t\t\t\t/^\\s*([-+*])\\s([^\\s[]+)$/,\n\t\t\t\tthis.type,\n\t\t\t),\n\t\t]\n\t},\n\n})\n\nexport default BulletList\n","/*\n * @copyright Copyright (c) 2021 Jonas Meurer <jonas@freesources.org>\n *\n * @author Jonas Meurer <jonas@freesources.org>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport { InputRule, wrappingInputRule } from '@tiptap/core'\n\n/**\n * Wrapping input handler that will append the content of the last match\n *\n * @param {RegExp} find find param for the wrapping input rule\n * @param {object} type Node Type object\n * @param {*} getAttributes handler to get the attributes\n */\nexport default function(find, type, getAttributes) {\n\tconst handler = ({ state, range, match }) => {\n\t\tconst wrap = wrappingInputRule({ find, type, getAttributes })\n\t\twrap.handler({ state, range, match })\n\t\t// Insert the first character after bullet if there is one\n\t\tif (match.length >= 3) {\n\t\t\tstate.tr.insertText(match[2])\n\t\t}\n\t}\n\treturn new InputRule({ find, handler })\n}\n","<!--\n  - @copyright Copyright (c) 2022 Vinicius Reis <vinicius@nextcloud.com>\n  -\n  - @author Vinicius Reis <vinicius@nextcloud.com>\n  -\n  - @license GNU AGPL version 3 or any later version\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\n  -\n  -->\n<template>\n\t<NodeViewWrapper data-text-el=\"callout\"\n\t\tclass=\"callout\"\n\t\t:class=\"`callout--${type}`\"\n\t\tas=\"div\">\n\t\t<component :is=\"icon\" class=\"callout__icon\" />\n\t\t<NodeViewContent class=\"callout__content\" />\n\t</NodeViewWrapper>\n</template>\n\n<script>\nimport { NodeViewWrapper, NodeViewContent } from '@tiptap/vue-2'\nimport { Positive, Warn, Danger, Info } from '../components/icons.js'\n\nconst ICONS_MAP = {\n\tinfo: Info,\n\tsuccess: Positive,\n\terror: Danger,\n\twarn: Warn,\n}\n\nexport default {\n\t// eslint-disable-next-line vue/match-component-file-name\n\tname: 'Callout',\n\tcomponents: {\n\t\tNodeViewWrapper,\n\t\tNodeViewContent,\n\t},\n\tprops: {\n\t\tnode: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\ticon() {\n\t\t\treturn ICONS_MAP[this.type] || Info\n\t\t},\n\t\ttype() {\n\t\t\treturn this.node?.attrs?.type || 'info'\n\t\t},\n\t},\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.callout {\n\tbackground-color: var(--callout-background, var(--color-background-hover));\n\tborder-left-color: var(--callout-border, var(--color-primary-element));\n\tborder-radius: var(--border-radius);\n\tpadding: 1em;\n\tpadding-left: 0.5em;\n\tborder-left-width: 0.3em;\n\tborder-left-style: solid;\n\tposition: relative;\n\tmargin-bottom: 0.5em;\n\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: flex-start;\n\n\t&+ * {\n\t\tmargin-top: 0.5em;\n\t}\n\n\t.callout__content {\n\t\tmargin-left: 1em;\n\t\t&:deep(p) {\n\t\t\t&:last-child {\n\t\t\t\tmargin-bottom: 0;\n\t\t\t}\n\t\t}\n\t}\n\n\t.callout__icon {\n\t\t&, :deep(svg) {\n\t\t\tcolor: var(--callout-border);\n\t\t}\n\t}\n\n\t// Info (default) variables\n\t&, &--info {\n\t\t--callout-border: var(--color-info, #006aa3);\n\t}\n\n\t// Warn variables\n\t&--warn {\n\t\t--callout-border: var(--color-warning);\n\t}\n\n\t// Error variables\n\t&--error {\n\t\t--callout-border: var(--color-error);\n\t}\n\n\t// Success variables\n\t&--success {\n\t\t--callout-border: var(--color-success);\n\t}\n}\n</style>\n","import mod from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Callout.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Callout.vue?vue&type=script&lang=js\"","\n      import API from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/sass-loader/dist/cjs.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Callout.vue?vue&type=style&index=0&id=4387ae9f&prod&lang=scss&scoped=true\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/sass-loader/dist/cjs.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Callout.vue?vue&type=style&index=0&id=4387ae9f&prod&lang=scss&scoped=true\";\n       export default content && content.locals ? content.locals : undefined;\n","import { render, staticRenderFns } from \"./Callout.vue?vue&type=template&id=4387ae9f&scoped=true\"\nimport script from \"./Callout.vue?vue&type=script&lang=js\"\nexport * from \"./Callout.vue?vue&type=script&lang=js\"\nimport style0 from \"./Callout.vue?vue&type=style&index=0&id=4387ae9f&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4387ae9f\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('NodeViewWrapper',{staticClass:\"callout\",class:`callout--${_vm.type}`,attrs:{\"data-text-el\":\"callout\",\"as\":\"div\"}},[_c(_vm.icon,{tag:\"component\",staticClass:\"callout__icon\"}),_vm._v(\" \"),_c('NodeViewContent',{staticClass:\"callout__content\"})],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","/*\n * @copyright Copyright (c) 2022 Vinicius Reis <vinicius@nextcloud.com>\n *\n * @author Vinicius Reis <vinicius@nextcloud.com>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport { Node, isNodeActive, mergeAttributes } from '@tiptap/core'\nimport { VueNodeViewRenderer } from '@tiptap/vue-2'\nimport { typesAvailable } from './../markdownit/callouts.js'\n\nimport Callout from './Callout.vue'\n\nexport default Node.create({\n\n\tname: 'callout',\n\n\tcontent: 'paragraph+',\n\n\tgroup: 'block',\n\n\tdefining: true,\n\n\taddOptions() {\n\t\treturn {\n\t\t\ttypes: typesAvailable,\n\t\t\tHTMLAttributes: {\n\t\t\t\tclass: 'callout',\n\t\t\t},\n\t\t}\n\t},\n\n\taddAttributes() {\n\t\treturn {\n\t\t\ttype: {\n\t\t\t\tdefault: 'info',\n\t\t\t\trendered: false,\n\t\t\t\tparseHTML: element => {\n\t\t\t\t\treturn element.getAttribute('data-callout')\n\t\t\t\t\t\t|| typesAvailable.find((type) => element.classList.contains(type))\n\t\t\t\t\t\t|| (element.classList.contains('warning') && 'warn')\n\t\t\t\t},\n\t\t\t\trenderHTML: attributes => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\t'data-callout': attributes.type,\n\t\t\t\t\t\tclass: `callout-${attributes.type}`,\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t}\n\t},\n\n\tparseHTML() {\n\t\treturn [\n\t\t\t{\n\t\t\t\ttag: 'div.callout',\n\t\t\t},\n\t\t\t{\n\t\t\t\ttag: 'p.callout',\n\t\t\t\tpriority: 1001,\n\t\t\t},\n\t\t]\n\t},\n\n\trenderHTML({ node, HTMLAttributes }) {\n\t\tconst { class: classy } = this.options.HTMLAttributes\n\n\t\tconst attributes = {\n\t\t\t...this.options.HTMLAttributes,\n\t\t\t'data-callout': node.attrs.type,\n\t\t\tclass: `${classy} ${classy}-${node.attrs.type}`,\n\t\t}\n\n\t\treturn ['div', mergeAttributes(attributes, HTMLAttributes), 0]\n\t},\n\n\ttoMarkdown: (state, node) => {\n\t\tstate.write('::: ' + (node.attrs.type || 'info') + '\\n')\n\t\tstate.renderContent(node)\n\t\tstate.ensureNewLine()\n\t\tstate.write(':::')\n\t\tstate.closeBlock(node)\n\t},\n\n\taddNodeView() {\n\t\treturn VueNodeViewRenderer(Callout)\n\t},\n\n\taddCommands() {\n\t\treturn {\n\t\t\tsetCallout: attributes => ({ commands }) => {\n\t\t\t\treturn commands.wrapIn(this.name, attributes)\n\t\t\t},\n\t\t\ttoggleCallout: attributes => ({ commands, state }) => {\n\t\t\t\tif (!isNodeActive(state, this.name)) {\n\t\t\t\t\treturn commands.setCallout(attributes)\n\t\t\t\t}\n\n\t\t\t\tif (!isNodeActive(state, this.name, attributes)) {\n\t\t\t\t\treturn commands.updateAttributes(this.name, attributes)\n\t\t\t\t}\n\n\t\t\t\treturn commands.unsetCallout()\n\t\t\t},\n\t\t\tunsetCallout: () => ({ commands }) => {\n\t\t\t\treturn commands.lift(this.name)\n\t\t\t},\n\t\t}\n\t},\n})\n","import { showError, showSuccess } from '@nextcloud/dialogs'\n\nexport default {\n\tdata() {\n\t\treturn {\n\t\t\tcopied: false,\n\t\t\tcopyLoading: false,\n\t\t\tcopySuccess: false,\n\t\t}\n\t},\n\n\tmethods: {\n\t\tasync copyToClipboard(content) {\n\t\t\t// change to loading status\n\t\t\tthis.copyLoading = true\n\n\t\t\t// copy link to clipboard\n\t\t\ttry {\n\t\t\t\tawait navigator.clipboard.writeText(content)\n\t\t\t\tthis.copySuccess = true\n\t\t\t\tthis.copied = true\n\n\t\t\t\t// Notify success\n\t\t\t\tshowSuccess(t('text', 'Copied to the clipboard'))\n\t\t\t} catch (error) {\n\t\t\t\tthis.copySuccess = false\n\t\t\t\tthis.copied = true\n\t\t\t\tshowError(\n\t\t\t\t\t`<div>${t('text', 'Could not copy to the clipboard')}</div>`,\n\t\t\t\t\t{ isHTML: true })\n\t\t\t} finally {\n\t\t\t\tthis.copyLoading = false\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t// stop loading status regardless of outcome\n\t\t\t\t\tthis.copySuccess = false\n\t\t\t\t\tthis.copied = false\n\t\t\t\t}, 4000)\n\t\t\t}\n\t\t},\n\t},\n}\n","import mod from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CodeBlockView.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CodeBlockView.vue?vue&type=script&lang=js\"","<template>\n\t<NodeViewWrapper as=\"div\" :data-mode=\"viewMode\" class=\"code-block\">\n\t\t<div class=\"code-block-header\">\n\t\t\t<div class=\"view-switch\">\n\t\t\t\t<NcActions :aria-label=\"t('text', 'Copy code block')\">\n\t\t\t\t\t<NcActionButton v-if=\"hasCode\"\n\t\t\t\t\t\tdata-cy=\"copy-code\"\n\t\t\t\t\t\t:aria-label=\"t('text', 'Copy code')\"\n\t\t\t\t\t\t:close-after-click=\"false\"\n\t\t\t\t\t\t@click=\"copyCode\">\n\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t<Check v-if=\"copySuccess\" :size=\"20\" />\n\t\t\t\t\t\t\t<NcLoadingIcon v-else-if=\"copyLoading\" :size=\"20\" />\n\t\t\t\t\t\t\t<ContentCopy v-else :size=\"20\" />\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</NcActionButton>\n\t\t\t\t</NcActions>\n\n\t\t\t\t<NcActions v-if=\"isEditable\"\n\t\t\t\t\tdata-cy=\"code-action-group\"\n\t\t\t\t\t:aria-label=\"t('text', 'Code block options')\">\n\t\t\t\t\t<NcActionInput :label=\"t('text', 'Code block language')\"\n\t\t\t\t\t\t:value=\"type\"\n\t\t\t\t\t\t:show-trailing-button=\"false\"\n\t\t\t\t\t\t:placeholder=\"t('text', 'e.g. php, javascript, json')\"\n\t\t\t\t\t\t@input=\"updateLanguage\">\n\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t<MarkerIcon :size=\"20\" />\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</NcActionInput>\n\n\t\t\t\t\t<NcActionSeparator v-if=\"supportPreview\" />\n\n\t\t\t\t\t<NcActionButton v-if=\"supportPreview\" :close-after-click=\"true\" @click=\"viewMode = 'code'\">\n\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t<CodeBraces :size=\"20\" />\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t{{ t('text', 'Source code') }}\n\t\t\t\t\t</NcActionButton>\n\t\t\t\t\t<NcActionButton v-if=\"supportPreview\" :close-after-click=\"true\" @click=\"viewMode = 'preview'\">\n\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t<Eye :size=\"20\" />\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t{{ t('text', 'Diagram') }}\n\t\t\t\t\t</NcActionButton>\n\t\t\t\t\t<NcActionButton v-if=\"supportPreview\" :close-after-click=\"true\" @click=\"viewMode = 'side-by-side'\">\n\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t<ViewSplitVertical :size=\"20\" />\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t{{ t('text', 'Both') }}\n\t\t\t\t\t</NcActionButton>\n\n\t\t\t\t\t<NcActionSeparator v-if=\"supportPreview\" />\n\n\t\t\t\t\t<NcActionLink v-if=\"supportPreview\" href=\"https://mermaid.js.org/intro/\" target=\"_blank\">\n\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t<Help :size=\"20\" />\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t{{ t('text', 'Mermaid documentation') }}\n\t\t\t\t\t</NcActionLink>\n\t\t\t\t</NcActions>\n\t\t\t</div>\n\t\t</div>\n\t\t<div :class=\"{'split-view': showCode && showPreview }\">\n\t\t\t<pre v-show=\"showCode\" class=\"split-view__code\"><NodeViewContent spellcheck=\"false\"\n\t\t\t\tas=\"code\"\n\t\t\t\t:contenteditable=\"isEditable\" /></pre>\n\t\t\t<div v-show=\"showPreview\"\n\t\t\t\tref=\"preview\"\n\t\t\t\tclass=\"split-view__preview\"\n\t\t\t\t:contenteditable=\"false\" />\n\t\t\t<div v-show=\"false\" :id=\"targetId\" :contenteditable=\"false\" />\n\t\t</div>\n\t</NodeViewWrapper>\n</template>\n\n<script>\nimport debounce from 'debounce'\nimport { NodeViewWrapper, NodeViewContent } from '@tiptap/vue-2'\nimport { NcActions, NcActionButton, NcActionInput, NcActionLink, NcActionSeparator, NcLoadingIcon } from '@nextcloud/vue'\nimport mermaid from 'mermaid'\nimport { v4 as uuidv4 } from 'uuid'\n\nimport ViewSplitVertical from 'vue-material-design-icons/ViewSplitVertical.vue'\nimport CodeBraces from 'vue-material-design-icons/CodeBraces.vue'\nimport Eye from 'vue-material-design-icons/Eye.vue'\nimport MarkerIcon from 'vue-material-design-icons/Marker.vue'\nimport Help from 'vue-material-design-icons/Help.vue'\nimport ContentCopy from 'vue-material-design-icons/ContentCopy.vue'\nimport Check from 'vue-material-design-icons/Check.vue'\n\nimport CopyToClipboardMixin from '../mixins/CopyToClipboardMixin.js'\n\nexport default {\n\t// eslint-disable-next-line vue/match-component-file-name\n\tname: 'CodeBlockView',\n\tcomponents: {\n\t\tMarkerIcon,\n\t\tContentCopy,\n\t\tHelp,\n\t\tCheck,\n\t\tEye,\n\t\tViewSplitVertical,\n\t\tCodeBraces,\n\t\tNcActions,\n\t\tNcActionButton,\n\t\tNcActionInput,\n\t\tNcActionLink,\n\t\tNcActionSeparator,\n\t\tNcLoadingIcon,\n\t\tNodeViewWrapper,\n\t\tNodeViewContent,\n\t},\n\tmixins: [CopyToClipboardMixin],\n\tprops: {\n\t\tnode: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\teditor: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tisEditable: false,\n\t\t\tviewMode: 'preview',\n\t\t\ttargetId: 'mermaid-view-' + uuidv4(),\n\t\t}\n\t},\n\tcomputed: {\n\t\thasCode() {\n\t\t\treturn this.node?.textContent\n\t\t},\n\t\ttype() {\n\t\t\treturn this.node?.attrs?.language || ''\n\t\t},\n\t\tsupportPreview() {\n\t\t\treturn ['mermaid'].includes(this.type)\n\t\t},\n\t\tshowCode() {\n\t\t\treturn !this.supportPreview || this.viewMode === 'code' || this.viewMode === 'side-by-side'\n\t\t},\n\t\tshowPreview() {\n\t\t\treturn this.supportPreview && (this.viewMode === 'preview' || this.viewMode === 'side-by-side')\n\t\t},\n\t\tdefaultMode() {\n\t\t\tif (this.isEditable) {\n\t\t\t\treturn 'side-by-side'\n\t\t\t} else {\n\t\t\t\treturn this.supportPreview() ? 'code' : 'preview'\n\t\t\t}\n\t\t},\n\t},\n\twatch: {\n\t\t'node.textContent'() {\n\t\t\tthis.renderMermaid()\n\t\t},\n\t},\n\tbeforeMount() {\n\t\tthis.isEditable = this.editor.isEditable\n\t\tthis.editor.on('update', ({ editor }) => {\n\t\t\tthis.isEditable = editor.isEditable\n\t\t})\n\t\tthis.renderMermaidDebounced = debounce(async function() {\n\t\t\tif (!this.supportPreview) {\n\t\t\t\tthis.viewMode = 'code'\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tconst textContent = this.node?.textContent || ''\n\t\t\tif (textContent.trim() === '') {\n\t\t\t\tthis.viewMode = this.defaultMode\n\t\t\t\tthis.$refs.preview.innerHTML = ''\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tawait mermaid.parse(textContent)\n\n\t\t\t\tconst { svg } = await mermaid.render(this.targetId, textContent)\n\t\t\t\tconst targetElement = document.getElementById(this.targetId)\n\t\t\t\tif (targetElement) {\n\t\t\t\t\ttargetElement.style.display = 'none'\n\t\t\t\t}\n\t\t\t\tthis.$refs.preview.innerHTML = svg\n\t\t\t} catch (e) {\n\t\t\t\tconsole.debug('Invalid mermaid source', e)\n\t\t\t\tif (this.viewMode === 'preview') {\n\t\t\t\t\tthis.viewMode = this.isEditable ? 'side-by-side' : 'code'\n\t\t\t\t}\n\t\t\t}\n\t\t}, 250)\n\n\t\tmermaid.initialize({ startOnLoad: false })\n\t\tthis.$nextTick(() => {\n\t\t\tthis.renderMermaid()\n\t\t})\n\t},\n\tmethods: {\n\t\tasync copyCode() {\n\t\t\tawait this.copyToClipboard(this.node?.textContent)\n\t\t},\n\t\tupdateLanguage(event) {\n\t\t\tthis.updateAttributes({\n\t\t\t\tlanguage: event.target.value,\n\t\t\t})\n\t\t},\n\t\trenderMermaid() {\n\t\t\tthis.renderMermaidDebounced()\n\t\t},\n\t},\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.code-block {\n\tbackground-color: var(--color-background-dark);\n\tborder-radius: var(--border-radius);\n}\n\n.code-block-header {\n\tdisplay: flex;\n\tflex-direction: row;\n\tjustify-content: space-between;\n\talign-items: stretch;\n\tposition: absolute;\n\tright: 12px;\n\tmargin-top: 4px;\n}\n\n.split-view {\n\tdisplay: flex;\n\tflex-direction: row;\n\tjustify-content: space-between;\n\talign-items: stretch;\n\tgap: 12px;\n\n\t& > * {\n\t\tflex: 1;\n\t}\n\n\t&__preview {\n\t\ttext-align: center;\n\t}\n}\n\n@media only screen and (max-width: 600px) {\n\t.split-view {\n\t\tflex-direction: column;\n\t}\n}\n\n.view-switch {\n\tdisplay: flex;\n\tflex-direction: row;\n}\n</style>\n","\n      import API from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/sass-loader/dist/cjs.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CodeBlockView.vue?vue&type=style&index=0&id=3451a47c&prod&lang=scss&scoped=true\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/sass-loader/dist/cjs.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CodeBlockView.vue?vue&type=style&index=0&id=3451a47c&prod&lang=scss&scoped=true\";\n       export default content && content.locals ? content.locals : undefined;\n","import { render, staticRenderFns } from \"./CodeBlockView.vue?vue&type=template&id=3451a47c&scoped=true\"\nimport script from \"./CodeBlockView.vue?vue&type=script&lang=js\"\nexport * from \"./CodeBlockView.vue?vue&type=script&lang=js\"\nimport style0 from \"./CodeBlockView.vue?vue&type=style&index=0&id=3451a47c&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3451a47c\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('NodeViewWrapper',{staticClass:\"code-block\",attrs:{\"as\":\"div\",\"data-mode\":_vm.viewMode}},[_c('div',{staticClass:\"code-block-header\"},[_c('div',{staticClass:\"view-switch\"},[_c('NcActions',{attrs:{\"aria-label\":_vm.t('text', 'Copy code block')}},[(_vm.hasCode)?_c('NcActionButton',{attrs:{\"data-cy\":\"copy-code\",\"aria-label\":_vm.t('text', 'Copy code'),\"close-after-click\":false},on:{\"click\":_vm.copyCode},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [(_vm.copySuccess)?_c('Check',{attrs:{\"size\":20}}):(_vm.copyLoading)?_c('NcLoadingIcon',{attrs:{\"size\":20}}):_c('ContentCopy',{attrs:{\"size\":20}})]},proxy:true}],null,false,2104404999)}):_vm._e()],1),_vm._v(\" \"),(_vm.isEditable)?_c('NcActions',{attrs:{\"data-cy\":\"code-action-group\",\"aria-label\":_vm.t('text', 'Code block options')}},[_c('NcActionInput',{attrs:{\"label\":_vm.t('text', 'Code block language'),\"value\":_vm.type,\"show-trailing-button\":false,\"placeholder\":_vm.t('text', 'e.g. php, javascript, json')},on:{\"input\":_vm.updateLanguage},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c('MarkerIcon',{attrs:{\"size\":20}})]},proxy:true}],null,false,3768505569)}),_vm._v(\" \"),(_vm.supportPreview)?_c('NcActionSeparator'):_vm._e(),_vm._v(\" \"),(_vm.supportPreview)?_c('NcActionButton',{attrs:{\"close-after-click\":true},on:{\"click\":function($event){_vm.viewMode = 'code'}},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c('CodeBraces',{attrs:{\"size\":20}})]},proxy:true}],null,false,2428748609)},[_vm._v(\"\\n\\t\\t\\t\\t\\t\"+_vm._s(_vm.t('text', 'Source code'))+\"\\n\\t\\t\\t\\t\")]):_vm._e(),_vm._v(\" \"),(_vm.supportPreview)?_c('NcActionButton',{attrs:{\"close-after-click\":true},on:{\"click\":function($event){_vm.viewMode = 'preview'}},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c('Eye',{attrs:{\"size\":20}})]},proxy:true}],null,false,1151454737)},[_vm._v(\"\\n\\t\\t\\t\\t\\t\"+_vm._s(_vm.t('text', 'Diagram'))+\"\\n\\t\\t\\t\\t\")]):_vm._e(),_vm._v(\" \"),(_vm.supportPreview)?_c('NcActionButton',{attrs:{\"close-after-click\":true},on:{\"click\":function($event){_vm.viewMode = 'side-by-side'}},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c('ViewSplitVertical',{attrs:{\"size\":20}})]},proxy:true}],null,false,3354721413)},[_vm._v(\"\\n\\t\\t\\t\\t\\t\"+_vm._s(_vm.t('text', 'Both'))+\"\\n\\t\\t\\t\\t\")]):_vm._e(),_vm._v(\" \"),(_vm.supportPreview)?_c('NcActionSeparator'):_vm._e(),_vm._v(\" \"),(_vm.supportPreview)?_c('NcActionLink',{attrs:{\"href\":\"https://mermaid.js.org/intro/\",\"target\":\"_blank\"},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c('Help',{attrs:{\"size\":20}})]},proxy:true}],null,false,802739225)},[_vm._v(\"\\n\\t\\t\\t\\t\\t\"+_vm._s(_vm.t('text', 'Mermaid documentation'))+\"\\n\\t\\t\\t\\t\")]):_vm._e()],1):_vm._e()],1)]),_vm._v(\" \"),_c('div',{class:{'split-view': _vm.showCode && _vm.showPreview }},[_c('pre',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.showCode),expression:\"showCode\"}],staticClass:\"split-view__code\"},[_c('NodeViewContent',{attrs:{\"spellcheck\":\"false\",\"as\":\"code\",\"contenteditable\":_vm.isEditable}})],1),_vm._v(\" \"),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.showPreview),expression:\"showPreview\"}],ref:\"preview\",staticClass:\"split-view__preview\",attrs:{\"contenteditable\":false}}),_vm._v(\" \"),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(false),expression:\"false\"}],attrs:{\"id\":_vm.targetId,\"contenteditable\":false}})])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import TiptapCodeBlockLowlight from '@tiptap/extension-code-block-lowlight'\nimport { VueNodeViewRenderer } from '@tiptap/vue-2'\nimport CodeBlockView from './CodeBlockView.vue'\n\nconst CodeBlock = TiptapCodeBlockLowlight.extend({\n\n\tparseHTML() {\n\t\treturn [\n\t\t\t{\n\t\t\t\ttag: 'pre',\n\t\t\t\tpreserveWhitespace: 'full',\n\t\t\t\t// Remove trailing newline from code blocks (#2344)\n\t\t\t\tgetContent: (node, schema) => {\n\t\t\t\t\tconst textContent = node.textContent.replace(/\\n$/, '')\n\t\t\t\t\tconst inner = textContent\n\t\t\t\t\t\t? [schema.text(textContent)]\n\t\t\t\t\t\t: []\n\t\t\t\t\treturn schema.nodes.codeBlock.create(null, inner)\n\t\t\t\t},\n\t\t\t},\n\t\t]\n\t},\n\n\ttoMarkdown(state, node, parent, index) {\n\t\t// @tiptap/pm/markdown uses `params` instead of `language` attribute\n\t\tnode.attrs.params = node.attrs.language\n\n\t\t// After https://github.com/ProseMirror/prosemirror-markdown/pull/90 the upstream markdown serialization\n\t\t// is no longer comparible with our extraction stripping the last new line, so we keep a reverted copy\n\t\t// to stay consistent with our unit tests\n\n\t\t// Make sure the front matter fences are longer than any dash sequence within it\n\t\tconst backticks = node.textContent.match(/`{3,}/gm)\n\t\tconst fence = backticks ? (backticks.sort().slice(-1)[0] + '`') : '```'\n\n\t\tstate.write(fence + (node.attrs.params || '') + '\\n')\n\t\tstate.text(node.textContent, false)\n\t\t// Add a newline to the current content before adding closing marker\n\t\tstate.ensureNewLine()\n\t\tstate.write(fence)\n\t\tstate.closeBlock(node)\n\t},\n\n\taddNodeView() {\n\t\treturn VueNodeViewRenderer(CodeBlockView)\n\t},\n\n\taddKeyboardShortcuts() {\n\t\treturn {\n\t\t\t'Mod-a': () => {\n\t\t\t\tif (!this.editor.isActive('codeBlock')) {\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\tconst nodeSize = this.editor.state.selection.$from.node().nodeSize\n\t\t\t\tthis.editor.commands.selectParentNode()\n\t\t\t\tconst from = this.editor.state.selection.$from.pos\n\t\t\t\tconst to = from + nodeSize\n\t\t\t\tthis.editor.commands.setTextSelection({ from, to })\n\n\t\t\t\treturn true\n\t\t\t},\n\t\t}\n\t},\n\n})\n\nexport default CodeBlock\n","<!--\n  - @copyright Copyright (c) 2021 Jonas <jonas@freesources.org>\n  -\n  - @author Jonas <jonas@freesources.org>\n  -\n  - @license GNU AGPL version 3 or any later version\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\n  -\n  -->\n\n<template>\n\t<div class=\"emoji-list\">\n\t\t<template v-if=\"hasResults\">\n\t\t\t<div v-for=\"(emojiObject, index) in items\"\n\t\t\t\t:key=\"index\"\n\t\t\t\tclass=\"emoji-list__item\"\n\t\t\t\t:class=\"{ 'is-selected': index === selectedIndex }\"\n\t\t\t\t@click=\"selectItem(index)\">\n\t\t\t\t<span class=\"emoji-list__item__emoji\">\n\t\t\t\t\t{{ emojiObject.native }}\n\t\t\t\t</span>\n\t\t\t\t:{{ emojiObject.short_name }}\n\t\t\t</div>\n\t\t</template>\n\t\t<div v-else class=\"emoji-list__item is-empty\">\n\t\t\t{{ t('text', 'No emoji found') }}\n\t\t</div>\n\t</div>\n</template>\n\n<script>\nimport { translate as t } from '@nextcloud/l10n'\nimport { emojiAddRecent } from '@nextcloud/vue'\n\nexport default {\n\tname: 'EmojiList',\n\tprops: {\n\t\titems: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tcommand: {\n\t\t\ttype: Function,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tselectedIndex: 0,\n\t\t}\n\t},\n\tcomputed: {\n\t\thasResults() {\n\t\t\treturn this.items.length > 0\n\t\t},\n\t\titemHeight() {\n\t\t\treturn this.$el.scrollHeight / this.items.length\n\t\t},\n\t\titemInsideScrollView() {\n\t\t\t// If upper border of item is bigger or equal than scroll top\n\t\t\t// and lower end of item is smaller or equal than scroll bottom\n\t\t\treturn this.selectedIndex * this.itemHeight >= this.$el.scrollTop\n\t\t\t\t&& (this.selectedIndex + 1) * this.itemHeight <= this.$el.scrollTop + this.$el.clientHeight\n\t\t},\n\t},\n\twatch: {\n\t\titems() {\n\t\t\tthis.selectedIndex = 0\n\t\t\tthis.$el.scrollTop = 0\n\t\t},\n\t},\n\tmethods: {\n\t\tt,\n\t\tonKeyDown({ event }) {\n\t\t\t// Ignore any key modifier combinations\n\t\t\tif (event.ctrlKey || event.shiftKey || event.altKey || event.metaKey) {\n\t\t\t\treturn false\n\t\t\t}\n\n\t\t\tif (event.key === 'ArrowUp') {\n\t\t\t\tthis.selectedIndex = ((this.selectedIndex + this.items.length) - 1) % this.items.length\n\t\t\t\tif (!this.itemInsideScrollView) {\n\t\t\t\t\tthis.$el.scrollTop = this.selectedIndex * this.itemHeight\n\t\t\t\t}\n\t\t\t\treturn true\n\t\t\t}\n\n\t\t\tif (event.key === 'ArrowDown') {\n\t\t\t\tthis.selectedIndex = (this.selectedIndex + 1) % this.items.length\n\t\t\t\tif (!this.itemInsideScrollView) {\n\t\t\t\t\tthis.$el.scrollTop = (this.selectedIndex + 1) * this.itemHeight - this.$el.clientHeight\n\t\t\t\t}\n\t\t\t\treturn true\n\t\t\t}\n\n\t\t\tif (event.key === 'Enter' || event.key === 'Tab') {\n\t\t\t\tthis.selectItem(this.selectedIndex)\n\t\t\t\treturn true\n\t\t\t}\n\n\t\t\treturn false\n\t\t},\n\n\t\tselectItem(index) {\n\t\t\tconst emojiObject = this.items[index]\n\n\t\t\tif (emojiObject) {\n\t\t\t\tthis.command(emojiObject)\n\t\t\t\temojiAddRecent(emojiObject)\n\t\t\t}\n\t\t},\n\t},\n}\n</script>\n\n<style scoped lang=\"scss\">\n\t.emoji-list {\n\t\tborder-radius: var(--border-radius);\n\t\tbackground-color: var(--color-main-background);\n\t\tbox-shadow: 0 1px 5px var(--color-box-shadow);\n\t\toverflow: auto;\n\n\t\tmin-width: 200px;\n\t\tmax-width: 200px;\n\t\tpadding: 4px;\n\t\t// Show maximum 5 entries and a half to show scroll\n\t\tmax-height: 35.5px * 5 + 18px;\n\t\tmargin: 5px 0;\n\n\t\t&__item {\n\t\t\tborder-radius: 8px;\n\t\t\tpadding: 4px 8px;\n\t\t\tmargin-bottom: 4px;\n\t\t\topacity: 0.8;\n\t\t\tcursor: pointer;\n\n\t\t\t// Take care of long names\n\t\t\twhite-space: nowrap;\n\t\t\toverflow: hidden;\n\t\t\ttext-overflow: ellipsis;\n\n\t\t\t&:last-child {\n\t\t\t\tmargin-bottom: 0;\n\t\t\t}\n\n\t\t\t&__emoji {\n\t\t\t\tpadding-right: 8px;\n\t\t\t}\n\n\t\t\t&.is-selected,\n\t\t\t&:focus,\n\t\t\t&:hover {\n\t\t\t\topacity: 1;\n\t\t\t\tbackground-color: var(--color-primary-element-light);\n\t\t\t}\n\t\t}\n\t}\n</style>\n","import mod from \"-!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./EmojiList.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./EmojiList.vue?vue&type=script&lang=js\"","\n      import API from \"!../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/sass-loader/dist/cjs.js!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./EmojiList.vue?vue&type=style&index=0&id=74f9a54a&prod&scoped=true&lang=scss\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/sass-loader/dist/cjs.js!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./EmojiList.vue?vue&type=style&index=0&id=74f9a54a&prod&scoped=true&lang=scss\";\n       export default content && content.locals ? content.locals : undefined;\n","import { render, staticRenderFns } from \"./EmojiList.vue?vue&type=template&id=74f9a54a&scoped=true\"\nimport script from \"./EmojiList.vue?vue&type=script&lang=js\"\nexport * from \"./EmojiList.vue?vue&type=script&lang=js\"\nimport style0 from \"./EmojiList.vue?vue&type=style&index=0&id=74f9a54a&prod&scoped=true&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"74f9a54a\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"emoji-list\"},[(_vm.hasResults)?_vm._l((_vm.items),function(emojiObject,index){return _c('div',{key:index,staticClass:\"emoji-list__item\",class:{ 'is-selected': index === _vm.selectedIndex },on:{\"click\":function($event){return _vm.selectItem(index)}}},[_c('span',{staticClass:\"emoji-list__item__emoji\"},[_vm._v(\"\\n\\t\\t\\t\\t\"+_vm._s(emojiObject.native)+\"\\n\\t\\t\\t\")]),_vm._v(\"\\n\\t\\t\\t:\"+_vm._s(emojiObject.short_name)+\"\\n\\t\\t\")])}):_c('div',{staticClass:\"emoji-list__item is-empty\"},[_vm._v(\"\\n\\t\\t\"+_vm._s(_vm.t('text', 'No emoji found'))+\"\\n\\t\")])],2)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { mergeAttributes } from '@tiptap/core'\nimport TiptapCodeBlock from '@tiptap/extension-code-block'\n\nconst FrontMatter = TiptapCodeBlock.extend({\n\tname: 'frontMatter',\n\t// FrontMatter are only valid at the begin of a document\n\tdraggable: false,\n\n\trenderHTML({ node, HTMLAttributes }) {\n\t\treturn this.parent({\n\t\t\tnode,\n\t\t\tHTMLAttributes:\n\t\t\tmergeAttributes(HTMLAttributes, { 'data-title': t('text', 'Front matter'), class: 'frontmatter' }),\n\t\t})\n\t},\n\tparseHTML() {\n\t\treturn [{\n\t\t\ttag: 'pre#frontmatter',\n\t\t\tpreserveWhitespace: 'full',\n\t\t\tpriority: 9001,\n\t\t\tattrs: {\n\t\t\t\tlanguage: 'yaml',\n\t\t\t},\n\t\t}]\n\t},\n\ttoMarkdown: (state, node) => {\n\t\tif (!state.out.match(/^\\s*/)) throw Error('FrontMatter must be the first node of the document!')\n\t\tconst text = node.textContent\n\t\t// Make sure the front matter fences are longer than any dash sequence within it\n\t\tconst dashes = text.match(/-{3,}/gm)\n\t\tconst separator = dashes ? (dashes.sort().slice(-1)[0] + '-') : '---'\n\n\t\tstate.write('')\n\t\tstate.out = ''\n\t\tstate.write(`${separator}\\n`)\n\t\tstate.text(text, false)\n\t\tstate.ensureNewLine()\n\t\tstate.write(separator)\n\t\tstate.closeBlock(node)\n\t},\n\n\t// Allow users to add a FrontMatter, but only at the beginning of the document\n\taddInputRules() {\n\t\treturn [\n\t\t\t{\n\t\t\t\tfind: /^---$/g,\n\t\t\t\thandler: ({ state, range, chain }) => {\n\t\t\t\t\tif (range.from === 1) {\n\t\t\t\t\t\tif (state.doc.resolve(1).parent.type.name === this.name) return false\n\t\t\t\t\t\tchain()\n\t\t\t\t\t\t\t.deleteRange(range)\n\t\t\t\t\t\t\t.insertContentAt(0, {\n\t\t\t\t\t\t\t\ttype: this.name,\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\treturn true\n\t\t\t\t\t}\n\t\t\t\t\treturn false\n\t\t\t\t},\n\t\t\t},\n\t\t]\n\t},\n\n\t// Override rules from Codeblock\n\taddCommands() {\n\t\treturn {}\n\t},\n\taddPasteRules: () => [],\n\taddProseMirrorPlugins: () => [],\n})\n\nexport default FrontMatter\n","/*\n * @copyright Copyright (c) 2022 Julius Hrtl <jus@bitgrid.net>\n *\n * @author Julius Hrtl <jus@bitgrid.net>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n*/\n\nimport TipTapHardBreak from '@tiptap/extension-hard-break'\n\nconst HardBreak = TipTapHardBreak.extend({\n\taddAttributes() {\n\t\treturn {\n\t\t\tsyntax: {\n\t\t\t\tdefault: '  ',\n\t\t\t\trendered: false,\n\t\t\t\tkeepOnSplit: true,\n\t\t\t\tparseHTML: (el) => el.getAttribute('data-syntax') || '  ',\n\t\t\t},\n\t\t}\n\t},\n\n\taddCommands() {\n\t\treturn {\n\t\t\t...this?.parent(),\n\t\t\tsetHardBreak: () => (ctx) => {\n\t\t\t\t// Prevent hard breaks within headings\n\t\t\t\tfor (let d = ctx.state.selection.$from.depth; d >= 0; d--) {\n\t\t\t\t\tif (ctx.state.selection.$from.node(d).type.name === 'heading') return false\n\t\t\t\t}\n\t\t\t\treturn this.parent().setHardBreak()(ctx)\n\t\t\t},\n\t\t}\n\t},\n\n\ttoMarkdown(state, node, parent, index) {\n\t\tfor (let i = index + 1; i < parent.childCount; i++) {\n\t\t\tif (parent.child(i).type !== node.type) {\n\t\t\t\tif (node.attrs.syntax !== 'html') {\n\t\t\t\t\tstate.write(node.attrs.syntax)\n\t\t\t\t\tif (!parent.child(i).text?.startsWith('\\n')) state.write('\\n')\n\t\t\t\t} else {\n\t\t\t\t\tstate.write('<br />')\n\t\t\t\t}\n\t\t\t\treturn\n\t\t\t}\n\t\t}\n\t},\n})\n\nexport default HardBreak\n","/**\n * SPDX-FileCopyrightText: 2024 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport { slugify } from './slug.js'\n\n/**\n * Extract heading data structure from doc\n *\n * @param {Document} doc - the prosemirror doc\n * @return {Array} headings found in the doc\n */\nexport default function extractHeadings(doc) {\n\tconst counter = new Map()\n\tconst headings = []\n\n\tconst getId = text => {\n\t\tconst id = slugify(text)\n\t\tif (counter.has(id)) {\n\t\t\tconst next = counter.get(id)\n\t\t\t// increment counter\n\t\t\tcounter.set(id, next + 1)\n\t\t\treturn `h-${id}--${next}`\n\t\t}\n\t\t// define counter\n\t\tcounter.set(id, 1)\n\t\treturn 'h-' + id\n\t}\n\n\tdoc.descendants((node, offset) => {\n\t\tif (node.type.name !== 'heading') {\n\t\t\treturn\n\t\t}\n\t\tconst text = node.textContent\n\t\t// ignore empty headings\n\t\tif (!text) return\n\t\tconst id = getId(text)\n\t\theadings.push(Object.freeze({\n\t\t\tlevel: node.attrs.level,\n\t\t\ttext,\n\t\t\tid,\n\t\t\toffset,\n\t\t}))\n\t})\n\n\treturn headings\n}\n","/**\n * SPDX-FileCopyrightText: 2024 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport { Plugin, PluginKey } from '@tiptap/pm/state'\nimport { Decoration, DecorationSet } from '@tiptap/pm/view'\nimport extractHeadings from './extractHeadings.js'\n\nexport const headingAnchorPluginKey = new PluginKey('headingAnchor')\n\n/**\n * Heading anchor decorations ProseMirror plugin\n * Add anchor tags with a unique id to all headings.\n *\n * @return {Plugin<DecorationSet>}\n */\nexport default function headingAnchor() {\n\treturn new Plugin({\n\n\t\tkey: headingAnchorPluginKey,\n\n\t\tstate: {\n\t\t\tinit(_, { doc }) {\n\t\t\t\tconst headings = extractHeadings(doc)\n\t\t\t\treturn {\n\t\t\t\t\theadings,\n\t\t\t\t\tdecorations: anchorDecorations(doc, headings),\n\t\t\t\t}\n\t\t\t},\n\t\t\tapply(tr, value, _oldState, newState) {\n\t\t\t\tif (!tr.docChanged) {\n\t\t\t\t\treturn value\n\t\t\t\t}\n\t\t\t\tconst headings = extractHeadings(newState.doc)\n\t\t\t\tconst decorations = mapDecorations(value, tr, headings) || anchorDecorations(newState.doc, headings)\n\t\t\t\treturn { headings, decorations }\n\t\t\t},\n\t\t},\n\n\t\tprops: {\n\t\t\tdecorations(state) {\n\t\t\t\treturn this.getState(state).decorations\n\t\t\t},\n\t\t},\n\t})\n}\n\n/**\n * Map the previous decorations to current document state.\n *\n * Return false if headings changed or decorations would get removed.\n * The latter prevents lost decorations in case of replacements.\n *\n * @param {object} value - previous plugin state\n * @param {object} tr - current transaction\n * @param {Array} headings - array of headings\n *\n * @return {false|DecorationSet}\n */\nfunction mapDecorations(value, tr, headings) {\n\tif (headingsChanged(headings, value.headings)) {\n\t\treturn false\n\t}\n\tlet removedDecorations = false\n\tconst decorations = value.decorations.map(tr.mapping, tr.doc, { onRemove: () => { removedDecorations = true } })\n\treturn removedDecorations\n\t\t? false\n\t\t: decorations\n}\n\n/**\n * Check if the headings provided are equivalent.\n *\n * @param {Array} current - array of headings\n * @param {Array} prev - headings to compare against\n *\n * @return {boolean}\n */\nfunction headingsChanged(current, prev) {\n\treturn (current.length !== prev.length)\n\t\t|| current.some(isDifferentFrom(prev))\n}\n\n/**\n * Check if headings are different - i.e. have different id or level\n *\n * @param {Array} other - headings to compare against\n *\n * Returns a function to be used in a call to Array#some.\n * The returned function takes a heading and an index (as provided by iterators)\n * and compares the id and level of the heading to the one in `other` with the same index.\n */\nconst isDifferentFrom = (other) => (heading, i) => {\n\treturn heading.id !== other[i].id\n\t\t|| heading.level !== other[i].level\n}\n\n/**\n * Create anchor decorations for the given headings\n * @param {Document} doc - prosemirror doc\n * @param {Array} headings - headings structure in the doc\n * @return {DecorationSet}\n */\nfunction anchorDecorations(doc, headings) {\n\tconst decorations = headings.map(decorationForHeading)\n\treturn DecorationSet.create(doc, decorations)\n}\n\n/**\n * Create a decoration for the given heading\n * @param {object} heading to decorate\n * @return {Decoration}\n */\nfunction decorationForHeading(heading) {\n\treturn Decoration.widget(\n\t\theading.offset + 1,\n\t\tanchorForHeading(heading),\n\t\t{ side: -1 },\n\t)\n}\n\n/**\n * Create an anchor element for the given heading\n * @param {object} heading to generate anchor for\n * @return {HTMLElement}\n */\nfunction anchorForHeading(heading) {\n\tconst el = document.createElement('a')\n\tconst symbol = document.createTextNode('#')\n\tel.appendChild(symbol)\n\tel.setAttribute('id', heading.id)\n\tel.setAttribute('aria-hidden', 'true')\n\tel.className = 'heading-anchor'\n\tel.setAttribute('href', `#${heading.id}`)\n\tel.setAttribute('title', window.t('text', 'Link to this section'))\n\tel.setAttribute('contenteditable', 'false')\n\tel.addEventListener('click', handleClick)\n\treturn el\n}\n\n/**\n * Handle click on an anchor - scroll into view and change location hash.\n * @param {PointerEvent} event click that triggered the function\n */\nfunction handleClick(event) {\n\tevent.stopPropagation()\n\tevent.target.scrollIntoView()\n\twindow.location.hash = event.target.getAttribute('href')\n}\n","/**\n * SPDX-FileCopyrightText: 2022 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport TipTapHeading from '@tiptap/extension-heading'\nimport headingAnchor, { headingAnchorPluginKey } from '../plugins/headingAnchor.js'\nimport store from '../store/index.js'\n\nconst setHeadings = (val) => store.dispatch('text/setHeadings', val)\n\nconst Heading = TipTapHeading.extend({\n\n\taddKeyboardShortcuts() {\n\t\treturn this.options.levels.reduce((items, level) => ({\n\t\t\t...items,\n\t\t\t[`Mod-Shift-${level}`]: () => this.editor.commands.toggleHeading({ level }),\n\t\t}), {})\n\t},\n\n\t// sync heading data structure to the vuex store\n\tonUpdate({ editor }) {\n\t\tconst headings = headingAnchorPluginKey\n\t\t\t.getState(editor.state)?.headings ?? []\n\t\tsetHeadings(headings)\n\t},\n\n\taddProseMirrorPlugins() {\n\t\treturn [headingAnchor()]\n\t},\n\n})\n\nexport default Heading\n","<template>\n\t<NcModal v-if=\"show\"\n\t\tsize=\"large\"\n\t\t:name=\"currentImage.name\"\n\t\t:out-transition=\"true\"\n\t\t:has-next=\"true\"\n\t\t:has-previous=\"true\"\n\t\t:close-button-contained=\"false\"\n\t\t:dark=\"true\"\n\t\t@next=\"showNextImage\"\n\t\t@previous=\"showPreviousImage\"\n\t\t@close=\"$emit('close')\">\n\t\t<div class=\"modal__content\">\n\t\t\t<img :src=\"currentImage.previewUrl\">\n\t\t</div>\n\t</NcModal>\n</template>\n\n<script>\nimport { NcModal } from '@nextcloud/vue'\n\nexport default {\n\tname: 'ShowImageModal',\n\tcomponents: {\n\t\tNcModal,\n\t},\n\tprops: {\n\t\timages: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tstartIndex: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0,\n\t\t},\n\t\tshow: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tcurrentImageIndex: 0,\n\t\t}\n\t},\n\tcomputed: {\n\t\tcurrentImage() {\n\t\t\treturn this.images[this.currentImageIndex]\n\t\t},\n\t},\n\twatch: {\n\t\t'startIndex'(val) {\n\t\t\tthis.currentImageIndex = val\n\t\t},\n\t},\n\tmethods: {\n\t\tshowNextImage() {\n\t\t\tthis.currentImageIndex = (this.currentImageIndex + 1) % this.images.length\n\t\t},\n\t\tshowPreviousImage() {\n\t\t\tthis.currentImageIndex = this.currentImageIndex <= 0\n\t\t\t\t? this.images.length - 1\n\t\t\t\t: this.currentImageIndex - 1\n\t\t},\n\t},\n}\n</script>\n\n<style scoped lang=\"scss\">\n.modal__content {\n\theight: 80vh;\n\tpadding: 0 50px;\n\tdisplay: flex;\n\tjustify-content: center;\n\timg {\n\t\twidth: 100%;\n\t\theight: 100%;\n\t\tobject-fit: contain;\n\t}\n}\n</style>\n","import mod from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ShowImageModal.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ShowImageModal.vue?vue&type=script&lang=js\"","\n      import API from \"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/sass-loader/dist/cjs.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ShowImageModal.vue?vue&type=style&index=0&id=403f8ff2&prod&scoped=true&lang=scss\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/sass-loader/dist/cjs.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ShowImageModal.vue?vue&type=style&index=0&id=403f8ff2&prod&scoped=true&lang=scss\";\n       export default content && content.locals ? content.locals : undefined;\n","import { render, staticRenderFns } from \"./ShowImageModal.vue?vue&type=template&id=403f8ff2&scoped=true\"\nimport script from \"./ShowImageModal.vue?vue&type=script&lang=js\"\nexport * from \"./ShowImageModal.vue?vue&type=script&lang=js\"\nimport style0 from \"./ShowImageModal.vue?vue&type=style&index=0&id=403f8ff2&prod&scoped=true&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"403f8ff2\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return (_vm.show)?_c('NcModal',{attrs:{\"size\":\"large\",\"name\":_vm.currentImage.name,\"out-transition\":true,\"has-next\":true,\"has-previous\":true,\"close-button-contained\":false,\"dark\":true},on:{\"next\":_vm.showNextImage,\"previous\":_vm.showPreviousImage,\"close\":function($event){return _vm.$emit('close')}}},[_c('div',{staticClass:\"modal__content\"},[_c('img',{attrs:{\"src\":_vm.currentImage.previewUrl}})])]):_vm._e()\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<!--\n  - @copyright Copyright (c) 2019 Julius Hrtl <jus@bitgrid.net>\n  -\n  - @author Julius Hrtl <jus@bitgrid.net>\n  -\n  - @license GNU AGPL version 3 or any later version\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\n  -\n  -->\n\n<template>\n\t<NodeViewWrapper :contenteditable=\"isEditable\">\n\t\t<figure class=\"image image-view\"\n\t\t\tdata-component=\"image-view\"\n\t\t\t:data-attachment-type=\"attachmentType\"\n\t\t\t:class=\"{'icon-loading': !loaded, 'image-view--failed': failed}\"\n\t\t\t:data-src=\"src\">\n\t\t\t<div v-if=\"canDisplayImage\"\n\t\t\t\tv-click-outside=\"() => showIcons = false\"\n\t\t\t\tclass=\"image__view\"\n\t\t\t\t@mouseover=\"showIcons = true\"\n\t\t\t\t@mouseleave=\"showIcons = false\">\n\t\t\t\t<transition name=\"fade\">\n\t\t\t\t\t<template v-if=\"!failed\">\n\t\t\t\t\t\t<div v-if=\"isMediaAttachment\"\n\t\t\t\t\t\t\tcontenteditable=\"false\"\n\t\t\t\t\t\t\tclass=\"media\"\n\t\t\t\t\t\t\t@click=\"handleAttachmentClick\">\n\t\t\t\t\t\t\t<div class=\"media__wrapper\">\n\t\t\t\t\t\t\t\t<img v-show=\"loaded\"\n\t\t\t\t\t\t\t\t\t:src=\"imageUrl\"\n\t\t\t\t\t\t\t\t\t:alt=\"alt\"\n\t\t\t\t\t\t\t\t\tclass=\"image__main\"\n\t\t\t\t\t\t\t\t\t@load=\"onLoaded\">\n\t\t\t\t\t\t\t\t<div class=\"metadata\">\n\t\t\t\t\t\t\t\t\t<span class=\"name\">{{ alt }}</span>\n\t\t\t\t\t\t\t\t\t<span class=\"size\">{{ attachmentSize }}</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div v-if=\"showDeleteIcon\"\n\t\t\t\t\t\t\t\tclass=\"buttons\">\n\t\t\t\t\t\t\t\t<NcButton :aria-label=\"t('text', 'Delete this attachment')\"\n\t\t\t\t\t\t\t\t\t:title=\"t('text', 'Delete this attachment')\"\n\t\t\t\t\t\t\t\t\t@click=\"onDelete\">\n\t\t\t\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t\t\t\t<DeleteIcon />\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t</NcButton>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div v-else class=\"media\" contenteditable=\"false\">\n\t\t\t\t\t\t\t<img v-show=\"loaded\"\n\t\t\t\t\t\t\t\t:src=\"imageUrl\"\n\t\t\t\t\t\t\t\t:alt=\"alt\"\n\t\t\t\t\t\t\t\tclass=\"image__main\"\n\t\t\t\t\t\t\t\t@click=\"handleImageClick\"\n\t\t\t\t\t\t\t\t@load=\"onLoaded\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<ImageIcon class=\"image__main image__main--broken-icon\" :size=\"100\" />\n\t\t\t\t\t</template>\n\t\t\t\t</transition>\n\t\t\t\t<transition name=\"fade\">\n\t\t\t\t\t<div v-if=\"!isMediaAttachment\"\n\t\t\t\t\t\tv-show=\"loaded\"\n\t\t\t\t\t\tclass=\"image__caption\"\n\t\t\t\t\t\t:title=\"alt\">\n\t\t\t\t\t\t<figcaption v-if=\"!isEditable\">\n\t\t\t\t\t\t\t{{ alt }}\n\t\t\t\t\t\t</figcaption>\n\t\t\t\t\t\t<div v-else class=\"image__caption__wrapper\">\n\t\t\t\t\t\t\t<input v-show=\"!isMediaAttachment\"\n\t\t\t\t\t\t\t\tref=\"altInput\"\n\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\tclass=\"image__caption__input\"\n\t\t\t\t\t\t\t\t:value=\"alt\"\n\t\t\t\t\t\t\t\t@blur=\"updateAlt\"\n\t\t\t\t\t\t\t\t@keyup=\"updateAlt\">\n\t\t\t\t\t\t\t<div v-if=\"showImageDeleteIcon\"\n\t\t\t\t\t\t\t\tcontenteditable=\"false\"\n\t\t\t\t\t\t\t\tclass=\"image__caption__delete\">\n\t\t\t\t\t\t\t\t<NcButton :aria-label=\"t('text', 'Delete this image')\"\n\t\t\t\t\t\t\t\t\t:title=\"t('text', 'Delete this image')\"\n\t\t\t\t\t\t\t\t\t@click=\"onDelete\">\n\t\t\t\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t\t\t\t<DeleteIcon />\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t</NcButton>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</transition>\n\t\t\t\t<div class=\"image__modal\">\n\t\t\t\t\t<ShowImageModal :images=\"embeddedImageList\"\n\t\t\t\t\t\t:start-index=\"imageIndex\"\n\t\t\t\t\t\t:show=\"showImageModal\"\n\t\t\t\t\t\t@close=\"showImageModal=false\" />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-else class=\"image-view__cant_display\">\n\t\t\t\t<transition name=\"fade\">\n\t\t\t\t\t<div v-show=\"loaded\" class=\"image__caption\">\n\t\t\t\t\t\t<input ref=\"altInput\"\n\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t:value=\"alt\"\n\t\t\t\t\t\t\t:disabled=\"!isEditable\"\n\t\t\t\t\t\t\t@blur=\"updateAlt\"\n\t\t\t\t\t\t\t@keyup.enter=\"updateAlt\">\n\t\t\t\t\t</div>\n\t\t\t\t</transition>\n\t\t\t</div>\n\t\t\t<small v-if=\"errorMessage\" class=\"image__error-message\">\n\t\t\t\t{{ errorMessage }}\n\t\t\t</small>\n\t\t</figure>\n\t</NodeViewWrapper>\n</template>\n\n<script>\nimport ClickOutside from 'vue-click-outside'\nimport { mapGetters } from 'vuex'\nimport { NcButton } from '@nextcloud/vue'\nimport { showError } from '@nextcloud/dialogs'\nimport ShowImageModal from '../components/ImageView/ShowImageModal.vue'\nimport store from '../mixins/store.js'\nimport { useAttachmentResolver } from '../components/Editor.provider.js'\nimport { emit } from '@nextcloud/event-bus'\nimport { NodeViewWrapper } from '@tiptap/vue-2'\nimport { Image as ImageIcon, Delete as DeleteIcon } from '../components/icons.js'\n\nclass LoadImageError extends Error {\n\n\tconstructor(reason, imageUrl) {\n\t\tsuper(reason?.message || t('text', 'Failed to load'))\n\t\tthis.reason = reason\n\t\tthis.imageUrl = imageUrl\n\t}\n\n}\n\nexport default {\n\tname: 'ImageView',\n\tcomponents: {\n\t\tImageIcon,\n\t\tDeleteIcon,\n\t\tNcButton,\n\t\tShowImageModal,\n\t\tNodeViewWrapper,\n\t},\n\tdirectives: {\n\t\tClickOutside,\n\t},\n\tmixins: [\n\t\tstore,\n\t\tuseAttachmentResolver,\n\t],\n\tprops: ['editor', 'node', 'extension', 'updateAttributes', 'deleteNode'], // eslint-disable-line\n\tdata() {\n\t\treturn {\n\t\t\tattachment: null,\n\t\t\timageLoaded: false,\n\t\t\tloaded: false,\n\t\t\tfailed: false,\n\t\t\tshowIcons: false,\n\t\t\timageUrl: null,\n\t\t\terrorMessage: null,\n\t\t\tattachmentSize: null,\n\t\t\tshowImageModal: false,\n\t\t\timageIndex: null,\n\t\t\tisEditable: false,\n\t\t\tisLastInserted: false,\n\t\t\tembeddedImageList: [],\n\t\t}\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\timageAttachments: 'text/imageAttachments',\n\t\t}),\n\t\tattachmentType() {\n\t\t\tif (this.attachment) {\n\t\t\t\treturn this.attachment.isImage ? 'image' : 'media'\n\t\t\t} else {\n\t\t\t\treturn null\n\t\t\t}\n\t\t},\n\t\tisMediaAttachment() {\n\t\t\treturn this.attachmentType === 'media'\n\t\t},\n\t\tshowDeleteIcon() {\n\t\t\treturn this.isEditable && this.showIcons\n\t\t},\n\t\tshowImageDeleteIcon() {\n\t\t\treturn this.showDeleteIcon && !this.isMediaAttachment\n\t\t},\n\t\tcanDisplayImage() {\n\t\t\tif (this.failed && this.loaded) {\n\t\t\t\treturn true\n\t\t\t}\n\n\t\t\treturn this.loaded && this.imageLoaded\n\t\t},\n\t\tsrc: {\n\t\t\tget() {\n\t\t\t\treturn this.node.attrs.src || ''\n\t\t\t},\n\t\t\tset(src) {\n\t\t\t\tthis.updateAttributes({\n\t\t\t\t\tsrc,\n\t\t\t\t})\n\t\t\t},\n\t\t},\n\t\talt: {\n\t\t\tget() {\n\t\t\t\treturn this.node.attrs.alt ? this.node.attrs.alt : ''\n\t\t\t},\n\t\t\tset(alt) {\n\t\t\t\tthis.updateAttributes({\n\t\t\t\t\talt,\n\t\t\t\t})\n\t\t\t},\n\t\t},\n\t},\n\tbeforeMount() {\n\t\tthis.isEditable = this.editor.isEditable\n\t\tthis.editor.on('update', ({ editor }) => {\n\t\t\tthis.isEditable = editor.isEditable\n\t\t})\n\t\tthis.editor.on('transaction', ({ transaction }) => {\n\t\t\tconst trMeta = transaction.getMeta('insertedAttachmentSrc')\n\t\t\tif (trMeta?.src === this.src) {\n\t\t\t\tthis.isLastInserted = true\n\t\t\t}\n\t\t})\n\t\tthis.loadPreview()\n\t\t\t.catch(this.onImageLoadFailure)\n\t},\n\tmethods: {\n\t\tasync loadPreview() {\n\t\t\tthis.attachment = await this.$attachmentResolver.resolve(this.src)\n\t\t\tif (!this.attachment.previewUrl) {\n\t\t\t\tthrow new Error('Attachment source was not resolved')\n\t\t\t}\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tconst img = new Image()\n\t\t\t\timg.onload = async () => {\n\t\t\t\t\tthis.imageUrl = this.attachment.previewUrl\n\t\t\t\t\tthis.imageLoaded = true\n\t\t\t\t\tthis.loaded = true\n\t\t\t\t\tthis.attachmentSize = this.attachment.size\n\t\t\t\t}\n\t\t\t\timg.onerror = (e) => {\n\t\t\t\t\treject(new LoadImageError(e, this.attachment.previewUrl))\n\t\t\t\t}\n\t\t\t\timg.src = this.attachment.previewUrl\n\t\t\t})\n\t\t},\n\t\tonImageLoadFailure(err) {\n\t\t\tthis.failed = true\n\t\t\tthis.imageLoaded = false\n\t\t\tthis.loaded = true\n\t\t\tthis.errorMessage = err.message\n\n\t\t\tif (err instanceof LoadImageError) {\n\t\t\t\tthis.errorMessage = `${this.errorMessage} ${this.src}`\n\t\t\t}\n\n\t\t\tthis.$emit('error', { error: err, src: this.src })\n\t\t},\n\t\tupdateAlt(event) {\n\t\t\tthis.updateAttributes({\n\t\t\t\talt: event.target.value,\n\t\t\t})\n\t\t},\n\t\tonLoaded() {\n\t\t\tthis.loaded = true\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tif (this.isLastInserted) {\n\t\t\t\t\tthis.$refs.altInput?.focus()\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t\tasync updateEmbeddedImageList() {\n\t\t\tthis.embeddedImageList = []\n\t\t\t// Get all images that succeeded to load\n\t\t\tconst imageViews = Array.from(document.querySelectorAll('figure[data-component=\"image-view\"][data-attachment-type=\"image\"]:not(.image-view--failed).image-view'))\n\t\t\tfor (const imgv of imageViews) {\n\t\t\t\tconst src = imgv.getAttribute('data-src')\n\t\t\t\tif (!this.embeddedImageList.find(i => i.src === src)) {\n\t\t\t\t\t// Don't add duplicates (e.g. when several editors are loaded in HTML document)\n\t\t\t\t\tconst attachment = await this.$attachmentResolver.resolve(imgv.getAttribute('data-src'))\n\t\t\t\t\tthis.embeddedImageList.push({\n\t\t\t\t\t\tsrc,\n\t\t\t\t\t\t...attachment,\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\thandleAttachmentClick() {\n\t\t\t// Open in viewer if possible\n\t\t\tif (OCA.Viewer\n\t\t\t\t// Viewer is not in use\n\t\t\t\t&& !OCA.Viewer.file\n\t\t\t\t// Viewer supports mimetype\n\t\t\t\t&& OCA.Viewer.mimetypes.indexOf(this.attachment.mimetype) !== -1\n\t\t\t\t// Attachment has davPath, i.e. is native attachment and not in public share\n\t\t\t\t//  (in public share we probably don't have DAV access)\n\t\t\t\t&& this.attachment.davPath) {\n\t\t\t\t// Viewer exists, is not in use and supports mimetype\n\t\t\t\tOCA.Viewer.open({ path: this.attachment.davPath })\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t// Download file\n\t\t\twindow.location.assign(this.attachment.fullUrl)\n\t\t},\n\t\tasync handleImageClick() {\n\t\t\tawait this.updateEmbeddedImageList()\n\t\t\tthis.imageIndex = this.embeddedImageList.findIndex(i => (i.src === this.src))\n\t\t\tif (this.imageIndex !== -1) {\n\t\t\t\tthis.showImageModal = true\n\t\t\t} else {\n\t\t\t\tconsole.error('Could not find image in attachments list', this.attachment)\n\t\t\t\tshowError(t('text', 'Could not find image in attachments list.'))\n\t\t\t}\n\t\t},\n\t\tonDelete() {\n\t\t\temit('text:image-node:delete', this.imageUrl)\n\t\t\tthis.deleteNode()\n\t\t},\n\t},\n}\n</script>\n\n<style scoped lang=\"scss\">\n.image {\n\tmargin: 0;\n\tpadding: 0;\n\n\t&, * {\n\t\t-webkit-user-modify: read-only !important;\n\t}\n}\n\n.image__caption {\n\ttext-align: center;\n\tcolor: var(--color-text-lighter);\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\t&__wrapper {\n\t\tposition: relative;\n\t}\n\t&__delete {\n\t\tdisplay: flex;\n\t\tflex-basis: 20%;\n\t\talign-items: center;\n\t\twidth: 20px !important;\n\t\theight: 20px;\n\t\tposition: absolute;\n\t\tbottom: -1px;\n\t\tright: -3px;\n\t\t&, svg {\n\t\t\tcursor: pointer;\n\t\t}\n\t}\n\t.image__caption__wrapper {\n\t\tflex-basis: 80%;\n\t}\n\tinput[type='text'] {\n\t\twidth: 85%;\n\t\ttext-align: center;\n\t\tbackground-color: transparent;\n\t\tborder: none !important;\n\t\tcolor: var(--color-text-maxcontrast) !important;\n\n\t\t&:focus {\n\t\t\tborder: 2px solid var(--color-border-dark) !important;\n\t\t\tcolor: var(--color-main-text) !important;\n\t\t}\n\t}\n\tfigcaption {\n\t\tcolor: var(--color-text-maxcontrast) !important;\n\t\tmax-width: 80%;\n\t\ttext-align: center;\n\t\twidth: fit-content;\n\t}\n}\n\n.image__loading {\n\theight: 100px;\n}\n\n.image__main {\n\tmax-height: calc(100vh - 50px - 50px);\n}\n\n.image__main--broken-icon, .image__error-message {\n\tcolor: var(--color-text-maxcontrast);\n}\n\n.image__error-message {\n\tdisplay: block;\n\ttext-align: center;\n}\n\n.image__view {\n\ttext-align: center;\n\tposition: relative;\n\n\timg {\n\t\tmax-width: 100%;\n\t}\n\n\t&:hover {\n\t\tinput[type='text'] {\n\t\t\tborder: 2px solid var(--color-border-dark) !important;\n\t\t\tcolor: var(--color-main-text) !important;\n\t\t}\n\t}\n}\n\n.media {\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: left;\n\tpadding-bottom: 0;\n\n\t.media__wrapper {\n\t\tdisplay: flex;\n\t\tborder: 2px solid var(--color-border);\n\t\tborder-radius: var(--border-radius-large);\n\t\tpadding: 8px;\n\n\t\timg {\n\t\t\twidth: 44px;\n\t\t\theight: 44px;\n\t\t}\n\n\t\t.metadata {\n\t\t\tmargin-left: 8px;\n\t\t\tdisplay: flex;\n\t\t\tflex-direction: column;\n\t\t\talign-items: start;\n\n\t\t\tspan {\n\t\t\t\tline-height: 20px;\n\t\t\t\tfont-weight: normal;\n\n\t\t\t\t&.size {\n\t\t\t\t\tcolor: var(--color-text-maxcontrast);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t.buttons {\n\t\tmargin-left: 8px;\n\t}\n}\n\n.fade-enter-active {\n\ttransition: opacity .3s ease-in-out;\n}\n\n.fade-enter-to {\n\topacity: 1;\n}\n\n.fade-enter {\n\topacity: 0;\n}\n</style>\n","import mod from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ImageView.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ImageView.vue?vue&type=script&lang=js\"","\n      import API from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/sass-loader/dist/cjs.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ImageView.vue?vue&type=style&index=0&id=42761165&prod&scoped=true&lang=scss\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/sass-loader/dist/cjs.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ImageView.vue?vue&type=style&index=0&id=42761165&prod&scoped=true&lang=scss\";\n       export default content && content.locals ? content.locals : undefined;\n","import { render, staticRenderFns } from \"./ImageView.vue?vue&type=template&id=42761165&scoped=true\"\nimport script from \"./ImageView.vue?vue&type=script&lang=js\"\nexport * from \"./ImageView.vue?vue&type=script&lang=js\"\nimport style0 from \"./ImageView.vue?vue&type=style&index=0&id=42761165&prod&scoped=true&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"42761165\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('NodeViewWrapper',{attrs:{\"contenteditable\":_vm.isEditable}},[_c('figure',{staticClass:\"image image-view\",class:{'icon-loading': !_vm.loaded, 'image-view--failed': _vm.failed},attrs:{\"data-component\":\"image-view\",\"data-attachment-type\":_vm.attachmentType,\"data-src\":_vm.src}},[(_vm.canDisplayImage)?_c('div',{directives:[{name:\"click-outside\",rawName:\"v-click-outside\",value:(() => _vm.showIcons = false),expression:\"() => showIcons = false\"}],staticClass:\"image__view\",on:{\"mouseover\":function($event){_vm.showIcons = true},\"mouseleave\":function($event){_vm.showIcons = false}}},[_c('transition',{attrs:{\"name\":\"fade\"}},[(!_vm.failed)?[(_vm.isMediaAttachment)?_c('div',{staticClass:\"media\",attrs:{\"contenteditable\":\"false\"},on:{\"click\":_vm.handleAttachmentClick}},[_c('div',{staticClass:\"media__wrapper\"},[_c('img',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.loaded),expression:\"loaded\"}],staticClass:\"image__main\",attrs:{\"src\":_vm.imageUrl,\"alt\":_vm.alt},on:{\"load\":_vm.onLoaded}}),_vm._v(\" \"),_c('div',{staticClass:\"metadata\"},[_c('span',{staticClass:\"name\"},[_vm._v(_vm._s(_vm.alt))]),_vm._v(\" \"),_c('span',{staticClass:\"size\"},[_vm._v(_vm._s(_vm.attachmentSize))])])]),_vm._v(\" \"),(_vm.showDeleteIcon)?_c('div',{staticClass:\"buttons\"},[_c('NcButton',{attrs:{\"aria-label\":_vm.t('text', 'Delete this attachment'),\"title\":_vm.t('text', 'Delete this attachment')},on:{\"click\":_vm.onDelete},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c('DeleteIcon')]},proxy:true}],null,false,3930079857)})],1):_vm._e()]):_c('div',{staticClass:\"media\",attrs:{\"contenteditable\":\"false\"}},[_c('img',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.loaded),expression:\"loaded\"}],staticClass:\"image__main\",attrs:{\"src\":_vm.imageUrl,\"alt\":_vm.alt},on:{\"click\":_vm.handleImageClick,\"load\":_vm.onLoaded}})])]:[_c('ImageIcon',{staticClass:\"image__main image__main--broken-icon\",attrs:{\"size\":100}})]],2),_vm._v(\" \"),_c('transition',{attrs:{\"name\":\"fade\"}},[(!_vm.isMediaAttachment)?_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.loaded),expression:\"loaded\"}],staticClass:\"image__caption\",attrs:{\"title\":_vm.alt}},[(!_vm.isEditable)?_c('figcaption',[_vm._v(\"\\n\\t\\t\\t\\t\\t\\t\"+_vm._s(_vm.alt)+\"\\n\\t\\t\\t\\t\\t\")]):_c('div',{staticClass:\"image__caption__wrapper\"},[_c('input',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.isMediaAttachment),expression:\"!isMediaAttachment\"}],ref:\"altInput\",staticClass:\"image__caption__input\",attrs:{\"type\":\"text\"},domProps:{\"value\":_vm.alt},on:{\"blur\":_vm.updateAlt,\"keyup\":_vm.updateAlt}}),_vm._v(\" \"),(_vm.showImageDeleteIcon)?_c('div',{staticClass:\"image__caption__delete\",attrs:{\"contenteditable\":\"false\"}},[_c('NcButton',{attrs:{\"aria-label\":_vm.t('text', 'Delete this image'),\"title\":_vm.t('text', 'Delete this image')},on:{\"click\":_vm.onDelete},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c('DeleteIcon')]},proxy:true}],null,false,3930079857)})],1):_vm._e()])]):_vm._e()]),_vm._v(\" \"),_c('div',{staticClass:\"image__modal\"},[_c('ShowImageModal',{attrs:{\"images\":_vm.embeddedImageList,\"start-index\":_vm.imageIndex,\"show\":_vm.showImageModal},on:{\"close\":function($event){_vm.showImageModal=false}}})],1)],1):_c('div',{staticClass:\"image-view__cant_display\"},[_c('transition',{attrs:{\"name\":\"fade\"}},[_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.loaded),expression:\"loaded\"}],staticClass:\"image__caption\"},[_c('input',{ref:\"altInput\",attrs:{\"type\":\"text\",\"disabled\":!_vm.isEditable},domProps:{\"value\":_vm.alt},on:{\"blur\":_vm.updateAlt,\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\"))return null;return _vm.updateAlt.apply(null, arguments)}}})])])],1),_vm._v(\" \"),(_vm.errorMessage)?_c('small',{staticClass:\"image__error-message\"},[_vm._v(\"\\n\\t\\t\\t\"+_vm._s(_vm.errorMessage)+\"\\n\\t\\t\")]):_vm._e()])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","/*\n * @copyright Copyright (c) 2019 Julius Hrtl <jus@bitgrid.net>\n *\n * @author Julius Hrtl <jus@bitgrid.net>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport TiptapImage from '@tiptap/extension-image'\nimport { Plugin } from '@tiptap/pm/state'\nimport ImageView from './ImageView.vue'\nimport { VueNodeViewRenderer } from '@tiptap/vue-2'\nimport { defaultMarkdownSerializer } from '@tiptap/pm/markdown'\n\nconst Image = TiptapImage.extend({\n\n\tselectable: false,\n\n\tparseHTML() {\n\t\treturn [\n\t\t\t{\n\t\t\t\ttag: this.options.allowBase64\n\t\t\t\t\t? 'figure img[src]'\n\t\t\t\t\t: 'figure img[src]:not([src^=\"data:\"])',\n\t\t\t},\n\t\t]\n\t},\n\n\trenderHTML() {\n\t\t// Avoid the prosemirror node creation to trigger image loading as we use a custom node view anyways\n\t\t// Otherwise it would attempt to load the image from the current location before the node view is even initialized\n\t\treturn ['img']\n\t},\n\n\taddOptions() {\n\t\treturn {\n\t\t\t...this.parent?.(),\n\t\t}\n\t},\n\n\taddNodeView() {\n\t\treturn VueNodeViewRenderer(ImageView)\n\t},\n\n\taddProseMirrorPlugins() {\n\t\treturn [\n\t\t\tnew Plugin({\n\t\t\t\tprops: {\n\t\t\t\t\thandleDrop: (view, event, slice) => {\n\t\t\t\t\t\t// only catch the drop if it contains files\n\t\t\t\t\t\tif (event.dataTransfer.files && event.dataTransfer.files.length > 0) {\n\t\t\t\t\t\t\tconst coordinates = view.posAtCoords({ left: event.clientX, top: event.clientY })\n\t\t\t\t\t\t\tconst customEvent = new CustomEvent('file-drop', {\n\t\t\t\t\t\t\t\tbubbles: true,\n\t\t\t\t\t\t\t\tdetail: {\n\t\t\t\t\t\t\t\t\tfiles: event.dataTransfer.files,\n\t\t\t\t\t\t\t\t\tposition: coordinates.pos,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\tevent.target.dispatchEvent(customEvent)\n\t\t\t\t\t\t\treturn true\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\thandlePaste: (view, event, slice) => {\n\t\t\t\t\t\t// only catch the paste if it contains files\n\t\t\t\t\t\tif (event.clipboardData.files && event.clipboardData.files.length > 0) {\n\t\t\t\t\t\t\t// let the editor wrapper catch this custom event\n\t\t\t\t\t\t\tconst customEvent = new CustomEvent('image-paste', {\n\t\t\t\t\t\t\t\tbubbles: true,\n\t\t\t\t\t\t\t\tdetail: {\n\t\t\t\t\t\t\t\t\tfiles: event.clipboardData.files,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\tevent.target.dispatchEvent(customEvent)\n\t\t\t\t\t\t\treturn true\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t}),\n\t\t]\n\t},\n\n\t/* Serializes an image node as a block image, so it ensures an image is always a block by itself */\n\ttoMarkdown(state, node, parent, index) {\n\t\tnode.attrs.alt = node.attrs.alt.toString()\n\t\tdefaultMarkdownSerializer.nodes.image(state, node, parent, index)\n\t\tstate.closeBlock(node)\n\t},\n})\n\nexport default Image\n","/*\n * @copyright Copyright (c) 2022 Jonas <jonas@freesources.org>\n *\n * @author Jonas <jonas@freesources.org>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport TiptapImage from '@tiptap/extension-image'\nimport ImageView from './ImageView.vue'\nimport { VueNodeViewRenderer } from '@tiptap/vue-2'\nimport { defaultMarkdownSerializer } from '@tiptap/pm/markdown'\n\n// Inline image extension. Needed if markdown contains inline images.\n// Not supported to be created from our UI (we default to block images).\nconst ImageInline = TiptapImage.extend({\n\tname: 'image-inline',\n\n\t// Lower priority than (block) Image extension\n\tpriority: 99,\n\n\tselectable: false,\n\n\tparseHTML() {\n\t\treturn [\n\t\t\t{\n\t\t\t\ttag: this.options.allowBase64\n\t\t\t\t\t? 'img[src]'\n\t\t\t\t\t: 'img[src]:not([src^=\"data:\"])',\n\t\t\t},\n\t\t]\n\t},\n\n\taddOptions() {\n\t\treturn {\n\t\t\t...this.parent?.(),\n\t\t\tinline: true,\n\t\t}\n\t},\n\n\t// Empty commands, we want only those from (block) Image extension\n\taddCommands() {\n\t\treturn {}\n\t},\n\n\t// Empty input rules, we want only those from (block) Image extension\n\taddInputRules() {\n\t\treturn []\n\t},\n\n\taddNodeView() {\n\t\treturn VueNodeViewRenderer(ImageView)\n\t},\n\n\ttoMarkdown(state, node, parent, index) {\n\t\treturn defaultMarkdownSerializer.nodes.image(state, node, parent, index)\n\t},\n})\n\nexport default ImageInline\n","<!--\n  - @copyright Copyright (c) 2022 Julius Hrtl <jus@bitgrid.net>\n  -\n  - @author Julius Hrtl <jus@bitgrid.net>\n  -\n  - @license GNU AGPL version 3 or any later version\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\n  -->\n<template>\n\t<SuggestionListWrapper ref=\"suggestionList\"\n\t\t:command=\"command\"\n\t\t:items=\"items\"\n\t\t@select=\"(item) => $emit('select', item)\">\n\t\t<template #default=\"{ item }\">\n\t\t\t<div class=\"link-picker__item\" :data-key=\"item.key\">\n\t\t\t\t<compoent :is=\"item.icon\" v-if=\"typeof item.icon !== 'string'\" />\n\t\t\t\t<img v-else :src=\"item.icon\">\n\t\t\t\t<div>{{ item.label }}</div>\n\t\t\t</div>\n\t\t</template>\n\t\t<template #empty>\n\t\t\t{{ t('text', 'No command found') }}\n\t\t</template>\n\t</SuggestionListWrapper>\n</template>\n\n<script>\nimport SuggestionListWrapper from '../SuggestionListWrapper.vue'\n\nexport default {\n\tcomponents: {\n\t\tSuggestionListWrapper,\n\t},\n\tprops: {\n\t\titems: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tcommand: {\n\t\t\ttype: Function,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tmethods: {\n\t\tonKeyDown({ event }) {\n\t\t\t// Ignore any key modifier combinations\n\t\t\treturn this.$refs.suggestionList?.onKeyDown({ event })\n\t\t},\n\t},\n}\n</script>\n<style lang=\"scss\" scoped>\n.link-picker__item {\n\tdisplay: flex;\n\talign-items: center;\n\n\t& > div {\n\t\tpadding: 4px;\n\t\tpadding-left: 8px;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t}\n\n\timg {\n\t\twidth: 20px;\n\t\theight: 20px;\n\t\tfilter: var(--background-invert-if-dark);\n\t}\n}\n</style>\n","import mod from \"-!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./LinkPickerList.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./LinkPickerList.vue?vue&type=script&lang=js\"","\n      import API from \"!../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/sass-loader/dist/cjs.js!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./LinkPickerList.vue?vue&type=style&index=0&id=11ad0ffc&prod&lang=scss&scoped=true\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/sass-loader/dist/cjs.js!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./LinkPickerList.vue?vue&type=style&index=0&id=11ad0ffc&prod&lang=scss&scoped=true\";\n       export default content && content.locals ? content.locals : undefined;\n","import { render, staticRenderFns } from \"./LinkPickerList.vue?vue&type=template&id=11ad0ffc&scoped=true\"\nimport script from \"./LinkPickerList.vue?vue&type=script&lang=js\"\nexport * from \"./LinkPickerList.vue?vue&type=script&lang=js\"\nimport style0 from \"./LinkPickerList.vue?vue&type=style&index=0&id=11ad0ffc&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"11ad0ffc\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('SuggestionListWrapper',{ref:\"suggestionList\",attrs:{\"command\":_vm.command,\"items\":_vm.items},on:{\"select\":(item) => _vm.$emit('select', item)},scopedSlots:_vm._u([{key:\"default\",fn:function({ item }){return [_c('div',{staticClass:\"link-picker__item\",attrs:{\"data-key\":item.key}},[(typeof item.icon !== 'string')?_c(item.icon,{tag:\"compoent\"}):_c('img',{attrs:{\"src\":item.icon}}),_vm._v(\" \"),_c('div',[_vm._v(_vm._s(item.label))])],1)]}},{key:\"empty\",fn:function(){return [_vm._v(\"\\n\\t\\t\"+_vm._s(_vm.t('text', 'No command found'))+\"\\n\\t\")]},proxy:true}])})\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","/*\n * @copyright Copyright (c) 2022 Julius Hrtl <jus@bitgrid.net>\n *\n * @author Julius Hrtl <jus@bitgrid.net>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport createSuggestions from '../suggestions.js'\nimport LinkPickerList from './LinkPickerList.vue'\nimport { searchProvider, getLinkWithPicker } from '@nextcloud/vue/dist/Components/NcRichText.js'\nimport menuEntries from './../../Menu/entries.js'\nimport { getIsActive } from '../../Menu/utils.js'\nimport markdownit from '../../../markdownit/index.js'\n\nconst suggestGroupFormat = t('text', 'Formatting')\nconst suggestGroupPicker = t('text', 'Smart picker')\n\nconst filterOut = (e) => {\n\treturn ['undo', 'redo', 'outline', 'emoji-picker'].indexOf(e.key) > -1\n}\n\nconst important = ['task-list', 'table']\n\nconst hasMarkdownSyntax = (content) => {\n\t// Regular expressions for common Markdown patterns\n\tconst markdownPatterns = [\n\t\t/\\*\\*.*?\\*\\*/, // Bold: **text**\n\t\t/\\*.*?\\*/, // Italics: *text*\n\t\t/\\[.*?\\(.*?\\)/, // Links: [text](url)\n\t\t/^#{1,6}\\s.*$/, // Headings: # text\n\t\t/^\\s*[-+*]\\s.*/m, // Unordered list: - item\n\t\t/^\\s\\d\\..*/m, // Ordered list: 1. item\n\t\t/^>+\\s.*/, // Blockquote: > text\n\t\t/`.*?`/, // Code: `code`\n\t]\n\n\treturn markdownPatterns.some(pattern => pattern.test(content))\n}\n\nconst isValidMarkdown = (content) => {\n\ttry {\n\t\tmarkdownit.parse(content)\n\t\treturn true\n\t} catch (e) {\n\t\treturn false\n\t}\n}\n\nconst sortImportantFirst = (list) => {\n\treturn [\n\t\t...list.filter(e => important.indexOf(e.key) > -1),\n\t\t...list.filter(e => important.indexOf(e.key) === -1),\n\t]\n}\n\nconst formattingSuggestions = (query) => {\n\treturn sortImportantFirst(\n\t\t[\n\t\t\t...menuEntries.find(e => e.key === 'headings').children,\n\t\t\t...menuEntries.filter(e => e.action && !filterOut(e)),\n\t\t\t...menuEntries.find(e => e.key === 'callouts').children,\n\t\t\t{\n\t\t\t\t...menuEntries.find(e => e.key === 'emoji-picker'),\n\t\t\t\taction: (command) => command.insertContent(':'),\n\t\t\t},\n\t\t].filter(e => e?.label?.toLowerCase?.()?.includes(query.toLowerCase()))\n\t\t\t.map(e => ({ ...e, suggestGroup: suggestGroupFormat })),\n\t)\n}\n\nexport default () => createSuggestions({\n\tlistComponent: LinkPickerList,\n\tcommand: ({ editor, range, props }) => {\n\t\tif (props.action) {\n\t\t\tconst commandChain = editor.chain().deleteRange(range)\n\t\t\tprops.action(commandChain)\n\t\t\tcommandChain.run()\n\t\t\treturn\n\t\t}\n\t\tgetLinkWithPicker(props.providerId, true)\n\t\t\t.then(link => {\n\t\t\t\tif (hasMarkdownSyntax(link) && isValidMarkdown(link)) {\n\t\t\t\t\t// Insert markdown content (e.g. from `text_templates` app)\n\t\t\t\t\tconst content = markdownit.render(link)\n\t\t\t\t\teditor\n\t\t\t\t\t\t.chain()\n\t\t\t\t\t\t.focus()\n\t\t\t\t\t\t.insertContentAt(range, content + ' ')\n\t\t\t\t\t\t.run()\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\teditor\n\t\t\t\t\t.chain()\n\t\t\t\t\t.focus()\n\t\t\t\t\t.deleteRange(range)\n\t\t\t\t\t.insertPreview(link)\n\t\t\t\t\t.run()\n\t\t\t})\n\t\t\t.catch(error => {\n\t\t\t\tconsole.error('Smart picker promise rejected', error)\n\t\t\t})\n\t},\n\titems: ({ editor, query }) => {\n\t\treturn [\n\t\t\t...searchProvider(query)\n\t\t\t\t.map(p => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tsuggestGroup: suggestGroupPicker,\n\t\t\t\t\t\tlabel: p.title,\n\t\t\t\t\t\ticon: p.icon_url,\n\t\t\t\t\t\tproviderId: p.id,\n\t\t\t\t\t}\n\t\t\t\t}).filter(e => e?.label?.toLowerCase?.()?.includes(query.toLowerCase())),\n\t\t\t...formattingSuggestions(query)\n\t\t\t\t.filter(({ action, isActive }) => {\n\t\t\t\t\tconst canRunState = action(editor?.can())\n\t\t\t\t\tconst isActiveState = isActive && getIsActive({ isActive }, editor)\n\t\t\t\t\treturn canRunState && !isActiveState\n\t\t\t\t}),\n\t\t]\n\t},\n})\n","import { Extension } from '@tiptap/core'\nimport { Suggestion } from '@tiptap/suggestion'\nimport { PluginKey } from '@tiptap/pm/state'\nimport suggestions from '../components/Suggestion/LinkPicker/suggestions.js'\n\nexport const LinkPickerPluginKey = new PluginKey('linkPicker')\nexport default Extension.create({\n\n\tname: 'linkPicker',\n\n\taddOptions() {\n\t\treturn {\n\t\t\tsuggestion: {\n\t\t\t\tchar: '/',\n\t\t\t\tallowedPrefixes: [' '],\n\t\t\t\tpluginKey: LinkPickerPluginKey,\n\t\t\t\tallow: ({ state, range }) => {\n\t\t\t\t\tconst $from = state.doc.resolve(range.from)\n\t\t\t\t\treturn $from.parent.type.name !== 'codeBlock'\n\t\t\t\t},\n\t\t\t\t...suggestions(),\n\t\t\t},\n\t\t}\n\t},\n\n\taddProseMirrorPlugins() {\n\t\treturn [\n\t\t\tSuggestion({\n\t\t\t\teditor: this.editor,\n\t\t\t\t...this.options.suggestion,\n\t\t\t}),\n\t\t]\n\t},\n})\n","/**\n * @copyright Copyright (c) 2020 Azul <azul@riseup.net>\n *\n * @author Azul <azul@riseup.net>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport { loadState } from '@nextcloud/initial-state'\nimport { generateUrl } from '@nextcloud/router'\n\nconst domHref = function(node, relativePath) {\n\tconst ref = node.attrs.href\n\tif (!ref) {\n\t\treturn ref\n\t}\n\tif (!window.OCA?.Viewer) {\n\t\treturn ref\n\t}\n\tif (ref.match(/^[a-zA-Z]*:/)) {\n\t\treturn ref\n\t}\n\tif (ref.startsWith('#')) {\n\t\treturn ref\n\t}\n\t// Don't rewrite links in collectives app context\n\tif (loadState('core', 'active-app', '') === 'collectives') {\n\t\treturn ref\n\t}\n\t// Don't rewrite links to the collectives app\n\tif (ref.includes('/apps/collectives/')) {\n\t\treturn ref\n\t}\n\n\t// Rewrite links with old format from file picker to `/f/<fileId>`\n\tconst match = ref.match(/^([^?]*)\\?fileId=(\\d+)/)\n\tif (match) {\n\t\tconst [, , id] = match\n\t\treturn (new URL(generateUrl(`/f/${id}`), window.origin)).href\n\t}\n\treturn ref\n}\n\nconst parseHref = function(dom) {\n\tconst ref = dom.getAttribute('href')\n\tif (!ref) {\n\t\treturn ref\n\t}\n\tconst match = ref.match(/\\?dir=([^&]*)&openfile=([^&]*)#relPath=([^&]*)/)\n\tif (match) {\n\t\tconst [, , id] = match\n\t\treturn (new URL(generateUrl(`/f/${id}`), window.origin)).href\n\t}\n\treturn ref\n}\n\nconst isLinkToSelfWithHash = function(href) {\n\tconst locationNoHash = window.location.origin + window.location.pathname + window.location.search\n\treturn href?.startsWith('#') || href?.startsWith(locationNoHash + '#')\n}\n\nexport {\n\tdomHref,\n\tparseHref,\n\tisLinkToSelfWithHash,\n}\n","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{key:_vm.key,staticClass:\"link-view-bubble\"},[_c('div',{staticClass:\"link-view-bubble__header\"},[_c('div',{staticClass:\"link-view-bubble__title\"},[_vm._v(\"\\n\\t\\t\\t\"+_vm._s(_vm.title)+\"\\n\\t\\t\")]),_vm._v(\" \"),_c('NcButton',{attrs:{\"title\":_vm.copyLinkTooltip,\"aria-label\":_vm.copyLinkTooltip,\"type\":\"tertiary\"},on:{\"click\":_vm.copyLink},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [(_vm.copySuccess)?_c('CheckIcon',{attrs:{\"size\":20}}):(_vm.copyLoading)?_c('NcLoadingIcon',{attrs:{\"size\":20}}):_c('ContentCopyIcon',{attrs:{\"size\":20}})]},proxy:true}])}),_vm._v(\" \"),(_vm.isEditable)?_c('div',{staticClass:\"edit-buttons\"},[(!_vm.edit)?_c('NcButton',{attrs:{\"title\":_vm.t('text', 'Edit link'),\"aria-label\":_vm.t('text', 'Edit link'),\"type\":\"tertiary\"},on:{\"click\":_vm.startEdit},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c('PencilIcon',{attrs:{\"size\":20}})]},proxy:true}],null,false,4260349822)}):_c('NcButton',{attrs:{\"title\":_vm.t('text', 'Save changes'),\"aria-label\":_vm.t('text', 'Save changes'),\"type\":\"tertiary\"},on:{\"click\":_vm.updateLink},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c('CheckIcon',{attrs:{\"size\":20}})]},proxy:true}],null,false,2630571749)}),_vm._v(\" \"),(!_vm.edit)?_c('NcButton',{attrs:{\"title\":_vm.t('text', 'Remove link'),\"aria-label\":_vm.t('text', 'Remove link'),\"type\":\"tertiary\"},on:{\"click\":_vm.removeLink},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c('LinkOffIcon',{attrs:{\"size\":20}})]},proxy:true}],null,false,2250374828)}):_c('NcButton',{attrs:{\"title\":_vm.t('text', 'Cancel'),\"aria-label\":_vm.t('text', 'Cancel'),\"type\":\"tertiary\"},on:{\"click\":_vm.stopEdit},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c('CloseIcon',{attrs:{\"size\":20}})]},proxy:true}],null,false,2428343285)})],1):_vm._e()],1),_vm._v(\" \"),(_vm.isEditable && _vm.edit)?_c('div',{staticClass:\"link-view-bubble__edit\"},[_c('NcTextField',{attrs:{\"name\":\"newHref\",\"label\":_vm.t('text', 'URL'),\"value\":_vm.newHref},on:{\"update:value\":function($event){_vm.newHref=$event},\"keypress\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\"))return null;$event.preventDefault();return _vm.updateLink.apply(null, arguments)}}})],1):(_vm.showPreview)?_c('NcReferenceList',{ref:\"referencelist\",staticClass:\"link-view-bubble__reference-list\",attrs:{\"text\":_vm.sanitizedHref,\"limit\":1,\"interactive\":false,\"display-fallback\":true},on:{\"loaded\":_vm.onReferenceListLoaded}}):_vm._e()],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n\t<div :key=\"key\" class=\"link-view-bubble\">\n\t\t<!-- link header with buttons -->\n\t\t<div class=\"link-view-bubble__header\">\n\t\t\t<div class=\"link-view-bubble__title\">\n\t\t\t\t{{ title }}\n\t\t\t</div>\n\t\t\t<!-- copy link -->\n\t\t\t<NcButton :title=\"copyLinkTooltip\"\n\t\t\t\t:aria-label=\"copyLinkTooltip\"\n\t\t\t\ttype=\"tertiary\"\n\t\t\t\t@click=\"copyLink\">\n\t\t\t\t<template #icon>\n\t\t\t\t\t<CheckIcon v-if=\"copySuccess\" :size=\"20\" />\n\t\t\t\t\t<NcLoadingIcon v-else-if=\"copyLoading\" :size=\"20\" />\n\t\t\t\t\t<ContentCopyIcon v-else :size=\"20\" />\n\t\t\t\t</template>\n\t\t\t</NcButton>\n\n\t\t\t<!-- edit/save -->\n\t\t\t<div v-if=\"isEditable\" class=\"edit-buttons\">\n\t\t\t\t<NcButton v-if=\"!edit\"\n\t\t\t\t\t:title=\"t('text', 'Edit link')\"\n\t\t\t\t\t:aria-label=\"t('text', 'Edit link')\"\n\t\t\t\t\ttype=\"tertiary\"\n\t\t\t\t\t@click=\"startEdit\">\n\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t<PencilIcon :size=\"20\" />\n\t\t\t\t\t</template>\n\t\t\t\t</NcButton>\n\t\t\t\t<NcButton v-else\n\t\t\t\t\t:title=\"t('text', 'Save changes')\"\n\t\t\t\t\t:aria-label=\"t('text', 'Save changes')\"\n\t\t\t\t\ttype=\"tertiary\"\n\t\t\t\t\t@click=\"updateLink\">\n\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t<CheckIcon :size=\"20\" />\n\t\t\t\t\t</template>\n\t\t\t\t</NcButton>\n\n\t\t\t\t<!-- remove link / dismiss changes -->\n\t\t\t\t<NcButton v-if=\"!edit\"\n\t\t\t\t\t:title=\"t('text', 'Remove link')\"\n\t\t\t\t\t:aria-label=\"t('text', 'Remove link')\"\n\t\t\t\t\ttype=\"tertiary\"\n\t\t\t\t\t@click=\"removeLink\">\n\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t<LinkOffIcon :size=\"20\" />\n\t\t\t\t\t</template>\n\t\t\t\t</NcButton>\n\t\t\t\t<NcButton v-else\n\t\t\t\t\t:title=\"t('text', 'Cancel')\"\n\t\t\t\t\t:aria-label=\"t('text', 'Cancel')\"\n\t\t\t\t\ttype=\"tertiary\"\n\t\t\t\t\t@click=\"stopEdit\">\n\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t<CloseIcon :size=\"20\" />\n\t\t\t\t\t</template>\n\t\t\t\t</NcButton>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<!-- link edit form -->\n\t\t<div v-if=\"isEditable && edit\" class=\"link-view-bubble__edit\">\n\t\t\t<NcTextField name=\"newHref\"\n\t\t\t\t:label=\"t('text', 'URL')\"\n\t\t\t\t:value.sync=\"newHref\"\n\t\t\t\t@keypress.enter.prevent=\"updateLink\" />\n\t\t</div>\n\n\t\t<!-- link preview -->\n\t\t<NcReferenceList v-else-if=\"showPreview\"\n\t\t\tref=\"referencelist\"\n\t\t\t:text=\"sanitizedHref\"\n\t\t\t:limit=\"1\"\n\t\t\t:interactive=\"false\"\n\t\t\t:display-fallback=\"true\"\n\t\t\tclass=\"link-view-bubble__reference-list\"\n\t\t\t@loaded=\"onReferenceListLoaded\" />\n\t</div>\n</template>\n\n<script>\nimport { NcButton, NcLoadingIcon, NcTextField } from '@nextcloud/vue'\nimport { NcReferenceList } from '@nextcloud/vue/dist/Components/NcRichText.js'\nimport { translate as t } from '@nextcloud/l10n'\nimport CheckIcon from 'vue-material-design-icons/Check.vue'\nimport CloseIcon from 'vue-material-design-icons/Close.vue'\nimport ContentCopyIcon from 'vue-material-design-icons/ContentCopy.vue'\nimport LinkOffIcon from 'vue-material-design-icons/LinkOff.vue'\nimport PencilIcon from 'vue-material-design-icons/Pencil.vue'\n\nimport CopyToClipboardMixin from '../../mixins/CopyToClipboardMixin.js'\n\nconst PROTOCOLS_WITH_PREVIEW = ['http:', 'https:']\n\nexport default {\n\tname: 'LinkBubbleView',\n\n\tcomponents: {\n\t\tCheckIcon,\n\t\tCloseIcon,\n\t\tContentCopyIcon,\n\t\tNcButton,\n\t\tNcLoadingIcon,\n\t\tNcReferenceList,\n\t\tNcTextField,\n\t\tLinkOffIcon,\n\t\tPencilIcon,\n\t},\n\n\tmixins: [\n\t\tCopyToClipboardMixin,\n\t],\n\n\tprops: {\n\t\teditor: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\thref: {\n\t\t\ttype: String,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\tisEditable: false,\n\t\t\tedit: false,\n\t\t\tnewHref: null,\n\t\t\treferenceTitle: null,\n\t\t}\n\t},\n\n\tcomputed: {\n\t\tkey() {\n\t\t\treturn this.href || 'no-href'\n\t\t},\n\n\t\tcopyLinkTooltip() {\n\t\t\tif (this.copied) {\n\t\t\t\tif (this.copySuccess) {\n\t\t\t\t\treturn ''\n\t\t\t\t}\n\t\t\t\treturn t('text', 'Cannot copy, please copy the link manually')\n\t\t\t}\n\t\t\treturn t('text', 'Copy link to clipboard')\n\t\t},\n\n\t\t/**\n\t\t * NcReferenceList only accepts full URLs with origin.\n\t\t */\n\t\tsanitizedHref() {\n\t\t\tconst url = new URL(this.href, window.location)\n\t\t\treturn url.href\n\t\t},\n\n\t\ttitle() {\n\t\t\treturn this.referenceTitle ? this.referenceTitle : this.sanitizedHref\n\t\t},\n\n\t\tshowPreview() {\n\t\t\tconst url = new URL(this.href, window.location)\n\t\t\treturn this.href && PROTOCOLS_WITH_PREVIEW.includes(url.protocol)\n\t\t},\n\t},\n\n\twatch: {\n\t\tkey() {\n\t\t\tthis.resetBubble()\n\t\t},\n\t},\n\n\tbeforeMount() {\n\t\tthis.isEditable = this.editor.isEditable\n\t\tthis.editor.on('update', ({ editor }) => {\n\t\t\tthis.isEditable = editor.isEditable\n\t\t})\n\t},\n\n\tmethods: {\n\t\tt,\n\n\t\tresetBubble() {\n\t\t\tthis.edit = false\n\t\t\tthis.newHref = null\n\t\t\tthis.referenceTitle = null\n\t\t},\n\n\t\tasync copyLink() {\n\t\t\tawait this.copyToClipboard(this.href)\n\t\t},\n\n\t\tonReferenceListLoaded() {\n\t\t\tthis.referenceTitle = this.$refs.referencelist.firstReference?.openGraphObject?.name ?? null\n\t\t},\n\n\t\tstartEdit() {\n\t\t\tthis.edit = true\n\t\t\tthis.newHref = this.href\n\t\t},\n\n\t\tstopEdit() {\n\t\t\tthis.edit = false\n\t\t\tthis.newHref = null\n\t\t},\n\n\t\tupdateLink() {\n\t\t\tif (this.href !== this.newHref) {\n\t\t\t\tthis.setLinkUrl(this.newHref)\n\t\t\t}\n\t\t\tthis.stopEdit()\n\t\t},\n\n\t\tsetLinkUrl(href) {\n\t\t\t// Store current selection to restore it after setLink\n\t\t\tconst selection = { ...this.editor.view.state.selection }\n\t\t\tconst { ranges } = selection\n\t\t\tconst from = Math.min(...ranges.map(range => range.$from.pos))\n\t\t\tconst to = Math.max(...ranges.map(range => range.$to.pos))\n\n\t\t\tconsole.debug('selection', selection)\n\t\t\tthis.editor.chain()\n\t\t\t\t.extendMarkRange('link')\n\t\t\t\t.setLink({ href })\n\t\t\t\t.setTextSelection({ from, to })\n\t\t\t\t.focus()\n\t\t\t\t.run()\n\t\t},\n\n\t\tremoveLink() {\n\t\t\tthis.editor.chain()\n\t\t\t\t// Explicitly hide bubble to prevent flickering before it's removed\n\t\t\t\t.hideLinkBubble()\n\t\t\t\t.unsetLink()\n\t\t\t\t.focus()\n\t\t\t\t.run()\n\t\t\tthis.stopEdit()\n\t\t},\n\t},\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.link-view-bubble {\n\tpadding: 4px;\n\twidth: 350px;\n\tbackground-color: var(--color-main-background);\n\tborder-radius: var(--border-radius-large);\n\tfilter: drop-shadow(0 1px 10px var(--color-box-shadow));\n\tbox-sizing: initial !important;\n\n\t&__header {\n\t\tdisplay: flex;\n\t\tjustify-content: flex-end;\n\n\t\t.edit-buttons {\n\t\t\tdisplay: flex;\n\t\t}\n\t}\n\n\t&__title {\n\t\talign-self: center;\n\t\tpadding-left: calc(var(--default-grid-baseline, 4px) * 3);\n\t\tmargin-right: auto;\n\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\twhite-space: nowrap;\n\t\tfont-weight: bold;\n\t}\n\n\t&__reference-list {\n\t\tpadding: 4px;\n\t\tpadding-top: 0;\n\n\t\t:deep(a.widget-default) {\n\t\t\tmargin: 0;\n\t\t\tborder: 0;\n\t\t\tborder-radius: unset;\n\t\t}\n\n\t\t:deep(img.widget-default--image) {\n\t\t\tborder-radius: var(--border-radius-large);\n\t\t}\n\t}\n\n\t&__edit {\n\t\tpadding: 4px;\n\t\tpadding-top: 0;\n\n\t\t.input-field {\n\t\t\tmargin-bottom: 12px;\n\t\t}\n\t}\n}\n</style>\n","import mod from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./LinkBubbleView.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./LinkBubbleView.vue?vue&type=script&lang=js\"","\n      import API from \"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/sass-loader/dist/cjs.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./LinkBubbleView.vue?vue&type=style&index=0&id=fb46e0ea&prod&lang=scss&scoped=true\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/sass-loader/dist/cjs.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./LinkBubbleView.vue?vue&type=style&index=0&id=fb46e0ea&prod&lang=scss&scoped=true\";\n       export default content && content.locals ? content.locals : undefined;\n","import { render, staticRenderFns } from \"./LinkBubbleView.vue?vue&type=template&id=fb46e0ea&scoped=true\"\nimport script from \"./LinkBubbleView.vue?vue&type=script&lang=js\"\nexport * from \"./LinkBubbleView.vue?vue&type=script&lang=js\"\nimport style0 from \"./LinkBubbleView.vue?vue&type=style&index=0&id=fb46e0ea&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"fb46e0ea\",\n  null\n  \n)\n\nexport default component.exports","import { VueRenderer } from '@tiptap/vue-2'\nimport tippy from 'tippy.js'\nimport { domHref } from '../helpers/links.js'\nimport LinkBubbleView from '../components/Link/LinkBubbleView.vue'\n\nclass LinkBubblePluginView {\n\n\t#component = null\n\t#editor = null\n\n\tconstructor({ view, options, plugin }) {\n\t\tthis.options = options\n\t\tthis.view = view\n\t\tthis.plugin = plugin\n\t\tthis.#editor = this.options.editor\n\n\t\tthis.#component = new VueRenderer(LinkBubbleView, {\n\t\t\tparent: this.options.parent,\n\t\t\tpropsData: {\n\t\t\t\teditor: this.options.editor,\n\t\t\t\thref: null,\n\t\t\t},\n\t\t})\n\t}\n\n\taddEventListeners() {\n\t\tthis.view.dom.addEventListener('dragstart',\n\t\t\tthis.closeOnExternalEvents,\n\t\t)\n\t\tdocument.addEventListener('mousedown',\n\t\t\tthis.closeOnExternalEvents,\n\t\t)\n\t\tdocument.addEventListener('scroll',\n\t\t\tthis.closeOnExternalEvents,\n\t\t\t{ capture: true },\n\t\t)\n\t}\n\n\tremoveEventListeners() {\n\t\tthis.view.dom.removeEventListener('dragstart',\n\t\t\tthis.closeOnExternalEvents,\n\t\t)\n\t\tdocument.removeEventListener('mousedown',\n\t\t\tthis.closeOnExternalEvents,\n\t\t)\n\t\tdocument.removeEventListener('scroll',\n\t\t\tthis.closeOnExternalEvents,\n\t\t\t{ capture: true },\n\t\t)\n\t}\n\n\tcloseOnExternalEvents = (event) => {\n\t\t// Only hide when targetting something outside of the popup\n\t\tif (this.tippy?.popper?.contains(event.target)) {\n\t\t\treturn\n\t\t}\n\n\t\t// Cypress fires unexpected scroll events, which breaks testing the link bubble\n\t\tif (window.Cypress && event.type === 'scroll') {\n\t\t\treturn\n\t\t}\n\n\t\tthis.#editor.commands.hideLinkBubble()\n\t}\n\n\tcreateTooltip() {\n\t\tconst editorElement = this.options.editor.options.element\n\t\tconst editorIsAttached = !!editorElement.parentElement\n\n\t\tif (this.tippy || !editorIsAttached) {\n\t\t\treturn\n\t\t}\n\n\t\tthis.tippy = tippy(editorElement, {\n\t\t\tduration: 100,\n\t\t\tgetReferenceClientRect: null,\n\t\t\tcontent: this.#component.element,\n\t\t\tinteractive: true,\n\t\t\ttrigger: 'manual',\n\t\t\tplacement: 'bottom',\n\t\t\thideOnClick: 'toggle',\n\t\t\tpopperOptions: {\n\t\t\t\tstrategy: 'fixed',\n\t\t\t},\n\t\t})\n\t}\n\n\tupdate(view, oldState) {\n\t\tconst { active } = this.plugin.getState(view.state)\n\t\tif (view.composing) {\n\t\t\treturn\n\t\t}\n\t\tthis.createTooltip()\n\t\tif (active?.mark) {\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.updateTooltip(view, active)\n\t\t\t}, 100)\n\t\t} else {\n\t\t\tthis.removeEventListeners()\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.tippy?.hide()\n\t\t\t}, 100)\n\t\t}\n\t}\n\n\tupdateTooltip(view, { mark, nodeStart }) {\n\t\tlet referenceEl = view.nodeDOM(nodeStart)\n\t\tif (Object.prototype.toString.call(referenceEl) === '[object Text]') {\n\t\t\treferenceEl = referenceEl.parentElement\n\t\t}\n\t\tconst clientRect = referenceEl?.getBoundingClientRect()\n\n\t\tthis.#component.updateProps({\n\t\t\thref: domHref(mark),\n\t\t})\n\n\t\tthis.tippy?.setProps({\n\t\t\tgetReferenceClientRect: () => clientRect,\n\t\t})\n\n\t\tthis.tippy?.show()\n\t\tthis.addEventListeners()\n\t}\n\n\tdestroy() {\n\t\tthis.tippy?.destroy()\n\t}\n\n}\n\nexport default LinkBubblePluginView\n","/**\n * @copyright Copyright (c) 2024 Max <max@nextcloud.com>\n *\n * @author Max <max@nextcloud.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport { isLinkToSelfWithHash } from '../helpers/links.js'\n\n/**\n * Get the link mark applied at the current selection or next to it.\n *\n * @param {object} state the prosemirror state\n * @param {object} state.selection - the current selection\n * @param {object} state.doc - the current doc\n */\nexport function activeLinkFromSelection({ selection, doc }) {\n\t// support for CellSelections\n\tconst { ranges } = selection\n\tconst from = Math.min(...ranges.map(range => range.$from.pos))\n\tconst to = Math.max(...ranges.map(range => range.$to.pos))\n\n\tconst resolved = doc.resolve(from)\n\n\t// ignore links in previews\n\tif (resolved.parent.type.name === 'preview') {\n\t\treturn false\n\t}\n\n\tconst node = resolved.parent.maybeChild(resolved.index())\n\tconst nodeStart = resolved.pos - resolved.textOffset\n\tconst nodeEnd = nodeStart + node?.nodeSize\n\tif (to > nodeEnd) {\n\t\t// Selection spans further than one text node\n\t\treturn null\n\t}\n\tconst active = activeLink(node, nodeStart)\n\tif (active) {\n\t\treturn active\n\t}\n\tconst nodeBefore = resolved.nodeBefore\n\tif (nodeBefore) {\n\t\treturn activeLink(nodeBefore, nodeStart - nodeBefore.nodeSize)\n\t}\n\treturn null\n}\n\n/**\n * Active link object for the given node and nodeStart\n * @param {object} node - node to check\n * @param {number} nodeStart - offset in the document\n */\nfunction activeLink(node, nodeStart) {\n\tconst mark = linkMark(node)\n\treturn mark ? { mark, nodeStart } : null\n}\n\n/**\n * Get the link mark for the given node\n * @param {object} node - node to check\n */\nfunction linkMark(node) {\n\tconst linkMark = node?.marks.find(m => m.type.name === 'link')\n\tif (!linkMark) {\n\t\treturn undefined\n\t}\n\t// Don't open link bubble for anchor links\n\tif (isLinkToSelfWithHash(linkMark.attrs.href)) {\n\t\treturn undefined\n\t} else {\n\t\treturn linkMark\n\t}\n}\n","/**\n * @copyright Copyright (c) 2024 Max <max@nextcloud.com>\n *\n * @author Max <max@nextcloud.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport { Plugin, PluginKey } from '@tiptap/pm/state'\nimport LinkBubblePluginView from './LinkBubblePluginView.js'\nimport { activeLinkFromSelection } from './linkHelpers.js'\nimport { isLinkToSelfWithHash } from '../helpers/links.js'\n\n// Commands\n\n/* Set resolved to be the active element (if it has a link mark)\n *\n * @params {ResolvedPos} resolved position of the action\n */\nexport const setActiveLink = (resolved) => (state, dispatch) => {\n\tconst mark = resolved.marks()\n\t\t.find(m => m.type.name === 'link')\n\tif (!mark) {\n\t\treturn false\n\t}\n\tconst nodeStart = resolved.pos - resolved.textOffset\n\tconst active = { mark, nodeStart }\n\tif (dispatch) {\n\t\tdispatch(state.tr.setMeta(linkBubbleKey, { active }))\n\t}\n\treturn true\n}\n\n/* Hide the link bubble by setting active state to null\n *\n */\nexport const hideLinkBubble = (state, dispatch) => {\n\tconst pluginState = linkBubbleKey.getState(state)\n\tif (!pluginState?.active) {\n\t\treturn false\n\t}\n\tif (dispatch) {\n\t\tdispatch(state.tr.setMeta(linkBubbleKey, { active: null }))\n\t}\n\treturn true\n}\n\nexport const linkBubbleKey = new PluginKey('linkBubble')\n/**\n * Prosemirror link bubble plugin\n * @param {object} options - options for the link bubble plugin view\n */\nexport function linkBubble(options) {\n\tconst linkBubblePlugin = new Plugin({\n\t\tkey: linkBubbleKey,\n\t\tstate: {\n\t\t\tinit: () => ({ active: null }),\n\t\t\tapply: (tr, cur) => {\n\t\t\t\tconst meta = tr.getMeta(linkBubbleKey)\n\t\t\t\tif (meta) {\n\t\t\t\t\treturn { ...cur, active: meta.active }\n\t\t\t\t} else {\n\t\t\t\t\treturn cur\n\t\t\t\t}\n\t\t\t},\n\t\t},\n\n\t\tview: (view) => new LinkBubblePluginView({\n\t\t\tview,\n\t\t\toptions,\n\t\t\tplugin: linkBubblePlugin,\n\t\t}),\n\n\t\tappendTransaction: (transactions, oldState, state) => {\n\t\t\t// Don't open bubble at editor initialisation\n\t\t\tif (oldState?.doc.content.size === 2) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t// Don't open bubble if neither selection nor doc changed\n\t\t\tconst sameSelection = oldState?.selection.eq(state.selection)\n\t\t\tconst sameDoc = oldState?.doc.eq(state.doc)\n\t\t\t// Don't open bubble on changes by other session members\n\t\t\tconst noHistory = transactions.every(tr => tr.meta.addToHistory === false)\n\t\t\tif (sameSelection && (noHistory || sameDoc)) {\n\t\t\t\treturn\n\t\t\t}\n\t\t\tconst active = activeLinkFromSelection(state)\n\t\t\treturn state.tr.setMeta(linkBubbleKey, { active })\n\t\t},\n\n\t\tprops: {\n\t\t\t// Required for read-only mode on Firefox.\n\t\t\t// For some reason, editor selection doesn't get updated\n\t\t\t// when clicking a link in read-only mode on Firefox.\n\t\t\thandleClickOn: (view, pos, _node, _nodePos, event, direct) => {\n\t\t\t\t// Only regard left clicks without Ctrl/Meta\n\t\t\t\tif (!direct\n\t\t\t\t\t|| event.button !== 0\n\t\t\t\t\t|| event.ctrlKey\n\t\t\t\t\t|| event.metaKey) {\n\t\t\t\t\treturn false\n\t\t\t\t}\n\t\t\t\tconst { state, dispatch } = view\n\t\t\t\tconst resolved = state.doc.resolve(pos)\n\t\t\t\treturn setActiveLink(resolved)(state, dispatch)\n\t\t\t},\n\n\t\t\thandleDOMEvents: {\n\t\t\t\t// Handled here because `handleKeyDown` does not work in read only editor.\n\t\t\t\tkeydown: (view, event) => {\n\t\t\t\t\tconst { state, dispatch } = view\n\t\t\t\t\tif (event.key === 'Escape') {\n\t\t\t\t\t\treturn hideLinkBubble(state, dispatch)\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\n\t\t},\n\n\t})\n\treturn linkBubblePlugin\n}\n\nexport const linkClickingKey = new PluginKey('textHandleClickLink')\n\n/**\n * Prosemirror plugin for special handling for clicks on links\n *\n * - Open link in new tab on middle click rather than pasting.\n * - Only open link on ctrl/cmd + left click.\n *   We use the link bubble otherwise.\n */\nexport function linkClicking() {\n\treturn new Plugin({\n\t\tkey: linkClickingKey,\n\t\tprops: {\n\t\t\thandleDOMEvents: {\n\t\t\t\t// Open link in new tab on middle click\n\t\t\t\tauxclick: (view, event) => {\n\t\t\t\t\tif (event.target.closest('a') && event.button === 1 && !event.ctrlKey && !event.metaKey && !event.shiftKey) {\n\t\t\t\t\t\tevent.preventDefault()\n\t\t\t\t\t\tevent.stopImmediatePropagation()\n\n\t\t\t\t\t\tconst linkElement = event.target.closest('a')\n\t\t\t\t\t\twindow.open(linkElement.href, '_blank')\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t// Prevent paste into links\n\t\t\t\t// On Linux, middle click pastes, which breaks \"open in new tab\" on middle click\n\t\t\t\t// Pasting into links will break the link anyway, so just disable it altogether.\n\t\t\t\tpaste: (view, event) => {\n\t\t\t\t\tif (event.target.closest('a')) {\n\t\t\t\t\t\tevent.stopPropagation()\n\t\t\t\t\t\tevent.preventDefault()\n\t\t\t\t\t\tevent.stopImmediatePropagation()\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t// Prevent open link (except anchor links) on left click (required for read-only mode)\n\t\t\t\t// Open link in new tab on Ctrl/Cmd + left click\n\t\t\t\tclick: (view, event) => {\n\t\t\t\t\tconst linkEl = event.target.closest('a')\n\t\t\t\t\tif (event.button === 0 && linkEl) {\n\t\t\t\t\t\t// No special handling in mermaid diagrams to not break links there\n\t\t\t\t\t\tif (linkEl.closest('svg[id^=\"mermaid-view\"]')) {\n\t\t\t\t\t\t\treturn false\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tevent.preventDefault()\n\t\t\t\t\t\tif (isLinkToSelfWithHash(linkEl.attributes.href?.value)) {\n\t\t\t\t\t\t\t// Open anchor links directly\n\t\t\t\t\t\t\tlocation.href = linkEl.attributes.href.value\n\t\t\t\t\t\t} else if (event.ctrlKey || event.metaKey) {\n\t\t\t\t\t\t\twindow.open(linkEl.href, '_blank')\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t})\n}\n","import { Extension } from '@tiptap/core'\nimport { linkBubble, hideLinkBubble } from '../plugins/links.js'\n\nconst LinkBubble = Extension.create({\n\tname: 'linkViewBubble',\n\n\taddCommands() {\n\t\treturn {\n\t\t\thideLinkBubble: () => ({ state, dispatch }) => {\n\t\t\t\treturn hideLinkBubble(state, dispatch)\n\t\t\t},\n\t\t}\n\t},\n\n\taddProseMirrorPlugins() {\n\t\treturn [\n\t\t\tlinkBubble({\n\t\t\t\teditor: this.editor,\n\t\t\t\tparent: this.editor.contentComponent,\n\t\t\t}),\n\t\t]\n\t},\n})\n\nexport default LinkBubble\n","/**\n * SPDX-FileCopyrightText: 2024 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport { isLinkToSelfWithHash } from './../helpers/links.js'\n\n/**\n * Get a list of all paragraphs that can be converted into a preview.\n *\n * @param {Document} doc - the prosemirror doc\n * @return {Array} paragraphs with one link only found in the doc\n */\nexport default function extractLinkParagraphs(doc) {\n\tconst paragraphs = []\n\n\tdoc.descendants((node, offset) => {\n\t\tif (previewPossible(node)) {\n\t\t\tparagraphs.push(Object.freeze({\n\t\t\t\toffset,\n\t\t\t\tnodeSize: node.nodeSize,\n\t\t\t\ttype: 'text-only',\n\t\t\t}))\n\t\t} else if (node.type.name === 'preview') {\n\t\t\tparagraphs.push(Object.freeze({\n\t\t\t\toffset,\n\t\t\t\tnodeSize: node.nodeSize,\n\t\t\t\ttype: 'link-preview',\n\t\t\t}))\n\t\t}\n\t})\n\n\treturn paragraphs\n}\n\n/**\n * Is it possible to convert the node into a preview?\n * @param {object} node the node in question\n * @return {boolean}\n */\nfunction previewPossible(node) {\n\tif (node.type.name !== 'paragraph' || hasOtherContent(node)) {\n\t\treturn false\n\t}\n\tconst href = extractHref(node.firstChild)\n\tif (!href || isLinkToSelfWithHash(href)) {\n\t\treturn false\n\t}\n\treturn true\n}\n\n/**\n * Does the node contain more content than the first child\n * @param {object} node node to inspect\n * @return {boolean}\n */\nfunction hasOtherContent(node) {\n\treturn node.childCount > 2\n\t\t|| (node.childCount === 2 && node.lastChild.textContent.trim())\n}\n\n/**\n * Get the link href of the given node\n * @param {object} node to inspect\n * @return {string} The href of the link mark of the node\n */\nfunction extractHref(node) {\n\tif (!node) {\n\t\treturn undefined\n\t}\n\tconst link = node.marks.find(mark => mark.type.name === 'link')\n\treturn link?.attrs.href\n}\n","<!--\n  - @copyright Copyright (c) 2024 Max Wiehle <max@nextcloud.com>\n  -\n  - @author Max <max@nextcloud.com>\n  -\n  - @license GNU AGPL version 3 or any later version\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\n  -\n  -->\n<template>\n\t<div contenteditable=\"false\" class=\"preview-options-container\">\n\t\t<NcActions data-text-preview-options=\"select\"\n\t\t\tclass=\"preview-options\"\n\t\t\t:open.sync=\"open\"\n\t\t\t@open=\"onOpen\">\n\t\t\t<template #icon>\n\t\t\t\t<DotsVerticalIcon :size=\"20\" />\n\t\t\t</template>\n\t\t\t<NcActionCaption :name=\"t('text', 'Preview options')\" />\n\t\t\t<NcActionRadio data-text-preview-option=\"text-only\"\n\t\t\t\tname=\"preview-option\"\n\t\t\t\tvalue=\"text-only\"\n\t\t\t\t:checked=\"type === 'text-only'\"\n\t\t\t\t@change=\"e => toggle(e.currentTarget.value)\">\n\t\t\t\t{{ t('text', 'Text only') }}\n\t\t\t</NcActionRadio>\n\t\t\t<NcActionRadio data-text-preview-option=\"link-preview\"\n\t\t\t\tname=\"preview-option\"\n\t\t\t\tvalue=\"link-preview\"\n\t\t\t\t:checked=\"type === 'link-preview'\"\n\t\t\t\t@change=\"e => toggle(e.currentTarget.value)\">\n\t\t\t\t{{ t('text', 'Show link preview') }}\n\t\t\t</NcActionRadio>\n\t\t\t<NcActionSeparator />\n\t\t\t<NcActionButton close-after-click=\"true\" @click=\"deleteNode\">\n\t\t\t\t<template #icon>\n\t\t\t\t\t<DeleteIcon :size=\"20\" />\n\t\t\t\t</template>\n\t\t\t\t{{ t('text','Remove link') }}\n\t\t\t</NcActionButton>\n\t\t</NcActions>\n\t</div>\n</template>\n\n<script>\nimport { NcActions, NcActionButton, NcActionRadio, NcActionCaption, NcActionSeparator } from '@nextcloud/vue'\nimport DotsVerticalIcon from 'vue-material-design-icons/DotsVertical.vue'\nimport DeleteIcon from 'vue-material-design-icons/Delete.vue'\n\nexport default {\n\tname: 'PreviewOptions',\n\n\tcomponents: {\n\t\tDotsVerticalIcon,\n\t\tNcActions,\n\t\tNcActionButton,\n\t\tNcActionCaption,\n\t\tNcActionRadio,\n\t\tNcActionSeparator,\n\t\tDeleteIcon,\n\t},\n\n\tprops: {\n\t\ttype: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\toffset: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tnodeSize: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\t$editor: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\topen: false,\n\t\t}\n\t},\n\n\tmethods: {\n\t\tonOpen() {\n\t\t\tthis.$editor.commands.hideLinkBubble()\n\t\t},\n\t\ttoggle(type) {\n\t\t\tthis.open = false\n\t\t\tconst chain = this.$editor.chain().focus()\n\t\t\t\t.setTextSelection(this.offset + 1)\n\t\t\tif (type === 'text-only') {\n\t\t\t\tchain.unsetPreview().run()\n\t\t\t\treturn\n\t\t\t}\n\t\t\tchain.setPreview().run()\n\t\t},\n\t\tdeleteNode() {\n\t\t\tthis.$editor.commands.deleteRange({\n\t\t\t\tfrom: this.offset,\n\t\t\t\tto: this.offset + this.nodeSize,\n\t\t\t})\n\t\t},\n\t},\n}\n</script>\n\n<style lang=\"scss\" scoped>\ndiv[contenteditable=false] {\n\tpadding: 0;\n\tmargin: 0;\n}\n\n.preview-options-container {\n\tposition: absolute;\n\twidth: 0 !important;\n\tleft: -44px;\n\ttop: 50%;\n\ttransform: translate(0, -50%);\n}\n\n</style>\n","import mod from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PreviewOptions.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PreviewOptions.vue?vue&type=script&lang=js\"","\n      import API from \"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/sass-loader/dist/cjs.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PreviewOptions.vue?vue&type=style&index=0&id=3eac6396&prod&lang=scss&scoped=true\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/sass-loader/dist/cjs.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PreviewOptions.vue?vue&type=style&index=0&id=3eac6396&prod&lang=scss&scoped=true\";\n       export default content && content.locals ? content.locals : undefined;\n","import { render, staticRenderFns } from \"./PreviewOptions.vue?vue&type=template&id=3eac6396&scoped=true\"\nimport script from \"./PreviewOptions.vue?vue&type=script&lang=js\"\nexport * from \"./PreviewOptions.vue?vue&type=script&lang=js\"\nimport style0 from \"./PreviewOptions.vue?vue&type=style&index=0&id=3eac6396&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3eac6396\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"preview-options-container\",attrs:{\"contenteditable\":\"false\"}},[_c('NcActions',{staticClass:\"preview-options\",attrs:{\"data-text-preview-options\":\"select\",\"open\":_vm.open},on:{\"update:open\":function($event){_vm.open=$event},\"open\":_vm.onOpen},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c('DotsVerticalIcon',{attrs:{\"size\":20}})]},proxy:true}])},[_vm._v(\" \"),_c('NcActionCaption',{attrs:{\"name\":_vm.t('text', 'Preview options')}}),_vm._v(\" \"),_c('NcActionRadio',{attrs:{\"data-text-preview-option\":\"text-only\",\"name\":\"preview-option\",\"value\":\"text-only\",\"checked\":_vm.type === 'text-only'},on:{\"change\":e => _vm.toggle(e.currentTarget.value)}},[_vm._v(\"\\n\\t\\t\\t\"+_vm._s(_vm.t('text', 'Text only'))+\"\\n\\t\\t\")]),_vm._v(\" \"),_c('NcActionRadio',{attrs:{\"data-text-preview-option\":\"link-preview\",\"name\":\"preview-option\",\"value\":\"link-preview\",\"checked\":_vm.type === 'link-preview'},on:{\"change\":e => _vm.toggle(e.currentTarget.value)}},[_vm._v(\"\\n\\t\\t\\t\"+_vm._s(_vm.t('text', 'Show link preview'))+\"\\n\\t\\t\")]),_vm._v(\" \"),_c('NcActionSeparator'),_vm._v(\" \"),_c('NcActionButton',{attrs:{\"close-after-click\":\"true\"},on:{\"click\":_vm.deleteNode},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c('DeleteIcon',{attrs:{\"size\":20}})]},proxy:true}])},[_vm._v(\"\\n\\t\\t\\t\"+_vm._s(_vm.t('text','Remove link'))+\"\\n\\t\\t\")])],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","/**\n * SPDX-FileCopyrightText: 2024 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport { Plugin, PluginKey } from '@tiptap/pm/state'\nimport { Decoration, DecorationSet } from '@tiptap/pm/view'\nimport extractLinkParagraphs from './extractLinkParagraphs.js'\nimport Vue from 'vue'\nimport PreviewOptions from '../components/Editor/PreviewOptions.vue'\n\nexport const previewOptionsPluginKey = new PluginKey('linkParagraphMenu')\n\n/**\n * Preview option decorations ProseMirror plugin\n * Add preview options to linkParagraphs.\n *\n * @param {object} options - options for the plugin\n * @param {object} options.editor - the tiptap editor\n *\n * @return {Plugin<DecorationSet>}\n */\nexport default function previewOptions({ editor }) {\n\treturn new Plugin({\n\t\tkey: previewOptionsPluginKey,\n\n\t\tstate: {\n\t\t\tinit(_, { doc }) {\n\t\t\t\tif (!editor.options.editable) {\n\t\t\t\t\treturn { decorations: DecorationSet.create() }\n\t\t\t\t}\n\t\t\t\tconst linkParagraphs = extractLinkParagraphs(doc)\n\t\t\t\treturn {\n\t\t\t\t\tlinkParagraphs,\n\t\t\t\t\tdecorations: linkParagraphDecorations(doc, linkParagraphs, editor),\n\t\t\t\t}\n\t\t\t},\n\t\t\tapply(tr, value, _oldState, newState) {\n\t\t\t\tif (!tr.docChanged) {\n\t\t\t\t\treturn value\n\t\t\t\t}\n\t\t\t\tif (!editor.options.editable) {\n\t\t\t\t\treturn value\n\t\t\t\t}\n\t\t\t\tconst linkParagraphs = extractLinkParagraphs(newState.doc)\n\t\t\t\tconst decorations = mapDecorations(value, tr, linkParagraphs) || linkParagraphDecorations(newState.doc, linkParagraphs, editor)\n\t\t\t\treturn { linkParagraphs, decorations }\n\t\t\t},\n\t\t},\n\n\t\tprops: {\n\t\t\tdecorations(state) {\n\t\t\t\treturn this.getState(state).decorations\n\t\t\t},\n\t\t},\n\t})\n}\n\n/**\n * Map the previous deocrations to current document state\n *\n * Return false if previewParagraphs changes or decorations would get removed. The latter prevents\n * lost decorations in case of replacements.\n *\n * @param {object} value - previous plugin state\n * @param {object} tr - current transaction\n * @param {Array} linkParagraphs - array of linkParagraphs\n *\n * @return {false|DecorationSet}\n */\nfunction mapDecorations(value, tr, linkParagraphs) {\n\tif (linkParagraphsChanged(linkParagraphs, value.linkParagraphs)) {\n\t\treturn false\n\t}\n\tlet removedDecorations = false\n\tconst decorations = value.decorations.map(tr.mapping, tr.doc, { onRemove: () => { removedDecorations = true } })\n\treturn removedDecorations\n\t\t? false\n\t\t: decorations\n}\n\n/**\n * Check if the linkParagraphs provided are equivalent.\n *\n * @param {Array} current - array of linkParagraphs\n * @param {Array} prev - linkParagraphs to compare against\n *\n * @return {boolean}\n */\nfunction linkParagraphsChanged(current, prev) {\n\treturn (current.length !== prev.length)\n\t\t|| current.some(isDifferentFrom(prev))\n}\n\n/**\n * Checks if linkParagraphs are different\n *\n * @param {Array} other - linkParagraphs to compare against\n *\n * Returns a function to be used to call to Array#some.\n * The returned function takes a linkParagraph and an index (as provided by iterators)\n */\nconst isDifferentFrom = (other) => (linkParagraph, i) => {\n\treturn linkParagraph.type !== other[i].type\n\t\t|| linkParagraph.nodeSize !== other[i].nodeSize\n}\n\n/**\n * Create anchor decorations for the given linkParagraphs\n *\n * @param {Document} doc - prosemirror doc\n * @param {Array} linkParagraphs - linkParagraphs structure in the doc\n * @param {object} editor - tiptap editor\n *\n * @return {DecorationSet}\n */\nfunction linkParagraphDecorations(doc, linkParagraphs, editor) {\n\tconst decorations = linkParagraphs.map((linkParagraph) => decorationForLinkParagraph(linkParagraph, editor))\n\treturn DecorationSet.create(doc, decorations)\n}\n\n/**\n * Create a decoration for the given linkParagraph\n *\n * @param {object} linkParagraph to decorate\n * @param {object} editor - tiptap editor\n *\n * @return {Decoration}\n */\nfunction decorationForLinkParagraph(linkParagraph, editor) {\n\treturn Decoration.widget(\n\t\tlinkParagraph.offset + 1,\n\t\tpreviewOptionForLinkParagraph(linkParagraph, editor),\n\t\t{ side: -1 },\n\t)\n}\n\n/**\n * Create a previewOptions element for the given linkParagraph\n *\n * @param {object} linkParagraph - linkParagraph to generate anchor for\n * @param {object} editor - tiptap editor\n *\n * @return {Element}\n */\nfunction previewOptionForLinkParagraph(linkParagraph, editor) {\n\tconst propsData = {\n\t\t$editor: editor,\n\t\t...linkParagraph,\n\t}\n\tconst el = document.createElement('div')\n\tconst Component = Vue.extend(PreviewOptions)\n\tconst previewOption = new Component({\n\t\tpropsData,\n\t}).$mount(el)\n\treturn previewOption.$el\n}\n","import TiptapParagraph from '@tiptap/extension-paragraph'\nimport previewOptions from '../plugins/previewOptions.js'\n\nconst Paragraph = TiptapParagraph.extend({\n\n\tparseHTML() {\n\t\treturn this.parent().map(rule => Object.assign(rule, { preserveWhitespace: 'full' }))\n\t},\n\n\taddKeyboardShortcuts() {\n\t\treturn {\n\t\t\tBackspace: () => {\n\t\t\t\t// Check that cursor is at beginning of text\n\t\t\t\tconst selection = this.editor.state.selection\n\t\t\t\tif (selection.$from.parentOffset !== 0) return false\n\n\t\t\t\tconst node = selection.$from.parent\n\t\t\t\tconst index = selection.$from.index(selection.$from.depth - 1)\n\t\t\t\t// Check there is a leading sibling\n\t\t\t\tif (index === 0) return false\n\n\t\t\t\tconst parent = selection.$from.node(selection.$from.depth - 1)\n\t\t\t\tconst previousNode = parent.child(index - 1)\n\t\t\t\t// Check this and the previous sibling are paragraphs\n\t\t\t\tif (node.type.name === this.name\n\t\t\t\t\t&& previousNode.type.name === this.name) {\n\t\t\t\t\treturn this.editor.chain().joinBackward().setHardBreak().run()\n\t\t\t\t}\n\t\t\t\treturn false\n\t\t\t},\n\t\t}\n\t},\n\n\taddProseMirrorPlugins() {\n\t\treturn [\n\t\t\tpreviewOptions({\n\t\t\t\teditor: this.editor,\n\t\t\t}),\n\t\t]\n\t},\n})\n\nexport default Paragraph\n","<!--\n  - @copyright Copyright (c) 2024 Max <max@nextcloud.com>\n  -\n  - @author Max <max@nextcloud.com>\n  -\n  - @license GNU AGPL version 3 or any later version\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\n  -\n  -->\n<template>\n\t<NodeViewWrapper data-text-el=\"preview\"\n\t\tclass=\"preview\"\n\t\tas=\"div\"\n\t\tcontenteditable=\"false\">\n\t\t<NodeViewContent />\n\t\t<NcReferenceList :text=\"node.attrs.href\"\n\t\t\t:limit=\"1\"\n\t\t\t:interactive=\"!extension.options.isEmbedded\"\n\t\t\t:display-fallback=\"true\" />\n\t</NodeViewWrapper>\n</template>\n\n<script>\nimport { nodeViewProps, NodeViewWrapper, NodeViewContent } from '@tiptap/vue-2'\nimport { NcReferenceList } from '@nextcloud/vue/dist/Components/NcRichText.js'\n\nexport default {\n\tname: 'Preview',\n\tcomponents: {\n\t\tNodeViewWrapper,\n\t\tNodeViewContent,\n\t\tNcReferenceList,\n\t},\n\tprops: nodeViewProps,\n}\n</script>\n\n<style lang=\"scss\" scoped>\n// Hide the link element inside previews. We cannot hide full node view content\n// as the preview options (prosemirror decorations) are inside it.\n[data-text-el='preview'] [data-node-view-content] :deep(a) {\n\tdisplay: none;\n}\n\n.preview {\n\tposition: relative;\n}\n\n:deep(div.widgets--list a.widget-default) {\n\tcolor: var(--color-main-text);\n\tpadding: 0;\n\ttext-decoration: none;\n\tmax-width: calc(100vw - 156px);\n}\n\n:deep(.widget-default--details) {\n\toverflow:hidden;\n\tp {\n\t\tmargin-bottom: 4px !important;\n\t}\n}\n\n/* Top align with preview image:\n * - unset center alignment\n * - margin-top of widget-default\n */\n:deep(.preview-options-container) {\n\ttop: unset;\n\ttransform: unset;\n\tmargin-top: calc(var(--default-grid-baseline, 4px) * 3) !important;\n}\n</style>\n","import mod from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Preview.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Preview.vue?vue&type=script&lang=js\"","\n      import API from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/sass-loader/dist/cjs.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Preview.vue?vue&type=style&index=0&id=26ba0d31&prod&lang=scss&scoped=true\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/sass-loader/dist/cjs.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Preview.vue?vue&type=style&index=0&id=26ba0d31&prod&lang=scss&scoped=true\";\n       export default content && content.locals ? content.locals : undefined;\n","import { render, staticRenderFns } from \"./Preview.vue?vue&type=template&id=26ba0d31&scoped=true\"\nimport script from \"./Preview.vue?vue&type=script&lang=js\"\nexport * from \"./Preview.vue?vue&type=script&lang=js\"\nimport style0 from \"./Preview.vue?vue&type=style&index=0&id=26ba0d31&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"26ba0d31\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('NodeViewWrapper',{staticClass:\"preview\",attrs:{\"data-text-el\":\"preview\",\"as\":\"div\",\"contenteditable\":\"false\"}},[_c('NodeViewContent'),_vm._v(\" \"),_c('NcReferenceList',{attrs:{\"text\":_vm.node.attrs.href,\"limit\":1,\"interactive\":!_vm.extension.options.isEmbedded,\"display-fallback\":true}})],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","/**\n * @copyright Copyright (c) 2024 Max <max@nextcloud.com>\n *\n * @author Max <max@nextcloud.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport { Node, isNodeActive, getNodeType } from '@tiptap/core'\nimport { domHref, parseHref, isLinkToSelfWithHash } from './../helpers/links.js'\nimport { VueNodeViewRenderer } from '@tiptap/vue-2'\n\nimport Preview from './Preview.vue'\n\nexport default Node.create({\n\n\tname: 'preview',\n\n\tgroup: 'block',\n\n\tcontent: 'text?',\n\n\tatom: true,\n\n\tmarks: 'link',\n\n\tisolating: true,\n\n\taddOptions() {\n\t\treturn {\n\t\t\tisEmbedded: false,\n\t\t\trelativePath: null,\n\t\t}\n\t},\n\n\taddAttributes() {\n\t\treturn {\n\t\t\thref: { parseHTML: parseHref },\n\t\t\ttitle: { parseHTML: el => el.getAttribute('title') },\n\t\t}\n\t},\n\n\tparseHTML() {\n\t\treturn [\n\t\t\t{\n\t\t\t\ttag: 'a[title=\"preview\"]',\n\t\t\t\tpriority: 1001,\n\t\t\t},\n\t\t]\n\t},\n\n\trenderHTML({ node }) {\n\t\treturn ['a', {\n\t\t\t...node.attrs,\n\t\t\thref: domHref(node, this.options.relativePath),\n\t\t\trel: 'noopener noreferrer nofollow',\n\t\t}, 0]\n\t},\n\n\taddNodeView() {\n\t\treturn VueNodeViewRenderer(Preview)\n\t},\n\n\ttoMarkdown: (state, node) => {\n\t\tstate.write('[')\n\t\tstate.text(node.textContent, false)\n\t\tstate.write(`](${node.attrs.href} (${node.attrs.title}))`)\n\t\tstate.closeBlock(node)\n\t},\n\n\taddCommands() {\n\t\treturn {\n\n\t\t\t/**\n\t\t\t * Turn a paragraph that contains a single link\n\t\t\t * into a preview.\n\t\t\t *\n\t\t\t */\n\t\t\tsetPreview: () => ({ state, chain }) => {\n\t\t\t\treturn previewPossible(state)\n\t\t\t\t\t&& chain()\n\t\t\t\t\t\t.setNode(this.name, previewAttributesFromSelection(state))\n\t\t\t\t\t\t.run()\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Turn a preview back into a paragraph with a link.\n\t\t\t *\n\t\t\t */\n\t\t\tunsetPreview: () => ({ state, chain }) => {\n\t\t\t\treturn isActive(this.name, this.attributes, state)\n\t\t\t\t\t&& chain()\n\t\t\t\t\t\t.setNode('paragraph')\n\t\t\t\t\t\t.run()\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Insert a preview for given link.\n\t\t\t *\n\t\t\t * @param {string} link the link URL\n\t\t\t */\n\t\t\tinsertPreview: (link) => ({ state, chain }) => {\n\t\t\t\treturn chain()\n\t\t\t\t\t.insertContent({\n\t\t\t\t\t\ttype: 'preview',\n\t\t\t\t\t\tattrs: { href: link, title: 'preview' },\n\t\t\t\t\t\tcontent: [{\n\t\t\t\t\t\t\ttype: 'text',\n\t\t\t\t\t\t\tmarks: [{\n\t\t\t\t\t\t\t\ttype: 'link',\n\t\t\t\t\t\t\t\tattrs: { href: link },\n\t\t\t\t\t\t\t}],\n\t\t\t\t\t\t\ttext: link,\n\t\t\t\t\t\t}],\n\t\t\t\t\t})\n\t\t\t\t\t.run()\n\t\t\t},\n\t\t}\n\t},\n})\n\n/**\n * Attributes for a preview from link in the current selection\n *\n * @param {object} state the edior state\n * @param {object} state.selection current selection\n * @return {object}\n */\nfunction previewAttributesFromSelection({ selection }) {\n\tconst { $from } = selection\n\tconst href = extractHref($from.nodeAfter)\n\treturn { href, title: 'preview' }\n}\n\n/**\n * Is the active node one of typeOrName with the given attributes\n * @param {object|string} typeOrName type or name of the preview node type\n * @param {object} attributes attributes of the node\n * @param {object} state current editor state\n * @return {boolean}\n */\nfunction isActive(typeOrName, attributes, state) {\n\tconst type = getNodeType(typeOrName, state.schema)\n\treturn isNodeActive(state, type, attributes)\n}\n\n/**\n * Is it possible to convert the currently selected node into a preview?\n * @param {object} state current editor state\n * @param {object} state.selection current selection\n * @return {boolean}\n */\nfunction previewPossible({ selection }) {\n\tconst { $from } = selection\n\tif (hasOtherContent($from.parent)) {\n\t\treturn false\n\t}\n\tconst href = extractHref($from.parent.firstChild)\n\tif (!href || isLinkToSelfWithHash(href)) {\n\t\treturn false\n\t}\n\treturn true\n}\n\n/**\n * Does the node contain more content than the first child\n * @param {object} node node to inspect\n * @return {boolean}\n */\nfunction hasOtherContent(node) {\n\treturn node.childCount > 2\n\t\t|| (node.childCount === 2 && node.lastChild.textContent.trim())\n}\n\n/**\n * Get the link href of the given node\n * @param {object} node to inspect\n * @return {string} The href of the link mark of the node\n */\nfunction extractHref(node) {\n\tif (!node) {\n\t\treturn undefined\n\t}\n\tconst link = node.marks.find(mark => mark.type.name === 'link')\n\treturn link?.attrs.href\n}\n","import Table from './Table/Table.js'\n\nexport default Table\n","// Copied from https://github.com/atlassian/prosemirror-utils/tree/1b97ff08f1bbaea781f205744588a3dfd228b0d1/src\n\n// Iterates over parent nodes starting from the given `$pos`, returning the closest node and its start position `predicate` returns truthy for. `start` points to the start position of the node, `pos` points directly before the node.\n//\n// ```javascript\n// const predicate = node => node.type === schema.nodes.blockquote;\n// const parent = findParentNodeClosestToPos(state.doc.resolve(5), predicate);\n// ```\nexport const findParentNodeClosestToPos = ($pos, predicate) => {\n\tfor (let i = $pos.depth; i > 0; i--) {\n\t\tconst node = $pos.node(i)\n\t\tif (predicate(node)) {\n\t\t\treturn {\n\t\t\t\tpos: i > 0 ? $pos.before(i) : 0,\n\t\t\t\tstart: $pos.start(i),\n\t\t\t\tdepth: i,\n\t\t\t\tnode,\n\t\t\t}\n\t\t}\n\t}\n}\n\n// Flattens descendants of a given `node`. It doesn't descend into a node when descend argument is `false` (defaults to `true`).\n//\n// ```javascript\n// const children = flatten(node);\n// ```\nexport const flatten = (node, descend = true) => {\n\tif (!node) {\n\t\tthrow new Error('Invalid \"node\" parameter')\n\t}\n\tconst result = []\n\tnode.descendants((child, pos) => {\n\t\tresult.push({ node: child, pos })\n\t\tif (!descend) {\n\t\t\treturn false\n\t\t}\n\t})\n\treturn result\n}\n\n// Iterates over descendants of a given `node`, returning child nodes predicate returns truthy for. It doesn't descend into a node when descend argument is `false` (defaults to `true`).\n//\n// ```javascript\n// const textNodes = findChildren(node, child => child.isText, false);\n// ```\nexport const findChildren = (node, predicate, descend) => {\n\tif (!node) {\n\t\tthrow new Error('Invalid \"node\" parameter')\n\t} else if (!predicate) {\n\t\tthrow new Error('Invalid \"predicate\" parameter')\n\t}\n\treturn flatten(node, descend).filter(child => predicate(child.node))\n}\n","/*\n * @copyright Copyright (c) 2019 Julius Hrtl <jus@bitgrid.net>\n *\n * @author Julius Hrtl <jus@bitgrid.net>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport TipTapTaskItem from '@tiptap/extension-task-item'\nimport { wrappingInputRule, mergeAttributes } from '@tiptap/core'\nimport { Plugin } from '@tiptap/pm/state'\nimport { findParentNodeClosestToPos } from './../helpers/prosemirrorUtils.js'\n\nconst TaskItem = TipTapTaskItem.extend({\n\n\taddOptions() {\n\t\treturn {\n\t\t\tnested: true,\n\t\t\tHTMLAttributes: {},\n\t\t}\n\t},\n\n\tdraggable: false,\n\n\tcontent: 'paragraph block*',\n\n\taddAttributes() {\n\t\tconst adjust = { ...this.parent() }\n\t\tadjust.checked.parseHTML = el => {\n\t\t\treturn el.querySelector('input[type=checkbox]')?.checked\n\t\t}\n\t\treturn adjust\n\t},\n\n\tparseHTML: [\n\t\t{\n\t\t\tpriority: 101,\n\t\t\ttag: 'li',\n\t\t\tgetAttrs: el => {\n\t\t\t\tconst checkbox = el.querySelector('input[type=checkbox]')\n\t\t\t\treturn checkbox\n\t\t\t},\n\t\t\tcontext: 'taskList/',\n\t\t},\n\t],\n\n\trenderHTML({ node, HTMLAttributes }) {\n\t\tconst listAttributes = { class: 'task-list-item checkbox-item' }\n\t\tconst checkboxAttributes = { type: 'checkbox', class: '', contenteditable: false }\n\t\tif (node.attrs.checked) {\n\t\t\tcheckboxAttributes.checked = true\n\t\t\tlistAttributes.class += ' checked'\n\t\t}\n\t\treturn [\n\t\t\t'li',\n\t\t\tmergeAttributes(HTMLAttributes, listAttributes),\n\t\t\t[\n\t\t\t\t'input',\n\t\t\t\tcheckboxAttributes,\n\t\t\t],\n\t\t\t[\n\t\t\t\t'label',\n\t\t\t\t0,\n\t\t\t],\n\t\t]\n\t},\n\n\t// overwrite the parent node view so renderHTML gets used\n\taddNodeView: false,\n\n\ttoMarkdown: (state, node) => {\n\t\tstate.write(`[${node.attrs.checked ? 'x' : ' '}] `)\n\t\tstate.renderContent(node)\n\t},\n\n\taddInputRules() {\n\t\treturn [\n\t\t\t...this.parent(),\n\t\t\twrappingInputRule({\n\t\t\t\tfind: /^\\s*([-+*])\\s(\\[(x|X|\\s)?\\])\\s$/,\n\t\t\t\ttype: this.type,\n\t\t\t\tgetAttributes: match => ({\n\t\t\t\t\tchecked: 'xX'.includes(match[match.length - 1]),\n\t\t\t\t}),\n\t\t\t}),\n\t\t]\n\t},\n\n\taddProseMirrorPlugins() {\n\t\treturn [\n\t\t\tnew Plugin({\n\t\t\t\tprops: {\n\t\t\t\t\thandleClick: (view, pos, event) => {\n\t\t\t\t\t\tconst state = view.state\n\t\t\t\t\t\tconst schema = state.schema\n\n\t\t\t\t\t\tconst coordinates = view.posAtCoords({ left: event.clientX, top: event.clientY })\n\t\t\t\t\t\tconst position = state.doc.resolve(coordinates.pos)\n\t\t\t\t\t\tconst parentList = findParentNodeClosestToPos(position, function(node) {\n\t\t\t\t\t\t\treturn node.type === schema.nodes.taskItem\n\t\t\t\t\t\t\t\t|| node.type === schema.nodes.listItem\n\t\t\t\t\t\t})\n\t\t\t\t\t\tconst isListClicked = event.target.tagName.toLowerCase() === 'li'\n\t\t\t\t\t\tif (!isListClicked\n\t\t\t\t\t\t\t|| !parentList\n\t\t\t\t\t\t\t|| parentList.node.type !== schema.nodes.taskItem\n\t\t\t\t\t\t    || !view.editable) {\n\t\t\t\t\t\t\treturn\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst tr = state.tr\n\t\t\t\t\t\ttr.setNodeMarkup(parentList.pos, schema.nodes.taskItem, { checked: !parentList.node.attrs.checked })\n\t\t\t\t\t\tview.dispatch(tr)\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t}),\n\t\t]\n\t},\n\n})\n\nexport default TaskItem\n","/*\n * @copyright Copyright (c) 2020 Julius Hrtl <jus@bitgrid.net>\n *\n * @author Julius Hrtl <jus@bitgrid.net>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport TiptapTaskList from '@tiptap/extension-task-list'\nimport { mergeAttributes } from '@tiptap/core'\n\nconst TaskList = TiptapTaskList.extend({\n\n\tparseHTML: [\n\t\t{\n\t\t\tpriority: 100,\n\t\t\ttag: 'ul.contains-task-list',\n\t\t},\n\t],\n\n\trenderHTML({ HTMLAttributes }) {\n\t\treturn ['ul', mergeAttributes(this.options.HTMLAttributes, HTMLAttributes, { class: 'contains-task-list' }), 0]\n\t},\n\n\taddAttributes() {\n\t\treturn {\n\t\t\t...this.parent?.(),\n\t\t\tbullet: {\n\t\t\t\tdefault: '-',\n\t\t\t\trendered: false,\n\t\t\t\tisRequired: true,\n\t\t\t\tparseHTML: (el) => el.getAttribute('data-bullet'),\n\t\t\t},\n\t\t}\n\t},\n\n\ttoMarkdown: (state, node) => {\n\t\tstate.renderList(node, '  ', () => `${node.attrs.bullet} `)\n\t},\n\n})\n\nexport default TaskList\n","/*\n * @copyright Copyright (c) 2021, berdosis GbR\n *\n * @license MIT\n *\n */\n\nimport { Extension } from '@tiptap/core'\nimport { PluginKey, Plugin } from '@tiptap/pm/state'\n\n/**\n * @param {object} args Arguments as deconstructable object\n * @param {Array | object} args.types possible types\n * @param {object} args.node node to check\n */\nfunction nodeEqualsType({ types, node }) {\n\treturn (Array.isArray(types) && types.includes(node.type)) || node.type === types\n}\n\n/**\n * Extension based on:\n * - https://github.com/ueberdosis/tiptap/tree/main/demos/src/Experiments/TrailingNode\n * - https://github.com/ueberdosis/tiptap/blob/v1/packages/tiptap-extensions/src/extensions/TrailingNode.js\n * - https://github.com/remirror/remirror/blob/e0f1bec4a1e8073ce8f5500d62193e52321155b9/packages/prosemirror-trailing-node/src/trailing-node-plugin.ts\n */\n\nconst TrailingNode = Extension.create({\n\tname: 'trailingNode',\n\n\taddOptions() {\n\t\treturn {\n\t\t\tnode: 'paragraph',\n\t\t\tnotAfter: ['paragraph'],\n\t\t}\n\t},\n\n\taddProseMirrorPlugins() {\n\t\tconst plugin = new PluginKey(this.name)\n\t\tconst disabledNodes = Object.entries(this.editor.schema.nodes)\n\t\t\t.map(([, value]) => value)\n\t\t\t.filter(node => this.options.notAfter.includes(node.name))\n\n\t\treturn [\n\t\t\tnew Plugin({\n\t\t\t\tkey: plugin,\n\t\t\t\tappendTransaction: (_, __, state) => {\n\t\t\t\t\tconst { doc, tr, schema } = state\n\t\t\t\t\tconst shouldInsertNodeAtEnd = plugin.getState(state)\n\t\t\t\t\tconst endPosition = doc.content.size\n\t\t\t\t\tconst type = schema.nodes[this.options.node]\n\n\t\t\t\t\tif (!shouldInsertNodeAtEnd) {\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\n\t\t\t\t\treturn tr.insert(endPosition, type.create())\n\t\t\t\t},\n\t\t\t\tstate: {\n\t\t\t\t\tinit: (_, state) => {\n\t\t\t\t\t\tconst lastNode = state.tr.doc.lastChild\n\t\t\t\t\t\treturn !nodeEqualsType({ node: lastNode, types: disabledNodes })\n\t\t\t\t\t},\n\t\t\t\t\tapply: (tr, value) => {\n\t\t\t\t\t\tif (!tr.docChanged) {\n\t\t\t\t\t\t\treturn value\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst lastNode = tr.doc.lastChild\n\t\t\t\t\t\treturn !nodeEqualsType({ node: lastNode, types: disabledNodes })\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t}),\n\t\t]\n\t},\n})\n\nexport default TrailingNode\n","/*\n * @copyright Copyright (c) 2019 Azul <azul@riseup.net>\n *\n * @author Azul <azul@riseup.net>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport TipTapLink from '@tiptap/extension-link'\nimport { domHref, parseHref } from './../helpers/links.js'\nimport { linkClicking } from '../plugins/links.js'\n\nconst PROTOCOLS_TO_LINK_TO = ['http:', 'https:', 'mailto:', 'tel:']\n\nconst Link = TipTapLink.extend({\n\n\taddOptions() {\n\t\treturn {\n\t\t\t...this.parent?.(),\n\t\t\trelativePath: null,\n\t\t}\n\t},\n\n\taddAttributes() {\n\t\treturn {\n\t\t\thref: {\n\t\t\t\tdefault: null,\n\t\t\t},\n\t\t\ttitle: {\n\t\t\t\tdefault: null,\n\t\t\t},\n\t\t}\n\t},\n\n\tinclusive: false,\n\n\tparseHTML: [\n\t\t{\n\t\t\ttag: 'a[href]',\n\t\t\tgetAttrs: dom => ({\n\t\t\t\thref: parseHref(dom),\n\t\t\t\ttitle: dom.getAttribute('title'),\n\t\t\t}),\n\t\t},\n\t],\n\n\trenderHTML(options) {\n\t\tconst { mark } = options\n\t\tlet href\n\t\ttry {\n\t\t\tconst url = new URL(mark.attrs.href, window.location)\n\t\t\thref = PROTOCOLS_TO_LINK_TO.includes(url.protocol)\n\t\t\t\t? domHref(mark, this.options.relativePath)\n\t\t\t\t: '#'\n\t\t} catch (error) {\n\t\t\thref = '#'\n\t\t}\n\t\treturn ['a', {\n\t\t\t...mark.attrs,\n\t\t\thref,\n\t\t\t'data-md-href': mark.attrs.href,\n\t\t\trel: 'noopener noreferrer nofollow',\n\t\t}, 0]\n\t},\n\n\taddProseMirrorPlugins() {\n\t\tconst plugins = this.parent()\n\t\t\t// remove upstream link click handle plugin\n\t\t\t.filter(({ key }) => {\n\t\t\t\treturn !key.startsWith('handleClickLink') && !key.startsWith('textHandleClickLink')\n\t\t\t})\n\n\t\t// Custom click handler plugins\n\t\treturn [\n\t\t\t...plugins,\n\t\t\tlinkClicking(),\n\t\t]\n\n\t},\n})\n\nexport default Link\n","/*\n * @copyright Copyright (c) 2019 Julius Hrtl <jus@bitgrid.net>\n *\n * @author Julius Hrtl <jus@bitgrid.net>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport TipTapStrike from '@tiptap/extension-strike'\n\nexport default TipTapStrike.extend({\n\n\tparseHTML() {\n\t\treturn [\n\t\t\t{\n\t\t\t\ttag: 's',\n\t\t\t},\n\t\t\t{\n\t\t\t\ttag: 'del',\n\t\t\t},\n\t\t\t{\n\t\t\t\ttag: 'strike',\n\t\t\t},\n\t\t\t{\n\t\t\t\tstyle: 'text-decoration',\n\t\t\t\tgetAttrs: value => value === 'line-through',\n\t\t\t},\n\t\t]\n\t},\n\n\trenderHTML() {\n\t\treturn ['s', 0]\n\t},\n\n\t/** Strike is currently unsupported by prosemirror-markdown */\n\ttoMarkdown: {\n\t\topen: '~~',\n\t\tclose: '~~',\n\t\tmixable: true,\n\t\texpelEnclosingWhitespace: true,\n\t},\n})\n","/*\n * @copyright Copyright (c) 2019 Julius Hrtl <jus@bitgrid.net>\n *\n * @author Julius Hrtl <jus@bitgrid.net>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport { markInputRule, markPasteRule } from '@tiptap/core'\nimport { Bold, starInputRegex, starPasteRegex } from '@tiptap/extension-bold'\n\nconst Strong = Bold.extend({\n\tname: 'strong',\n\n\taddInputRules() {\n\t\treturn [\n\t\t\tmarkInputRule({\n\t\t\t\tfind: starInputRegex,\n\t\t\t\ttype: this.type,\n\t\t\t}),\n\t\t]\n\t},\n\n\taddPasteRules() {\n\t\treturn [\n\t\t\tmarkPasteRule({\n\t\t\t\tfind: starPasteRegex,\n\t\t\t\ttype: this.type,\n\t\t\t}),\n\t\t]\n\t},\n})\n\nexport default Strong\n","/*\n * @copyright Copyright (c) 2022 Max <max@nextcloud.com>\n *\n * @author Max <max@nextcloud.com>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport TipTapUnderline from '@tiptap/extension-underline'\nimport { markInputRule, markPasteRule } from '@tiptap/core'\nimport { underscoreInputRegex, underscorePasteRegex } from '@tiptap/extension-bold'\n\nconst Underline = TipTapUnderline.extend({\n\n\tparseHTML() {\n\t\treturn [\n\t\t\t{\n\t\t\t\ttag: 'u',\n\t\t\t},\n\t\t\t{\n\t\t\t\tstyle: 'text-decoration',\n\t\t\t\tgetAttrs: value => value === 'underline',\n\t\t\t},\n\t\t]\n\t},\n\n\trenderHTML() {\n\t\treturn ['u', 0]\n\t},\n\n\ttoMarkdown: {\n\t\topen: '__',\n\t\tclose: '__',\n\t\tmixable: true,\n\t\texpelEnclosingWhitespace: true,\n\t},\n\n\taddInputRules() {\n\t\treturn [\n\t\t\tmarkInputRule({\n\t\t\t\tfind: underscoreInputRegex,\n\t\t\t\ttype: this.type,\n\t\t\t}),\n\t\t]\n\t},\n\n\taddPasteRules() {\n\t\treturn [\n\t\t\tmarkPasteRule({\n\t\t\t\tfind: underscorePasteRegex,\n\t\t\t\ttype: this.type,\n\t\t\t}),\n\t\t]\n\t},\n\n})\n\nexport default Underline\n","/*\n * @copyright Copyright (c) 2019 Julius Hrtl <jus@bitgrid.net>\n *\n * @author Julius Hrtl <jus@bitgrid.net>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport TipTapItalic from '@tiptap/extension-italic'\nimport Link from './Link.js'\nimport Strike from './Strike.js'\nimport Strong from './Strong.js'\nimport Underline from './Underline.js'\n\nconst Italic = TipTapItalic.extend({\n\tname: 'em',\n})\n\nexport {\n\tStrong,\n\tItalic,\n\tStrike,\n\tLink,\n\tUnderline,\n}\n","/**\n * @copyright Copyright (c) 2022 Max <max@nextcloud.com>\n *\n * @author Max <max@nextcloud.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport { Extension } from '@tiptap/core'\nimport { lowlight } from 'lowlight'\n\n/* eslint-disable import/no-named-as-default */\nimport Blockquote from '@tiptap/extension-blockquote'\nimport BulletList from './../nodes/BulletList.js'\nimport Callouts from './../nodes/Callouts.js'\nimport CharacterCount from '@tiptap/extension-character-count'\nimport Code from '@tiptap/extension-code'\nimport CodeBlock from './../nodes/CodeBlock.js'\nimport Document from '@tiptap/extension-document'\nimport Dropcursor from '@tiptap/extension-dropcursor'\nimport EditableTable from './../nodes/EditableTable.js'\nimport Emoji from './Emoji.js'\nimport EmojiSuggestion from './../components/Suggestion/Emoji/suggestions.js'\nimport FrontMatter from './../nodes/FrontMatter.js'\nimport Gapcursor from '@tiptap/extension-gapcursor'\nimport HardBreak from './../nodes/HardBreak.js'\nimport Heading from '../nodes/Heading.js'\nimport HorizontalRule from '@tiptap/extension-horizontal-rule'\nimport Image from './../nodes/Image.js'\nimport ImageInline from './../nodes/ImageInline.js'\nimport KeepSyntax from './KeepSyntax.js'\nimport LinkPicker from './../extensions/LinkPicker.js'\nimport LinkBubble from './../extensions/LinkBubble.js'\nimport ListItem from '@tiptap/extension-list-item'\nimport Markdown from './../extensions/Markdown.js'\nimport Mention from './../extensions/Mention.js'\nimport OrderedList from '@tiptap/extension-ordered-list'\nimport Paragraph from './../nodes/Paragraph.js'\nimport Placeholder from '@tiptap/extension-placeholder'\nimport Preview from './../nodes/Preview.js'\nimport Table from './../nodes/Table.js'\nimport TaskItem from './../nodes/TaskItem.js'\nimport TaskList from './../nodes/TaskList.js'\nimport Text from '@tiptap/extension-text'\nimport TrailingNode from './../nodes/TrailingNode.js'\n/* eslint-enable import/no-named-as-default */\n\nimport { Strong, Italic, Strike, Link, Underline } from './../marks/index.js'\nimport { translate as t } from '@nextcloud/l10n'\n\nlowlight.registerAlias('plaintext', 'mermaid')\n\nexport default Extension.create({\n\tname: 'RichText',\n\n\taddOptions() {\n\t\treturn {\n\t\t\tediting: true,\n\t\t\textensions: [],\n\t\t\tcomponent: null,\n\t\t\trelativePath: null,\n\t\t\tisEmbedded: false,\n\t\t}\n\t},\n\n\taddExtensions() {\n\t\tconst defaultExtensions = [\n\t\t\tthis.options.editing ? Markdown : null,\n\t\t\tDocument,\n\t\t\tText,\n\t\t\tParagraph,\n\t\t\tHardBreak,\n\t\t\tHeading,\n\t\t\tStrong,\n\t\t\tItalic,\n\t\t\tStrike,\n\t\t\tBlockquote,\n\t\t\tCharacterCount,\n\t\t\tCode,\n\t\t\tCodeBlock.configure({\n\t\t\t\tlowlight,\n\t\t\t\tdefaultLanguage: 'plaintext',\n\t\t\t}),\n\t\t\tBulletList,\n\t\t\tHorizontalRule,\n\t\t\tOrderedList,\n\t\t\tListItem,\n\t\t\tthis.options.editing ? EditableTable : Table,\n\t\t\tTaskList,\n\t\t\tTaskItem,\n\t\t\tCallouts,\n\t\t\tPreview.configure({\n\t\t\t\tisEmbedded: this.options.isEmbedded,\n\t\t\t}),\n\t\t\tUnderline,\n\t\t\tImage,\n\t\t\tImageInline,\n\t\t\tDropcursor,\n\t\t\tGapcursor,\n\t\t\tKeepSyntax,\n\t\t\tFrontMatter,\n\t\t\tMention,\n\t\t\tEmoji.configure({\n\t\t\t\tsuggestion: EmojiSuggestion(),\n\t\t\t}),\n\t\t\tLinkPicker,\n\t\t\tLink.configure({\n\t\t\t\topenOnClick: true,\n\t\t\t\tvalidate: href => /^https?:\\/\\//.test(href),\n\t\t\t\trelativePath: this.options.relativePath,\n\t\t\t}),\n\t\t\tLinkBubble,\n\t\t\tthis.options.editing\n\t\t\t\t? Placeholder.configure({\n\t\t\t\t\temptyNodeClass: 'is-empty',\n\t\t\t\t\tplaceholder: t('text', 'Add notes, lists or links '),\n\t\t\t\t\tshowOnlyWhenEditable: true,\n\t\t\t\t})\n\t\t\t\t: null,\n\t\t\tTrailingNode,\n\t\t]\n\t\tconst additionalExtensionNames = this.options.extensions.map(e => e.name)\n\t\treturn [\n\t\t\t...defaultExtensions.filter(e => e && !additionalExtensionNames.includes(e.name)),\n\t\t\t...this.options.extensions,\n\t\t]\n\t},\n\n})\n","/*\n * @copyright Copyright (c) 2022 Julius Hrtl <jus@bitgrid.net>\n *\n * @author Julius Hrtl <jus@bitgrid.net>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { emojiSearch } from '@nextcloud/vue'\nimport createSuggestions from '../suggestions.js'\nimport EmojiList from './EmojiList.vue'\n\nexport default () => createSuggestions({\n\tlistComponent: EmojiList,\n\titems: ({ query }) => {\n\t\treturn emojiSearch(query)\n\t},\n\tcommand: ({ editor, range, props }) => {\n\t\teditor\n\t\t\t.chain()\n\t\t\t.focus()\n\t\t\t.insertContentAt(range, props.native + ' ')\n\t\t\t.run()\n\t},\n})\n","/*\n * @copyright Copyright (c) 2020 Julius Hrtl <jus@bitgrid.net>\n *\n * @author Julius Hrtl <jus@bitgrid.net>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nexport class Span {\n\n\tconstructor(from, to, author) {\n\t\tthis.from = from\n\t\tthis.to = to\n\t\tthis.author = author\n\t}\n\n}\n","/*\n * @copyright Copyright (c) 2021 Julius Hrtl <jus@bitgrid.net>\n *\n * @author Julius Hrtl <jus@bitgrid.net>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport { Span } from './models.js'\n\n/*\n * This code is heavily inspired by the change tracking example of prosemirror\n * https://github.com/ProseMirror/website/blob/master/example/track/index.js\n */\n\n/**\n * @param {Array} map List of document ranges and corresponding authors\n * @param {object} transform ProseMirror transform object\n * @param {Array} clientIDs List of client IDs\n */\nfunction updateBlameMap(map, transform, clientIDs) {\n\tconst result = []\n\tconst mapping = transform.mapping\n\tfor (let i = 0; i < map.length; i++) {\n\t\tconst span = map[i]\n\t\tconst from = mapping.map(span.from, 1)\n\t\tconst to = mapping.map(span.to, -1)\n\t\tif (from < to) result.push(new Span(from, to, span.author))\n\t}\n\n\tfor (let i = 0; i < mapping.maps.length; i++) {\n\t\tconst map = mapping.maps[i]; const after = mapping.slice(i + 1)\n\t\tmap.forEach((_s, _e, start, end) => {\n\t\t\tinsertIntoBlameMap(result, after.map(start, 1), after.map(end, -1), clientIDs[i])\n\t\t})\n\t}\n\n\treturn result\n}\n\n/**\n * @param {Array} map List of document ranges and corresponding authors\n * @param {number} from The lower bound of the selection's main range\n * @param {number} to The upper bound of the selection's main range\n * @param {number} author ClientID of the author\n */\nfunction insertIntoBlameMap(map, from, to, author) {\n\tif (from >= to) {\n\t\treturn\n\t}\n\tlet pos = 0\n\tlet next\n\tfor (; pos < map.length; pos++) {\n\t\tnext = map[pos]\n\t\tif (next.author === author) {\n\t\t\tif (next.to >= from) break\n\t\t} else if (next.to > from) { // Different author, not before\n\t\t\tif (next.from < from) { // Sticks out to the left (loop below will handle right side)\n\t\t\t\tconst left = new Span(next.from, from, next.author)\n\t\t\t\tif (next.to > to) map.splice(pos++, 0, left)\n\t\t\t\telse map[pos++] = left\n\t\t\t}\n\t\t\tbreak\n\t\t}\n\t}\n\n\t// eslint-ignore\n\twhile ((next = map[pos])) {\n\t\tif (next.author === author) {\n\t\t\tif (next.from > to) break\n\t\t\tfrom = Math.min(from, next.from)\n\t\t\tto = Math.max(to, next.to)\n\t\t\tmap.splice(pos, 1)\n\t\t} else {\n\t\t\tif (next.from >= to) break\n\t\t\tif (next.to > to) {\n\t\t\t\tmap[pos] = new Span(to, next.to, next.author)\n\t\t\t\tbreak\n\t\t\t} else {\n\t\t\t\tmap.splice(pos, 1)\n\t\t\t}\n\t\t}\n\t}\n\n\tmap.splice(pos, 0, new Span(from, to, author))\n}\n\nexport default class TrackState {\n\n\tconstructor(blameMap) {\n\t\t// The blame map is a data structure that lists a sequence of\n\t\t// document ranges, along with the author that inserted them. This\n\t\t// can be used to, for example, highlight the part of the document\n\t\t// that was inserted by a author.\n\t\tthis.blameMap = blameMap\n\t}\n\n\t// Apply a transform to this state\n\tapplyTransform(transform) {\n\t\tconst clientID = transform.getMeta('clientID') ?? transform.steps.map(item => 'self')\n\t\tconst newBlame = updateBlameMap(this.blameMap, transform, clientID)\n\t\t// Create a new statesince these are part of the editor state, a\n\t\t// persistent data structure, they must not be mutated.\n\t\treturn new TrackState(newBlame)\n\t}\n\n}\n","/*\n * @copyright Copyright (c) 2020 Julius Hrtl <jus@bitgrid.net>\n *\n * @author Julius Hrtl <jus@bitgrid.net>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport { Extension } from '@tiptap/core'\nimport { Plugin } from '@tiptap/pm/state'\nimport { Decoration, DecorationSet } from '@tiptap/pm/view'\nimport TrackState from './tracking/TrackState.js'\nimport { Span } from './tracking/models.js'\n\nconst UserColor = Extension.create({\n\n\tname: 'users',\n\n\taddOptions() {\n\t\treturn {\n\t\t\tclientID: 0,\n\t\t\tcolor: (clientID) => {\n\t\t\t\treturn '#' + Math.floor((Math.abs(Math.sin(clientID) * 16777215)) % 16777215).toString(16) + 'aa'\n\t\t\t},\n\t\t\tname: (clientID) => {\n\t\t\t\treturn 'Unknown user ' + clientID\n\t\t\t},\n\t\t}\n\t},\n\n\taddProseMirrorPlugins() {\n\t\tlet viewReference = null\n\t\treturn [\n\t\t\tnew Plugin({\n\t\t\t\tclientID: this.options.clientID,\n\t\t\t\tcolor: this.options.color,\n\t\t\t\tname: this.options.name,\n\t\t\t\tview: (editorView) => {\n\t\t\t\t\tviewReference = editorView\n\t\t\t\t\treturn {}\n\t\t\t\t},\n\t\t\t\tstate: {\n\t\t\t\t\tinit(_, instance) {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\ttracked: new TrackState([new Span(0, instance.doc.content.size, null)], [], [], []),\n\t\t\t\t\t\t\tdeco: DecorationSet.empty,\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tapply(tr, instance, oldState, state) {\n\t\t\t\t\t\tlet { tracked, decos } = instance\n\t\t\t\t\t\tlet tState = this.getState(oldState).tracked\n\t\t\t\t\t\tif (tr.docChanged) {\n\t\t\t\t\t\t\tif (!tr.getMeta('clientID')) {\n\t\t\t\t\t\t\t\t// we have an undefined client id for own transactions\n\t\t\t\t\t\t\t\ttr.setMeta('clientID', tr.steps.map(i => this.spec.clientID))\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// Don't apply transaction when in composition (Github issue #2871)\n\t\t\t\t\t\t\tif (!viewReference.composing) {\n\t\t\t\t\t\t\t\ttracked = tracked.applyTransform(tr)\n\t\t\t\t\t\t\t\ttState = tracked\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdecos = tState.blameMap\n\t\t\t\t\t\t\t.map(span => {\n\t\t\t\t\t\t\t\tconst clientID = span.author\n\t\t\t\t\t\t\t\treturn Decoration.inline(span.from, span.to, {\n\t\t\t\t\t\t\t\t\tclass: 'author-annotation',\n\t\t\t\t\t\t\t\t\tstyle: 'background-color: ' + this.spec.color(clientID) + '66;',\n\t\t\t\t\t\t\t\t\ttitle: this.spec.name(clientID),\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t}).filter(dec => dec !== null)\n\t\t\t\t\t\treturn { tracked, deco: DecorationSet.create(state.doc, decos) }\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tprops: {\n\t\t\t\t\tdecorations(state) {\n\t\t\t\t\t\treturn this.getState(state).deco\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t}),\n\t\t]\n\t},\n\n})\n\nexport default UserColor\n","/*\n * @copyright Copyright (c) 2022 Vinicius Reis <vinicius@nextcloud.com>\n *\n * @author Vinicius Reis <vinicius@nextcloud.com>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport container from 'markdown-it-container'\n\nexport const typesAvailable = ['info', 'warn', 'error', 'success']\n\nconst buildRender = type => (tokens, idx, options, env, slf) => {\n\tconst tag = tokens[idx]\n\n\t// add attributes to the opening tag\n\tif (tag.nesting === 1) {\n\t\ttag.attrSet('data-callout', type)\n\t\ttag.attrJoin('class', `callout callout-${type}`)\n\t}\n\n\treturn slf.renderToken(tokens, idx, options, env, slf)\n}\n\n/**\n * @param {object} md Markdown object\n */\nexport default (md) => {\n\t// create a custom container to each callout type\n\ttypesAvailable.forEach(type => {\n\t\tmd.use(container, type, {\n\t\t\trender: buildRender(type),\n\t\t})\n\t})\n\n\treturn md\n}\n","/*\n * @copyright Copyright (c) 2022 Max <max@nextcloud.com>\n *\n * @author Max <max@nextcloud.com>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n/**\n * @param {import('markdown-it')} md Markdown object\n */\nexport default function splitMixedLists(md) {\n\tmd.core.ruler.after('task-lists', 'split-mixed-task-lists', state => {\n\t\tconst tokens = state.tokens\n\n\t\tfor (let i = 0; i < tokens.length; i++) {\n\t\t\tconst token = tokens[i]\n\t\t\tif (!includesClass(token, 'contains-task-list')) {\n\t\t\t\tcontinue\n\t\t\t}\n\t\t\tconst firstChild = tokens[i + 1]\n\t\t\tconst startsWithTask = includesClass(firstChild, 'task-list-item')\n\t\t\tif (!startsWithTask) {\n\t\t\t\ttoken.attrs.splice(token.attrIndex('class'))\n\t\t\t\tif (token.attrs.length === 0) {\n\t\t\t\t\ttoken.attrs = null\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst splitBefore = findChildOf(tokens, i, child => {\n\t\t\t\treturn child.nesting === 1\n\t\t\t\t\t&& includesClass(child, 'task-list-item') !== startsWithTask\n\t\t\t})\n\t\t\tif (splitBefore > i) {\n\t\t\t\tsplitListAt(tokens, splitBefore, state.Token)\n\t\t\t}\n\t\t}\n\n\t\treturn false\n\t})\n}\n\n/**\n * @param {object} token MarkdownIT token\n * @param {string} cls Class name to query\n */\nfunction includesClass(token, cls) {\n\treturn token.attrGet('class')?.split(' ').includes(cls) || false\n}\n\n/**\n * @param {Array} tokens - all the tokens in the doc\n * @param {number} index - index into the tokens array where to split\n * @param {object} TokenConstructor - constructor provided by Markdown-it\n */\nfunction splitListAt(tokens, index, TokenConstructor) {\n\tconst closeList = new TokenConstructor('bullet_list_close', 'ul', -1)\n\tcloseList.block = true\n\tconst openList = new TokenConstructor('bullet_list_open', 'ul', 1)\n\topenList.attrSet('class', 'contains-task-list')\n\topenList.block = true\n\topenList.markup = tokens[index].markup\n\ttokens.splice(index, 0, closeList, openList)\n}\n\n/**\n * @param {Array} tokens - all the tokens in the doc\n * @param {number} parentIndex - index of the parent in the tokens array\n * @param {Function} predicate - test function returned child needs to pass\n */\nfunction findChildOf(tokens, parentIndex, predicate) {\n\tconst searchLevel = tokens[parentIndex].level + 1\n\tfor (let i = parentIndex + 1; i < tokens.length; i++) {\n\t\tconst token = tokens[i]\n\t\tif (token.level < searchLevel) {\n\t\t\treturn -1\n\t\t}\n\t\tif ((token.level === searchLevel) && predicate(tokens[i])) {\n\t\t\treturn i\n\t\t}\n\t}\n\treturn -1\n}\n","/**\n * @copyright Copyright (c) 2024 Max <max@nextcloud.com>\n *\n * @author Max <max@nextcloud.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n/**\n * Check if the given tokens represent a preview in a paragraph\n * @param {Array} tokens - tokens to check\n * @param {number} i - offset into the tokens\n */\nfunction isPreviewLinkInParagraph(tokens, i) {\n\tconst [prev, cur, next] = tokens.slice(i - 1, i + 2)\n\treturn prev?.type === 'paragraph_open'\n\t\t&& cur.type === 'inline'\n\t\t&& cur.children\n\t\t&& cur.children.length === 3\n\t\t&& cur.children[0].type === 'link_open'\n\t\t&& cur.children[0].attrGet('title') === 'preview'\n\t\t&& cur.children[1].type === 'text'\n\t\t&& cur.children[2].type === 'link_close'\n\t\t&& next.type === 'paragraph_close'\n}\n\n/**\n * Remove wrapping tokens\n *\n * @param {Array} tokens - the token stream to modify\n * @param {number} i - index of the token to unwrap\n */\nfunction unwrapToken(tokens, i) {\n\t// Start from the end so indexes stay the same.\n\ttokens.splice(i + 1, 1)\n\ttokens.splice(i - 1, 1)\n}\n\n/**\n * @param {object} md Markdown object\n */\nexport default (md) => {\n\n\t/**\n\t * Markdownit plugin to unwrap previews from a paragraph\n\t *\n\t * @param {object} state handed to the plugin\n\t * @param {Array} state.tokens current token stream\n\t */\n\tfunction linkPreviews({ tokens }) {\n\t\t// do not process first and last token\n\t\tfor (let i = 1, l = tokens.length; i < (l - 1); ++i) {\n\t\t\tif (isPreviewLinkInParagraph(tokens, i)) {\n\t\t\t\tunwrapToken(tokens, i)\n\t\t\t}\n\t\t}\n\t}\n\n\tmd.core.ruler.before('linkify', 'link_previews', linkPreviews)\n}\n","import MarkdownIt from 'markdown-it'\nimport taskLists from '@hedgedoc/markdown-it-task-lists'\nimport markdownitMentions from '@quartzy/markdown-it-mentions'\nimport underline from './underline.js'\nimport splitMixedLists from './splitMixedLists.js'\nimport callouts from './callouts.js'\nimport preview from './preview.js'\nimport hardbreak from './hardbreak.js'\nimport keepSyntax from './keepSyntax.js'\nimport frontMatter from 'markdown-it-front-matter'\nimport implicitFigures from 'markdown-it-image-figures'\nimport { escapeHtml } from 'markdown-it/lib/common/utils.js'\n\nconst markdownit = MarkdownIt('commonmark', { html: false, breaks: false })\n\t.enable('strikethrough')\n\t.enable('table')\n\t.use(taskLists, { enable: true, labelAfter: true })\n\t.use(frontMatter, (fm) => {})\n\t.use(splitMixedLists) // needs task Lists to be used first.\n\t.use(underline)\n\t.use(hardbreak)\n\t.use(callouts)\n\t.use(preview)\n\t.use(keepSyntax)\n\t.use(markdownitMentions)\n\t.use(implicitFigures)\n\n// Render front matter tokens\nmarkdownit.renderer.rules.front_matter = (tokens, idx, options) => `<pre id=\"frontmatter\"><code>${escapeHtml(tokens[idx].meta)}</code></pre>`\n\n// Render lists with bullet attribute\nmarkdownit.renderer.rules.bullet_list_open = (tokens, idx, options) => {\n\ttokens[idx].attrs = [\n\t\t...(tokens[idx].attrs || []),\n\t\t['data-bullet', tokens[idx].markup],\n\t]\n\treturn markdownit.renderer.renderToken(tokens, idx, options)\n}\n\nexport default markdownit\n","/*\n * @copyright Copyright (c) 2022 Max <max@nextcloud.com>\n *\n * @author Max <max@nextcloud.com>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n/**\n * @param {object} md Markdown object\n */\nexport default function markdownUnderlines(md) {\n\tmd.inline.ruler2.after('emphasis', 'underline', state => {\n\t\tconst tokens = state.tokens\n\n\t\tfor (let i = tokens.length - 1; i > 0; i--) {\n\t\t\tconst token = tokens[i]\n\n\t\t\tif (token.markup === '__') {\n\t\t\t\tif (token.type === 'strong_open') {\n\t\t\t\t\ttokens[i].tag = 'u'\n\t\t\t\t\ttokens[i].type = 'u_open'\n\t\t\t\t}\n\t\t\t\tif (token.type === 'strong_close') {\n\t\t\t\t\ttokens[i].tag = 'u'\n\t\t\t\t\ttokens[i].type = 'u_close'\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn false\n\t})\n}\n","/**\n * @copyright Copyright (c) 2022\n *\n * @author Ferdinand Thiessen <rpm@fthiessen.de>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport markdownitNewline from 'markdown-it/lib/rules_inline/newline.js'\nimport markdownitEscape from 'markdown-it/lib/rules_inline/escape.js'\n\n/**\n * Add information about used markdown syntax to HTML hard breaks\n *\n * @param {import('markdown-it')} md Markdown object\n */\nexport default function keepHardbreakSyntax(md) {\n\t// Add syntax information to hard line breaks using double spaces\n\tmd.inline.ruler.at('newline', (state, silent) => {\n\t\tconst rval = markdownitNewline(state, silent)\n\t\tif (rval && state.tokens.length && state.tokens[state.tokens.length - 1].type === 'hardbreak') state.tokens[state.tokens.length - 1].attrSet('syntax', '  ')\n\t\treturn rval\n\t})\n\n\t// Add syntax information to hard line breaks using a backslash\n\tmd.inline.ruler.at('escape', (state, silent) => {\n\t\tconst rval = markdownitEscape(state, silent)\n\t\tif (rval && state.tokens.length && state.tokens[state.tokens.length - 1].type === 'hardbreak') state.tokens[state.tokens.length - 1].attrSet('syntax', '\\\\')\n\t\treturn rval\n\t})\n\n\t// Add rule for parsing `<br>` tags (as we have HTML disabled)\n\tmd.inline.ruler.after('html_inline', 'html_breaks', (state) => {\n\t\tconst res = state.src.slice(state.pos).match(/^\\s*<br\\s*\\/?>/)\n\n\t\tif (res) {\n\t\t\tconst token = state.push('hardbreak', 'br', 0)\n\t\t\ttoken.attrPush(['syntax', 'html'])\n\t\t\tstate.pos += res[0].length\n\t\t\treturn true\n\t\t}\n\t\treturn false\n\t})\n\n\t// Adds syntax attribute to `<br>` and fixes issue #3370 (no additional newline after `<br>`)\n\tmd.renderer.rules.hardbreak = (tokens, idx, options) => `<br data-syntax=\"${tokens[idx].attrGet('syntax')}\" ${options.xhtmlOut ? '/' : ''}>`\n}\n","/**\n * @copyright Copyright (c) 2022\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n/**\n * Add a mark for keeping special markdown syntax unescaped\n *\n * @param {object} md Markdown object\n */\nexport default function keepSyntax(md) {\n\t// Extracting named groups as positive lookbehind patterns are not supported by Safari\n\tconst escaped = /(\\n(?<linestart>[#\\-*+>])|(?<special>[`*\\\\~[\\]]+))/\n\n\tmd.core.ruler.before('text_join', 'tag-markdown-syntax', state => {\n\t\tconst open = new state.Token('keep_md_open', 'span', 1)\n\t\topen.attrSet('class', 'keep-md')\n\t\tconst close = new state.Token('keep_md_close', 'span', -1)\n\n\t\tfor (let i = 0; i < state.tokens.length; i++) {\n\t\t\tconst block = state.tokens[i]\n\t\t\tif (block.type !== 'inline') continue\n\n\t\t\tfor (let j = 0; j < block.children.length; j++) {\n\t\t\t\tconst token = block.children[j]\n\t\t\t\tif (token.type === 'text') {\n\t\t\t\t\tconst match = escaped.exec(token.content)\n\t\t\t\t\tif (match) {\n\t\t\t\t\t\tconst index = match.groups.linestart ? match.index + 1 : match.index\n\t\t\t\t\t\tconst matchChars = match.groups.linestart ?? match.groups.special\n\t\t\t\t\t\tconst contentNext = index + matchChars.length\n\t\t\t\t\t\tblock.children.splice(j, 1,\n\t\t\t\t\t\t\tObject.assign({}, token, { content: token.content.slice(0, index) }),\n\t\t\t\t\t\t\tObject.assign({}, open),\n\t\t\t\t\t\t\tObject.assign({}, token, { content: token.content.slice(index, contentNext) }),\n\t\t\t\t\t\t\tObject.assign({}, close),\n\t\t\t\t\t\t\tObject.assign({}, token, { content: token.content.slice(contentNext) }),\n\t\t\t\t\t\t)\n\t\t\t\t\t\tj += 3\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn false\n\t})\n}\n","/*\n * @copyright Copyright (c) 2021 Julius Hrtl <jus@bitgrid.net>\n *\n * @author Julius Hrtl <jus@bitgrid.net>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport store, { textModule } from '../store/index.js'\n\n/**\n * This mixin is required since we cannot be sure that the root Vue instance has\n * registered the global store. This might be the case if the text app components\n * are mounted in other apps e.g. viewer\n */\nexport default {\n\tdata() {\n\t\treturn {\n\t\t\t$store: store,\n\t\t}\n\t},\n\tbeforeMount() {\n\t\tif (typeof this.$store === 'undefined') {\n\t\t\t// Store is undefined, e.g. when used through `viewer.js`\n\t\t\tthis.$store = store\n\t\t} else if (!this.$store.hasModule('text')) {\n\t\t\t// Store lacks text modul (another store exists), e.g. when used as component via NPM package\n\t\t\tthis.$store.registerModule('text', textModule)\n\t\t}\n\t},\n}\n","<!--\n  - @copyright Copyright (c) 2022 Max <max@nextcloud.com>\n  -\n  - @author Max <max@nextcloud.com>\n  -\n  - @license GNU AGPL version 3 or any later version\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\n  -\n  -->\n\n<template>\n\t<NodeViewWrapper data-text-el=\"table-view\" class=\"table-wrapper\">\n\t\t<NcActions v-if=\"isEditable\"\n\t\t\tforce-menu\n\t\t\tdata-text-table-actions=\"settings\"\n\t\t\tclass=\"table-settings\">\n\t\t\t<template #icon>\n\t\t\t\t<TableSettings />\n\t\t\t</template>\n\t\t\t<NcActionButton data-text-table-action=\"delete\"\n\t\t\t\tclose-after-click\n\t\t\t\t@click=\"deleteNode\">\n\t\t\t\t<template #icon>\n\t\t\t\t\t<Delete />\n\t\t\t\t</template>\n\t\t\t\t{{ t('text', 'Delete this table') }}\n\t\t\t</NcActionButton>\n\t\t</NcActions>\n\t\t<NodeViewContent class=\"content\" as=\"table\" />\n\t\t<div class=\"clearfix\" />\n\t</NodeViewWrapper>\n</template>\n\n<script>\nimport { NodeViewWrapper, NodeViewContent } from '@tiptap/vue-2'\nimport { NcActions, NcActionButton } from '@nextcloud/vue'\nimport { TableSettings, Delete } from '../../components/icons.js'\n\nexport default {\n\tname: 'TableView',\n\tcomponents: {\n\t\tNcActionButton,\n\t\tNcActions,\n\t\tNodeViewWrapper,\n\t\tNodeViewContent,\n\t\tTableSettings,\n\t\tDelete,\n\t},\n\tprops: {\n\t\teditor: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tdeleteNode: {\n\t\t\ttype: Function,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tisEditable: false,\n\t\t}\n\t},\n\tbeforeMount() {\n\t\tthis.isEditable = this.editor.isEditable\n\t\tthis.editor.on('update', ({ editor }) => {\n\t\t\tthis.isEditable = editor.isEditable\n\t\t})\n\t},\n}\n</script>\n\n<style scoped lang=\"scss\">\n.table-wrapper {\n\tposition: relative;\n\toverflow-x: auto;\n}\n\n.clearfix {\n\tclear: both;\n}\n\ntable {\n\tfloat: left;\n}\n\n.table-settings {\n\tpadding-left: 3px;\n\topacity: .5;\n\tposition: absolute;\n\ttop: 0;\n\tright: 3px;\n\n\t&:hover {\n\t\topacity: 1;\n\t}\n}\n</style>\n","import mod from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TableView.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TableView.vue?vue&type=script&lang=js\"","\n      import API from \"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/sass-loader/dist/cjs.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TableView.vue?vue&type=style&index=0&id=048279dc&prod&scoped=true&lang=scss\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/sass-loader/dist/cjs.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TableView.vue?vue&type=style&index=0&id=048279dc&prod&scoped=true&lang=scss\";\n       export default content && content.locals ? content.locals : undefined;\n","import { render, staticRenderFns } from \"./TableView.vue?vue&type=template&id=048279dc&scoped=true\"\nimport script from \"./TableView.vue?vue&type=script&lang=js\"\nexport * from \"./TableView.vue?vue&type=script&lang=js\"\nimport style0 from \"./TableView.vue?vue&type=style&index=0&id=048279dc&prod&scoped=true&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"048279dc\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('NodeViewWrapper',{staticClass:\"table-wrapper\",attrs:{\"data-text-el\":\"table-view\"}},[(_vm.isEditable)?_c('NcActions',{staticClass:\"table-settings\",attrs:{\"force-menu\":\"\",\"data-text-table-actions\":\"settings\"},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c('TableSettings')]},proxy:true}],null,false,1699550424)},[_vm._v(\" \"),_c('NcActionButton',{attrs:{\"data-text-table-action\":\"delete\",\"close-after-click\":\"\"},on:{\"click\":_vm.deleteNode},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c('Delete')]},proxy:true}],null,false,3429380666)},[_vm._v(\"\\n\\t\\t\\t\"+_vm._s(_vm.t('text', 'Delete this table'))+\"\\n\\t\\t\")])],1):_vm._e(),_vm._v(\" \"),_c('NodeViewContent',{staticClass:\"content\",attrs:{\"as\":\"table\"}}),_vm._v(\" \"),_c('div',{staticClass:\"clearfix\"})],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<!--\n  - @copyright Copyright (c) 2022 Max <max@nextcloud.com>\n  -\n  - @author Max <max@nextcloud.com>\n  -\n  - @license GNU AGPL version 3 or any later version\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\n  -\n  -->\n\n<template>\n\t<NodeViewWrapper data-text-el=\"table-cell\" as=\"td\" :style=\"textAlign\">\n\t\t<div class=\"container\">\n\t\t\t<NodeViewContent class=\"content\" />\n\t\t\t<NcActions v-if=\"isEditable\"\n\t\t\t\tdata-text-table-actions=\"row\">\n\t\t\t\t<NcActionButton data-text-table-action=\"add-row-before\"\n\t\t\t\t\tclose-after-click\n\t\t\t\t\t@click=\"addRowBefore\">\n\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t<TableAddRowBefore />\n\t\t\t\t\t</template>\n\t\t\t\t\t{{ t('text', 'Add row before') }}\n\t\t\t\t</NcActionButton>\n\t\t\t\t<NcActionButton data-text-table-action=\"add-row-after\"\n\t\t\t\t\tclose-after-click\n\t\t\t\t\t@click=\"addRowAfter\">\n\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t<TableAddRowAfter />\n\t\t\t\t\t</template>\n\t\t\t\t\t{{ t('text', 'Add row after') }}\n\t\t\t\t</NcActionButton>\n\t\t\t\t<NcActionButton data-text-table-action=\"remove-row\"\n\t\t\t\t\tclose-after-click\n\t\t\t\t\t@click=\"deleteRow\">\n\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t<Delete />\n\t\t\t\t\t</template>\n\t\t\t\t\t{{ t('text', 'Delete this row') }}\n\t\t\t\t</NcActionButton>\n\t\t\t</NcActions>\n\t\t</div>\n\t</NodeViewWrapper>\n</template>\n\n<script>\nimport { NodeViewWrapper, NodeViewContent } from '@tiptap/vue-2'\nimport { NcActions, NcActionButton } from '@nextcloud/vue'\nimport { TableAddRowBefore, TableAddRowAfter, Delete } from '../../components/icons.js'\n\nexport default {\n\tname: 'TableCellView',\n\tcomponents: {\n\t\tNcActionButton,\n\t\tNcActions,\n\t\tNodeViewWrapper,\n\t\tNodeViewContent,\n\t\tTableAddRowBefore,\n\t\tTableAddRowAfter,\n\t\tDelete,\n\t},\n\tprops: {\n\t\teditor: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tgetPos: {\n\t\t\ttype: Function,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tisEditable: false,\n\t\t}\n\t},\n\tcomputed: {\n\t\ttextAlign() {\n\t\t\treturn { 'text-align': this.node.attrs.textAlign }\n\t\t},\n\t},\n\tbeforeMount() {\n\t\tthis.isEditable = this.editor.isEditable\n\t\tthis.editor.on('update', ({ editor }) => {\n\t\t\tthis.isEditable = editor.isEditable\n\t\t})\n\t},\n\tmethods: {\n\t\tdeleteRow() {\n\t\t\tthis.editor.chain()\n\t\t\t\t.focus()\n\t\t\t\t.setTextSelection(this.getPos())\n\t\t\t\t.deleteRow()\n\t\t\t\t.run()\n\t\t},\n\t\taddRowBefore() {\n\t\t\tthis.editor.chain()\n\t\t\t\t.focus()\n\t\t\t\t.setTextSelection(this.getPos())\n\t\t\t\t.addRowBefore()\n\t\t\t\t.run()\n\t\t},\n\t\taddRowAfter() {\n\t\t\tthis.editor.chain()\n\t\t\t\t.focus()\n\t\t\t\t.setTextSelection(this.getPos())\n\t\t\t\t.addRowAfter()\n\t\t\t\t.run()\n\t\t},\n\t},\n}\n</script>\n\n<style scoped lang=\"scss\">\ntd {\n\tposition: relative;\n\n\t.container {\n\t\tdisplay: flex;\n\t\tflex-wrap: wrap;\n\t\tmin-height: 36px;\n\t}\n\n\t.content {\n\t\tflex: 1 1 0;\n\t\tmargin: 0;\n\t\tpadding-top: 0.6em;\n\t}\n\n\t.action-item {\n\t\tposition: absolute;\n\t\tright: -48px;\n\t\tflex: 0 1 auto;\n\t\tdisplay: none;\n\t\ttop: 2px;\n\t}\n\n\t&:last-child {\n\t\t.action-item {\n\t\t\tdisplay: block;\n\t\t\topacity: 50%;\n\t\t}\n\n\t\t&:hover, &:active, &:focus, &:focus-within {\n\t\t\t.action-item {\n\t\t\t\topacity: 100%;\n\t\t\t}\n\t\t}\n\t}\n\n}\n\n</style>\n","import mod from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TableCellView.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TableCellView.vue?vue&type=script&lang=js\"","\n      import API from \"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/sass-loader/dist/cjs.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TableCellView.vue?vue&type=style&index=0&id=2f56cd8c&prod&scoped=true&lang=scss\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/sass-loader/dist/cjs.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TableCellView.vue?vue&type=style&index=0&id=2f56cd8c&prod&scoped=true&lang=scss\";\n       export default content && content.locals ? content.locals : undefined;\n","import { render, staticRenderFns } from \"./TableCellView.vue?vue&type=template&id=2f56cd8c&scoped=true\"\nimport script from \"./TableCellView.vue?vue&type=script&lang=js\"\nexport * from \"./TableCellView.vue?vue&type=script&lang=js\"\nimport style0 from \"./TableCellView.vue?vue&type=style&index=0&id=2f56cd8c&prod&scoped=true&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2f56cd8c\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('NodeViewWrapper',{style:(_vm.textAlign),attrs:{\"data-text-el\":\"table-cell\",\"as\":\"td\"}},[_c('div',{staticClass:\"container\"},[_c('NodeViewContent',{staticClass:\"content\"}),_vm._v(\" \"),(_vm.isEditable)?_c('NcActions',{attrs:{\"data-text-table-actions\":\"row\"}},[_c('NcActionButton',{attrs:{\"data-text-table-action\":\"add-row-before\",\"close-after-click\":\"\"},on:{\"click\":_vm.addRowBefore},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c('TableAddRowBefore')]},proxy:true}],null,false,1805502767)},[_vm._v(\"\\n\\t\\t\\t\\t\"+_vm._s(_vm.t('text', 'Add row before'))+\"\\n\\t\\t\\t\")]),_vm._v(\" \"),_c('NcActionButton',{attrs:{\"data-text-table-action\":\"add-row-after\",\"close-after-click\":\"\"},on:{\"click\":_vm.addRowAfter},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c('TableAddRowAfter')]},proxy:true}],null,false,3179199218)},[_vm._v(\"\\n\\t\\t\\t\\t\"+_vm._s(_vm.t('text', 'Add row after'))+\"\\n\\t\\t\\t\")]),_vm._v(\" \"),_c('NcActionButton',{attrs:{\"data-text-table-action\":\"remove-row\",\"close-after-click\":\"\"},on:{\"click\":_vm.deleteRow},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c('Delete')]},proxy:true}],null,false,3429380666)},[_vm._v(\"\\n\\t\\t\\t\\t\"+_vm._s(_vm.t('text', 'Delete this row'))+\"\\n\\t\\t\\t\")])],1):_vm._e()],1)])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<!--\n  - @copyright Copyright (c) 2022 Max <max@nextcloud.com>\n  -\n  - @author Max <max@nextcloud.com>\n  - @author Grigorii K. Shartsev <me@shgk.me>\n  -\n  - @license GNU AGPL version 3 or any later version\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\n  -\n  -->\n\n<template>\n\t<NodeViewWrapper data-text-el=\"table-header\" as=\"th\" :style=\"textAlign\">\n\t\t<div>\n\t\t\t<NodeViewContent class=\"content\" />\n\t\t\t<NcActions v-if=\"isEditable\"\n\t\t\t\tref=\"menu\"\n\t\t\t\tdata-text-table-actions=\"header\">\n\t\t\t\t<NcActionButtonGroup>\n\t\t\t\t\t<NcActionButton data-text-table-action=\"align-column-left\"\n\t\t\t\t\t\t:aria-label=\"t('text', 'Left align column')\"\n\t\t\t\t\t\ttype=\"radio\"\n\t\t\t\t\t\tvalue=\"left\"\n\t\t\t\t\t\t:model-value=\"node.attrs.textAlign\"\n\t\t\t\t\t\t@click=\"alignLeft\">\n\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t<AlignHorizontalLeft />\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</NcActionButton>\n\t\t\t\t\t<NcActionButton data-text-table-action=\"align-column-center\"\n\t\t\t\t\t\t:aria-label=\"t('text', 'Center align column')\"\n\t\t\t\t\t\ttype=\"radio\"\n\t\t\t\t\t\tvalue=\"center\"\n\t\t\t\t\t\t:model-value=\"node.attrs.textAlign\"\n\t\t\t\t\t\t@click=\"alignCenter\">\n\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t<AlignHorizontalCenter />\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</NcActionButton>\n\t\t\t\t\t<NcActionButton data-text-table-action=\"align-column-right\"\n\t\t\t\t\t\t:aria-label=\"t('text', 'Right align column')\"\n\t\t\t\t\t\ttype=\"radio\"\n\t\t\t\t\t\tvalue=\"right\"\n\t\t\t\t\t\t:model-value=\"node.attrs.textAlign\"\n\t\t\t\t\t\t@click=\"alignRight\">\n\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t<AlignHorizontalRight />\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</NcActionButton>\n\t\t\t\t</NcActionButtonGroup>\n\t\t\t\t<NcActionButton data-text-table-action=\"add-column-before\"\n\t\t\t\t\tclose-after-click\n\t\t\t\t\t@click=\"addColumnBefore\">\n\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t<TableAddColumnBefore />\n\t\t\t\t\t</template>\n\t\t\t\t\t{{ t('text', 'Add column before') }}\n\t\t\t\t</NcActionButton>\n\t\t\t\t<NcActionButton data-text-table-action=\"add-column-after\"\n\t\t\t\t\tclose-after-click\n\t\t\t\t\t@click=\"addColumnAfter\">\n\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t<TableAddColumnAfter />\n\t\t\t\t\t</template>\n\t\t\t\t\t{{ t('text', 'Add column after') }}\n\t\t\t\t</NcActionButton>\n\t\t\t\t<NcActionButton data-text-table-action=\"remove-column\"\n\t\t\t\t\tclose-after-click\n\t\t\t\t\t@click=\"deleteColumn\">\n\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t<Delete />\n\t\t\t\t\t</template>\n\t\t\t\t\t{{ t('text', 'Delete this column') }}\n\t\t\t\t</NcActionButton>\n\t\t\t</NcActions>\n\t\t</div>\n\t</NodeViewWrapper>\n</template>\n\n<script>\nimport { NodeViewWrapper, NodeViewContent } from '@tiptap/vue-2'\nimport { NcActions, NcActionButton, NcActionButtonGroup } from '@nextcloud/vue'\nimport {\n\tAlignHorizontalCenter,\n\tAlignHorizontalLeft,\n\tAlignHorizontalRight,\n\tDelete,\n\tTableAddColumnBefore,\n\tTableAddColumnAfter,\n} from '../../components/icons.js'\n\nexport default {\n\tname: 'TableHeaderView',\n\tcomponents: {\n\t\tAlignHorizontalCenter,\n\t\tAlignHorizontalLeft,\n\t\tAlignHorizontalRight,\n\t\tDelete,\n\t\tNcActionButton,\n\t\tNcActionButtonGroup,\n\t\tNcActions,\n\t\tNodeViewWrapper,\n\t\tNodeViewContent,\n\t\tTableAddColumnBefore,\n\t\tTableAddColumnAfter,\n\t},\n\tprops: {\n\t\teditor: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tgetPos: {\n\t\t\ttype: Function,\n\t\t\trequired: true,\n\t\t},\n\t\tnode: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tisEditable: false,\n\t\t}\n\t},\n\tcomputed: {\n\t\ttextAlign() {\n\t\t\treturn { 'text-align': this.node.attrs.textAlign }\n\t\t},\n\t},\n\tbeforeMount() {\n\t\tthis.isEditable = this.editor.isEditable\n\t\tthis.editor.on('update', ({ editor }) => {\n\t\t\tthis.isEditable = editor.isEditable\n\t\t})\n\t},\n\tmethods: {\n\t\talignCenter() {\n\t\t\tthis.align('center')\n\t\t},\n\t\talignLeft() {\n\t\t\tthis.align('left')\n\t\t},\n\t\talignRight() {\n\t\t\tthis.align('right')\n\t\t},\n\t\talign(textAlign) {\n\t\t\tthis.editor.chain()\n\t\t\t\t.focus()\n\t\t\t\t.setTextSelection(this.getPos())\n\t\t\t\t.setCellAttribute('textAlign', textAlign)\n\t\t\t\t.run()\n\t\t\twhile (this.editor.commands.goToNextRow()) {\n\t\t\t\tthis.editor.commands.setCellAttribute('textAlign', textAlign)\n\t\t\t}\n\t\t\t// Set focus back to first row\n\t\t\tthis.editor.chain()\n\t\t\t\t.setTextSelection(this.getPos())\n\t\t\t\t.focus()\n\t\t\t\t.run()\n\t\t\tthis.$refs.menu.closeMenu(false)\n\t\t},\n\t\tdeleteColumn() {\n\t\t\tthis.editor.chain()\n\t\t\t\t.focus()\n\t\t\t\t.setTextSelection(this.getPos())\n\t\t\t\t.deleteColumn()\n\t\t\t\t.run()\n\t\t},\n\t\taddColumnBefore() {\n\t\t\tthis.editor.chain()\n\t\t\t\t.focus()\n\t\t\t\t.setTextSelection(this.getPos())\n\t\t\t\t.addColumnBefore()\n\t\t\t\t.run()\n\t\t},\n\t\taddColumnAfter() {\n\t\t\tthis.editor.chain()\n\t\t\t\t.focus()\n\t\t\t\t.setTextSelection(this.getPos())\n\t\t\t\t.addColumnAfter()\n\t\t\t\t.run()\n\t\t},\n\t},\n}\n</script>\n\n<style scoped lang=\"scss\">\nth {\n\n\t.content {\n\t\tmargin: 0;\n\t\tpadding-top: 0.75em;\n\t\tflex-grow: 1;\n\t}\n\t.action-item {\n\t\topacity: 50%;\n\t}\n\n\t&:hover, &:active, &:focus, &:focus-within {\n\t\t.action-item {\n\t\t\topacity: 100%;\n\t\t}\n\t}\n}\n</style>\n","import mod from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TableHeaderView.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TableHeaderView.vue?vue&type=script&lang=js\"","\n      import API from \"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/sass-loader/dist/cjs.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TableHeaderView.vue?vue&type=style&index=0&id=a456a642&prod&scoped=true&lang=scss\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/sass-loader/dist/cjs.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TableHeaderView.vue?vue&type=style&index=0&id=a456a642&prod&scoped=true&lang=scss\";\n       export default content && content.locals ? content.locals : undefined;\n","import { render, staticRenderFns } from \"./TableHeaderView.vue?vue&type=template&id=a456a642&scoped=true\"\nimport script from \"./TableHeaderView.vue?vue&type=script&lang=js\"\nexport * from \"./TableHeaderView.vue?vue&type=script&lang=js\"\nimport style0 from \"./TableHeaderView.vue?vue&type=style&index=0&id=a456a642&prod&scoped=true&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"a456a642\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('NodeViewWrapper',{style:(_vm.textAlign),attrs:{\"data-text-el\":\"table-header\",\"as\":\"th\"}},[_c('div',[_c('NodeViewContent',{staticClass:\"content\"}),_vm._v(\" \"),(_vm.isEditable)?_c('NcActions',{ref:\"menu\",attrs:{\"data-text-table-actions\":\"header\"}},[_c('NcActionButtonGroup',[_c('NcActionButton',{attrs:{\"data-text-table-action\":\"align-column-left\",\"aria-label\":_vm.t('text', 'Left align column'),\"type\":\"radio\",\"value\":\"left\",\"model-value\":_vm.node.attrs.textAlign},on:{\"click\":_vm.alignLeft},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c('AlignHorizontalLeft')]},proxy:true}],null,false,2968467243)}),_vm._v(\" \"),_c('NcActionButton',{attrs:{\"data-text-table-action\":\"align-column-center\",\"aria-label\":_vm.t('text', 'Center align column'),\"type\":\"radio\",\"value\":\"center\",\"model-value\":_vm.node.attrs.textAlign},on:{\"click\":_vm.alignCenter},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c('AlignHorizontalCenter')]},proxy:true}],null,false,536750267)}),_vm._v(\" \"),_c('NcActionButton',{attrs:{\"data-text-table-action\":\"align-column-right\",\"aria-label\":_vm.t('text', 'Right align column'),\"type\":\"radio\",\"value\":\"right\",\"model-value\":_vm.node.attrs.textAlign},on:{\"click\":_vm.alignRight},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c('AlignHorizontalRight')]},proxy:true}],null,false,3861151024)})],1),_vm._v(\" \"),_c('NcActionButton',{attrs:{\"data-text-table-action\":\"add-column-before\",\"close-after-click\":\"\"},on:{\"click\":_vm.addColumnBefore},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c('TableAddColumnBefore')]},proxy:true}],null,false,3782681875)},[_vm._v(\"\\n\\t\\t\\t\\t\"+_vm._s(_vm.t('text', 'Add column before'))+\"\\n\\t\\t\\t\")]),_vm._v(\" \"),_c('NcActionButton',{attrs:{\"data-text-table-action\":\"add-column-after\",\"close-after-click\":\"\"},on:{\"click\":_vm.addColumnAfter},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c('TableAddColumnAfter')]},proxy:true}],null,false,1608287598)},[_vm._v(\"\\n\\t\\t\\t\\t\"+_vm._s(_vm.t('text', 'Add column after'))+\"\\n\\t\\t\\t\")]),_vm._v(\" \"),_c('NcActionButton',{attrs:{\"data-text-table-action\":\"remove-column\",\"close-after-click\":\"\"},on:{\"click\":_vm.deleteColumn},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c('Delete')]},proxy:true}],null,false,3429380666)},[_vm._v(\"\\n\\t\\t\\t\\t\"+_vm._s(_vm.t('text', 'Delete this column'))+\"\\n\\t\\t\\t\")])],1):_vm._e()],1)])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import Table from './Table/Table.js'\nimport TableCaption from './Table/TableCaption.js'\nimport TableCell from './Table/TableCell.js'\nimport TableHeader from './Table/TableHeader.js'\nimport TableHeadRow from './Table/TableHeadRow.js'\nimport TableRow from './Table/TableRow.js'\nimport { VueNodeViewRenderer } from '@tiptap/vue-2'\nimport TableView from './Table/TableView.vue'\nimport TableCellView from './Table/TableCellView.vue'\nimport TableHeaderView from './Table/TableHeaderView.vue'\n\n/**\n * Add the node view to the node.\n * The node views include buttons to enable editing the table.\n *\n * @param {object} node - the node to add the view to.\n * @param {object} view - the node view to add to the node.\n */\nfunction extendNodeWithView(node, view) {\n\treturn node.extend({\n\t\taddNodeView() {\n\t\t\treturn VueNodeViewRenderer(view)\n\t\t},\n\t})\n}\n\nexport default Table.extend({\n\n\taddNodeView() {\n\t\treturn VueNodeViewRenderer(TableView)\n\t},\n\n\taddExtensions() {\n\t\treturn [\n\t\t\tTableCaption,\n\t\t\textendNodeWithView(TableCell, TableCellView),\n\t\t\textendNodeWithView(TableHeader, TableHeaderView),\n\t\t\tTableHeadRow,\n\t\t\tTableRow,\n\t\t]\n\t},\n})\n","/**\n * SPDX-FileCopyrightText: 2025 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport { Node } from '@tiptap/core'\n\nexport default Node.create({\n\tname: 'doc',\n\tcontent: 'table',\n})\n","import { mergeAttributes } from '@tiptap/core'\nimport { Table } from '@tiptap/extension-table'\nimport TableCaption from './TableCaption.js'\nimport TableCell from './TableCell.js'\nimport TableHeader from './TableHeader.js'\nimport TableHeadRow from './TableHeadRow.js'\nimport TableRow from './TableRow.js'\nimport { TextSelection } from '@tiptap/pm/state'\nimport {\n\taddRowAfter,\n\taddRowBefore,\n\tisInTable,\n\tmoveCellForward,\n\tselectedRect,\n\tselectionCell,\n} from '@tiptap/pm/tables'\nimport { Node } from '@tiptap/pm/model'\n\n/**\n *\n * @param {object} schema - schema of the editor\n * @param {number} rowsCount - number of rows in the table\n * @param {number} colsCount - number of cols in the table\n * @param {object} cellContent - currently unused\n */\nfunction createTable(schema, rowsCount, colsCount, cellContent) {\n\tconst headerCells = []\n\tconst cells = []\n\tfor (let index = 0; index < colsCount; index += 1) {\n\t\tconst cell = schema.nodes.tableCell.createAndFill()\n\t\tif (cell) {\n\t\t\tcells.push(cell)\n\t\t}\n\t\tconst headerCell = schema.nodes.tableHeader.createAndFill()\n\t\tif (headerCell) {\n\t\t\theaderCells.push(headerCell)\n\t\t}\n\t}\n\tconst headRow = schema.nodes.tableHeadRow.createChecked(null, headerCells)\n\tconst rows = []\n\tfor (let index = 1; index < rowsCount; index += 1) {\n\t\trows.push(schema.nodes.tableRow.createChecked(null, cells))\n\t}\n\treturn schema.nodes.table.createChecked(null, [headRow, ...rows])\n}\n\n/**\n *\n * @param {object} $cell - resolved position of the current cell\n */\nfunction findSameCellInNextRow($cell) {\n\tif ($cell.index(-1) === $cell.node(-1).childCount - 1) {\n\t\treturn null\n\t}\n\tlet cellStart = $cell.after()\n\tconst table = $cell.node(-1)\n\tfor (let row = $cell.indexAfter(-1); row < table.childCount; row++) {\n\t\tconst rowNode = table.child(row)\n\t\tif (rowNode.childCount >= $cell.index()) {\n\t\t\tfor (let cell = 0; cell < $cell.index(); cell++) {\n\t\t\t\tconst cellNode = rowNode.child(cell)\n\t\t\t\tcellStart += cellNode.nodeSize\n\t\t\t}\n\t\t\treturn cellStart + 1\n\t\t}\n\t\tcellStart += rowNode.nodeSize\n\t}\n}\n\n/**\n *\n * @param {Node} node - Table node\n */\nfunction getColumns(node) {\n\tconst columns = []\n\n\tnode.content.forEach((row) => {\n\t\trow.content.forEach((cell, offset, columnIndex) => {\n\t\t\tif (!columns[columnIndex]) {\n\t\t\t\tcolumns[columnIndex] = []\n\t\t\t}\n\t\t\tcolumns[columnIndex].push(cell)\n\t\t})\n\t})\n\n\treturn columns\n}\n\n/**\n *\n * @param {Array} columns - Columns of table\n */\nfunction calculateColumnWidths(columns) {\n\tconst widths = []\n\n\tcolumns.forEach((column) => {\n\t\tlet maxWidth = 0\n\n\t\tcolumn.forEach((cell) => {\n\t\t\tlet cellWidth = 0\n\t\t\tcell.content.forEach(node => {\n\t\t\t\tcellWidth += (node.text?.length || 6)\n\t\t\t\tif (node.text?.includes('|')) cellWidth += 1\n\t\t\t})\n\t\t\tmaxWidth = Math.max(maxWidth, cellWidth)\n\t\t})\n\n\t\twidths.push(maxWidth)\n\t})\n\n\treturn widths\n}\n\nexport default Table.extend({\n\tcontent: 'tableCaption? tableHeadRow tableRow*',\n\n\taddExtensions() {\n\t\treturn [\n\t\t\tTableCaption,\n\t\t\tTableCell,\n\t\t\tTableHeader,\n\t\t\tTableHeadRow,\n\t\t\tTableRow,\n\t\t]\n\t},\n\n\taddCommands() {\n\t\treturn {\n\t\t\t...this.parent(),\n\t\t\taddRowAfter: () => ({ chain, dispatch }) => {\n\t\t\t\treturn chain()\n\t\t\t\t\t.command(({ state }) => addRowAfter(state, dispatch))\n\t\t\t\t\t.command(({ state, tr }) => {\n\t\t\t\t\t\tconst { tableStart, table, bottom } = selectedRect(state)\n\n\t\t\t\t\t\tif (dispatch) {\n\t\t\t\t\t\t\tconst lastRow = table.child(bottom - 1)\n\t\t\t\t\t\t\tconst newRow = table.child(bottom)\n\t\t\t\t\t\t\tlet pos = tableStart + 1\n\t\t\t\t\t\t\tfor (let i = 0; i < bottom; i++) { pos += table.child(i).nodeSize }\n\n\t\t\t\t\t\t\tfor (let i = 0; i < lastRow.childCount; i++) {\n\t\t\t\t\t\t\t\ttr.setNodeAttribute(\n\t\t\t\t\t\t\t\t\tpos,\n\t\t\t\t\t\t\t\t\t'textAlign',\n\t\t\t\t\t\t\t\t\tlastRow.child(i).attrs.textAlign,\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\tpos += newRow.child(i).nodeSize\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn true\n\t\t\t\t\t})\n\t\t\t\t\t.run()\n\t\t\t},\n\t\t\taddRowBefore: () => ({ chain, dispatch }) =>\n\t\t\t\tchain()\n\t\t\t\t\t.command(({ state }) => addRowBefore(state, dispatch))\n\t\t\t\t\t.command(({ state, tr }) => {\n\t\t\t\t\t\tconst { tableStart, table, top } = selectedRect(state)\n\t\t\t\t\t\tif (dispatch) {\n\t\t\t\t\t\t\tconst lastRow = table.child(top)\n\t\t\t\t\t\t\tconst newRow = table.child(top - 1)\n\t\t\t\t\t\t\tlet pos = tableStart + 1\n\t\t\t\t\t\t\tfor (let i = 0; i < (top - 1); i++) { pos += table.child(i).nodeSize }\n\n\t\t\t\t\t\t\tfor (let i = 0; i < lastRow.childCount; i++) {\n\t\t\t\t\t\t\t\ttr.setNodeAttribute(\n\t\t\t\t\t\t\t\t\tpos,\n\t\t\t\t\t\t\t\t\t'textAlign',\n\t\t\t\t\t\t\t\t\tlastRow.child(i).attrs.textAlign,\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\tpos += newRow.child(i).nodeSize\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn true\n\t\t\t\t\t})\n\t\t\t\t\t.run(),\n\t\t\tinsertTable: () => ({ tr, dispatch, editor }) => {\n\t\t\t\tif (isInTable(tr)) return false\n\t\t\t\tconst node = createTable(editor.schema, 3, 3, true)\n\t\t\t\tif (dispatch) {\n\t\t\t\t\tconst offset = tr.selection.anchor + 1\n\t\t\t\t\ttr.replaceSelectionWith(node)\n\t\t\t\t\t\t.scrollIntoView()\n\t\t\t\t\t\t.setSelection(TextSelection.near(tr.doc.resolve(offset)))\n\t\t\t\t}\n\t\t\t\treturn true\n\t\t\t},\n\t\t\t// move to the next node after the table from the last cell\n\t\t\tleaveTable: () => ({ tr, dispatch, editor }) => {\n\t\t\t\tif (!isInTable(tr)) return false\n\t\t\t\tconst { $head, empty } = tr.selection\n\t\t\t\tif (!empty) return false\n\t\t\t\t// the selection can temporarily be inside the table but outside of cells.\n\t\t\t\tconst tableDepth = $head.depth < 3 ? 1 : $head.depth - 2\n\t\t\t\tif (dispatch) {\n\t\t\t\t\tconst $next = tr.doc.resolve($head.after(tableDepth) + 1)\n\t\t\t\t\tconst selection = TextSelection.near($next)\n\t\t\t\t\tdispatch(tr.setSelection(selection).scrollIntoView())\n\t\t\t\t}\n\t\t\t\treturn true\n\t\t\t},\n\t\t\tgoToNextRow: () => ({ tr, dispatch, editor }) => {\n\t\t\t\tif (!isInTable(tr)) return false\n\t\t\t\tconst cell = findSameCellInNextRow(selectionCell(tr))\n\t\t\t\tif (cell == null) return\n\t\t\t\tif (dispatch) {\n\t\t\t\t\tconst $cell = tr.doc.resolve(cell)\n\t\t\t\t\tconst selection = TextSelection.between($cell, moveCellForward($cell))\n\t\t\t\t\tdispatch(tr.setSelection(selection).scrollIntoView())\n\t\t\t\t}\n\t\t\t\treturn true\n\t\t\t},\n\t\t}\n\t},\n\n\trenderHTML({ HTMLAttributes }) {\n\t\treturn [\n\t\t\t'div',\n\t\t\t{ class: 'table-wrapper', style: 'overflow-x: auto;' },\n\t\t\t['table', mergeAttributes(this.options.HTMLAttributes, HTMLAttributes), 0],\n\t\t]\n\t},\n\n\ttoMarkdown(state, node) {\n\t\tconst columns = getColumns(node)\n\t\tstate.options.columnWidths = calculateColumnWidths(columns)\n\t\tstate.options.currentHeaderIndex = 0\n\t\tstate.renderContent(node)\n\t\tstate.closeBlock(node)\n\t},\n\n\taddKeyboardShortcuts() {\n\t\treturn {\n\t\t\t...this.parent(),\n\t\t\tTab: () => this.editor.commands.goToNextCell() || this.editor.commands.leaveTable(),\n\t\t\tEnter: ({ editor }) => {\n\t\t\t\tconst { selection } = editor.state\n\t\t\t\tif (!selection.$from.parent.type.name.startsWith('table')) return false\n\n\t\t\t\tif (selection.$from.nodeBefore?.type.name === 'hardBreak') {\n\t\t\t\t\tif (editor.can().goToNextRow() || editor.can().addRowAfter()) {\n\t\t\t\t\t\t// Remove previous hard break and move to next row instead\n\t\t\t\t\t\teditor.chain()\n\t\t\t\t\t\t\t.setTextSelection({ from: selection.from - 1, to: selection.from })\n\t\t\t\t\t\t\t.deleteSelection()\n\t\t\t\t\t\t\t.run()\n\t\t\t\t\t\tif (editor.commands.goToNextRow()) return true\n\t\t\t\t\t\treturn editor.chain().addRowAfter().goToNextRow().run()\n\t\t\t\t\t}\n\t\t\t\t\treturn false\n\t\t\t\t} else {\n\t\t\t\t\treturn editor.chain()\n\t\t\t\t\t\t.insertContent('<br data-syntax=\"html\" />')\n\t\t\t\t\t\t.focus()\n\t\t\t\t\t\t.run()\n\t\t\t\t}\n\t\t\t},\n\t\t}\n\t},\n\n})\n","import { Node } from '@tiptap/core'\n\n/*\n * Markdown tables do not include captions.\n * We still need to parse them though\n * because otherwise tiptap will try to insert their text content\n * and put it in the top row of the table.\n */\nexport default Node.create({\n\tname: 'tableCaption',\n\tcontent: 'inline*',\n\tallowGapCursor: false,\n\taddAttributes() {\n\t\treturn {}\n\t},\n\n\trenderHTML() {\n\t\treturn ['caption']\n\t},\n\n\ttoMarkdown(state, node) {\n\t},\n\n\tparseHTML() {\n\t\treturn [\n\t\t\t{ tag: 'table caption', priority: 90 },\n\t\t]\n\t},\n\n})\n","import { TableCell } from '@tiptap/extension-table-cell'\nimport { Plugin } from '@tiptap/pm/state'\nimport { Fragment } from '@tiptap/pm/model'\n\nexport default TableCell.extend({\n\tcontent: 'inline*',\n\n\ttoMarkdown(state, node) {\n\t\tstate.write(' ')\n\t\tconst backup = state.options?.escapeExtraCharacters\n\t\tconst columnIndex = state.options.currentColumnIndex\n\t\tstate.options.escapeExtraCharacters = /\\|/\n\n\t\tlet cellRenderedContentLength = 0\n\t\tnode.content.forEach((childNode, offset, index) => {\n\t\t\tcellRenderedContentLength += (childNode.text?.length || 6)\n\t\t\tif (childNode.text?.includes('|')) cellRenderedContentLength += 1\n\t\t\tif (childNode.attrs.syntax === '  ') node.child(index).attrs.syntax = 'html'\n\t\t})\n\t\tconst columnWidth = state.options.columnWidths[columnIndex]\n\t\tconst align = node.attrs?.textAlign || 'left'\n\t\tconst space = columnWidth - cellRenderedContentLength\n\t\tconst leftPadding = Math.floor(space / 2)\n\t\tconst rightPadding = Math.ceil(space / 2)\n\n\t\tif (align === 'center') state.write(' '.repeat(leftPadding))\n\t\tif (align === 'right') state.write(' '.repeat(space))\n\t\tstate.renderInline(node)\n\t\tif (align === 'center') state.write(' '.repeat(rightPadding))\n\t\tif (align === 'left') state.write(' '.repeat(space))\n\n\t\tstate.options.escapeExtraCharacters = backup\n\t\tstate.write(' |')\n\t\tstate.options.currentColumnIndex++\n\t},\n\n\tparseHTML() {\n\t\treturn [\n\t\t\t{ tag: 'td', preserveWhitespace: true },\n\t\t\t{ tag: 'th', preserveWhitespace: true },\n\t\t\t{ tag: 'table thead ~ tbody th', priority: 70, preserveWhitespace: true },\n\t\t\t{ tag: 'table thead ~ tbody td', priority: 70, preserveWhitespace: true },\n\t\t]\n\t},\n\n\taddAttributes() {\n\t\treturn {\n\t\t\t...this.parent?.(),\n\t\t\ttextAlign: {\n\t\t\t\trendered: true,\n\t\t\t\tdefault: null,\n\t\t\t\trenderHTML: attributes => {\n\t\t\t\t\tif (!attributes.textAlign) {\n\t\t\t\t\t\treturn {}\n\t\t\t\t\t}\n\t\t\t\t\treturn {\n\t\t\t\t\t\tstyle: `text-align: ${attributes.textAlign}`,\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tparseHTML: element => element.style.textAlign || null,\n\t\t\t},\n\t\t}\n\t},\n\n\taddProseMirrorPlugins() {\n\t\treturn [\n\t\t\tnew Plugin({\n\t\t\t\tprops: {\n\t\t\t\t\t// Only paste (marked) text into table cells to prevent jumping out of cell\n\t\t\t\t\thandlePaste: (view, event, slice) => {\n\t\t\t\t\t\tif (!this.editor.isActive(this.type.name)) {\n\t\t\t\t\t\t\treturn false\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst { state } = view\n\t\t\t\t\t\tconst { schema } = state\n\t\t\t\t\t\tconst childNodes = []\n\t\t\t\t\t\tslice.content.descendants((node, pos) => {\n\t\t\t\t\t\t\tif (node.isText) {\n\t\t\t\t\t\t\t\tchildNodes.push(schema.text(node.textContent, node.marks))\n\t\t\t\t\t\t\t} else if (childNodes.length !== 0 && node.type === schema.nodes.hardBreak) {\n\t\t\t\t\t\t\t\tchildNodes.push(node)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\n\t\t\t\t\t\tconst newNode = schema.node('paragraph', [], childNodes)\n\t\t\t\t\t\tslice.content = Fragment.empty.addToStart(newNode)\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t}),\n\t\t]\n\t},\n})\n","import TableRow from './TableRow.js'\n\nexport default TableRow.extend({\n\tname: 'tableHeadRow',\n\tcontent: 'tableHeader+',\n\tallowGapCursor: false,\n\n\ttoMarkdown(state, node) {\n\t\tstate.write('|')\n\t\tstate.renderInline(node)\n\t\tstate.ensureNewLine()\n\t\tstate.write('|')\n\t\tnode.forEach((cell, offset, index) => {\n\t\t\tlet row = state.repeat('-', state.options.columnWidths[index] + 2)\n\t\t\tconst align = cell.attrs?.textAlign\n\t\t\tif (align === 'center' || align === 'left') row = ':' + row.slice(1)\n\t\t\tif (align === 'center' || align === 'right') row = row.slice(0, -1) + ':'\n\t\t\tstate.write(row)\n\t\t\tstate.write('|')\n\t\t})\n\t\tstate.ensureNewLine()\n\t},\n\n\tparseHTML() {\n\t\treturn [\n\t\t\t{ tag: 'tr:first-of-type', priority: 80 },\n\t\t]\n\t},\n})\n","import { TableHeader } from '@tiptap/extension-table-header'\n\nexport default TableHeader.extend({\n\tcontent: 'inline*',\n\n\ttoMarkdown(state, node) {\n\t\tconst headerIndex = state.options.currentHeaderIndex\n\t\tconst columnWidth = state.options.columnWidths[headerIndex]\n\t\tconst align = node.attrs?.textAlign || 'left'\n\t\tconst space = columnWidth - node.content.size\n\t\tconst leftPadding = Math.floor(space / 2)\n\t\tconst rightPadding = Math.ceil(space / 2)\n\n\t\tstate.write(' ')\n\t\tif (align === 'center') state.write(' '.repeat(leftPadding))\n\t\tif (align === 'right') state.write(' '.repeat(space))\n\t\tstate.renderInline(node)\n\t\tif (align === 'center') state.write(' '.repeat(rightPadding))\n\t\tif (align === 'left') state.write(' '.repeat(space))\n\t\tstate.write(' |')\n\t\tstate.options.currentHeaderIndex++\n\t},\n\n\tparseHTML() {\n\t\treturn [\n\t\t\t{ tag: 'table thead:empty ~ tbody :first-child th', priority: 80 },\n\t\t\t{ tag: 'table thead:empty ~ tbody :first-child td', priority: 80 },\n\t\t\t{ tag: 'table thead :first-child th', priority: 60 },\n\t\t\t{ tag: 'table thead :first-child td', priority: 60 },\n\t\t\t{ tag: 'table tbody :first-child th', priority: 60 },\n\t\t\t{ tag: 'table tbody :first-child td', priority: 60 },\n\t\t\t{ tag: 'table > :first-child > th', priority: 60 },\n\t\t\t{ tag: 'table > :first-child > td', priority: 60 },\n\t\t]\n\t},\n\n\taddAttributes() {\n\t\treturn {\n\t\t\t...this.parent?.(),\n\t\t\ttextAlign: {\n\t\t\t\trendered: true,\n\t\t\t\tdefault: null,\n\t\t\t\trenderHTML: attributes => {\n\t\t\t\t\tif (!attributes.textAlign) {\n\t\t\t\t\t\treturn {}\n\t\t\t\t\t}\n\t\t\t\t\treturn {\n\t\t\t\t\t\tstyle: `text-align: ${attributes.textAlign}`,\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tparseHTML: element => element.style.textAlign || null,\n\t\t\t},\n\t\t}\n\t},\n})\n","import { TableRow } from '@tiptap/extension-table-row'\n\nexport default TableRow.extend({\n\tcontent: 'tableCell*',\n\tallowGapCursor: false,\n\n\ttoMarkdown(state, node) {\n\t\tstate.write('|')\n\t\tstate.options.currentColumnIndex = 0\n\t\tstate.renderInline(node)\n\t\tstate.ensureNewLine()\n\t},\n\n\tparseHTML() {\n\t\treturn [\n\t\t\t{ tag: 'tr', priority: 70 },\n\t\t]\n\t},\n})\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.text-menubar button.entry-action__button,.v-popper__inner button.entry-action__button{height:44px;margin:0;border:0;position:relative;background-color:rgba(0,0,0,0);vertical-align:top;box-shadow:none;padding:0}.text-menubar button.entry-action__button p,.v-popper__inner button.entry-action__button p{padding:0}.text-menubar button.entry-action__button:is(li.entry-action-item button),.v-popper__inner button.entry-action__button:is(li.entry-action-item button){padding:0 .5em 0 0}.text-menubar button.entry-action__button:not(li.entry-action-item button),.v-popper__inner button.entry-action__button:not(li.entry-action-item button){width:44px}.text-menubar button.entry-action__button:hover,.text-menubar button.entry-action__button:focus,.text-menubar button.entry-action__button:active,.v-popper__inner button.entry-action__button:hover,.v-popper__inner button.entry-action__button:focus,.v-popper__inner button.entry-action__button:active{background-color:var(--color-background-dark)}.text-menubar button.entry-action__button:hover:not(:disabled),.text-menubar button.entry-action__button:focus:not(:disabled),.text-menubar button.entry-action__button:active:not(:disabled),.v-popper__inner button.entry-action__button:hover:not(:disabled),.v-popper__inner button.entry-action__button:focus:not(:disabled),.v-popper__inner button.entry-action__button:active:not(:disabled){box-shadow:var(--color-primary-element)}.text-menubar button.entry-action__button:hover,.text-menubar button.entry-action__button:focus,.v-popper__inner button.entry-action__button:hover,.v-popper__inner button.entry-action__button:focus{opacity:1}.text-menubar button.entry-action__button:focus-visible,.v-popper__inner button.entry-action__button:focus-visible{box-shadow:var(--color-primary-element)}.text-menubar .button-vue,.v-popper__inner .button-vue{margin-right:2px}@media only screen and (max-width: 767px){.text-menubar .button-vue,.v-popper__inner .button-vue{margin-right:0}}.text-menubar .action-item__menutoggle.action-item__menutoggle--with-icon-slot,.v-popper__inner .action-item__menutoggle.action-item__menutoggle--with-icon-slot{opacity:1}`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/components/Menu/ActionEntry.scss\"],\"names\":[],\"mappings\":\"AACC,uFACC,WAAA,CACA,QAAA,CACA,QAAA,CAEA,iBAAA,CACA,8BAAA,CACA,kBAAA,CACA,eAAA,CACA,SAAA,CAEA,2FACC,SAAA,CAGD,uJACC,kBAAA,CAGD,yJACC,UAAA,CAGD,2SAGC,6CAAA,CACA,qYACC,uCAAA,CAIF,sMAEC,SAAA,CAED,mHACC,uCAAA,CAKF,uDACC,gBAAA,CAGD,0CACC,uDACC,cAAA,CAAA,CAIF,iKACC,SAAA\",\"sourcesContent\":[\".text-menubar, .v-popper__inner {\\n\\tbutton.entry-action__button {\\n\\t\\theight: 44px;\\n\\t\\tmargin: 0;\\n\\t\\tborder: 0;\\n\\t\\t// opacity: 0.5;\\n\\t\\tposition: relative;\\n\\t\\tbackground-color: transparent;\\n\\t\\tvertical-align: top;\\n\\t\\tbox-shadow: none;\\n\\t\\tpadding: 0;\\n\\n\\t\\tp {\\n\\t\\t\\tpadding: 0;\\n\\t\\t}\\n\\n\\t\\t&:is(li.entry-action-item button) {\\n\\t\\t\\tpadding: 0 0.5em 0 0;\\n\\t\\t}\\n\\n\\t\\t&:not(li.entry-action-item button) {\\n\\t\\t\\twidth: 44px;\\n\\t\\t}\\n\\n\\t\\t&:hover,\\n\\t\\t&:focus,\\n\\t\\t&:active {\\n\\t\\t\\tbackground-color: var(--color-background-dark);\\n\\t\\t\\t&:not(:disabled) {\\n\\t\\t\\t\\tbox-shadow: var(--color-primary-element);\\n\\t\\t\\t}\\n\\t\\t}\\n\\n\\t\\t&:hover,\\n\\t\\t&:focus {\\n\\t\\t\\topacity: 1;\\n\\t\\t}\\n\\t\\t&:focus-visible {\\n\\t\\t\\tbox-shadow: var(--color-primary-element);\\n\\t\\t}\\n\\n\\t}\\n\\n\\t.button-vue {\\n\\t\\tmargin-right: 2px;\\n\\t}\\n\\n\\t@media only screen and (max-width: 767px) {\\n\\t\\t.button-vue {\\n\\t\\t\\tmargin-right: 0;\\n\\t\\t}\\n\\t}\\n\\n\\t.action-item__menutoggle.action-item__menutoggle--with-icon-slot {\\n\\t\\topacity: 1;\\n\\t}\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.editor--outline[data-v-2e01a79b]{width:300px;padding:0 10px 10px 10px;position:fixed;overflow:auto;max-height:calc(100% - 204px)}.editor--outline-mobile[data-v-2e01a79b]{border-radius:var(--border-radius-large);box-shadow:0 1px 10px var(--color-box-shadow);background-color:var(--color-main-background-translucent);z-index:1}.editor--outline__header[data-v-2e01a79b]{margin:0;position:sticky;top:0;z-index:1;background-color:var(--color-main-background);padding:.6em .6em .6em 0;display:flex;align-items:center}.editor--outline__header h2[data-v-2e01a79b]{font-size:1rem;line-height:1.1rem;flex-grow:1;padding:0;margin:0}`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/components/Editor/EditorOutline.vue\"],\"names\":[],\"mappings\":\"AACA,kCACC,WAAA,CACA,wBAAA,CACA,cAAA,CACA,aAAA,CAEA,6BAAA,CAEA,yCACC,wCAAA,CACA,6CAAA,CACA,yDAAA,CACA,SAAA,CAGD,0CACC,QAAA,CACA,eAAA,CACA,KAAA,CACA,SAAA,CACA,6CAAA,CACA,wBAAA,CACA,YAAA,CACA,kBAAA,CAEA,6CACC,cAAA,CACA,kBAAA,CACA,WAAA,CACA,SAAA,CACA,QAAA\",\"sourcesContent\":[\"\\n.editor--outline {\\n\\twidth:  300px;\\n\\tpadding: 0 10px 10px 10px;\\n\\tposition: fixed;\\n\\toverflow: auto;\\n\\t// 204px = 50px nc header + 60px collectives titlebar + 44px menubar + 50px bottom margin\\n\\tmax-height: calc(100% - 204px);\\n\\n\\t&-mobile {\\n\\t\\tborder-radius: var(--border-radius-large);\\n\\t\\tbox-shadow: 0 1px 10px var(--color-box-shadow);\\n\\t\\tbackground-color: var(--color-main-background-translucent);\\n\\t\\tz-index: 1;\\n\\t}\\n\\n\\t&__header {\\n\\t\\tmargin: 0;\\n\\t\\tposition: sticky;\\n\\t\\ttop: 0;\\n\\t\\tz-index: 1;\\n\\t\\tbackground-color: var(--color-main-background);\\n\\t\\tpadding: 0.6em 0.6em 0.6em 0;\\n\\t\\tdisplay: flex;\\n\\t\\talign-items: center;\\n\\n\\t\\th2 {\\n\\t\\t\\tfont-size: 1rem;\\n\\t\\t\\tline-height: 1.1rem;\\n\\t\\t\\tflex-grow: 1;\\n\\t\\t\\tpadding: 0;\\n\\t\\t\\tmargin: 0;\\n\\t\\t}\\n\\t}\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `div[contenteditable=false][data-v-3eac6396]{padding:0;margin:0}.preview-options-container[data-v-3eac6396]{position:absolute;width:0 !important;left:-44px;top:50%;transform:translate(0, -50%)}`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/components/Editor/PreviewOptions.vue\"],\"names\":[],\"mappings\":\"AACA,4CACC,SAAA,CACA,QAAA,CAGD,4CACC,iBAAA,CACA,kBAAA,CACA,UAAA,CACA,OAAA,CACA,4BAAA\",\"sourcesContent\":[\"\\ndiv[contenteditable=false] {\\n\\tpadding: 0;\\n\\tmargin: 0;\\n}\\n\\n.preview-options-container {\\n\\tposition: absolute;\\n\\twidth: 0 !important;\\n\\tleft: -44px;\\n\\ttop: 50%;\\n\\ttransform: translate(0, -50%);\\n}\\n\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.--initial-render .editor--toc__item{--initial-padding-left: 0;animation:initialPadding 1.5s}.editor--toc{padding:0 10px;color:var(--color-main-text-maxcontrast);--animation-duration: 0.8s}.editor--toc h3{padding-left:.75rem}.editor--toc__list{width:100%;list-style:none;font-size:.9rem;padding:0;animation-name:fadeInLeft;animation-duration:var(--animation-duration)}.editor--toc__item{transform:translateX(var(--padding-left, 0rem));text-overflow:ellipsis;overflow:hidden;white-space:nowrap;animation:initialPadding calc(var(--animation-duration)*2);width:calc(100% - var(--padding-left))}.editor--toc__item a:hover{color:var(--color-primary-element-hover)}.editor--toc__item--1{--padding-left: 0rem;font-weight:600}.editor--toc__item--1:not(:nth-child(1)){margin-top:.5rem}.editor--toc__item--2{--padding-left: 1rem}.editor--toc__item--3{--padding-left: 2rem}.editor--toc__item--4{--padding-left: 3rem}.editor--toc__item--5{--padding-left: 4rem}.editor--toc__item--6{--padding-left: 5rem}.editor--toc__item--previous-1{--initial-padding-left: 0rem }.editor--toc__item--previous-2{--initial-padding-left: 1rem }.editor--toc__item--previous-3{--initial-padding-left: 2rem }.editor--toc__item--previous-4{--initial-padding-left: 3rem }.editor--toc__item--previous-5{--initial-padding-left: 4rem }.editor--toc__item--previous-6{--initial-padding-left: 5rem }@keyframes initialPadding{from{transform:translateX(var(--initial-padding-left, initial))}to{transform:translateX(var(--padding-left, 0rem))}}`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/components/Editor/TableOfContents.vue\"],\"names\":[],\"mappings\":\"AAGE,qCACC,yBAAA,CACA,6BAAA,CAKH,aACC,cAAA,CACA,wCAAA,CACA,0BAAA,CAEA,gBACC,mBAAA,CAGD,mBACC,UAAA,CACA,eAAA,CACA,eAAA,CACA,SAAA,CAEA,yBAAA,CACA,4CAAA,CAGD,mBACC,+CAAA,CACA,sBAAA,CACA,eAAA,CACA,kBAAA,CACA,0DAAA,CACA,sCAAA,CAEA,2BACC,wCAAA,CAGD,sBACC,oBAAA,CACA,eAAA,CACA,yCACC,gBAAA,CAIF,sBACC,oBAAA,CAGD,sBACC,oBAAA,CAGD,sBACC,oBAAA,CAGD,sBACC,oBAAA,CAGD,sBACC,oBAAA,CAGD,+BACC,6BAAA,CAGD,+BACC,6BAAA,CAGD,+BACC,6BAAA,CAGD,+BACC,6BAAA,CAGD,+BACC,6BAAA,CAGD,+BACC,6BAAA,CAKH,0BACE,KACD,0DAAA,CAGC,GACD,+CAAA,CAAA\",\"sourcesContent\":[\"\\n.--initial-render {\\n\\t.editor--toc {\\n\\t\\t&__item {\\n\\t\\t\\t--initial-padding-left: 0;\\n\\t\\t\\tanimation: initialPadding 1.5s;\\n\\t\\t}\\n\\t}\\n}\\n\\n.editor--toc {\\n\\tpadding: 0 10px;\\n\\tcolor: var(--color-main-text-maxcontrast);\\n\\t--animation-duration: 0.8s;\\n\\n\\th3 {\\n\\t\\tpadding-left: 0.75rem;\\n\\t}\\n\\n\\t&__list {\\n\\t\\twidth: 100%;\\n\\t\\tlist-style: none;\\n\\t\\tfont-size: 0.9rem;\\n\\t\\tpadding: 0;\\n\\n\\t\\tanimation-name: fadeInLeft;\\n\\t\\tanimation-duration: var(--animation-duration);\\n\\t}\\n\\n\\t&__item {\\n\\t\\ttransform: translateX(var(--padding-left, 0rem));\\n\\t\\ttext-overflow: ellipsis;\\n\\t\\toverflow: hidden;\\n\\t\\twhite-space: nowrap;\\n\\t\\tanimation: initialPadding calc(var(--animation-duration) * 2);\\n\\t\\twidth: calc(100% - var(--padding-left));\\n\\n\\t\\ta:hover {\\n\\t\\t\\tcolor: var(--color-primary-element-hover);\\n\\t\\t}\\n\\n\\t\\t&--1 {\\n\\t\\t\\t--padding-left: 0rem;\\n\\t\\t\\tfont-weight: 600;\\n\\t\\t\\t&:not(:nth-child(1)) {\\n\\t\\t\\t\\tmargin-top: 0.5rem;\\n\\t\\t\\t}\\n\\t\\t}\\n\\n\\t\\t&--2 {\\n\\t\\t\\t--padding-left: 1rem;\\n\\t\\t}\\n\\n\\t\\t&--3 {\\n\\t\\t\\t--padding-left: 2rem;\\n\\t\\t}\\n\\n\\t\\t&--4 {\\n\\t\\t\\t--padding-left: 3rem;\\n\\t\\t}\\n\\n\\t\\t&--5 {\\n\\t\\t\\t--padding-left: 4rem;\\n\\t\\t}\\n\\n\\t\\t&--6 {\\n\\t\\t\\t--padding-left: 5rem;\\n\\t\\t}\\n\\n\\t\\t&--previous-1 {\\n\\t\\t\\t--initial-padding-left: 0rem\\n\\t\\t}\\n\\n\\t\\t&--previous-2 {\\n\\t\\t\\t--initial-padding-left: 1rem\\n\\t\\t}\\n\\n\\t\\t&--previous-3 {\\n\\t\\t\\t--initial-padding-left: 2rem\\n\\t\\t}\\n\\n\\t\\t&--previous-4 {\\n\\t\\t\\t--initial-padding-left: 3rem\\n\\t\\t}\\n\\n\\t\\t&--previous-5 {\\n\\t\\t\\t--initial-padding-left: 4rem\\n\\t\\t}\\n\\n\\t\\t&--previous-6 {\\n\\t\\t\\t--initial-padding-left: 5rem\\n\\t\\t}\\n\\t}\\n}\\n\\n@keyframes initialPadding {\\n  from {\\n\\ttransform: translateX(var(--initial-padding-left, initial));\\n  }\\n\\n  to {\\n\\ttransform: translateX(var(--padding-left, 0rem));\\n  }\\n}\\n\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.modal__content[data-v-403f8ff2]{height:80vh;padding:0 50px;display:flex;justify-content:center}.modal__content img[data-v-403f8ff2]{width:100%;height:100%;object-fit:contain}`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/components/ImageView/ShowImageModal.vue\"],\"names\":[],\"mappings\":\"AACA,iCACC,WAAA,CACA,cAAA,CACA,YAAA,CACA,sBAAA,CACA,qCACC,UAAA,CACA,WAAA,CACA,kBAAA\",\"sourcesContent\":[\"\\n.modal__content {\\n\\theight: 80vh;\\n\\tpadding: 0 50px;\\n\\tdisplay: flex;\\n\\tjustify-content: center;\\n\\timg {\\n\\t\\twidth: 100%;\\n\\t\\theight: 100%;\\n\\t\\tobject-fit: contain;\\n\\t}\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.link-view-bubble[data-v-fb46e0ea]{padding:4px;width:350px;background-color:var(--color-main-background);border-radius:var(--border-radius-large);filter:drop-shadow(0 1px 10px var(--color-box-shadow));box-sizing:initial !important}.link-view-bubble__header[data-v-fb46e0ea]{display:flex;justify-content:flex-end}.link-view-bubble__header .edit-buttons[data-v-fb46e0ea]{display:flex}.link-view-bubble__title[data-v-fb46e0ea]{align-self:center;padding-left:calc(var(--default-grid-baseline, 4px)*3);margin-right:auto;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-weight:bold}.link-view-bubble__reference-list[data-v-fb46e0ea]{padding:4px;padding-top:0}.link-view-bubble__reference-list[data-v-fb46e0ea] a.widget-default{margin:0;border:0;border-radius:unset}.link-view-bubble__reference-list[data-v-fb46e0ea] img.widget-default--image{border-radius:var(--border-radius-large)}.link-view-bubble__edit[data-v-fb46e0ea]{padding:4px;padding-top:0}.link-view-bubble__edit .input-field[data-v-fb46e0ea]{margin-bottom:12px}`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/components/Link/LinkBubbleView.vue\"],\"names\":[],\"mappings\":\"AACA,mCACC,WAAA,CACA,WAAA,CACA,6CAAA,CACA,wCAAA,CACA,sDAAA,CACA,6BAAA,CAEA,2CACC,YAAA,CACA,wBAAA,CAEA,yDACC,YAAA,CAIF,0CACC,iBAAA,CACA,sDAAA,CACA,iBAAA,CAEA,eAAA,CACA,sBAAA,CACA,kBAAA,CACA,gBAAA,CAGD,mDACC,WAAA,CACA,aAAA,CAEA,oEACC,QAAA,CACA,QAAA,CACA,mBAAA,CAGD,6EACC,wCAAA,CAIF,yCACC,WAAA,CACA,aAAA,CAEA,sDACC,kBAAA\",\"sourcesContent\":[\"\\n.link-view-bubble {\\n\\tpadding: 4px;\\n\\twidth: 350px;\\n\\tbackground-color: var(--color-main-background);\\n\\tborder-radius: var(--border-radius-large);\\n\\tfilter: drop-shadow(0 1px 10px var(--color-box-shadow));\\n\\tbox-sizing: initial !important;\\n\\n\\t&__header {\\n\\t\\tdisplay: flex;\\n\\t\\tjustify-content: flex-end;\\n\\n\\t\\t.edit-buttons {\\n\\t\\t\\tdisplay: flex;\\n\\t\\t}\\n\\t}\\n\\n\\t&__title {\\n\\t\\talign-self: center;\\n\\t\\tpadding-left: calc(var(--default-grid-baseline, 4px) * 3);\\n\\t\\tmargin-right: auto;\\n\\n\\t\\toverflow: hidden;\\n\\t\\ttext-overflow: ellipsis;\\n\\t\\twhite-space: nowrap;\\n\\t\\tfont-weight: bold;\\n\\t}\\n\\n\\t&__reference-list {\\n\\t\\tpadding: 4px;\\n\\t\\tpadding-top: 0;\\n\\n\\t\\t:deep(a.widget-default) {\\n\\t\\t\\tmargin: 0;\\n\\t\\t\\tborder: 0;\\n\\t\\t\\tborder-radius: unset;\\n\\t\\t}\\n\\n\\t\\t:deep(img.widget-default--image) {\\n\\t\\t\\tborder-radius: var(--border-radius-large);\\n\\t\\t}\\n\\t}\\n\\n\\t&__edit {\\n\\t\\tpadding: 4px;\\n\\t\\tpadding-top: 0;\\n\\n\\t\\t.input-field {\\n\\t\\t\\tmargin-bottom: 12px;\\n\\t\\t}\\n\\t}\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.emoji-list[data-v-74f9a54a]{border-radius:var(--border-radius);background-color:var(--color-main-background);box-shadow:0 1px 5px var(--color-box-shadow);overflow:auto;min-width:200px;max-width:200px;padding:4px;max-height:195.5px;margin:5px 0}.emoji-list__item[data-v-74f9a54a]{border-radius:8px;padding:4px 8px;margin-bottom:4px;opacity:.8;cursor:pointer;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.emoji-list__item[data-v-74f9a54a]:last-child{margin-bottom:0}.emoji-list__item__emoji[data-v-74f9a54a]{padding-right:8px}.emoji-list__item.is-selected[data-v-74f9a54a],.emoji-list__item[data-v-74f9a54a]:focus,.emoji-list__item[data-v-74f9a54a]:hover{opacity:1;background-color:var(--color-primary-element-light)}`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/components/Suggestion/Emoji/EmojiList.vue\"],\"names\":[],\"mappings\":\"AACA,6BACC,kCAAA,CACA,6CAAA,CACA,4CAAA,CACA,aAAA,CAEA,eAAA,CACA,eAAA,CACA,WAAA,CAEA,kBAAA,CACA,YAAA,CAEA,mCACC,iBAAA,CACA,eAAA,CACA,iBAAA,CACA,UAAA,CACA,cAAA,CAGA,kBAAA,CACA,eAAA,CACA,sBAAA,CAEA,8CACC,eAAA,CAGD,0CACC,iBAAA,CAGD,iIAGC,SAAA,CACA,mDAAA\",\"sourcesContent\":[\"\\n.emoji-list {\\n\\tborder-radius: var(--border-radius);\\n\\tbackground-color: var(--color-main-background);\\n\\tbox-shadow: 0 1px 5px var(--color-box-shadow);\\n\\toverflow: auto;\\n\\n\\tmin-width: 200px;\\n\\tmax-width: 200px;\\n\\tpadding: 4px;\\n\\t// Show maximum 5 entries and a half to show scroll\\n\\tmax-height: 35.5px * 5 + 18px;\\n\\tmargin: 5px 0;\\n\\n\\t&__item {\\n\\t\\tborder-radius: 8px;\\n\\t\\tpadding: 4px 8px;\\n\\t\\tmargin-bottom: 4px;\\n\\t\\topacity: 0.8;\\n\\t\\tcursor: pointer;\\n\\n\\t\\t// Take care of long names\\n\\t\\twhite-space: nowrap;\\n\\t\\toverflow: hidden;\\n\\t\\ttext-overflow: ellipsis;\\n\\n\\t\\t&:last-child {\\n\\t\\t\\tmargin-bottom: 0;\\n\\t\\t}\\n\\n\\t\\t&__emoji {\\n\\t\\t\\tpadding-right: 8px;\\n\\t\\t}\\n\\n\\t\\t&.is-selected,\\n\\t\\t&:focus,\\n\\t\\t&:hover {\\n\\t\\t\\topacity: 1;\\n\\t\\t\\tbackground-color: var(--color-primary-element-light);\\n\\t\\t}\\n\\t}\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.link-picker__item[data-v-11ad0ffc]{display:flex;align-items:center}.link-picker__item>div[data-v-11ad0ffc]{padding:4px;padding-left:8px;overflow:hidden;text-overflow:ellipsis}.link-picker__item img[data-v-11ad0ffc]{width:20px;height:20px;filter:var(--background-invert-if-dark)}`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/components/Suggestion/LinkPicker/LinkPickerList.vue\"],\"names\":[],\"mappings\":\"AACA,oCACC,YAAA,CACA,kBAAA,CAEA,wCACC,WAAA,CACA,gBAAA,CACA,eAAA,CACA,sBAAA,CAGD,wCACC,UAAA,CACA,WAAA,CACA,uCAAA\",\"sourcesContent\":[\"\\n.link-picker__item {\\n\\tdisplay: flex;\\n\\talign-items: center;\\n\\n\\t& > div {\\n\\t\\tpadding: 4px;\\n\\t\\tpadding-left: 8px;\\n\\t\\toverflow: hidden;\\n\\t\\ttext-overflow: ellipsis;\\n\\t}\\n\\n\\timg {\\n\\t\\twidth: 20px;\\n\\t\\theight: 20px;\\n\\t\\tfilter: var(--background-invert-if-dark);\\n\\t}\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.suggestion-list[data-v-721c3a10]{border-radius:var(--border-radius);background-color:var(--color-main-background);box-shadow:0 1px 5px var(--color-box-shadow);overflow:auto;min-width:200px;max-width:400px;width:80vw;padding:4px;max-height:195.5px;margin:5px 0}.suggestion-list__group[data-v-721c3a10]{font-weight:bold;color:var(--color-primary-element);font-size:var(--default-font-size);line-height:44px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;opacity:.7;box-shadow:none !important;flex-shrink:0;padding-left:8px}.suggestion-list__item[data-v-721c3a10]{border-radius:8px;padding:4px 8px;margin-bottom:4px;opacity:.8;cursor:pointer;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.suggestion-list__item[data-v-721c3a10]:last-child{margin-bottom:0}.suggestion-list__item__emoji[data-v-721c3a10]{padding-right:8px}.suggestion-list__item.is-selected[data-v-721c3a10],.suggestion-list__item[data-v-721c3a10]:focus,.suggestion-list__item[data-v-721c3a10]:hover{opacity:1;background-color:var(--color-primary-element-light)}`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/components/Suggestion/SuggestionListWrapper.vue\"],\"names\":[],\"mappings\":\"AACA,kCACC,kCAAA,CACA,6CAAA,CACA,4CAAA,CACA,aAAA,CAEA,eAAA,CACA,eAAA,CACA,UAAA,CACA,WAAA,CAEA,kBAAA,CACA,YAAA,CAEA,yCACC,gBAAA,CACA,kCAAA,CACA,kCAAA,CACA,gBAAA,CACA,kBAAA,CACA,eAAA,CACA,sBAAA,CACA,UAAA,CACA,0BAAA,CACA,aAAA,CACA,gBAAA,CAGD,wCACC,iBAAA,CACA,eAAA,CACA,iBAAA,CACA,UAAA,CACA,cAAA,CAGA,kBAAA,CACA,eAAA,CACA,sBAAA,CAEA,mDACC,eAAA,CAGD,+CACC,iBAAA,CAGD,gJAGC,SAAA,CACA,mDAAA\",\"sourcesContent\":[\"\\n.suggestion-list {\\n\\tborder-radius: var(--border-radius);\\n\\tbackground-color: var(--color-main-background);\\n\\tbox-shadow: 0 1px 5px var(--color-box-shadow);\\n\\toverflow: auto;\\n\\n\\tmin-width: 200px;\\n\\tmax-width: 400px;\\n\\twidth: 80vw;\\n\\tpadding: 4px;\\n\\t// Show maximum 5 entries and a half to show scroll\\n\\tmax-height: 35.5px * 5 + 18px;\\n\\tmargin: 5px 0;\\n\\n\\t&__group {\\n\\t\\tfont-weight: bold;\\n\\t\\tcolor: var(--color-primary-element);\\n\\t\\tfont-size: var(--default-font-size);\\n\\t\\tline-height: 44px;\\n\\t\\twhite-space: nowrap;\\n\\t\\toverflow: hidden;\\n\\t\\ttext-overflow: ellipsis;\\n\\t\\topacity: .7;\\n\\t\\tbox-shadow: none !important;\\n\\t\\tflex-shrink: 0;\\n\\t\\tpadding-left: 8px;\\n\\t}\\n\\n\\t&__item {\\n\\t\\tborder-radius: 8px;\\n\\t\\tpadding: 4px 8px;\\n\\t\\tmargin-bottom: 4px;\\n\\t\\topacity: 0.8;\\n\\t\\tcursor: pointer;\\n\\n\\t\\t// Take care of long names\\n\\t\\twhite-space: nowrap;\\n\\t\\toverflow: hidden;\\n\\t\\ttext-overflow: ellipsis;\\n\\n\\t\\t&:last-child {\\n\\t\\t\\tmargin-bottom: 0;\\n\\t\\t}\\n\\n\\t\\t&__emoji {\\n\\t\\t\\tpadding-right: 8px;\\n\\t\\t}\\n\\n\\t\\t&.is-selected,\\n\\t\\t&:focus,\\n\\t\\t&:hover {\\n\\t\\t\\topacity: 1;\\n\\t\\t\\tbackground-color: var(--color-primary-element-light);\\n\\t\\t}\\n\\t}\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.callout[data-v-4387ae9f]{background-color:var(--callout-background, var(--color-background-hover));border-left-color:var(--callout-border, var(--color-primary-element));border-radius:var(--border-radius);padding:1em;padding-left:.5em;border-left-width:.3em;border-left-style:solid;position:relative;margin-bottom:.5em;display:flex;align-items:center;justify-content:flex-start}.callout+*[data-v-4387ae9f]{margin-top:.5em}.callout .callout__content[data-v-4387ae9f]{margin-left:1em}.callout .callout__content[data-v-4387ae9f] p:last-child{margin-bottom:0}.callout .callout__icon[data-v-4387ae9f],.callout .callout__icon[data-v-4387ae9f] svg{color:var(--callout-border)}.callout[data-v-4387ae9f],.callout--info[data-v-4387ae9f]{--callout-border: var(--color-info, #006aa3)}.callout--warn[data-v-4387ae9f]{--callout-border: var(--color-warning)}.callout--error[data-v-4387ae9f]{--callout-border: var(--color-error)}.callout--success[data-v-4387ae9f]{--callout-border: var(--color-success)}`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/nodes/Callout.vue\"],\"names\":[],\"mappings\":\"AACA,0BACC,yEAAA,CACA,qEAAA,CACA,kCAAA,CACA,WAAA,CACA,iBAAA,CACA,sBAAA,CACA,uBAAA,CACA,iBAAA,CACA,kBAAA,CAEA,YAAA,CACA,kBAAA,CACA,0BAAA,CAEA,4BACC,eAAA,CAGD,4CACC,eAAA,CAEC,yDACC,eAAA,CAMF,sFACC,2BAAA,CAKF,0DACC,4CAAA,CAID,gCACC,sCAAA,CAID,iCACC,oCAAA,CAID,mCACC,sCAAA\",\"sourcesContent\":[\"\\n.callout {\\n\\tbackground-color: var(--callout-background, var(--color-background-hover));\\n\\tborder-left-color: var(--callout-border, var(--color-primary-element));\\n\\tborder-radius: var(--border-radius);\\n\\tpadding: 1em;\\n\\tpadding-left: 0.5em;\\n\\tborder-left-width: 0.3em;\\n\\tborder-left-style: solid;\\n\\tposition: relative;\\n\\tmargin-bottom: 0.5em;\\n\\n\\tdisplay: flex;\\n\\talign-items: center;\\n\\tjustify-content: flex-start;\\n\\n\\t&+ * {\\n\\t\\tmargin-top: 0.5em;\\n\\t}\\n\\n\\t.callout__content {\\n\\t\\tmargin-left: 1em;\\n\\t\\t&:deep(p) {\\n\\t\\t\\t&:last-child {\\n\\t\\t\\t\\tmargin-bottom: 0;\\n\\t\\t\\t}\\n\\t\\t}\\n\\t}\\n\\n\\t.callout__icon {\\n\\t\\t&, :deep(svg) {\\n\\t\\t\\tcolor: var(--callout-border);\\n\\t\\t}\\n\\t}\\n\\n\\t// Info (default) variables\\n\\t&, &--info {\\n\\t\\t--callout-border: var(--color-info, #006aa3);\\n\\t}\\n\\n\\t// Warn variables\\n\\t&--warn {\\n\\t\\t--callout-border: var(--color-warning);\\n\\t}\\n\\n\\t// Error variables\\n\\t&--error {\\n\\t\\t--callout-border: var(--color-error);\\n\\t}\\n\\n\\t// Success variables\\n\\t&--success {\\n\\t\\t--callout-border: var(--color-success);\\n\\t}\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.code-block[data-v-3451a47c]{background-color:var(--color-background-dark);border-radius:var(--border-radius)}.code-block-header[data-v-3451a47c]{display:flex;flex-direction:row;justify-content:space-between;align-items:stretch;position:absolute;right:12px;margin-top:4px}.split-view[data-v-3451a47c]{display:flex;flex-direction:row;justify-content:space-between;align-items:stretch;gap:12px}.split-view>*[data-v-3451a47c]{flex:1}.split-view__preview[data-v-3451a47c]{text-align:center}@media only screen and (max-width: 600px){.split-view[data-v-3451a47c]{flex-direction:column}}.view-switch[data-v-3451a47c]{display:flex;flex-direction:row}`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/nodes/CodeBlockView.vue\"],\"names\":[],\"mappings\":\"AACA,6BACC,6CAAA,CACA,kCAAA,CAGD,oCACC,YAAA,CACA,kBAAA,CACA,6BAAA,CACA,mBAAA,CACA,iBAAA,CACA,UAAA,CACA,cAAA,CAGD,6BACC,YAAA,CACA,kBAAA,CACA,6BAAA,CACA,mBAAA,CACA,QAAA,CAEA,+BACC,MAAA,CAGD,sCACC,iBAAA,CAIF,0CACC,6BACC,qBAAA,CAAA,CAIF,8BACC,YAAA,CACA,kBAAA\",\"sourcesContent\":[\"\\n.code-block {\\n\\tbackground-color: var(--color-background-dark);\\n\\tborder-radius: var(--border-radius);\\n}\\n\\n.code-block-header {\\n\\tdisplay: flex;\\n\\tflex-direction: row;\\n\\tjustify-content: space-between;\\n\\talign-items: stretch;\\n\\tposition: absolute;\\n\\tright: 12px;\\n\\tmargin-top: 4px;\\n}\\n\\n.split-view {\\n\\tdisplay: flex;\\n\\tflex-direction: row;\\n\\tjustify-content: space-between;\\n\\talign-items: stretch;\\n\\tgap: 12px;\\n\\n\\t& > * {\\n\\t\\tflex: 1;\\n\\t}\\n\\n\\t&__preview {\\n\\t\\ttext-align: center;\\n\\t}\\n}\\n\\n@media only screen and (max-width: 600px) {\\n\\t.split-view {\\n\\t\\tflex-direction: column;\\n\\t}\\n}\\n\\n.view-switch {\\n\\tdisplay: flex;\\n\\tflex-direction: row;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.image[data-v-42761165]{margin:0;padding:0}.image[data-v-42761165],.image *[data-v-42761165]{-webkit-user-modify:read-only !important}.image__caption[data-v-42761165]{text-align:center;color:var(--color-text-lighter);display:flex;align-items:center;justify-content:center}.image__caption__wrapper[data-v-42761165]{position:relative}.image__caption__delete[data-v-42761165]{display:flex;flex-basis:20%;align-items:center;width:20px !important;height:20px;position:absolute;bottom:-1px;right:-3px}.image__caption__delete[data-v-42761165],.image__caption__delete svg[data-v-42761165]{cursor:pointer}.image__caption .image__caption__wrapper[data-v-42761165]{flex-basis:80%}.image__caption input[type=text][data-v-42761165]{width:85%;text-align:center;background-color:rgba(0,0,0,0);border:none !important;color:var(--color-text-maxcontrast) !important}.image__caption input[type=text][data-v-42761165]:focus{border:2px solid var(--color-border-dark) !important;color:var(--color-main-text) !important}.image__caption figcaption[data-v-42761165]{color:var(--color-text-maxcontrast) !important;max-width:80%;text-align:center;width:fit-content}.image__loading[data-v-42761165]{height:100px}.image__main[data-v-42761165]{max-height:calc(100vh - 50px - 50px)}.image__main--broken-icon[data-v-42761165],.image__error-message[data-v-42761165]{color:var(--color-text-maxcontrast)}.image__error-message[data-v-42761165]{display:block;text-align:center}.image__view[data-v-42761165]{text-align:center;position:relative}.image__view img[data-v-42761165]{max-width:100%}.image__view:hover input[type=text][data-v-42761165]{border:2px solid var(--color-border-dark) !important;color:var(--color-main-text) !important}.media[data-v-42761165]{display:flex;align-items:center;justify-content:left;padding-bottom:0}.media .media__wrapper[data-v-42761165]{display:flex;border:2px solid var(--color-border);border-radius:var(--border-radius-large);padding:8px}.media .media__wrapper img[data-v-42761165]{width:44px;height:44px}.media .media__wrapper .metadata[data-v-42761165]{margin-left:8px;display:flex;flex-direction:column;align-items:start}.media .media__wrapper .metadata span[data-v-42761165]{line-height:20px;font-weight:normal}.media .media__wrapper .metadata span.size[data-v-42761165]{color:var(--color-text-maxcontrast)}.media .buttons[data-v-42761165]{margin-left:8px}.fade-enter-active[data-v-42761165]{transition:opacity .3s ease-in-out}.fade-enter-to[data-v-42761165]{opacity:1}.fade-enter[data-v-42761165]{opacity:0}`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/nodes/ImageView.vue\"],\"names\":[],\"mappings\":\"AACA,wBACC,QAAA,CACA,SAAA,CAEA,kDACC,wCAAA,CAIF,iCACC,iBAAA,CACA,+BAAA,CACA,YAAA,CACA,kBAAA,CACA,sBAAA,CACA,0CACC,iBAAA,CAED,yCACC,YAAA,CACA,cAAA,CACA,kBAAA,CACA,qBAAA,CACA,WAAA,CACA,iBAAA,CACA,WAAA,CACA,UAAA,CACA,sFACC,cAAA,CAGF,0DACC,cAAA,CAED,kDACC,SAAA,CACA,iBAAA,CACA,8BAAA,CACA,sBAAA,CACA,8CAAA,CAEA,wDACC,oDAAA,CACA,uCAAA,CAGF,4CACC,8CAAA,CACA,aAAA,CACA,iBAAA,CACA,iBAAA,CAIF,iCACC,YAAA,CAGD,8BACC,oCAAA,CAGD,kFACC,mCAAA,CAGD,uCACC,aAAA,CACA,iBAAA,CAGD,8BACC,iBAAA,CACA,iBAAA,CAEA,kCACC,cAAA,CAIA,qDACC,oDAAA,CACA,uCAAA,CAKH,wBACC,YAAA,CACA,kBAAA,CACA,oBAAA,CACA,gBAAA,CAEA,wCACC,YAAA,CACA,oCAAA,CACA,wCAAA,CACA,WAAA,CAEA,4CACC,UAAA,CACA,WAAA,CAGD,kDACC,eAAA,CACA,YAAA,CACA,qBAAA,CACA,iBAAA,CAEA,uDACC,gBAAA,CACA,kBAAA,CAEA,4DACC,mCAAA,CAKJ,iCACC,eAAA,CAIF,oCACC,kCAAA,CAGD,gCACC,SAAA,CAGD,6BACC,SAAA\",\"sourcesContent\":[\"\\n.image {\\n\\tmargin: 0;\\n\\tpadding: 0;\\n\\n\\t&, * {\\n\\t\\t-webkit-user-modify: read-only !important;\\n\\t}\\n}\\n\\n.image__caption {\\n\\ttext-align: center;\\n\\tcolor: var(--color-text-lighter);\\n\\tdisplay: flex;\\n\\talign-items: center;\\n\\tjustify-content: center;\\n\\t&__wrapper {\\n\\t\\tposition: relative;\\n\\t}\\n\\t&__delete {\\n\\t\\tdisplay: flex;\\n\\t\\tflex-basis: 20%;\\n\\t\\talign-items: center;\\n\\t\\twidth: 20px !important;\\n\\t\\theight: 20px;\\n\\t\\tposition: absolute;\\n\\t\\tbottom: -1px;\\n\\t\\tright: -3px;\\n\\t\\t&, svg {\\n\\t\\t\\tcursor: pointer;\\n\\t\\t}\\n\\t}\\n\\t.image__caption__wrapper {\\n\\t\\tflex-basis: 80%;\\n\\t}\\n\\tinput[type='text'] {\\n\\t\\twidth: 85%;\\n\\t\\ttext-align: center;\\n\\t\\tbackground-color: transparent;\\n\\t\\tborder: none !important;\\n\\t\\tcolor: var(--color-text-maxcontrast) !important;\\n\\n\\t\\t&:focus {\\n\\t\\t\\tborder: 2px solid var(--color-border-dark) !important;\\n\\t\\t\\tcolor: var(--color-main-text) !important;\\n\\t\\t}\\n\\t}\\n\\tfigcaption {\\n\\t\\tcolor: var(--color-text-maxcontrast) !important;\\n\\t\\tmax-width: 80%;\\n\\t\\ttext-align: center;\\n\\t\\twidth: fit-content;\\n\\t}\\n}\\n\\n.image__loading {\\n\\theight: 100px;\\n}\\n\\n.image__main {\\n\\tmax-height: calc(100vh - 50px - 50px);\\n}\\n\\n.image__main--broken-icon, .image__error-message {\\n\\tcolor: var(--color-text-maxcontrast);\\n}\\n\\n.image__error-message {\\n\\tdisplay: block;\\n\\ttext-align: center;\\n}\\n\\n.image__view {\\n\\ttext-align: center;\\n\\tposition: relative;\\n\\n\\timg {\\n\\t\\tmax-width: 100%;\\n\\t}\\n\\n\\t&:hover {\\n\\t\\tinput[type='text'] {\\n\\t\\t\\tborder: 2px solid var(--color-border-dark) !important;\\n\\t\\t\\tcolor: var(--color-main-text) !important;\\n\\t\\t}\\n\\t}\\n}\\n\\n.media {\\n\\tdisplay: flex;\\n\\talign-items: center;\\n\\tjustify-content: left;\\n\\tpadding-bottom: 0;\\n\\n\\t.media__wrapper {\\n\\t\\tdisplay: flex;\\n\\t\\tborder: 2px solid var(--color-border);\\n\\t\\tborder-radius: var(--border-radius-large);\\n\\t\\tpadding: 8px;\\n\\n\\t\\timg {\\n\\t\\t\\twidth: 44px;\\n\\t\\t\\theight: 44px;\\n\\t\\t}\\n\\n\\t\\t.metadata {\\n\\t\\t\\tmargin-left: 8px;\\n\\t\\t\\tdisplay: flex;\\n\\t\\t\\tflex-direction: column;\\n\\t\\t\\talign-items: start;\\n\\n\\t\\t\\tspan {\\n\\t\\t\\t\\tline-height: 20px;\\n\\t\\t\\t\\tfont-weight: normal;\\n\\n\\t\\t\\t\\t&.size {\\n\\t\\t\\t\\t\\tcolor: var(--color-text-maxcontrast);\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t}\\n\\t}\\n\\t.buttons {\\n\\t\\tmargin-left: 8px;\\n\\t}\\n}\\n\\n.fade-enter-active {\\n\\ttransition: opacity .3s ease-in-out;\\n}\\n\\n.fade-enter-to {\\n\\topacity: 1;\\n}\\n\\n.fade-enter {\\n\\topacity: 0;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `[data-text-el=preview] [data-node-view-content][data-v-26ba0d31] a{display:none}.preview[data-v-26ba0d31]{position:relative}[data-v-26ba0d31] div.widgets--list a.widget-default{color:var(--color-main-text);padding:0;text-decoration:none;max-width:calc(100vw - 156px)}[data-v-26ba0d31] .widget-default--details{overflow:hidden}[data-v-26ba0d31] .widget-default--details p{margin-bottom:4px !important}[data-v-26ba0d31] .preview-options-container{top:unset;transform:unset;margin-top:calc(var(--default-grid-baseline, 4px)*3) !important}`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/nodes/Preview.vue\"],\"names\":[],\"mappings\":\"AAGA,mEACC,YAAA,CAGD,0BACC,iBAAA,CAGD,qDACC,4BAAA,CACA,SAAA,CACA,oBAAA,CACA,6BAAA,CAGD,2CACC,eAAA,CACA,6CACC,4BAAA,CAQF,6CACC,SAAA,CACA,eAAA,CACA,+DAAA\",\"sourcesContent\":[\"\\n// Hide the link element inside previews. We cannot hide full node view content\\n// as the preview options (prosemirror decorations) are inside it.\\n[data-text-el='preview'] [data-node-view-content] :deep(a) {\\n\\tdisplay: none;\\n}\\n\\n.preview {\\n\\tposition: relative;\\n}\\n\\n:deep(div.widgets--list a.widget-default) {\\n\\tcolor: var(--color-main-text);\\n\\tpadding: 0;\\n\\ttext-decoration: none;\\n\\tmax-width: calc(100vw - 156px);\\n}\\n\\n:deep(.widget-default--details) {\\n\\toverflow:hidden;\\n\\tp {\\n\\t\\tmargin-bottom: 4px !important;\\n\\t}\\n}\\n\\n/* Top align with preview image:\\n * - unset center alignment\\n * - margin-top of widget-default\\n */\\n:deep(.preview-options-container) {\\n\\ttop: unset;\\n\\ttransform: unset;\\n\\tmargin-top: calc(var(--default-grid-baseline, 4px) * 3) !important;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `td[data-v-2f56cd8c]{position:relative}td .container[data-v-2f56cd8c]{display:flex;flex-wrap:wrap;min-height:36px}td .content[data-v-2f56cd8c]{flex:1 1 0;margin:0;padding-top:.6em}td .action-item[data-v-2f56cd8c]{position:absolute;right:-48px;flex:0 1 auto;display:none;top:2px}td:last-child .action-item[data-v-2f56cd8c]{display:block;opacity:50%}td:last-child:hover .action-item[data-v-2f56cd8c],td:last-child:active .action-item[data-v-2f56cd8c],td:last-child:focus .action-item[data-v-2f56cd8c],td:last-child:focus-within .action-item[data-v-2f56cd8c]{opacity:100%}`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/nodes/Table/TableCellView.vue\"],\"names\":[],\"mappings\":\"AACA,oBACC,iBAAA,CAEA,+BACC,YAAA,CACA,cAAA,CACA,eAAA,CAGD,6BACC,UAAA,CACA,QAAA,CACA,gBAAA,CAGD,iCACC,iBAAA,CACA,WAAA,CACA,aAAA,CACA,YAAA,CACA,OAAA,CAIA,4CACC,aAAA,CACA,WAAA,CAIA,gNACC,YAAA\",\"sourcesContent\":[\"\\ntd {\\n\\tposition: relative;\\n\\n\\t.container {\\n\\t\\tdisplay: flex;\\n\\t\\tflex-wrap: wrap;\\n\\t\\tmin-height: 36px;\\n\\t}\\n\\n\\t.content {\\n\\t\\tflex: 1 1 0;\\n\\t\\tmargin: 0;\\n\\t\\tpadding-top: 0.6em;\\n\\t}\\n\\n\\t.action-item {\\n\\t\\tposition: absolute;\\n\\t\\tright: -48px;\\n\\t\\tflex: 0 1 auto;\\n\\t\\tdisplay: none;\\n\\t\\ttop: 2px;\\n\\t}\\n\\n\\t&:last-child {\\n\\t\\t.action-item {\\n\\t\\t\\tdisplay: block;\\n\\t\\t\\topacity: 50%;\\n\\t\\t}\\n\\n\\t\\t&:hover, &:active, &:focus, &:focus-within {\\n\\t\\t\\t.action-item {\\n\\t\\t\\t\\topacity: 100%;\\n\\t\\t\\t}\\n\\t\\t}\\n\\t}\\n\\n}\\n\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `th .content[data-v-a456a642]{margin:0;padding-top:.75em;flex-grow:1}th .action-item[data-v-a456a642]{opacity:50%}th:hover .action-item[data-v-a456a642],th:active .action-item[data-v-a456a642],th:focus .action-item[data-v-a456a642],th:focus-within .action-item[data-v-a456a642]{opacity:100%}`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/nodes/Table/TableHeaderView.vue\"],\"names\":[],\"mappings\":\"AAGC,6BACC,QAAA,CACA,iBAAA,CACA,WAAA,CAED,iCACC,WAAA,CAIA,oKACC,YAAA\",\"sourcesContent\":[\"\\nth {\\n\\n\\t.content {\\n\\t\\tmargin: 0;\\n\\t\\tpadding-top: 0.75em;\\n\\t\\tflex-grow: 1;\\n\\t}\\n\\t.action-item {\\n\\t\\topacity: 50%;\\n\\t}\\n\\n\\t&:hover, &:active, &:focus, &:focus-within {\\n\\t\\t.action-item {\\n\\t\\t\\topacity: 100%;\\n\\t\\t}\\n\\t}\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.table-wrapper[data-v-048279dc]{position:relative;overflow-x:auto}.clearfix[data-v-048279dc]{clear:both}table[data-v-048279dc]{float:left}.table-settings[data-v-048279dc]{padding-left:3px;opacity:.5;position:absolute;top:0;right:3px}.table-settings[data-v-048279dc]:hover{opacity:1}`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/nodes/Table/TableView.vue\"],\"names\":[],\"mappings\":\"AACA,gCACC,iBAAA,CACA,eAAA,CAGD,2BACC,UAAA,CAGD,uBACC,UAAA,CAGD,iCACC,gBAAA,CACA,UAAA,CACA,iBAAA,CACA,KAAA,CACA,SAAA,CAEA,uCACC,SAAA\",\"sourcesContent\":[\"\\n.table-wrapper {\\n\\tposition: relative;\\n\\toverflow-x: auto;\\n}\\n\\n.clearfix {\\n\\tclear: both;\\n}\\n\\ntable {\\n\\tfloat: left;\\n}\\n\\n.table-settings {\\n\\tpadding-left: 3px;\\n\\topacity: .5;\\n\\tposition: absolute;\\n\\ttop: 0;\\n\\tright: 3px;\\n\\n\\t&:hover {\\n\\t\\topacity: 1;\\n\\t}\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `\n.action[data-v-a0f3b418] {\n\t/* to unify width of ActionInput and ActionButton */\n\tmin-width: 218px;\n}\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/components/Menu/ActionInsertLink.vue\"],\"names\":[],\"mappings\":\";AAoRA;CACA,mDAAA;CACA,gBAAA;AACA\",\"sourcesContent\":[\"<!--\\n  - @copyright Copyright (c) 2022\\n  -\\n  - @license AGPL-3.0-or-later\\n  -\\n  - This program is free software: you can redistribute it and/or modify\\n  - it under the terms of the GNU Affero General Public License as\\n  - published by the Free Software Foundation, either version 3 of the\\n  - License, or (at your option) any later version.\\n  -\\n  - This program is distributed in the hope that it will be useful,\\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\\n  - GNU Affero General Public License for more details.\\n  -\\n  - You should have received a copy of the GNU Affero General Public License\\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\\n  -\\n  -->\\n<template>\\n\\t<NcActions class=\\\"entry-action entry-action__insert-link\\\"\\n\\t\\t:title=\\\"actionEntry.label\\\"\\n\\t\\t:aria-label=\\\"actionEntry.label\\\"\\n\\t\\t:class=\\\"activeClass\\\"\\n\\t\\t:container=\\\"menuIDSelector\\\"\\n\\t\\t:data-text-action-entry=\\\"actionEntry.key\\\"\\n\\t\\t:name=\\\"actionEntry.label\\\"\\n\\t\\t:open=\\\"menuOpen\\\"\\n\\t\\t@update:open=\\\"(open) => { menuOpen = menuOpen || open }\\\">\\n\\t\\t<template #icon>\\n\\t\\t\\t<component :is=\\\"icon\\\"\\n\\t\\t\\t\\t:name=\\\"actionEntry.label\\\"\\n\\t\\t\\t\\t:aria-label=\\\"actionEntry.label\\\" />\\n\\t\\t</template>\\n\\t\\t<NcActionButton v-if=\\\"state.active\\\"\\n\\t\\t\\t:data-text-action-entry=\\\"`${actionEntry.key}-remove`\\\"\\n\\t\\t\\t@click=\\\"removeLink\\\">\\n\\t\\t\\t<template #icon>\\n\\t\\t\\t\\t<LinkOff />\\n\\t\\t\\t</template>\\n\\t\\t\\t{{ t('text', 'Remove link') }}\\n\\t\\t</NcActionButton>\\n\\t\\t<NcActionButton v-if=\\\"!isUsingDirectEditing\\\"\\n\\t\\t\\tref=\\\"buttonFile\\\"\\n\\t\\t\\t:data-text-action-entry=\\\"`${actionEntry.key}-file`\\\"\\n\\t\\t\\t@click=\\\"linkFile\\\">\\n\\t\\t\\t<template #icon>\\n\\t\\t\\t\\t<Document />\\n\\t\\t\\t</template>\\n\\t\\t\\t{{ t('text', 'Link to file or folder') }}\\n\\t\\t</NcActionButton>\\n\\t\\t<NcActionInput v-if=\\\"isInputMode\\\"\\n\\t\\t\\ttype=\\\"text\\\"\\n\\t\\t\\t:value.sync=\\\"href\\\"\\n\\t\\t\\t:data-text-action-entry=\\\"`${actionEntry.key}-input`\\\"\\n\\t\\t\\t@submit=\\\"linkWebsite\\\">\\n\\t\\t\\t<template #icon>\\n\\t\\t\\t\\t<Web />\\n\\t\\t\\t</template>\\n\\t\\t\\t{{ t('text', 'Link to website') }}\\n\\t\\t</NcActionInput>\\n\\t\\t<NcActionButton v-else\\n\\t\\t\\t:data-text-action-entry=\\\"`${actionEntry.key}-website`\\\"\\n\\t\\t\\t@click=\\\"linkWebsite\\\">\\n\\t\\t\\t<template #icon>\\n\\t\\t\\t\\t<Web />\\n\\t\\t\\t</template>\\n\\t\\t\\t{{ state.active ? t('text', 'Update link') : t('text', 'Link to website') }}\\n\\t\\t</NcActionButton>\\n\\t\\t<NcActionButton :data-text-action-entry=\\\"`${actionEntry.key}-picker`\\\"\\n\\t\\t\\t@click=\\\"linkPicker\\\">\\n\\t\\t\\t<template #icon>\\n\\t\\t\\t\\t<Shape />\\n\\t\\t\\t</template>\\n\\t\\t\\t{{ t('text', 'Open the Smart Picker') }}\\n\\t\\t</NcActionButton>\\n\\t</NcActions>\\n</template>\\n\\n<script>\\nimport { NcActions, NcActionButton, NcActionInput } from '@nextcloud/vue'\\nimport { getLinkWithPicker } from '@nextcloud/vue/dist/Components/NcRichText.js'\\nimport { getFilePickerBuilder } from '@nextcloud/dialogs'\\nimport { generateUrl } from '@nextcloud/router'\\nimport { loadState } from '@nextcloud/initial-state'\\n\\nimport { getMarkAttributes, isActive } from '@tiptap/core'\\n\\nimport { Document, Loading, LinkOff, Web, Shape } from '../icons.js'\\nimport { BaseActionEntry } from './BaseActionEntry.js'\\nimport { useFileMixin } from '../Editor.provider.js'\\nimport { useMenuIDMixin } from './MenuBar.provider.js'\\n\\nexport default {\\n\\tname: 'ActionInsertLink',\\n\\tcomponents: {\\n\\t\\tNcActions,\\n\\t\\tNcActionButton,\\n\\t\\tNcActionInput,\\n\\t\\tDocument,\\n\\t\\tLoading,\\n\\t\\tLinkOff,\\n\\t\\tWeb,\\n\\t\\tShape,\\n\\t},\\n\\textends: BaseActionEntry,\\n\\tmixins: [\\n\\t\\tuseFileMixin,\\n\\t\\tuseMenuIDMixin,\\n\\t],\\n\\tdata: () => {\\n\\t\\treturn {\\n\\t\\t\\thref: '',\\n\\t\\t\\tisInputMode: false,\\n\\t\\t\\tstartPath: null,\\n\\t\\t\\t/** Open state of the actions menu */\\n\\t\\t\\tmenuOpen: false,\\n\\t\\t\\tisUsingDirectEditing: loadState('text', 'directEditingToken', null) !== null,\\n\\t\\t}\\n\\t},\\n\\tcomputed: {\\n\\t\\tactiveClass() {\\n\\t\\t\\treturn this.state.active ? 'is-active' : ''\\n\\t\\t},\\n\\t\\trelativePath() {\\n\\t\\t\\treturn this.$file?.relativePath ?? '/'\\n\\t\\t},\\n\\t},\\n\\tmethods: {\\n\\t\\t/**\\n\\t\\t * Open dialog and ask user which file to link to\\n\\t\\t * Triggered by the \\\"link file\\\" button\\n\\t\\t */\\n\\t\\tlinkFile() {\\n\\t\\t\\tif (this.startPath === null) {\\n\\t\\t\\t\\tthis.startPath = this.relativePath.split('/').slice(0, -1).join('/')\\n\\t\\t\\t}\\n\\n\\t\\t\\tconst filePicker = getFilePickerBuilder(t('text', 'Select file or folder to link to'))\\n\\t\\t\\t\\t.startAt(this.startPath)\\n\\t\\t\\t\\t.allowDirectories(true)\\n\\t\\t\\t\\t.setMultiSelect(false)\\n\\t\\t\\t\\t.setButtonFactory((nodes, path) => {\\n\\t\\t\\t\\t\\tconst buttons = []\\n\\t\\t\\t\\t\\tconst node = nodes?.[0]?.attributes?.displayName || nodes?.[0]?.basename\\n\\t\\t\\t\\t\\tconst isRoot = nodes?.[0]?.root === nodes?.[0]?.attributes?.filename\\n\\t\\t\\t\\t\\tlet label = t('text', 'Choose')\\n\\n\\t\\t\\t\\t\\tif (nodes.length === 1 && !isRoot) {\\n\\t\\t\\t\\t\\t\\tlabel = t('text', 'Choose {file}', { file: node })\\n\\t\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\t\\tbuttons.push({\\n\\t\\t\\t\\t\\t\\tcallback: () => {},\\n\\t\\t\\t\\t\\t\\ttype: 'primary',\\n\\t\\t\\t\\t\\t\\tlabel,\\n\\t\\t\\t\\t\\t\\tdisabled: isRoot,\\n\\t\\t\\t\\t\\t})\\n\\n\\t\\t\\t\\t\\treturn buttons\\n\\t\\t\\t\\t})\\n\\t\\t\\t\\t.build()\\n\\n\\t\\t\\tfilePicker.pick()\\n\\t\\t\\t\\t.then((file) => {\\n\\t\\t\\t\\t\\tconst client = OC.Files.getClient()\\n\\t\\t\\t\\t\\tclient.getFileInfo(file).then((_status, fileInfo) => {\\n\\t\\t\\t\\t\\t\\tconst url = new URL(generateUrl(`/f/${fileInfo.id}`), window.origin)\\n\\t\\t\\t\\t\\t\\tthis.setLink(url.href, fileInfo.name)\\n\\t\\t\\t\\t\\t\\tthis.startPath = fileInfo.path + (fileInfo.type === 'dir' ? `/${fileInfo.name}/` : '')\\n\\t\\t\\t\\t\\t})\\n\\t\\t\\t\\t\\tthis.menuOpen = false\\n\\t\\t\\t\\t})\\n\\t\\t\\t\\t.catch(() => {\\n\\t\\t\\t\\t\\t// do not close menu but keep focus\\n\\t\\t\\t\\t\\tthis.$refs.buttonFile.$el.focus()\\n\\t\\t\\t\\t})\\n\\t\\t},\\n\\t\\t/**\\n\\t\\t * Allow user to enter an URL manually\\n\\t\\t * Triggered when by the \\\"link url\\\" button\\n\\t\\t *\\n\\t\\t * @param {Event} event Triggering event\\n\\t\\t */\\n\\t\\tlinkWebsite(event) {\\n\\t\\t\\tif (event?.type === 'submit') {\\n\\t\\t\\t\\tconst href = [...event.target.elements].filter(e => e?.type === 'text')[0].value\\n\\t\\t\\t\\tthis.menuOpen = false\\n\\t\\t\\t\\tthis.isInputMode = false\\n\\t\\t\\t\\tthis.href = ''\\n\\t\\t\\t\\treturn this.setLink(href, href)\\n\\t\\t\\t}\\n\\n\\t\\t\\tif (isActive(this.$editor.state, 'link')) {\\n\\t\\t\\t\\tconst attrs = getMarkAttributes(this.$editor.state, 'link')\\n\\t\\t\\t\\tthis.href = attrs.href\\n\\t\\t\\t}\\n\\t\\t\\tthis.isInputMode = true\\n\\t\\t},\\n\\t\\t/**\\n\\t\\t * Save user entered URL as a link markup\\n\\t\\t * Triggered when the user submits the ActionInput\\n\\t\\t *\\n\\t\\t * @param {string} url href attribute of the link\\n\\t\\t * @param {string} text Text part of the link\\n\\t\\t */\\n\\t\\tsetLink(url, text) {\\n\\t\\t\\t// Heuristics for determining if we need a https:// prefix.\\n\\t\\t\\tconst noPrefixes = [\\n\\t\\t\\t\\t/^[a-zA-Z]+:/, // url with protocol (\\\"mailTo:email@domain.tld\\\")\\n\\t\\t\\t\\t/^\\\\//, // absolute path\\n\\t\\t\\t\\t/\\\\?fileId=/, // relative link with fileId\\n\\t\\t\\t\\t/^\\\\.\\\\.?\\\\//, // relative link starting with ./ or ../\\n\\t\\t\\t\\t/^[^.]*[/$]/, // no dots before first '/' - not a domain name\\n\\t\\t\\t\\t/^#/, // url fragment\\n\\t\\t\\t]\\n\\t\\t\\tif (url && !noPrefixes.find(regex => url.match(regex))) {\\n\\t\\t\\t\\turl = 'https://' + url\\n\\t\\t\\t}\\n\\n\\t\\t\\t// Avoid issues when parsing urls later on in markdown that might be entered in an invalid format (e.g. \\\"mailto: example@example.com\\\")\\n\\t\\t\\tconst href = url.replaceAll(' ', '%20')\\n\\t\\t\\tconst chain = this.$editor.chain()\\n\\t\\t\\t// Check if any text is selected, if not insert the link using the given text property\\n\\t\\t\\tif (this.$editor.view.state?.selection.empty) {\\n\\t\\t\\t\\tchain.insertContent({\\n\\t\\t\\t\\t\\ttype: 'paragraph',\\n\\t\\t\\t\\t\\tcontent: [{\\n\\t\\t\\t\\t\\t\\ttype: 'text',\\n\\t\\t\\t\\t\\t\\tmarks: [{\\n\\t\\t\\t\\t\\t\\t\\ttype: 'link',\\n\\t\\t\\t\\t\\t\\t\\tattrs: {\\n\\t\\t\\t\\t\\t\\t\\t\\thref,\\n\\t\\t\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t\\t}],\\n\\t\\t\\t\\t\\t\\ttext,\\n\\t\\t\\t\\t\\t}],\\n\\t\\t\\t\\t})\\n\\t\\t\\t} else {\\n\\t\\t\\t\\tchain.setLink({ href })\\n\\t\\t\\t}\\n\\t\\t\\tchain.focus().run()\\n\\t\\t},\\n\\t\\t/**\\n\\t\\t * Remove link markup at current position\\n\\t\\t * Triggered by the \\\"remove link\\\" button\\n\\t\\t */\\n\\t\\tremoveLink() {\\n\\t\\t\\tthis.$editor.chain().unsetLink().focus().run()\\n\\t\\t\\tthis.menuOpen = false\\n\\t\\t},\\n\\t\\tlinkPicker() {\\n\\t\\t\\tgetLinkWithPicker(null, true)\\n\\t\\t\\t\\t.then(link => {\\n\\t\\t\\t\\t\\tconst chain = this.$editor.chain()\\n\\t\\t\\t\\t\\tif (this.$editor.view.state?.selection.empty) {\\n\\t\\t\\t\\t\\t\\tchain.focus().insertPreview(link).run()\\n\\t\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\t\\tchain.setLink({ href: link }).focus().run()\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t})\\n\\t\\t\\t\\t.catch(error => {\\n\\t\\t\\t\\t\\tconsole.error('Smart picker promise rejected', error)\\n\\t\\t\\t\\t})\\n\\t\\t},\\n\\t},\\n}\\n</script>\\n\\n<style scoped>\\n\\t.action {\\n\\t\\t/* to unify width of ActionInput and ActionButton */\\n\\t\\tmin-width: 218px;\\n\\t}\\n</style>\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `\n/* This is required to properly render the bubble text (which seems linke a browser bug) */\n.text-editor__wrapper div.ProseMirror .mention[contenteditable=false][data-v-297bb5fa] * {\n\t-webkit-user-modify: read-only !important;\n}\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/extensions/Mention.vue\"],\"names\":[],\"mappings\":\";AA8CA,0FAAA;AACA;CACA,yCAAA;AACA\",\"sourcesContent\":[\"<template>\\n\\t<NodeViewWrapper as=\\\"span\\\" class=\\\"mention\\\" contenteditable=\\\"false\\\">\\n\\t\\t<NcUserBubble :user=\\\"node.attrs.id\\\"\\n\\t\\t\\t:display-name=\\\"username\\\"\\n\\t\\t\\t:primary=\\\"isCurrentUser\\\"\\n\\t\\t\\tclass=\\\"mention-user-bubble\\\">\\n\\t\\t\\t@{{ username }}\\n\\t\\t</NcUserBubble>\\n\\t</NodeViewWrapper>\\n</template>\\n\\n<script>\\nimport { NcUserBubble } from '@nextcloud/vue'\\nimport { NodeViewWrapper } from '@tiptap/vue-2'\\nimport { getCurrentUser } from '@nextcloud/auth'\\n\\nexport default {\\n\\tname: 'Mention',\\n\\tcomponents: {\\n\\t\\tNcUserBubble,\\n\\t\\tNodeViewWrapper,\\n\\t},\\n\\tprops: {\\n\\t\\tupdateAttributes: {\\n\\t\\t\\ttype: Function,\\n\\t\\t\\trequired: true,\\n\\t\\t},\\n\\n\\t\\tnode: {\\n\\t\\t\\ttype: Object,\\n\\t\\t\\trequired: true,\\n\\t\\t},\\n\\t},\\n\\tdata() {\\n\\t\\treturn {\\n\\t\\t\\tusername: this.node.attrs.label,\\n\\t\\t}\\n\\t},\\n\\tcomputed: {\\n\\t\\tisCurrentUser() {\\n\\t\\t\\treturn this.node.attrs.id === getCurrentUser()?.uid\\n\\t\\t},\\n\\t},\\n}\\n</script>\\n<style scoped>\\n/* This is required to properly render the bubble text (which seems linke a browser bug) */\\n.text-editor__wrapper div.ProseMirror .mention[contenteditable=false] :deep(*) {\\n\\t-webkit-user-modify: read-only !important;\\n}\\n</style>\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"editor--outline\",class:{ 'editor--outline-mobile': _vm.$isMobile },attrs:{\"data-text-el\":\"editor-outline\"}},[_c('header',{staticClass:\"editor--outline__header\"},[_c('NcButton',{staticClass:\"editor--outline__btn-close\",attrs:{\"type\":\"tertiary\",\"aria-label\":_vm.t('text', 'Close outline view')},on:{\"click\":_vm.$outlineActions.toggle},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c('Close')]},proxy:true}])}),_vm._v(\" \"),_c('h2',[_vm._v(_vm._s(_vm.t('text', 'Outline')))])],1),_vm._v(\" \"),_c('TableOfContents')],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n\t<div data-text-el=\"editor-table-of-contents\" :class=\"{ '--initial-render': initialRender }\" class=\"editor--toc\">\n\t\t<ul class=\"editor--toc__list\">\n\t\t\t<li v-for=\"(heading) in headings\"\n\t\t\t\t:key=\"heading.id\"\n\t\t\t\t:data-toc-level=\"heading.level\"\n\t\t\t\tclass=\"editor--toc__item\"\n\t\t\t\t:class=\"{\n\t\t\t\t\t[`editor--toc__item--${heading.level}`]: true,\n\t\t\t\t\t[`editor--toc__item--previous-${heading.previous}`]: heading.previous > 0,\n\t\t\t\t}\">\n\t\t\t\t<a :href=\"`#${heading.id}`\" @click.prevent=\"goto(heading)\">\n\t\t\t\t\t{{ heading.text }}\n\t\t\t\t</a>\n\t\t\t</li>\n\t\t</ul>\n\t</div>\n</template>\n\n<script>\nimport { mapState } from 'vuex'\nimport { useEditorMixin } from '../Editor.provider.js'\nimport useStore from '../../mixins/store.js'\n\nexport default {\n\tname: 'TableOfContents',\n\tmixins: [useStore, useEditorMixin],\n\tdata: () => ({\n\t\tinitialRender: true,\n\t}),\n\tcomputed: {\n\t\t...mapState({\n\t\t\theadings: (state) => state.text.headings,\n\t\t}),\n\t},\n\tmounted() {\n\t\tsetTimeout(() => {\n\t\t\tthis.initialRender = false\n\t\t}, 1000)\n\t},\n\tmethods: {\n\t\tgoto(heading) {\n\t\t\tdocument.getElementById(heading.id).scrollIntoView()\n\n\t\t\tthis.$nextTick(() => {\n\t\t\t\twindow.location.hash = heading.id\n\t\t\t})\n\t\t},\n\t},\n}\n</script>\n\n<style lang=\"scss\">\n.--initial-render {\n\t.editor--toc {\n\t\t&__item {\n\t\t\t--initial-padding-left: 0;\n\t\t\tanimation: initialPadding 1.5s;\n\t\t}\n\t}\n}\n\n.editor--toc {\n\tpadding: 0 10px;\n\tcolor: var(--color-main-text-maxcontrast);\n\t--animation-duration: 0.8s;\n\n\th3 {\n\t\tpadding-left: 0.75rem;\n\t}\n\n\t&__list {\n\t\twidth: 100%;\n\t\tlist-style: none;\n\t\tfont-size: 0.9rem;\n\t\tpadding: 0;\n\n\t\tanimation-name: fadeInLeft;\n\t\tanimation-duration: var(--animation-duration);\n\t}\n\n\t&__item {\n\t\ttransform: translateX(var(--padding-left, 0rem));\n\t\ttext-overflow: ellipsis;\n\t\toverflow: hidden;\n\t\twhite-space: nowrap;\n\t\tanimation: initialPadding calc(var(--animation-duration) * 2);\n\t\twidth: calc(100% - var(--padding-left));\n\n\t\ta:hover {\n\t\t\tcolor: var(--color-primary-element-hover);\n\t\t}\n\n\t\t&--1 {\n\t\t\t--padding-left: 0rem;\n\t\t\tfont-weight: 600;\n\t\t\t&:not(:nth-child(1)) {\n\t\t\t\tmargin-top: 0.5rem;\n\t\t\t}\n\t\t}\n\n\t\t&--2 {\n\t\t\t--padding-left: 1rem;\n\t\t}\n\n\t\t&--3 {\n\t\t\t--padding-left: 2rem;\n\t\t}\n\n\t\t&--4 {\n\t\t\t--padding-left: 3rem;\n\t\t}\n\n\t\t&--5 {\n\t\t\t--padding-left: 4rem;\n\t\t}\n\n\t\t&--6 {\n\t\t\t--padding-left: 5rem;\n\t\t}\n\n\t\t&--previous-1 {\n\t\t\t--initial-padding-left: 0rem\n\t\t}\n\n\t\t&--previous-2 {\n\t\t\t--initial-padding-left: 1rem\n\t\t}\n\n\t\t&--previous-3 {\n\t\t\t--initial-padding-left: 2rem\n\t\t}\n\n\t\t&--previous-4 {\n\t\t\t--initial-padding-left: 3rem\n\t\t}\n\n\t\t&--previous-5 {\n\t\t\t--initial-padding-left: 4rem\n\t\t}\n\n\t\t&--previous-6 {\n\t\t\t--initial-padding-left: 5rem\n\t\t}\n\t}\n}\n\n@keyframes initialPadding {\n  from {\n\ttransform: translateX(var(--initial-padding-left, initial));\n  }\n\n  to {\n\ttransform: translateX(var(--padding-left, 0rem));\n  }\n}\n\n</style>\n","import mod from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TableOfContents.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TableOfContents.vue?vue&type=script&lang=js\"","\n      import API from \"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/sass-loader/dist/cjs.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TableOfContents.vue?vue&type=style&index=0&id=2abb93ae&prod&lang=scss\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/sass-loader/dist/cjs.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TableOfContents.vue?vue&type=style&index=0&id=2abb93ae&prod&lang=scss\";\n       export default content && content.locals ? content.locals : undefined;\n","import { render, staticRenderFns } from \"./TableOfContents.vue?vue&type=template&id=2abb93ae\"\nimport script from \"./TableOfContents.vue?vue&type=script&lang=js\"\nexport * from \"./TableOfContents.vue?vue&type=script&lang=js\"\nimport style0 from \"./TableOfContents.vue?vue&type=style&index=0&id=2abb93ae&prod&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"editor--toc\",class:{ '--initial-render': _vm.initialRender },attrs:{\"data-text-el\":\"editor-table-of-contents\"}},[_c('ul',{staticClass:\"editor--toc__list\"},_vm._l((_vm.headings),function(heading){return _c('li',{key:heading.id,staticClass:\"editor--toc__item\",class:{\n\t\t\t\t[`editor--toc__item--${heading.level}`]: true,\n\t\t\t\t[`editor--toc__item--previous-${heading.previous}`]: heading.previous > 0,\n\t\t\t},attrs:{\"data-toc-level\":heading.level}},[_c('a',{attrs:{\"href\":`#${heading.id}`},on:{\"click\":function($event){$event.preventDefault();return _vm.goto(heading)}}},[_vm._v(\"\\n\\t\\t\\t\\t\"+_vm._s(heading.text)+\"\\n\\t\\t\\t\")])])}),0)])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n\t<div data-text-el=\"editor-outline\" class=\"editor--outline\" :class=\"{ 'editor--outline-mobile': $isMobile }\">\n\t\t<header class=\"editor--outline__header\">\n\t\t\t<NcButton class=\"editor--outline__btn-close\"\n\t\t\t\ttype=\"tertiary\"\n\t\t\t\t:aria-label=\"t('text', 'Close outline view')\"\n\t\t\t\t@click=\"$outlineActions.toggle\">\n\t\t\t\t<template #icon>\n\t\t\t\t\t<Close />\n\t\t\t\t</template>\n\t\t\t</NcButton>\n\t\t\t<h2>{{ t('text', 'Outline') }}</h2>\n\t\t</header>\n\t\t<TableOfContents />\n\t</div>\n</template>\n\n<script>\nimport { NcButton } from '@nextcloud/vue'\nimport TableOfContents from './TableOfContents.vue'\nimport { useOutlineStateMixin, useOutlineActions } from './Wrapper.provider.js'\nimport { Close } from './../icons.js'\nimport useStore from '../../mixins/store.js'\nimport { useIsMobileMixin } from '../Editor.provider.js'\n\nexport default {\n\tname: 'EditorOutline',\n\tcomponents: {\n\t\tClose,\n\t\tNcButton,\n\t\tTableOfContents,\n\t},\n\tmixins: [\n\t\tuseIsMobileMixin,\n\t\tuseStore,\n\t\tuseOutlineStateMixin,\n\t\tuseOutlineActions,\n\t],\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.editor--outline {\n\twidth:  300px;\n\tpadding: 0 10px 10px 10px;\n\tposition: fixed;\n\toverflow: auto;\n\t// 204px = 50px nc header + 60px collectives titlebar + 44px menubar + 50px bottom margin\n\tmax-height: calc(100% - 204px);\n\n\t&-mobile {\n\t\tborder-radius: var(--border-radius-large);\n\t\tbox-shadow: 0 1px 10px var(--color-box-shadow);\n\t\tbackground-color: var(--color-main-background-translucent);\n\t\tz-index: 1;\n\t}\n\n\t&__header {\n\t\tmargin: 0;\n\t\tposition: sticky;\n\t\ttop: 0;\n\t\tz-index: 1;\n\t\tbackground-color: var(--color-main-background);\n\t\tpadding: 0.6em 0.6em 0.6em 0;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\n\t\th2 {\n\t\t\tfont-size: 1rem;\n\t\t\tline-height: 1.1rem;\n\t\t\tflex-grow: 1;\n\t\t\tpadding: 0;\n\t\t\tmargin: 0;\n\t\t}\n\t}\n}\n</style>\n","import mod from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./EditorOutline.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./EditorOutline.vue?vue&type=script&lang=js\"","\n      import API from \"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/sass-loader/dist/cjs.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./EditorOutline.vue?vue&type=style&index=0&id=2e01a79b&prod&lang=scss&scoped=true\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/sass-loader/dist/cjs.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./EditorOutline.vue?vue&type=style&index=0&id=2e01a79b&prod&lang=scss&scoped=true\";\n       export default content && content.locals ? content.locals : undefined;\n","import { render, staticRenderFns } from \"./EditorOutline.vue?vue&type=template&id=2e01a79b&scoped=true\"\nimport script from \"./EditorOutline.vue?vue&type=script&lang=js\"\nexport * from \"./EditorOutline.vue?vue&type=script&lang=js\"\nimport style0 from \"./EditorOutline.vue?vue&type=style&index=0&id=2e01a79b&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2e01a79b\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"suggestion-list\"},[(_vm.hasResults)?_vm._l((_vm.itemGroups),function(groupItems,key,groupIndex){return _c('div',{key:key},[(_vm.hasGroups)?_c('div',{staticClass:\"suggestion-list__group\"},[_vm._v(\"\\n\\t\\t\\t\\t\"+_vm._s(key)+\"\\n\\t\\t\\t\")]):_vm._e(),_vm._v(\" \"),_vm._l((groupItems),function(item,index){return _c('div',{key:_vm.combineIndex(groupIndex, index),staticClass:\"suggestion-list__item\",class:{ 'is-selected': _vm.combineIndex(groupIndex, index) === _vm.selectedIndex },on:{\"click\":function($event){_vm.selectItem(_vm.combineIndex(groupIndex, index))}}},[_vm._t(\"default\",null,{\"item\":item,\"active\":_vm.combineIndex(groupIndex, index) === _vm.selectedIndex})],2)})],2)}):_c('div',{staticClass:\"suggestion-list__item is-empty\"},[_vm._v(\"\\n\\t\\t\"+_vm._s(_vm.t('text', 'No suggestion found'))+\"\\n\\t\")])],2)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<!--\n  - @copyright Copyright (c) 2021 Jonas <jonas@freesources.org>\n  -\n  - @author Jonas <jonas@freesources.org>\n  -\n  - @license GNU AGPL version 3 or any later version\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\n  -\n  -->\n\n<template>\n\t<div class=\"suggestion-list\">\n\t\t<template v-if=\"hasResults\">\n\t\t\t<div v-for=\"(groupItems, key, groupIndex) in itemGroups\" :key=\"key\">\n\t\t\t\t<div v-if=\"hasGroups\" class=\"suggestion-list__group\">\n\t\t\t\t\t{{ key }}\n\t\t\t\t</div>\n\t\t\t\t<div v-for=\"(item, index) in groupItems\"\n\t\t\t\t\t:key=\"combineIndex(groupIndex, index)\"\n\t\t\t\t\tclass=\"suggestion-list__item\"\n\t\t\t\t\t:class=\"{ 'is-selected': combineIndex(groupIndex, index) === selectedIndex }\"\n\t\t\t\t\t@click=\"selectItem(combineIndex(groupIndex, index))\">\n\t\t\t\t\t<slot :item=\"item\" :active=\"combineIndex(groupIndex, index) === selectedIndex\" />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</template>\n\t\t<div v-else class=\"suggestion-list__item is-empty\">\n\t\t\t{{ t('text', 'No suggestion found') }}\n\t\t</div>\n\t</div>\n</template>\n<script>\nimport { translate as t } from '@nextcloud/l10n'\n\nexport default {\n\tname: 'SuggestionListWrapper',\n\n\tprops: {\n\t\titems: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tcommand: {\n\t\t\ttype: Function,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tselectedIndex: 0,\n\t\t}\n\t},\n\tcomputed: {\n\t\thasGroups() {\n\t\t\treturn Object.keys(this.itemGroups).includes(undefined)\n\t\t},\n\t\thasResults() {\n\t\t\treturn this.items.length > 0\n\t\t},\n\t\titemHeight() {\n\t\t\treturn this.$el.scrollHeight / this.items.length\n\t\t},\n\t\titemInsideScrollView() {\n\t\t\t// If upper border of item is bigger or equal than scroll top\n\t\t\t// and lower end of item is smaller or equal than scroll bottom\n\t\t\treturn this.selectedIndex * this.itemHeight >= this.$el.scrollTop\n\t\t\t\t&& (this.selectedIndex + 1) * this.itemHeight <= this.$el.scrollTop + this.$el.clientHeight\n\t\t},\n\t\titemGroups() {\n\t\t\tconst groups = {}\n\t\t\tthis.items.forEach((item) => {\n\t\t\t\tif (!groups[item.suggestGroup]) {\n\t\t\t\t\tgroups[item.suggestGroup] = []\n\t\t\t\t}\n\t\t\t\tgroups[item.suggestGroup].push(item)\n\t\t\t})\n\t\t\treturn groups\n\t\t},\n\t\tcombineIndex() {\n\t\t\treturn (groupIndex, index) => {\n\t\t\t\tconst previousItemCount = Object.values(this.itemGroups)\n\t\t\t\t\t.slice(0, groupIndex)\n\t\t\t\t\t.reduce((sum, items) => {\n\t\t\t\t\t\treturn sum + items.length\n\t\t\t\t\t}, 0)\n\t\t\t\treturn previousItemCount + index\n\t\t\t}\n\t\t},\n\t},\n\twatch: {\n\t\titems() {\n\t\t\tthis.selectedIndex = 0\n\t\t\tthis.$el.scrollTop = 0\n\t\t},\n\t},\n\tmethods: {\n\t\tt,\n\t\tonKeyDown({ event }) {\n\t\t\t// Ignore any key modifier combinations\n\t\t\tif (event.ctrlKey || event.shiftKey || event.altKey || event.metaKey) {\n\t\t\t\treturn false\n\t\t\t}\n\n\t\t\tif (event.key === 'ArrowUp') {\n\t\t\t\tthis.selectedIndex = ((this.selectedIndex + this.items.length) - 1) % this.items.length\n\t\t\t\tif (!this.itemInsideScrollView) {\n\t\t\t\t\tthis.$el.scrollTop = this.selectedIndex * this.itemHeight\n\t\t\t\t}\n\t\t\t\treturn true\n\t\t\t}\n\n\t\t\tif (event.key === 'ArrowDown') {\n\t\t\t\tthis.selectedIndex = (this.selectedIndex + 1) % this.items.length\n\t\t\t\tif (!this.itemInsideScrollView) {\n\t\t\t\t\tthis.$el.scrollTop = (this.selectedIndex + 1) * this.itemHeight - this.$el.clientHeight\n\t\t\t\t}\n\t\t\t\treturn true\n\t\t\t}\n\n\t\t\tif (event.key === 'Enter' || event.key === 'Tab') {\n\t\t\t\tthis.selectItem(this.selectedIndex)\n\t\t\t\treturn true\n\t\t\t}\n\n\t\t\treturn false\n\t\t},\n\n\t\tselectItem(index) {\n\t\t\tconst item = this.items[index]\n\n\t\t\tif (item) {\n\t\t\t\tthis.$emit('select', item)\n\t\t\t\tthis.command(item)\n\t\t\t}\n\t\t},\n\t},\n}\n</script>\n\n<style scoped lang=\"scss\">\n.suggestion-list {\n\tborder-radius: var(--border-radius);\n\tbackground-color: var(--color-main-background);\n\tbox-shadow: 0 1px 5px var(--color-box-shadow);\n\toverflow: auto;\n\n\tmin-width: 200px;\n\tmax-width: 400px;\n\twidth: 80vw;\n\tpadding: 4px;\n\t// Show maximum 5 entries and a half to show scroll\n\tmax-height: 35.5px * 5 + 18px;\n\tmargin: 5px 0;\n\n\t&__group {\n\t\tfont-weight: bold;\n\t\tcolor: var(--color-primary-element);\n\t\tfont-size: var(--default-font-size);\n\t\tline-height: 44px;\n\t\twhite-space: nowrap;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\topacity: .7;\n\t\tbox-shadow: none !important;\n\t\tflex-shrink: 0;\n\t\tpadding-left: 8px;\n\t}\n\n\t&__item {\n\t\tborder-radius: 8px;\n\t\tpadding: 4px 8px;\n\t\tmargin-bottom: 4px;\n\t\topacity: 0.8;\n\t\tcursor: pointer;\n\n\t\t// Take care of long names\n\t\twhite-space: nowrap;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\n\t\t&:last-child {\n\t\t\tmargin-bottom: 0;\n\t\t}\n\n\t\t&__emoji {\n\t\t\tpadding-right: 8px;\n\t\t}\n\n\t\t&.is-selected,\n\t\t&:focus,\n\t\t&:hover {\n\t\t\topacity: 1;\n\t\t\tbackground-color: var(--color-primary-element-light);\n\t\t}\n\t}\n}\n</style>\n","import mod from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SuggestionListWrapper.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SuggestionListWrapper.vue?vue&type=script&lang=js\"","\n      import API from \"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/sass-loader/dist/cjs.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SuggestionListWrapper.vue?vue&type=style&index=0&id=721c3a10&prod&scoped=true&lang=scss\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/sass-loader/dist/cjs.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SuggestionListWrapper.vue?vue&type=style&index=0&id=721c3a10&prod&scoped=true&lang=scss\";\n       export default content && content.locals ? content.locals : undefined;\n","import { render, staticRenderFns } from \"./SuggestionListWrapper.vue?vue&type=template&id=721c3a10&scoped=true\"\nimport script from \"./SuggestionListWrapper.vue?vue&type=script&lang=js\"\nexport * from \"./SuggestionListWrapper.vue?vue&type=script&lang=js\"\nimport style0 from \"./SuggestionListWrapper.vue?vue&type=style&index=0&id=721c3a10&prod&scoped=true&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"721c3a10\",\n  null\n  \n)\n\nexport default component.exports"],"names":["OUTLINE_STATE","Symbol","OUTLINE_ACTIONS","useOutlineStateMixin","inject","$outlineState","from","default","visible","enable","useOutlineActions","$outlineActions","toggle","options","styleTagTransform","setAttributes","insert","domAPI","insertStyleElement","locals","BaseActionEntry","mixins","useEditorMixin","useIsMobileMixin","useStore","props","actionEntry","type","Object","required","canBeFocussed","Boolean","data","state","getActionState","this","$editor","computed","label","icon","keyshortcuts","getKeyshortcuts","tooltip","getKeys","$isMobile","join","watch","setTabIndexOnButton","mounted","$_updateState","debounce","updateState","bind","on","$emit","disabled","beforeDestroy","off","methods","button","$el","tagName","toLowerCase","querySelector","removeAttribute","setAttribute","focusButton","focus","MENU_ID","useMenuIDMixin","$menuID","menuIDSelector","name","components","NcEmojiPicker","NcButton","extends","addEmoji","_ref","id","native","action","chain","run","_vm","_c","_self","staticClass","attrs","key","scopedSlots","_u","fn","tag","proxy","NcActions","NcActionButton","Loading","Folder","Upload","useIsPublicMixin","useEditorUpload","useActionAttachmentPromptMixin","useUploadingStateMixin","useActionChooseLocalAttachmentMixin","isUploadingAttachments","$uploadingState","_v","$editorUpload","$callChooseLocalAttachment","_s","t","_e","$isPublic","$callAttachmentPrompt","NcActionInput","Document","LinkOff","Web","Shape","useFileMixin","href","isInputMode","startPath","menuOpen","isUsingDirectEditing","loadState","activeClass","active","relativePath","$file","linkFile","split","slice","getFilePickerBuilder","startAt","allowDirectories","setMultiSelect","setButtonFactory","nodes","path","buttons","node","attributes","displayName","basename","isRoot","root","filename","length","file","push","callback","build","pick","then","OC","Files","getClient","getFileInfo","_status","fileInfo","url","URL","generateUrl","window","origin","setLink","catch","$refs","buttonFile","linkWebsite","event","target","elements","filter","e","value","isActive","getMarkAttributes","text","find","regex","match","replaceAll","view","selection","empty","insertContent","content","marks","removeLink","unsetLink","linkPicker","getLinkWithPicker","link","insertPreview","error","console","class","open","ref","$event","ReadonlyEntries","forceLabel","FormatListBulleted","click","_ref2","keyChar","keyModifiers","MODIFIERS","Mod","Undo","command","undo","priority","Redo","redo","FormatBold","toggleBold","FormatItalic","toggleItalic","FormatUnderline","toggleUnderline","Shift","FormatStrikethrough","toggleStrike","FormatHeader1","children","level","toggleHeading","FormatHeader2","FormatHeader3","FormatHeader4","FormatHeader5","FormatHeader6","isSeparator","_ref3","_ref4","_ref5","_ref6","toggleBulletList","FormatListNumbered","toggleOrderedList","FormatListCheckbox","toggleTaskList","LinkIcon","component","ActionInsertLink","FormatQuote","toggleBlockquote","Info","toggleCallout","Positive","Warn","Danger","Alt","CodeTags","toggleCodeBlock","Table","insertTable","Emoticon","EmojiPickerAction","emojiObject","arguments","undefined","emoji","Images","ActionAttachmentUpload","isMac","navigator","userAgent","includes","Control","TRANSLATIONS","getEntryClasses","map","mod","concat","isMobile","toUpperCase","keysString","isDisabled","can","getIsActive","args","Array","isArray","getType","listComponent","items","editor","range","render","popup","onStart","VueRenderer","parent","propsData","clientRect","tippy","getReferenceClientRect","appendTo","document","body","element","showOnCreate","interactive","trigger","placement","$on","hide","onUpdate","updateProps","setProps","onKeyDown","destroy","onExit","makeIcon","original","functional","h","size","MDI_Loading","AlphabeticalVariant","MDI_AlphabeticalVariant","AlignHorizontalCenter","MDI_AlignHorizontalCenter","AlignHorizontalLeft","MDI_AlignHorizontalLeft","AlignHorizontalRight","MDI_AlignHorizontalRight","Close","MDI_Close","MDI_Check","MDI_CodeTags","MDI_CircleMedium","MDI_Danger","Delete","MDI_Delete","MDI_Document","DotsHorizontal","MDI_DotsHorizontal","MDI_Emoticon","MDI_Folder","MDI_FormatBold","MDI_FormatHeader1","MDI_FormatHeader2","MDI_FormatHeader3","MDI_FormatHeader4","MDI_FormatHeader5","MDI_FormatHeader6","MDI_FormatItalic","MDI_FormatListBulleted","MDI_FormatListCheckbox","MDI_FormatListNumbered","MDI_FormatQuote","MDI_FormatStrikethrough","MDI_FormatUnderline","Help","MDI_Help","Image","MDI_Image","MDI_Images","MDI_Info","MDI_Link","MDI_LinkOff","MDI_LinkVariantPlus","MDI_Lock","MDI_Positive","MDI_Redo","MDI_Shape","MDI_Table","TableAddColumnAfter","MDI_TableAddColumnAfter","TableAddColumnBefore","MDI_TableAddColumnBefore","TableAddRowAfter","MDI_TableAddRowAfter","TableAddRowBefore","MDI_TableAddRowBefore","TableSettings","MDI_TableSettings","TranslateVariant","MDI_TrashCan","MDI_TranslateVariant","MDI_Undo","MDI_Upload","MDI_Warn","MDI_Web","showCursorLabel","clientId","setTimeout","el","getElementById","classList","add","remove","getTimestamp","Math","floor","Date","now","TiptapCollaborationCursor","extend","addOptions","provider","user","color","lastUpdate","cursor","createElement","insertBefore","createTextNode","onCreate","awareness","added","removed","updated","onTransaction","transaction","meta","addToHistory","pointer","setLocalStateField","EmojiPluginKey","PluginKey","Node","create","HTMLAttributes","suggestion","char","allowedPrefixes","pluginKey","addCommands","commands","addProseMirrorPlugins","Suggestion","ownPaused","toggleFocusTrap","trapStack","_nc_focus_trap","activeTrap","sinkListItem","goToNextCell","goToPreviousCell","pause","unpause","Extension","onFocus","onBlur","onSelectionUpdate","Mark","parseHTML","renderHTML","toMarkdown","close","mixable","escape","expelEnclosingWhitespace","tr","doc","descendants","pos","index","findIndex","mark","removeMark","nodeSize","docChanged","setMeta","dispatch","addKeyboardShortcuts","Plugin","handleKeyDown","keyCode","ctrlKey","metaKey","shiftKey","stopPropagation","dispatchEvent","html","DOMParser","parseFromString","nodeIterator","createNodeIterator","NodeFilter","SHOW_TEXT","currentNode","nextNode","forAllTextNodes","textNode","COLLAPSING_WHITE_SPACE_VALUES","ancestor","parentElement","style","getComputedStyle","whiteSpace","getPropertyValue","collapseWhiteSpace","textContent","innerHTML","Markdown","extendMarkSchema","extension","context","storage","getExtensionField","extendNodeSchema","handleDOMEvents","mouseup","_","clipboardTextParser","str","$context","parser","fromSchema","schema","cloneNode","dom","part","para","innerText","append","markdownit","parseSlice","preserveWhitespace","clipboardTextSerializer","traverseNodes","childCount","clipboardSerializer","serialize","isLeaf","firstChild","transformPastedHTML","createMarkdownSerializer","serializer","MarkdownSerializer","extractNodesToMarkdown","extractMarksToMarkdown","tightLists","extractToPlaintext","blankMark","defaultMarks","convertNames","defaultMarkdownSerializer","markEntries","entries","_mark","fromEntries","extractToMarkdown","nodesOrMarks","nodeOrMarkEntries","nodeOrMark","spec","object","convert","replace","_m","letter","NcUserBubble","NodeViewWrapper","updateAttributes","Function","username","isCurrentUser","getCurrentUser","uid","TipTapMention","getAttrs","decodeURIComponent","getAttribute","mergeAttributes","addNodeView","VueNodeViewRenderer","Mention","write","encodeURIComponent","Tab","addExtensions","PlainTextDocument","Text","TiptapBulletList","rule","assign","addAttributes","bullet","rendered","isRequired","addInputRules","InputRule","handler","wrappingInputRule","getAttributes","insertText","ICONS_MAP","info","success","warn","NodeViewContent","group","defining","types","typesAvailable","contains","classy","renderContent","ensureNewLine","closeBlock","Callout","setCallout","wrapIn","isNodeActive","unsetCallout","lift","copied","copyLoading","copySuccess","copyToClipboard","clipboard","writeText","showSuccess","showError","isHTML","MarkerIcon","ContentCopy","Check","Eye","ViewSplitVertical","CodeBraces","NcActionLink","NcActionSeparator","NcLoadingIcon","CopyToClipboardMixin","isEditable","viewMode","targetId","uuidv4","hasCode","language","supportPreview","showCode","showPreview","defaultMode","renderMermaid","beforeMount","renderMermaidDebounced","trim","preview","mermaid","parse","svg","targetElement","display","debug","initialize","startOnLoad","$nextTick","copyCode","updateLanguage","directives","rawName","expression","TiptapCodeBlockLowlight","getContent","inner","codeBlock","params","backticks","fence","sort","CodeBlockView","Mod-a","$from","selectParentNode","to","setTextSelection","selectedIndex","hasResults","itemHeight","scrollHeight","itemInsideScrollView","scrollTop","clientHeight","altKey","selectItem","emojiAddRecent","_l","short_name","TiptapCodeBlock","draggable","out","Error","dashes","separator","resolve","deleteRange","insertContentAt","addPasteRules","TipTapHardBreak","syntax","keepOnSplit","setHardBreak","ctx","d","depth","i","child","startsWith","extractHeadings","counter","Map","headings","offset","slugify","has","next","get","set","getId","freeze","headingAnchorPluginKey","headingAnchor","init","decorations","anchorDecorations","apply","_oldState","newState","current","prev","some","isDifferentFrom","removedDecorations","mapping","onRemove","mapDecorations","getState","other","heading","decorationForHeading","DecorationSet","Decoration","widget","symbol","appendChild","className","addEventListener","handleClick","anchorForHeading","side","scrollIntoView","location","hash","TipTapHeading","levels","reduce","val","store","NcModal","images","startIndex","Number","show","currentImageIndex","currentImage","showNextImage","showPreviousImage","previewUrl","LoadImageError","constructor","reason","imageUrl","message","ImageIcon","DeleteIcon","ShowImageModal","ClickOutside","useAttachmentResolver","attachment","imageLoaded","loaded","failed","showIcons","errorMessage","attachmentSize","showImageModal","imageIndex","isLastInserted","embeddedImageList","mapGetters","imageAttachments","attachmentType","isImage","isMediaAttachment","showDeleteIcon","showImageDeleteIcon","canDisplayImage","src","alt","trMeta","getMeta","loadPreview","onImageLoadFailure","$attachmentResolver","Promise","reject","img","onload","onerror","err","updateAlt","onLoaded","altInput","updateEmbeddedImageList","imageViews","querySelectorAll","imgv","handleAttachmentClick","OCA","Viewer","mimetypes","indexOf","mimetype","davPath","fullUrl","handleImageClick","onDelete","emit","deleteNode","domProps","_k","TiptapImage","selectable","allowBase64","ImageView","handleDrop","dataTransfer","files","coordinates","posAtCoords","left","clientX","top","clientY","customEvent","CustomEvent","bubbles","detail","position","handlePaste","clipboardData","toString","image","inline","SuggestionListWrapper","suggestionList","item","suggestGroupFormat","suggestGroupPicker","important","formattingSuggestions","query","list","menuEntries","filterOut","suggestGroup","createSuggestions","LinkPickerList","commandChain","providerId","pattern","test","isValidMarkdown","searchProvider","p","title","icon_url","canRunState","isActiveState","LinkPickerPluginKey","allow","suggestions","domHref","parseHref","isLinkToSelfWithHash","locationNoHash","pathname","search","PROTOCOLS_WITH_PREVIEW","CheckIcon","CloseIcon","ContentCopyIcon","NcReferenceList","NcTextField","LinkOffIcon","PencilIcon","String","edit","newHref","referenceTitle","copyLinkTooltip","sanitizedHref","protocol","resetBubble","copyLink","onReferenceListLoaded","referencelist","firstReference","openGraphObject","startEdit","stopEdit","updateLink","setLinkUrl","ranges","min","max","$to","extendMarkRange","hideLinkBubble","preventDefault","plugin","LinkBubbleView","addEventListeners","closeOnExternalEvents","capture","removeEventListeners","removeEventListener","popper","Cypress","createTooltip","editorElement","editorIsAttached","duration","hideOnClick","popperOptions","strategy","update","oldState","composing","updateTooltip","nodeStart","referenceEl","nodeDOM","prototype","call","getBoundingClientRect","activeLink","linkMark","m","pluginState","linkBubbleKey","linkBubble","linkBubblePlugin","cur","LinkBubblePluginView","appendTransaction","transactions","sameSelection","eq","sameDoc","noHistory","every","resolved","maybeChild","textOffset","nodeBefore","activeLinkFromSelection","handleClickOn","_node","_nodePos","direct","setActiveLink","keydown","linkClickingKey","contentComponent","extractLinkParagraphs","paragraphs","lastChild","hasOtherContent","extractHref","previewPossible","DotsVerticalIcon","NcActionCaption","NcActionRadio","onOpen","setPreview","unsetPreview","currentTarget","previewOptionsPluginKey","previewOptions","editable","linkParagraphs","linkParagraphDecorations","linkParagraph","Component","Vue","PreviewOptions","$mount","previewOptionForLinkParagraph","decorationForLinkParagraph","TiptapParagraph","Backspace","parentOffset","previousNode","joinBackward","nodeViewProps","isEmbedded","atom","isolating","rel","Preview","setNode","nodeAfter","previewAttributesFromSelection","typeOrName","getNodeType","TipTapTaskItem","nested","adjust","checked","listAttributes","checkboxAttributes","contenteditable","parentList","findParentNodeClosestToPos","$pos","predicate","before","start","taskItem","listItem","setNodeMarkup","TiptapTaskList","renderList","nodeEqualsType","notAfter","disabledNodes","__","shouldInsertNodeAtEnd","endPosition","PROTOCOLS_TO_LINK_TO","Link","TipTapLink","inclusive","auxclick","closest","stopImmediatePropagation","linkElement","paste","linkEl","TipTapStrike","Bold","markInputRule","starInputRegex","markPasteRule","starPasteRegex","TipTapUnderline","underscoreInputRegex","underscorePasteRegex","Italic","TipTapItalic","lowlight","registerAlias","editing","extensions","defaultExtensions","Paragraph","HardBreak","Heading","Strong","Strike","Blockquote","CharacterCount","Code","CodeBlock","configure","defaultLanguage","BulletList","HorizontalRule","OrderedList","ListItem","EditableTable","TaskList","TaskItem","Callouts","Underline","ImageInline","Dropcursor","Gapcursor","KeepSyntax","FrontMatter","Emoji","EmojiList","emojiSearch","LinkPicker","openOnClick","validate","LinkBubble","Placeholder","emptyNodeClass","placeholder","showOnlyWhenEditable","TrailingNode","additionalExtensionNames","Span","author","insertIntoBlameMap","splice","TrackState","blameMap","applyTransform","transform","clientID","steps","newBlame","clientIDs","result","span","maps","after","forEach","end","updateBlameMap","abs","sin","viewReference","editorView","instance","tracked","deco","decos","tState","dec","buildRender","tokens","idx","env","slf","nesting","attrSet","attrJoin","renderToken","md","use","container","includesClass","token","cls","attrGet","splitListAt","TokenConstructor","closeList","block","openList","markup","findChildOf","parentIndex","searchLevel","isPreviewLinkInParagraph","unwrapToken","MarkdownIt","breaks","taskLists","labelAfter","frontMatter","fm","core","ruler","startsWithTask","attrIndex","splitBefore","Token","ruler2","at","silent","rval","markdownitNewline","markdownitEscape","res","attrPush","renderer","rules","hardbreak","xhtmlOut","callouts","l","escaped","j","exec","groups","linestart","contentNext","special","markdownitMentions","implicitFigures","front_matter","escapeHtml","bullet_list_open","$store","hasModule","registerModule","textModule","getPos","textAlign","deleteRow","addRowBefore","addRowAfter","NcActionButtonGroup","alignCenter","align","alignLeft","alignRight","setCellAttribute","goToNextRow","menu","closeMenu","deleteColumn","addColumnBefore","addColumnAfter","extendNodeWithView","TableView","TableCaption","TableCell","TableCellView","TableHeader","TableHeaderView","TableHeadRow","TableRow","tableStart","table","bottom","selectedRect","lastRow","newRow","setNodeAttribute","_ref7","isInTable","rowsCount","colsCount","headerCells","cells","cell","tableCell","createAndFill","headerCell","tableHeader","headRow","tableHeadRow","createChecked","rows","tableRow","createTable","anchor","replaceSelectionWith","setSelection","TextSelection","near","leaveTable","_ref8","$head","tableDepth","$next","_ref9","$cell","cellStart","row","indexAfter","rowNode","findSameCellInNextRow","selectionCell","between","moveCellForward","_ref10","columns","columnIndex","getColumns","columnWidths","widths","column","maxWidth","cellWidth","calculateColumnWidths","currentHeaderIndex","Enter","_ref11","deleteSelection","allowGapCursor","backup","escapeExtraCharacters","currentColumnIndex","cellRenderedContentLength","childNode","columnWidth","space","leftPadding","rightPadding","ceil","repeat","renderInline","childNodes","isText","hardBreak","newNode","Fragment","addToStart","headerIndex","___CSS_LOADER_EXPORT___","module","initialRender","mapState","goto","previous","TableOfContents","hasGroups","keys","itemGroups","combineIndex","groupIndex","values","sum","groupItems","_t"],"sourceRoot":""}