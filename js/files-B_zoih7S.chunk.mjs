const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=[window.OC.filePath('text', '', 'js/PublicFilesEditor-3NXI2QQz.chunk.mjs'),window.OC.filePath('text', '', 'js/index-gMaV0V1e.chunk.mjs'),window.OC.filePath('text', '', 'js/emoji-picker-DQhTjoLy.chunk.mjs'),window.OC.filePath('text', '', 'js/NcNoteCard-Dz5-u2BY-DlVQ92TX.chunk.mjs'),window.OC.filePath('text', '', 'js/index-B64e8dYD.chunk.mjs'),window.OC.filePath('text', '', 'js/vue.runtime.esm-UAI8SE-v.chunk.mjs'),window.OC.filePath('text', '', 'js/NcLoadingIcon-pzx-bM2e.chunk.mjs'),window.OC.filePath('text', '', 'js/index-DUrHmx5a.chunk.mjs'),window.OC.filePath('text', '', 'css/NcLoadingIcon-CAC0K4sG.chunk.css'),window.OC.filePath('text', '', 'css/NcNoteCard-Dz5-u2BY-WJ_dH_TX.chunk.css'),window.OC.filePath('text', '', 'js/_plugin-vue2_normalizer-XSZyZ-Zg.chunk.mjs'),window.OC.filePath('text', '', 'js/RichWorkspace-Bw0x_3Fl.chunk.mjs'),window.OC.filePath('text', '', 'js/Editor.singleton-cJZFQQVy.chunk.mjs'),window.OC.filePath('text', '', 'js/RichTextReader-Dl7LaAH_.chunk.mjs'),window.OC.filePath('text', '', 'js/EditorOutline-DVWCROI6.chunk.mjs'),window.OC.filePath('text', '', 'js/logger-DH1Ckv9w.chunk.mjs'),window.OC.filePath('text', '', 'js/NcCheckboxRadioSwitch-CLnWsBwK-De_MbaV5.chunk.mjs'),window.OC.filePath('text', '', 'css/NcCheckboxRadioSwitch-CLnWsBwK-35V8jJy1.chunk.css'),window.OC.filePath('text', '', 'js/MediaHandler.provider-B-6EH1Bu.chunk.mjs'),window.OC.filePath('text', '', 'css/EditorOutline-SPSLoLQ_.chunk.css'),window.OC.filePath('text', '', 'js/BaseReader-_4M7V3Q6.chunk.mjs'),window.OC.filePath('text', '', 'css/BaseReader-DLKIg9lj.chunk.css'),window.OC.filePath('text', '', 'css/MarkdownContentEditor-BXAvrv-W.chunk.css'),window.OC.filePath('text', '', 'css/RichWorkspace-DF75DIQU.chunk.css')])))=>i.map(i=>d[i]);
import{_ as h,a as w,e as _}from"./index-gMaV0V1e.chunk.mjs";import{t as l,c as I}from"./NcLoadingIcon-pzx-bM2e.chunk.mjs";import{g as F,s as R,a as g}from"./NcNoteCard-Dz5-u2BY-DlVQ92TX.chunk.mjs";import{V as A}from"./vue.runtime.esm-UAI8SE-v.chunk.mjs";import{H as y,a as O,N as D}from"./index-D0ZnU7fN.chunk.mjs";import{l as H}from"./index-B64e8dYD.chunk.mjs";import{h as C}from"./index-DUrHmx5a.chunk.mjs";import{b as u}from"./mime-BQlQASQR.chunk.mjs";import{F as T,P as k}from"./dav-CQDyL7M_-zte0U9Np.chunk.mjs";import"./emoji-picker-DQhTjoLy.chunk.mjs";const V='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-text" viewBox="0 0 24 24"><path d="M21,6V8H3V6H21M3,18H12V16H3V18M3,13H21V11H3V13Z" /></svg>',b="Edit with text app",B=()=>{const t=F(),e=document.querySelector("#preview table.files-filestable");if(!t||!e){const i=document.createElement("div");i.id="text-viewer-fallback",document.body.appendChild(i);const s=r=>OCA.Files.fileActions.register(r,b,OC.PERMISSION_UPDATE|OC.PERMISSION_READ,C("core","actions/rename"),n=>{const c=window.FileList.findFile(n);Promise.all([h(()=>import("./vue.runtime.esm-UAI8SE-v.chunk.mjs").then(a=>a.z),[],import.meta.url),h(()=>import("./PublicFilesEditor-3NXI2QQz.chunk.mjs"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]),import.meta.url)]).then(a=>{const m=window.FileList.getCurrentDirectory()+"/"+n,p=a[0].default,x=a[1].default;new p({render:E=>E(x,{props:{fileId:c?c.id:null,active:!0,shareToken:t,relativePath:m,mimeType:c.mimetype},on:{close:()=>{(void 0).$destroy()}}})}).$mount(i)})},l("text","Edit"));for(let r=0;r<u.length;r++)s(u[r]),OCA.Files.fileActions.setDefault(u[r],b)}},Z=()=>{const t=l("text","Readme")+"."+H("text","default_file_extension");O({id:"rich-workspace-init",displayName:l("text","Add folder description"),category:D.Other,enabled(e){return Number(e.attributes["rich-workspace-file"])?!1:(e.permissions&k.CREATE)!==0},iconSvgInline:V,async handler(e,i){var a,m;if(i.map(p=>p.basename).includes(t)){R(l("text",'"{name}" already exist!',{name:t}));return}const s=e.encodedSource+"/"+encodeURIComponent(t),r=await I({method:"PUT",url:s,headers:{Overwrite:"F"}}),n=parseInt(r.headers["oc-fileid"]),c=new T({source:e.source+"/"+t,id:n,mtime:new Date,mime:"text/markdown",owner:((a=w())==null?void 0:a.uid)||null,permissions:k.ALL,root:(e==null?void 0:e.root)||"/files/"+((m=w())==null?void 0:m.uid)});g(l("text",'Created "{name}"',{name:t})),e.attributes["rich-workspace-file"]=n,e.attributes["rich-workspace"]="",_("files:node:created",c),_("files:node:updated",e)}})};let f,o,d;const v=(t,e)=>["files","favorites","public-share"].includes(e.id),j=new y({id:"workspace",order:10,enabled:v,render:async(t,e)=>{d=e,f||(f=(await h(()=>import("./RichWorkspace-Bw0x_3Fl.chunk.mjs"),__vite__mapDeps([11,6,2,1,5,7,8,4,3,9,12,13,14,15,16,17,10,18,19,20,21,22,23]),import.meta.url)).default),o&&(o.$destroy(),console.debug("Destroying existing FilesHeaderRichWorkspaceInstance"));const i=!!d.attributes["rich-workspace-file"],s=d.attributes["rich-workspace"]||"",r=d.path||"";o=new A({extends:f,propsData:{content:s,hasRichWorkspace:i,path:r}}).$mount(t),window.FilesHeaderRichWorkspaceInstance=o},updated(t,e){if(d=t,!o){console.error("No vue instance found for FilesWorkspaceHeader");return}const i=!!t.attributes["rich-workspace-file"]&&v(t,e);o.hasRichWorkspace=i,o.content=t.attributes["rich-workspace"]||"",o.path=t.path||""}});export{b as FILE_ACTION_IDENTIFIER,j as FilesWorkspaceHeader,Z as addMenuRichWorkspace,B as registerFileActionFallback};
//# sourceMappingURL=files-B_zoih7S.chunk.mjs.map
