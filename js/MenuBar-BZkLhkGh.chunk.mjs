import{f as y,r as S}from"./vue.runtime.esm-CmyF5LTP.chunk.mjs";import{a9 as k,v as A,u as K,aa as T,ab as $,ac as W,ad as H,ae as P,af as F,ag as x,q as I,ah as L,B as U,ai as D,aj as V,ak as j,al as z,am as q,k as N,an as J,ao as Q,ap as f,aq as G,ar as Y}from"./EditorOutline-BnyqtJC0.chunk.mjs";import{t as p,n as Z,G as X,c as tt,e as g}from"./NcLoadingIcon-DAvEVuxu.chunk.mjs";import{f as w}from"./MediaHandler.provider-bE4nrOxZ.chunk.mjs";import{n as d,u as et}from"./NcCheckboxRadioSwitch-CX3HXCEk-qnG5ZcLO.chunk.mjs";import{g as C,b as it}from"./index-DCzdQJ7L.chunk.mjs";import{g as nt}from"./emoji-picker-hi3Hwbeu.chunk.mjs";import{d as st,N as ot,u as rt}from"./NcNoteCard-CwNXZ4vV-wGY_yume.chunk.mjs";import{u as at}from"./Wrapper-l3BZ6_tV.chunk.mjs";const ct={name:"NcActionButton",components:{NextcloudVueNcActionButton:A},extends:k,mounted(){this.editor?.on("transaction",()=>this.updateState())},methods:{runAction(){const{actionEntry:t}=this;t.click?t.click(this):t.action(this.editor?.chain().focus(),this.editor)?.run(),this.$nextTick(()=>{this.$emit("trigged",{...t})})}}};var lt=function(){var t=this,e=t._self._c;return e("NextcloudVueNcActionButton",t._g({staticClass:"entry-single-action entry-action entry-action-item",class:t.state.class,attrs:{title:t.listItemTooltip||void 0,disabled:t.state.disabled,"aria-keyshortcuts":t.keyshortcuts||void 0,"data-text-action-entry":t.actionEntry.key,"model-value":t.actionType!=="button"?t.state.active:void 0,"close-after-click":""},on:{click:t.runAction},scopedSlots:t._u([{key:"icon",fn:function(){return[e(t.icon,{tag:"component"})]},proxy:!0}])},t.$listeners),[t._v(" "+t._s(t.label)+" ")])},dt=[],ht=d(ct,lt,dt,!1,null,null);const ut=ht.exports,_t={name:"ActionList",components:{NcActions:st,NcActionSeparator:$,ActionListItem:ut},extends:k,mixins:[K,T],props:{forceEnabled:{type:Boolean,default:!1}},data:()=>({visible:!1,hasEnabledChild:!0}),computed:{currentChild(){const{state:t,editor:e,actionEntry:{children:i}}=this;return t.active?i.find(n=>P(n,e)):null},icon(){return this.currentChild?this.currentChild.icon:this.actionEntry.icon},iconKey(){return`${this.actionEntry.key}/${this.activeKey}`},activeKey(){return this.currentChild?.key},children(){return this.actionEntry.children.filter(({visible:t})=>t===void 0?!0:typeof t=="function"?t(this):t)},labelWithSelected(){return this.currentChild?p("text",'{menuItemName}, "{selectedSubMenuItemName}" is selected',{menuItemName:this.actionEntry.label,selectedSubMenuItemName:this.currentChild.label}):this.actionEntry.label},isEnabled(){return this.forceEnabled||this.hasEnabledChild}},mounted(){this.$_updateState=H(this.checkStateOfChildren.bind(this),50),this.editor?.on("update",this.$_updateState),this.editor?.on("selectionUpdate",this.$_updateState)},beforeDestroy(){this.editor?.off("update",this.$_updateState),this.editor?.off("selectionUpdate",this.$_updateState)},methods:{onOpenChange(t){this.visible=t},runAction(){},onTrigger(t){t?.click||(this.editor?.chain().focus().run(),this.$emit("trigged",t))},checkStateOfChildren(){this.hasEnabledChild=this.children.some(t=>this.isChildEnabled(t))},isChildEnabled(t){return!t.isSeparator&&!W(t,this.editor).disabled}}};var bt=function(){var t=this,e=t._self._c;return e("NcActions",t._b({staticClass:"entry-list-action entry-action",attrs:{title:t.tooltip,container:t.menuIDSelector,"aria-label":t.labelWithSelected,variant:t.state.active?"primary":"tertiary","force-menu":!0,"data-text-action-entry":t.actionEntry.key,"data-text-action-active":t.activeKey,disabled:!t.isEnabled},on:{"update:open":t.onOpenChange},scopedSlots:t._u([{key:"icon",fn:function(){return[e(t.icon,{key:t.iconKey,tag:"component"})]},proxy:!0}])},"NcActions",t.state,!1),[t._l(t.children,function(i){return[i.isSeparator?e("NcActionSeparator",{key:`child-${i.key}`}):e("ActionListItem",t._g({key:`child-${i.key}`,attrs:{active:t.currentChild?.key===i.key,"is-item":"","action-entry":i},on:{trigged:t.onTrigger}},t.$listeners))]}),t._t("lastAction",null,null,{visible:t.visible})],2)},pt=[],vt=d(_t,bt,pt,!1,null,null);const O=vt.exports,yt={name:"ActionSingle",components:{NcButton:ot},extends:k,props:{isItem:{type:Boolean,default:!1}},mounted(){this.editor?.on("transaction",()=>this.updateState())},methods:{runAction(){const{actionEntry:t}=this;t.click?t.click(this):t.action(this.editor?.chain().focus(),this.editor)?.run(),this.$nextTick(()=>{this.$emit("trigged",{...t})})}}};var mt=function(){var t=this,e=t._self._c;return e("NcButton",t._g({staticClass:"entry-single-action entry-action",class:t.state.class,attrs:{disabled:t.state.disabled,"aria-keyshortcuts":t.keyshortcuts||void 0,"data-text-action-entry":t.actionEntry.key,"aria-label":t.label,title:t.tooltip,variant:"tertiary",pressed:t.actionType!=="button"?t.state.active:void 0},on:{click:t.runAction},scopedSlots:t._u([{key:"icon",fn:function(){return[e(t.icon,{tag:"component"})]},proxy:!0},t.actionEntry.forceLabel?{key:"default",fn:function(){return[t._v(" "+t._s(t.label)+" ")]},proxy:!0}:null],null,!0)},t.$listeners))},ft=[],kt=d(yt,mt,ft,!1,null,null);const B=kt.exports,R=y({data(){return{activeMenuEntry:0,entries:[]}},computed:{visibleEntries(){return this.entries}},watch:{visibleEntries(){this.$nextTick(()=>{(this.activeMenuEntry>this.visibleEntries.length||this.visibleEntries[this.activeMenuEntry]?.disabled)&&this.setNextMenuEntry()})}},methods:{disableMenuEntry(t,e){const i=this.visibleEntries.findIndex(({key:n})=>n===t);this.visibleEntries[i].disabled=e,e===!1&&this.activeMenuEntry===i&&this.$nextTick(()=>this.setNextMenuEntry())},setNextMenuEntry(){const t=this.visibleEntries.length+(this.$refs.remainingEntries?1:0);do this.activeMenuEntry=(this.activeMenuEntry+1)%t;while(this.activeMenuEntry<this.visibleEntries.length&&this.visibleEntries[this.activeMenuEntry].disabled)},setPreviousMenuEntry(){const t=this.visibleEntries.length+(this.$refs.remainingEntries?1:0);do{const e=this.activeMenuEntry-1;this.activeMenuEntry=(e%t+t)%t}while(this.activeMenuEntry<this.visibleEntries.length&&this.visibleEntries[this.activeMenuEntry].disabled)},handleToolbarNavigation(t){t.key==="ArrowRight"?this.setNextMenuEntry():t.key==="ArrowLeft"&&this.setPreviousMenuEntry(),this.activeMenuEntry===this.visibleEntries.length?this.$refs.remainingEntries?.focusButton?.():[...this.$refs.menuEntries].sort((e,i)=>this.visibleEntries.findIndex(({key:n})=>n===e.$vnode.data.key)-this.visibleEntries.findIndex(({key:n})=>n===i.$vnode.data.key))[this.activeMenuEntry].focusButton()}}}),xt=y({name:"ReadonlyBar",components:{ActionList:O,ActionSingle:B},extends:R,mixins:[w],props:{isHidden:{type:Boolean,default:!1},openReadOnly:{type:Boolean,default:!1}},emits:["update:loaded"],setup(){const{isRichWorkspace:t}=I();return{isRichWorkspace:t}},data(){return{entries:this.openReadOnly?[...F,...x]:[...x],isReady:!1}},mounted(){this.$nextTick(()=>{this.isReady=!0,this.$emit("update:loaded",!0)})},methods:{t:p}});var gt=function(){var t=this,e=t._self._c;return t._self._setupProxy,e("div",{staticClass:"text-readonly-bar",class:{"text-readonly-bar--ready":t.isReady,"text-readonly-bar--is-workspace":t.isRichWorkspace,"text-readonly-bar--hide":t.isHidden,"is-mobile":t.$isMobile},attrs:{"data-text-el":"readonly-bar"}},[e("div",{ref:"menubar",staticClass:"text-readonly-bar__entries",attrs:{role:"toolbar","aria-label":t.t("text","Editor actions")}},t._l(t.visibleEntries,function(i,n){return e(i.component?i.component:i.children?"ActionList":"ActionSingle",{key:i.key,ref:"menuEntries",refInFor:!0,tag:"component",attrs:{"action-entry":i,"can-be-focussed":t.activeMenuEntry===n},on:{disabled:function(o){return t.disableMenuEntry(i.key,o)}}})}),1),e("div",{staticClass:"text-readonly-bar__slot"},[t._t("default")],2)])},Ct=[],Et=d(xt,gt,Ct,!1,null,"988a9965");const be=Et.exports,Mt={name:"NcActionCheckbox",mixins:[L],inject:{isInSemanticMenu:{from:"NcActions:isSemanticMenu",default:!1}},model:{prop:"modelValue",event:"update:modelValue"},props:{id:{type:String,default:()=>"action-"+X(),validator:t=>t.trim()!==""},checked:{type:Boolean,default:void 0},modelValue:{type:Boolean,default:!1},value:{type:[String,Number],default:""},disabled:{type:Boolean,default:!1}},emits:["change","check","uncheck","update:checked","update:modelValue","update:model-value"],setup(){return{model:et("checked","update:checked")}},computed:{isFocusable(){return!this.disabled},ariaChecked(){if(this.isInSemanticMenu)return this.model?"true":"false"}},methods:{checkInput(){this.$refs.label.click()},onChange(t){this.model=this.$refs.checkbox.checked,this.$emit("change",t),this.$refs.checkbox.checked?this.$emit("check"):this.$emit("uncheck")}}};var St=function(){var t=this,e=t._self._c;return e("li",{staticClass:"action",class:{"action--disabled":t.disabled},attrs:{role:t.isInSemanticMenu&&"presentation"}},[e("span",{staticClass:"action-checkbox",attrs:{role:t.isInSemanticMenu&&"menuitemcheckbox","aria-checked":t.ariaChecked}},[e("input",{ref:"checkbox",staticClass:"checkbox action-checkbox__checkbox",class:{focusable:t.isFocusable},attrs:{id:t.id,disabled:t.disabled,type:"checkbox"},domProps:{checked:t.model,value:t.value},on:{keydown:function(i){return!i.type.indexOf("key")&&t._k(i.keyCode,"enter",13,i.key,"Enter")||i.ctrlKey||i.shiftKey||i.altKey||i.metaKey?null:(i.preventDefault(),t.checkInput.apply(null,arguments))},change:t.onChange}}),e("label",{ref:"label",staticClass:"action-checkbox__label",attrs:{for:t.id}},[t._v(t._s(t.text))]),t._e()],2)])},At=[],$t=Z(Mt,St,At,!1,null,"73edcb0b");const It=$t.exports;var E={},M;function Nt(){return M||(M=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.normalize=void 0;const e=47,i=46,n=c=>{const r=typeof c;if(r!=="string")throw new TypeError(`Expected a string, got a ${r}`)},o=(c,r)=>{let s="",h=0,u=-1,_=0,v;for(let l=0;l<=c.length;++l){if(l<c.length)v=c.charCodeAt(l);else{if(v===e)break;v=e}if(v===e){if(!(u===l-1||_===1))if(u!==l-1&&_===2){if(s.length<2||h!==2||s.charCodeAt(s.length-1)!==i||s.charCodeAt(s.length-2)!==i){if(s.length>2){const m=s.lastIndexOf("/");if(m!==s.length-1){m===-1?(s="",h=0):(s=s.slice(0,m),h=s.length-1-s.lastIndexOf("/")),u=l,_=0;continue}}else if(s.length===2||s.length===1){s="",h=0,u=l,_=0;continue}}r&&(s.length>0?s+="/..":s="..",h=2)}else s.length>0?s+="/"+c.slice(u+1,l):s=c.slice(u+1,l),h=l-u-1;u=l,_=0}else v===i&&_!==-1?++_:_=-1}return s},a=c=>{try{return decodeURIComponent(c)}catch{return c}},b=c=>{n(c);let r=c;if(r.length===0)return".";const s=r.charCodeAt(0)===e,h=r.charCodeAt(r.length-1)===e;return r=a(r),r=o(r,!s),r.length===0&&!s&&(r="."),r.length>0&&h&&(r+="/"),s?"/"+r:r};t.normalize=b,t.default=t.normalize})(E)),E}var wt=Nt();const Ot=nt(wt);class pe{#t;#e;#i;#n;#s;#o;#r=[];constructor({session:e,user:i,shareToken:n,currentDirectory:o,fileId:a}){this.#t=e,this.#e=i,this.#i=n,this.#n=o,this.#s=a??e.documentId,this.#o=this.#a()}async#a(){const e=await tt.post(C("/apps/text/attachments"),{documentId:this.#t?.documentId??this.#s,sessionId:this.#t?.id,sessionToken:this.#t?.token,shareToken:this.#i});this.#r=e.data}#c(e){return this.#r.find(i=>i.name===e)}async resolve(e,i=!0){let n;const o=/^\.attachments\.\d+\//;if(e.match(o)){const a=decodeURIComponent(e.replace(o,"").split("?")[0]);if(await this.#o,n=this.#c(a),i&&!n&&(await this.#a(),n=this.#c(a)),n)return n}return Bt(e)?{isImage:!0,name:this.#l(e),previewUrl:e,fullUrl:e}:{isImage:!0,name:this.#l(e),previewUrl:this.#d(e),fullUrl:this.#d(e)}}#l(e){return e.split("/").pop()}#d(e){if(this.#e){const a=this.#e.uid,b=this.#h(e).split("/").map(encodeURIComponent).join("/");return it(`dav/files/${a}${b}`)}const i=this.#h(e).split("/"),n=i.pop(),o=i.join("/");return C("/s/{token}/download?path={dirname}&files={basename}",{token:this.#i,basename:n,dirname:o})}#u(e){return decodeURI(e.split("?")[0])}#h(e){const i=[this.#n,this.#u(e)].join("/");return Ot(i)}}function Bt(t){return t.startsWith("http://")||t.startsWith("https://")||t.startsWith("data:")}function Rt(){return navigator?.userAgentData?.mobile!==void 0?navigator.userAgentData.mobile:[/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/playbook/i,/silk/i,/BlackBerry/i,/Windows Phone/i].some(t=>navigator.userAgent.match(t))}const Kt={name:"HelpModal",components:{NcDialog:U},data(){return{formatted:{bold:!0,italic:!0,strikethrough:!0,heading1:!0,heading6:!0,unorderdList:!0,orderedList:!0,checkList:!0,blockQuote:!0,codeBlock:!0},ctrlOrModKey:D[V.Mod]}},computed:{isFormatted(){return t=>this.formatted[t]},isMobileCached(){return this.isMobilePlatform()}},methods:{t:p,toggleFormatted(t){this.formatted[t]=!this.formatted[t]},isMobilePlatform:Rt}};var Tt=function(){var t=this,e=t._self._c;return e("NcDialog",{attrs:{size:"large","data-text-el":"formatting-help",name:t.t("text","Formatting and shortcuts"),"close-on-click-outside":!0},on:{closing:function(i){return t.$emit("close")}}},[e("h2",[t._v(t._s(t.t("text","Formatting and shortcuts")))]),e("p",[t._v(t._s(t.t("text","Speed up your writing with simple shortcuts.")))]),t.isMobileCached?e("p",[t._v(" "+t._s(t.t("text","Just type the Markdown syntax from below."))+" ")]):e("p",[t._v(" "+t._s(t.t("text","Just type the Markdown syntax or use keyboard shortcuts from below."))+" ")]),e("table",[e("thead",[e("tr",[e("th",[t._v(t._s(t.t("text","Style")))]),e("th",[t._v(t._s(t.t("text","Syntax")))]),t.isMobileCached?t._e():e("th",[t._v(" "+t._s(t.t("text","Keyboard shortcuts"))+" ")])])]),e("tbody",[e("tr",[e("td",[t._v(t._s(t.t("text","New paragraph")))]),e("td",[e("kbd",[t._v(t._s(t.t("text","Enter")))])]),t.isMobileCached?t._e():e("td")]),e("tr",[e("td",[t._v(t._s(t.t("text","Hard line break")))]),e("td",[e("kbd",[t._v(t._s(t.t("text","Enter")))]),t._v(" "+t._s(t.t("text","followed by"))+" "),e("kbd",[t._v(t._s(t.t("text","Backspace")))])]),t.isMobileCached?t._e():e("td",[e("kbd",[t._v(t._s(t.t("text","Shift")))]),t._v(" + "),e("kbd",[t._v(t._s(t.t("text","Enter")))])])]),e("tr",[e("td",[t._v(t._s(t.t("text","Bold")))]),e("td",[e("code",[t._v("**"+t._s(t.t("text","Bold text"))+"**")])]),t.isMobileCached?t._e():e("td",[e("kbd",[t._v(t._s(t.ctrlOrModKey))]),t._v(" + "),e("kbd",[t._v("B")])])]),e("tr",[e("td",[t._v(t._s(t.t("text","Italic")))]),e("td",[e("code",[t._v("*"+t._s(t.t("text","Italicized text"))+"*")])]),t.isMobileCached?t._e():e("td",[e("kbd",[t._v(t._s(t.ctrlOrModKey))]),t._v(" + "),e("kbd",[t._v("I")])])]),e("tr",[e("td",[t._v(t._s(t.t("text","Strikethrough")))]),e("td",[e("code",[t._v("~~"+t._s(t.t("text","Mistaken text"))+"~~")])]),t.isMobileCached?t._e():e("td",[e("kbd",[t._v(t._s(t.ctrlOrModKey))]),t._v(" + "),e("kbd",[t._v(t._s(t.t("text","Shift")))]),t._v(" + "),e("kbd",[t._v("S")])])]),e("tr",[e("td",[t._v(t._s(t.t("text","Underline")))]),e("td",[e("code",[t._v("__"+t._s(t.t("text","Underlined text"))+"__")])]),t.isMobileCached?t._e():e("td",[e("kbd",[t._v(t._s(t.ctrlOrModKey))]),t._v(" + "),e("kbd",[t._v("U")])])]),e("tr",[e("td",{staticClass:"ellipsis_top"},[t._v(" "+t._s(t.t("text","Heading 1"))+" ")]),e("td",{staticClass:"ellipsis_top"},[e("code",[t._v("# "+t._s(t.t("text","Heading level 1")))])]),t.isMobileCached?t._e():e("td",{staticClass:"ellipsis_top"},[e("kbd",[t._v(t._s(t.ctrlOrModKey))]),t._v(" + "),e("kbd",[t._v(t._s(t.t("text","Shift")))]),t._v(" + "),e("kbd",[t._v("1")])])]),e("tr",[e("td",{staticClass:"noborder ellipsis"},[t._v("…")]),e("td",{staticClass:"noborder ellipsis"},[t._v("…")]),t.isMobileCached?t._e():e("td",{staticClass:"ellipsis noborder"},[t._v("…")])]),e("tr",[e("td",{staticClass:"noborder ellipsis_bottom"},[t._v(" "+t._s(t.t("text","Heading 6"))+" ")]),e("td",{staticClass:"noborder ellipsis_bottom"},[e("code",[t._v("###### "+t._s(t.t("text","Heading level 6")))])]),t.isMobileCached?t._e():e("td",{staticClass:"noborder ellipsis_bottom"},[e("kbd",[t._v(t._s(t.ctrlOrModKey))]),t._v(" + "),e("kbd",[t._v(t._s(t.t("text","Shift")))]),t._v(" + "),e("kbd",[t._v("6")])])]),e("tr",[e("td",[t._v(t._s(t.t("text","Unordered list")))]),e("td",[e("code",[t._v("* "+t._s(t.t("text","An item")))])]),t.isMobileCached?t._e():e("td",[e("kbd",[t._v(t._s(t.ctrlOrModKey))]),t._v(" + "),e("kbd",[t._v(t._s(t.t("text","Shift")))]),t._v(" + "),e("kbd",[t._v("8")])])]),e("tr",[e("td",[t._v(t._s(t.t("text","Ordered list")))]),e("td",[e("code",[t._v("1. "+t._s(t.t("text","First item")))])]),t.isMobileCached?t._e():e("td",[e("kbd",[t._v(t._s(t.ctrlOrModKey))]),t._v(" + "),e("kbd",[t._v(t._s(t.t("text","Shift")))]),t._v(" + "),e("kbd",[t._v("7")])])]),e("tr",[e("td",[t._v(t._s(t.t("text","Checklist")))]),e("td",[e("code",[t._v("* [] "+t._s(t.t("text","To-Do item")))])]),t.isMobileCached?t._e():e("td",[e("kbd",[t._v(t._s(t.ctrlOrModKey))]),t._v(" + "),e("kbd",[t._v(t._s(t.t("text","Shift")))]),t._v(" + "),e("kbd",[t._v("9")])])]),e("tr",[e("td",[t._v(t._s(t.t("text","Blockquote")))]),e("td",[e("code",[t._v("> "+t._s(t.t("text","Quoted text")))])]),t.isMobileCached?t._e():e("td",[e("kbd",[t._v(t._s(t.ctrlOrModKey))]),t._v(" + "),e("kbd",[t._v(">")])])]),e("tr",[e("td",[t._v(t._s(t.t("text","Code block")))]),e("td",[e("code",[t._v("``` "+t._s(t.t("text","Some code")))])]),t.isMobileCached?t._e():e("td")]),e("tr",[e("td",[t._v(t._s(t.t("text","Link")))]),e("td",[e("code",[t._v("[Title](https://example.org)")])]),t.isMobileCached?t._e():e("td",[e("kbd",[t._v(t._s(t.ctrlOrModKey))]),t._v(" + "),e("kbd",[t._v("K")])])]),e("tr",[e("td",[t._v(t._s(t.t("text","Insert emoji")))]),e("td",[e("code",[t._v(":"+t._s(t.t("text","emoji")))])]),t.isMobileCached?t._e():e("td")]),e("tr",[e("td",[t._v(t._s(t.t("text","Mention someone")))]),e("td",[e("code",[t._v("@"+t._s(t.t("text","name")))])]),t.isMobileCached?t._e():e("td")]),e("tr",[e("td",[t._v(t._s(t.t("text","Smart picker")))]),e("td",[e("code",[t._v("/"+t._s(t.t("text","something")))])]),t.isMobileCached?t._e():e("td")])])]),e("table",{attrs:{vif:"!isMobileCached"}},[e("thead",[e("tr",[e("th",[t._v(t._s(t.t("text","Action")))]),e("th",[t._v(t._s(t.t("text","Keyboard shortcuts")))])])]),e("tbody",[e("tr",[e("td",[t._v(t._s(t.t("text","Undo")))]),e("td",[e("kbd",[t._v(t._s(t.ctrlOrModKey))]),t._v(" + "),e("kbd",[t._v("Z")])])]),e("tr",[e("td",[t._v(t._s(t.t("text","Redo")))]),e("td",[e("kbd",[t._v(t._s(t.ctrlOrModKey))]),t._v(" + "),e("kbd",[t._v("Y")])])]),e("tr",[e("td",[t._v(t._s(t.t("text","Toggle outline")))]),e("td",[e("kbd",[t._v(t._s(t.ctrlOrModKey))]),t._v(" + "),e("kbd",[t._v(t._s(t.t("text","Alt")))]),t._v(" + "),e("kbd",[t._v("H")])])])])])])},Wt=[],Ht=d(Kt,Tt,Wt,!1,null,"ee2c50ae");const Pt=Ht.exports,Ft=y({name:"NcActionButton",components:{NextcloudVueNcActionButton:A,Help:j},methods:{t:p}});var Lt=function(){var t=this,e=t._self._c;return t._self._setupProxy,e("NextcloudVueNcActionButton",t._g({attrs:{"close-after-click":"","data-text-action-entry":"formatting-help"},scopedSlots:t._u([{key:"icon",fn:function(){return[e("Help")]},proxy:!0}])},t.$listeners),[t._v(" "+t._s(t.t("text","Formatting help"))+" ")])},Ut=[],Dt=d(Ft,Lt,Ut,!1,null,null);const Vt=Dt.exports,jt=y({name:"CharacterCount",components:{AlphabeticalVariant:q,NcActionText:z},props:{visible:Boolean},setup(){const{editor:t}=N(),e=S("");return{countString:e,refresh:()=>{const{storage:i,state:n}=t,o=i.characterCount.words({node:n.doc}),a=i.characterCount.characters({node:n.doc}),b=g("text","%n word","%n words",o),c=g("text","%n char","%n chars",a);e.value=[b,c].join(", "),console.debug({wordCount:o,charCount:a,countString:e.value})}}},watch:{visible:"refresh"},created(){this.refresh()}});var zt=function(){var t=this,e=t._self._c;return t._self._setupProxy,e("NcActionText",{attrs:{"data-text-action-entry":"character-count",name:t.countString},scopedSlots:t._u([{key:"icon",fn:function(){return[e("AlphabeticalVariant")]},proxy:!0}])})},qt=[],Jt=d(jt,zt,qt,!1,null,null);const Qt=Jt.exports,Gt={__name:"WidthToggle",setup(t){const{canToggleWidth:e,isFullWidth:i,setFullWidth:n}=at();return{__sfc:!0,canToggleWidth:e,isFullWidth:i,setFullWidth:n,t:p,NcActionCheckbox:It}}};var Yt=function(){var t=this,e=t._self._c,i=t._self._setupProxy;return i.canToggleWidth?e(i.NcActionCheckbox,{attrs:{checked:i.isFullWidth},on:{"update:checked":i.setFullWidth}},[t._v(" "+t._s(i.t("text","Full width editor"))+" ")]):t._e()},Zt=[],Xt=d(Gt,Yt,Zt,!1,null,null);const te=Xt.exports,ee={name:"MenuBar",components:{ActionFormattingHelp:Vt,ActionList:O,ActionSingle:B,HelpModal:Pt,NcActionSeparator:$,CharacterCount:Qt,WidthToggle:te},extends:R,mixins:[w],provide(){const t={};return Object.defineProperties(t,{[Y]:{get:()=>this.randomID}}),t},props:{isHidden:{type:Boolean,default:!1},openReadOnly:{type:Boolean,default:!1}},setup(){const t=N(),{isPublic:e,isRichEditor:i,isRichWorkspace:n}=I(),o=S(),{width:a}=rt(o);return{editor:t,isPublic:e,isRichEditor:i,isRichWorkspace:n,menubar:o,width:a}},data(){return{entries:(this.openReadOnly?[...Q,...f]:this.isPublic||this.isRichWorkspace?[...f]:[...f,...G]).filter(t=>!!t),randomID:`menu-bar-${Math.ceil(Math.random()*1e4+500).toString(16)}`,displayHelp:!1,isReady:!1,resize:null}},computed:{visibleEntryKeys(){return this.entries.toSorted((t,e)=>(t.priority??0)-(e.priority??0)).map(t=>t.key).slice(0,this.iconsLimit)},visibleEntries(){return this.entries.filter(t=>this.visibleEntryKeys.includes(t.key))},hiddenEntries(){const t=this.entries.filter(i=>!this.visibleEntryKeys.includes(i.key)),e=t.reduce((i,n,o)=>{const a=n.children??[n];if(a.length>1){const b=i.length&&!i.at(-1).isSeparator?[{key:`separator-before-${n.id}`,isSeparator:!0}]:[],c=o!==t.length-1?[{key:`separator-after-${n.id}`,isSeparator:!0}]:[];return[...i,...b,...a,...c]}return[...i,...a]},[]);return{key:"remain",label:this.t("text","Remaining actions"),icon:J,children:e}},iconWidth(){const t=(this.menubar&&getComputedStyle(this.menubar))?.getPropertyValue("--default-clickable-area");return parseInt(t)||34},iconsLimit(){const t=this.width-4,e=this.$isMobile?this.iconWidth:this.iconWidth+2;return Math.floor(t/e)-1}},mounted(){this.$nextTick(()=>{this.isReady=!0,this.$emit("update:loaded",!0)})},methods:{showHelp(){this.displayHelp=!0},hideHelp(){this.displayHelp=!1},t:p}};var ie=function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-menubar",class:{"text-menubar--ready":t.isReady,"text-menubar--hide":t.isHidden,"text-menubar--is-workspace":t.isRichWorkspace,"is-mobile":t.$isMobile},attrs:{id:t.randomID,"data-text-el":"menubar",role:"region","aria-label":t.t("text","Editor actions")}},[t.displayHelp?e("HelpModal",{on:{close:t.hideHelp}}):t._e(),t.isRichEditor?e("div",{ref:"menubar",staticClass:"text-menubar__entries",attrs:{role:"toolbar","aria-label":t.t("text","Formatting menu bar")},on:{keyup:[function(i){return!i.type.indexOf("key")&&t._k(i.keyCode,"left",37,i.key,["Left","ArrowLeft"])||"button"in i&&i.button!==0?null:(i.stopPropagation(),t.handleToolbarNavigation.apply(null,arguments))},function(i){return!i.type.indexOf("key")&&t._k(i.keyCode,"right",39,i.key,["Right","ArrowRight"])||"button"in i&&i.button!==2?null:(i.stopPropagation(),t.handleToolbarNavigation.apply(null,arguments))}]}},[t._l(t.visibleEntries,function(i,n){return e(i.component?i.component:i.children?"ActionList":"ActionSingle",{key:i.key,ref:"menuEntries",refInFor:!0,tag:"component",attrs:{"action-entry":i,"can-be-focussed":t.activeMenuEntry===n},on:{disabled:function(o){return t.disableMenuEntry(i.key,o)},click:function(o){t.activeMenuEntry=n}}})}),e("ActionList",{ref:"remainingEntries",attrs:{"action-entry":t.hiddenEntries,"can-be-focussed":t.activeMenuEntry===t.visibleEntries.length,"force-enabled":!0},on:{click:function(i){t.activeMenuEntry="remain"}},scopedSlots:t._u([{key:"lastAction",fn:function({visible:i}){return[e("WidthToggle"),e("ActionFormattingHelp",{on:{click:t.showHelp}}),e("NcActionSeparator"),e("CharacterCount",t._b({},"CharacterCount",{visible:i},!1))]}}],null,!1,4216951189)})],2):t._e(),e("div",{staticClass:"text-menubar__slot"},[t._t("default")],2)],1)},ne=[],se=d(ee,ie,ne,!1,null,"01109639");const ve=se.exports;export{pe as A,ve as M,be as R};
//# sourceMappingURL=MenuBar-BZkLhkGh.chunk.mjs.map
