const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=[window.OC.filePath('text', '', 'js/PublicFilesEditor-Dpi37AT8.chunk.mjs'),window.OC.filePath('text', '', 'js/modulepreload-polyfill-nb9XBeg7.chunk.mjs'),window.OC.filePath('text', '', 'js/emoji-picker-DlAAdvrL.chunk.mjs'),window.OC.filePath('text', '', 'js/NcNoteCard-ChweF_5Q-DZCruKzr.chunk.mjs'),window.OC.filePath('text', '', 'js/index-DfiDB3im.chunk.mjs'),window.OC.filePath('text', '', 'js/NcLoadingIcon-CHw5fok5.chunk.mjs'),window.OC.filePath('text', '', 'css/NcLoadingIcon-CFe6qyTF.chunk.css'),window.OC.filePath('text', '', 'js/vue.runtime.esm-C7aVrvtW.chunk.mjs'),window.OC.filePath('text', '', 'css/NcNoteCard-ChweF_5Q-DY8mPymx.chunk.css'),window.OC.filePath('text', '', 'js/_plugin-vue2_normalizer-wd1ZAbRr.chunk.mjs'),window.OC.filePath('text', '', 'js/RichWorkspace-6zCEKenV.chunk.mjs'),window.OC.filePath('text', '', 'js/index-DchN-JlI.chunk.mjs'),window.OC.filePath('text', '', 'js/Editor.singleton-CIK9TJYC.chunk.mjs'),window.OC.filePath('text', '', 'js/RichTextReader-B-FSE5FI.chunk.mjs'),window.OC.filePath('text', '', 'js/BaseReader-CwLTgKN5.chunk.mjs'),window.OC.filePath('text', '', 'js/NcColorPicker-BVg6KZPY.chunk.mjs'),window.OC.filePath('text', '', 'js/index-Bsbkakvg.chunk.mjs'),window.OC.filePath('text', '', 'js/NcCheckboxRadioSwitch-ip_mRd2T-kNk9kCSa.chunk.mjs'),window.OC.filePath('text', '', 'css/NcCheckboxRadioSwitch-ip_mRd2T-Bebqso8K.chunk.css'),window.OC.filePath('text', '', 'js/MediaHandler.provider-BaIXomKI.chunk.mjs'),window.OC.filePath('text', '', 'js/logger-BdOMU2ej.chunk.mjs'),window.OC.filePath('text', '', 'js/index-DdNNDBD_.chunk.mjs'),window.OC.filePath('text', '', 'css/NcColorPicker-BHLGTX-r.chunk.css'),window.OC.filePath('text', '', 'css/BaseReader-CsLFhfbT.chunk.css'),window.OC.filePath('text', '', 'css/RichTextReader-Bg06MJVH.chunk.css'),window.OC.filePath('text', '', 'css/RichWorkspace-Dn8GlGXa.chunk.css')])))=>i.map(i=>d[i]);
import{_ as w,g as f,e as h}from"./modulepreload-polyfill-nb9XBeg7.chunk.mjs";import{g as v,s as y,a as g}from"./NcNoteCard-ChweF_5Q-DZCruKzr.chunk.mjs";import{H as F,b as O,N as R,P as _,F as C}from"./index-Bm8uPHK6.chunk.mjs";import{h as D,c as H}from"./index-DchN-JlI.chunk.mjs";import{l as T}from"./index-DfiDB3im.chunk.mjs";import{V as P}from"./vue.runtime.esm-C7aVrvtW.chunk.mjs";import{b as m}from"./mime-CuxkK4Yj.chunk.mjs";import{s as V}from"./index-Bsbkakvg.chunk.mjs";import"./emoji-picker-DlAAdvrL.chunk.mjs";import"./NcLoadingIcon-CHw5fok5.chunk.mjs";import"./index-DdNNDBD_.chunk.mjs";const N='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-text" viewBox="0 0 24 24"><path d="M21,6V8H3V6H21M3,18H12V16H3V18M3,13H21V11H3V13Z" /></svg>',b="Edit with text app",G=()=>{const e=v(),r=document.querySelector("#preview table.files-filestable");if(!e||!r){const i=document.createElement("div");i.id="text-viewer-fallback",document.body.appendChild(i);const n=o=>OCA.Files.fileActions.register(o,b,OC.PERMISSION_UPDATE|OC.PERMISSION_READ,D("core","actions/rename"),c=>{const d=window.FileList.findFile(c);Promise.all([w(()=>import("./vue.runtime.esm-C7aVrvtW.chunk.mjs").then(a=>a.z),[],import.meta.url),w(()=>import("./PublicFilesEditor-Dpi37AT8.chunk.mjs"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]),import.meta.url)]).then(a=>{const x=window.FileList.getCurrentDirectory()+"/"+c,p=a[0].default;p.prototype.t=window.t,p.prototype.n=window.n,p.prototype.OCA=window.OCA;const E=a[1].default;new p({render:function(I){const A=this;return I(E,{props:{fileId:d?d.id:null,active:!0,shareToken:e,relativePath:x,mimeType:d.mimetype},on:{close:function(){A.$destroy()}}})}}).$mount(i)})},t("text","Edit"));for(let o=0;o<m.length;o++)n(m[o]),OCA.Files.fileActions.setDefault(m[o],b)}},J=()=>{const e=t("text","Readme")+"."+T("text","default_file_extension");O({id:"rich-workspace-init",displayName:t("text","Add folder description"),category:R.Other,enabled(r){return!window?.OCA?.Text?.RichWorkspaceEnabled||Number(r.attributes["rich-workspace-file"])?!1:(r.permissions&_.CREATE)!==0},iconSvgInline:N,async handler(r,i){if(i.map(a=>a.basename).includes(e)){y(t("text",'"{name}" already exist!',{name:e}));return}const n=r.encodedSource+"/"+encodeURIComponent(e),o=await H({method:"PUT",url:n,headers:{Overwrite:"F"}}),c=parseInt(o.headers["oc-fileid"]),d=new C({source:r.source+"/"+e,id:c,mtime:new Date,mime:"text/markdown",owner:f()?.uid||null,permissions:_.ALL,root:r?.root||"/files/"+f()?.uid});g(t("text",'Created "{name}"',{name:e})),r.attributes["rich-workspace-file"]=c,r.attributes["rich-workspace"]="",h("files:node:created",d),h("files:node:updated",r)}})};let u,s,l;const k=(e,r)=>["files","favorites","public-share"].includes(r.id),K=new F({id:"workspace",order:10,enabled:k,render:async(e,r)=>{l=r,u||(u=(await w(()=>import("./RichWorkspace-6zCEKenV.chunk.mjs"),__vite__mapDeps([10,11,1,2,7,3,4,5,6,8,12,13,14,15,9,16,17,18,19,20,21,22,23,24,25]),import.meta.url)).default),s&&(s.$destroy(),console.debug("Destroying existing FilesHeaderRichWorkspaceInstance"));const i=!!l.attributes["rich-workspace-file"],n=l.attributes["rich-workspace"]||"",o=l.path||"";s=new P({extends:u,propsData:{content:n,hasRichWorkspace:i,path:o},store:V}).$mount(e),window.FilesHeaderRichWorkspaceInstance=s},updated(e,r){if(l=e,!s){console.error("No vue instance found for FilesWorkspaceHeader");return}const i=!!e.attributes["rich-workspace-file"]&&k(e,r);s.hasRichWorkspace=i,s.content=e.attributes["rich-workspace"]||"",s.path=e.path||""}});export{b as FILE_ACTION_IDENTIFIER,K as FilesWorkspaceHeader,J as addMenuRichWorkspace,G as registerFileActionFallback};
//# sourceMappingURL=files-COVwfwUg.chunk.mjs.map
