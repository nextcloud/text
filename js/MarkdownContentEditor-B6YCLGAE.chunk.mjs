import{e as s,R as d,F as l,U as u,c as p,d as m,p as h,f as c}from"./EditorOutline-CJaAQE7w.chunk.mjs";import{W as f,M as y,a as g,R as C,C as w,A as B}from"./MenuBar-C5CKA9UU.chunk.mjs";import{g as O}from"./index-CdM8BgQf.chunk.mjs";import{w as a,p as v}from"./vue.runtime.esm-C6p0QIhY.chunk.mjs";import{A as M}from"./MediaHandler.provider-Co_8hElS.chunk.mjs";import{n as R}from"./NcCheckboxRadioSwitch-DAPHFb0L-CV26DpRz.chunk.mjs";import"./NcLoadingIcon-BLBsV_jd.chunk.mjs";import"./emoji-picker-hi3Hwbeu.chunk.mjs";import"./index-DCzdQJ7L.chunk.mjs";import"./logger-JRW888D7.chunk.mjs";import"./index-CAxq7uh6.chunk.mjs";import"./index-B8nYQ_zQ.chunk.mjs";import"./NcNoteCard-Dz5-u2BY-BFR1Ui_6.chunk.mjs";import"./preload-helper-BorfeO-5.chunk.mjs";const $={name:"MarkdownContentEditor",components:{ContentContainer:w,ReadonlyBar:C,MenuBar:g,MainContainer:y,Wrapper:f},provide(){const t={};return Object.defineProperties(t,{[M]:{get:()=>this.$attachmentResolver??null}}),t},props:{fileId:{type:Number,default:null},content:{type:String,required:!0},readOnly:{type:Boolean,default:!1},relativePath:{type:String,default:""},shareToken:{type:String,default:null},showMenuBar:{type:Boolean,default:!0},showOutlineOutside:{type:Boolean,default:!1}},emits:["update:content"],setup(t){const e=[d.configure({extensions:[u]}),l],o=new p({extensions:e}),{setEditable:r,setContent:i}=m(o);return a(()=>t.content,n=>{i(n)}),r(!t.readOnly),a(()=>t.readOnly,n=>{r(!n)}),h(o),v(c,{isPublic:!1,isRichEditor:!0,isRichWorkspace:!1}),{editor:o,setContent:i}},created(){this.setContent(this.content,{addToHistory:!1}),this.editor.on("create",()=>{this.$emit("ready"),this.$parent.$emit("ready")}),this.editor.on("update",({editor:t})=>{const e=s(t.schema).serialize(t.state.doc);this.emit("update:content",{json:t.state.doc,markdown:e})}),this.fileId&&(this.$attachmentResolver=new B({currentDirectory:this.relativePath?.match(/.*\//),user:O(),shareToken:this.shareToken,fileId:this.fileId}))},beforeDestroy(){this.editor.destroy()},methods:{outlineToggled(t){this.emit("outline-toggled",t)},emit(t,e){this.$emit(t,e),this.$parent?.$emit(t,e)}}};var k=function(){var t=this,e=t._self._c;return e("Wrapper",{attrs:{"content-loaded":!0,"show-outline-outside":t.showOutlineOutside},on:{"outline-toggled":t.outlineToggled}},[e("MainContainer",[t.showMenuBar?[t.readOnly?t._t("readonlyBar",function(){return[e("ReadonlyBar")]}):e("MenuBar",{attrs:{autohide:!1}})]:t._e(),e("ContentContainer",{attrs:{"read-only":t.readOnly}})],2)],1)},T=[],b=R($,k,T,!1,null,null);const N=b.exports;export{N as default};
//# sourceMappingURL=MarkdownContentEditor-B6YCLGAE.chunk.mjs.map
