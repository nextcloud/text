import{Q as w,T as F,aG as Q,_ as u,g as _,s as j,a as I,b as J,t as U,q as X,l as O,c as Y,F as Z,K as tt,a4 as et,e as at,z as it,H as rt}from"./mermaid.core-CZw9wSLE.chunk.mjs";import{p as nt}from"./chunk-4BX2VUAB-_1HlWocy.chunk.mjs";import{p as lt}from"./treemap-75Q7IDZK-DDb0KPhW.chunk.mjs";import{d as P}from"./arc-Bk61-qiK.chunk.mjs";import{o as st}from"./ordinal-JciKjLuy.chunk.mjs";import"./preload-helper-Dlt9bAsw.chunk.mjs";import"./emoji-picker-DJyM6asK.chunk.mjs";import"./NcLoadingIcon-V-QWbD5-.chunk.mjs";import"./index-CkfhUZfI.chunk.mjs";import"./vue.runtime.esm-Ci2e5rf_.chunk.mjs";import"./index-DUrHmx5a.chunk.mjs";import"./_baseUniq-CATc9vFd.chunk.mjs";import"./_basePickBy-B8Xf3nJn.chunk.mjs";import"./clone-DRuuTDPn.chunk.mjs";import"./init-CbUY40dC.chunk.mjs";function ot(t,a){return a<t?-1:a>t?1:a>=t?0:NaN}function pt(t){return t}function ct(){var t=pt,a=ot,m=null,s=w(0),o=w(F),y=w(0);function l(e){var r,p=(e=Q(e)).length,d,S,x=0,c=new Array(p),n=new Array(p),f=+s.apply(this,arguments),v=Math.min(F,Math.max(-F,o.apply(this,arguments)-f)),h,T=Math.min(Math.abs(v)/p,y.apply(this,arguments)),C=T*(v<0?-1:1),g;for(r=0;r<p;++r)(g=n[c[r]=r]=+t(e[r],r,e))>0&&(x+=g);for(a!=null?c.sort(function(b,A){return a(n[b],n[A])}):m!=null&&c.sort(function(b,A){return m(e[b],e[A])}),r=0,S=x?(v-p*C)/x:0;r<p;++r,f=h)d=c[r],g=n[d],h=f+(g>0?g*S:0)+C,n[d]={data:e[d],index:r,value:g,startAngle:f,endAngle:h,padAngle:T};return n}return l.value=function(e){return arguments.length?(t=typeof e=="function"?e:w(+e),l):t},l.sortValues=function(e){return arguments.length?(a=e,m=null,l):a},l.sort=function(e){return arguments.length?(m=e,a=null,l):m},l.startAngle=function(e){return arguments.length?(s=typeof e=="function"?e:w(+e),l):s},l.endAngle=function(e){return arguments.length?(o=typeof e=="function"?e:w(+e),l):o},l.padAngle=function(e){return arguments.length?(y=typeof e=="function"?e:w(+e),l):y},l}var ut=rt.pie,R={sections:new Map,showData:!1},D=R.sections,W=R.showData,dt=structuredClone(ut),gt=u(()=>structuredClone(dt),"getConfig"),ft=u(()=>{D=new Map,W=R.showData,it()},"clear"),mt=u(({label:t,value:a})=>{if(a<0)throw new Error('"'.concat(t,'" has invalid value: ').concat(a,". Negative values are not allowed in pie charts. All slice values must be >= 0."));D.has(t)||(D.set(t,a),O.debug("added new section: ".concat(t,", with value: ").concat(a)))},"addSection"),ht=u(()=>D,"getSections"),xt=u(t=>{W=t},"setShowData"),wt=u(()=>W,"getShowData"),V={getConfig:gt,clear:ft,setDiagramTitle:X,getDiagramTitle:U,setAccTitle:J,getAccTitle:I,setAccDescription:j,getAccDescription:_,addSection:mt,getSections:ht,setShowData:xt,getShowData:wt},yt=u((t,a)=>{nt(t,a),a.setShowData(t.showData),t.sections.map(a.addSection)},"populateDb"),St={parse:u(async t=>{const a=await lt("pie",t);O.debug(a),yt(a,V)},"parse")},vt=u(t=>"\n  .pieCircle{\n    stroke: ".concat(t.pieStrokeColor,";\n    stroke-width : ").concat(t.pieStrokeWidth,";\n    opacity : ").concat(t.pieOpacity,";\n  }\n  .pieOuterCircle{\n    stroke: ").concat(t.pieOuterStrokeColor,";\n    stroke-width: ").concat(t.pieOuterStrokeWidth,";\n    fill: none;\n  }\n  .pieTitleText {\n    text-anchor: middle;\n    font-size: ").concat(t.pieTitleTextSize,";\n    fill: ").concat(t.pieTitleTextColor,";\n    font-family: ").concat(t.fontFamily,";\n  }\n  .slice {\n    font-family: ").concat(t.fontFamily,";\n    fill: ").concat(t.pieSectionTextColor,";\n    font-size:").concat(t.pieSectionTextSize,";\n    // fill: white;\n  }\n  .legend text {\n    fill: ").concat(t.pieLegendTextColor,";\n    font-family: ").concat(t.fontFamily,";\n    font-size: ").concat(t.pieLegendTextSize,";\n  }\n"),"getStyles"),$t=vt,bt=u(t=>{const a=[...t.values()].reduce((s,o)=>s+o,0),m=[...t.entries()].map(([s,o])=>({label:s,value:o})).filter(s=>s.value/a*100>=1).sort((s,o)=>o.value-s.value);return ct().value(s=>s.value)(m)},"createPieArcs"),At=u((t,a,m,s)=>{O.debug("rendering pie chart\n"+t);const o=s.db,y=Y(),l=Z(o.getConfig(),y.pie),e=40,r=18,p=4,d=450,S=d,x=tt(a),c=x.append("g");c.attr("transform","translate("+S/2+","+d/2+")");const{themeVariables:n}=y;let[f]=et(n.pieOuterStrokeWidth);f!=null||(f=2);const v=l.textPosition,h=Math.min(S,d)/2-e,T=P().innerRadius(0).outerRadius(h),C=P().innerRadius(h*v).outerRadius(h*v);c.append("circle").attr("cx",0).attr("cy",0).attr("r",h+f/2).attr("class","pieOuterCircle");const g=o.getSections(),b=bt(g),A=[n.pie1,n.pie2,n.pie3,n.pie4,n.pie5,n.pie6,n.pie7,n.pie8,n.pie9,n.pie10,n.pie11,n.pie12];let k=0;g.forEach(i=>{k+=i});const E=b.filter(i=>(i.data.value/k*100).toFixed(0)!=="0"),M=st(A);c.selectAll("mySlices").data(E).enter().append("path").attr("d",T).attr("fill",i=>M(i.data.label)).attr("class","pieCircle"),c.selectAll("mySlices").data(E).enter().append("text").text(i=>(i.data.value/k*100).toFixed(0)+"%").attr("transform",i=>"translate("+C.centroid(i)+")").style("text-anchor","middle").attr("class","slice"),c.append("text").text(o.getDiagramTitle()).attr("x",0).attr("y",-400/2).attr("class","pieTitleText");const N=[...g.entries()].map(([i,$])=>({label:i,value:$})),z=c.selectAll(".legend").data(N).enter().append("g").attr("class","legend").attr("transform",(i,$)=>{const L=r+p,G=L*N.length/2,H=12*r,K=$*L-G;return"translate("+H+","+K+")"});z.append("rect").attr("width",r).attr("height",r).style("fill",i=>M(i.label)).style("stroke",i=>M(i.label)),z.append("text").attr("x",r+p).attr("y",r-p).text(i=>o.getShowData()?"".concat(i.label," [").concat(i.value,"]"):i.label);const q=Math.max(...z.selectAll("text").nodes().map(i=>{var $;return($=i==null?void 0:i.getBoundingClientRect().width)!=null?$:0})),B=S+e+r+p+q;x.attr("viewBox","0 0 ".concat(B," ").concat(d)),at(x,d,B,l.useMaxWidth)},"draw"),Tt={draw:At},qt={parser:St,db:V,renderer:Tt,styles:$t};export{qt as diagram};
//# sourceMappingURL=pieDiagram-ADFJNKIX-Cr0SrNol.chunk.mjs.map
