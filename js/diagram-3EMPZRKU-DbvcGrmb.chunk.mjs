import{s as se}from"./chunk-SKB7J2MH-BzLo5ixN.chunk.mjs";import{_ as v,s as ie,g as ce,o as de,p as pe,b as he,c as fe,l as X,G as te,F as ae,aY as ue,v as me,K as ge,k as ye,aZ as B,j as J,E as xe}from"./mermaid.core-BHwTKsb0.chunk.mjs";import{p as Se}from"./chunk-353BL4L5-BTeDqGZX.chunk.mjs";import{I as ve}from"./chunk-AACKK3MU-BaK5m5DZ.chunk.mjs";import{p as be}from"./treemap-6Y5VK53G-CToCjyia.chunk.mjs";import{b as E}from"./defaultLocale-0_YM-Ssk.chunk.mjs";import{o as U}from"./ordinal-D6YK7yj2.chunk.mjs";import"./modulepreload-polyfill-BbX-W30F.chunk.mjs";import"./emoji-picker-DlAAdvrL.chunk.mjs";import"./NcLoadingIcon-CxBtjyQA.chunk.mjs";import"./vue.runtime.esm-Ccc28AWB.chunk.mjs";import"./_baseUniq-ClfDlypz.chunk.mjs";import"./_basePickBy-DRo97grM.chunk.mjs";import"./clone-BY_YduCA.chunk.mjs";import"./init-CLzSasj9.chunk.mjs";function Ce(t){var a=0,r=t.children,n=r&&r.length;if(!n)a=1;else for(;--n>=0;)a+=r[n].value;t.value=a}function $e(){return this.eachAfter(Ce)}function we(t,a){let r=-1;for(const n of this)t.call(a,n,++r,this);return this}function Le(t,a){for(var r=this,n=[r],s,o,d=-1;r=n.pop();)if(t.call(a,r,++d,this),s=r.children)for(o=s.length-1;o>=0;--o)n.push(s[o]);return this}function ke(t,a){for(var r=this,n=[r],s=[],o,d,h,u=-1;r=n.pop();)if(s.push(r),o=r.children)for(d=0,h=o.length;d<h;++d)n.push(o[d]);for(;r=s.pop();)t.call(a,r,++u,this);return this}function Me(t,a){let r=-1;for(const n of this)if(t.call(a,n,++r,this))return n}function Te(t){return this.eachAfter(function(a){for(var r=+t(a.data)||0,n=a.children,s=n&&n.length;--s>=0;)r+=n[s].value;a.value=r})}function ze(t){return this.eachBefore(function(a){a.children&&a.children.sort(t)})}function Fe(t){for(var a=this,r=Ne(a,t),n=[a];a!==r;)a=a.parent,n.push(a);for(var s=n.length;t!==r;)n.splice(s,0,t),t=t.parent;return n}function Ne(t,a){if(t===a)return t;var r=t.ancestors(),n=a.ancestors(),s=null;for(t=r.pop(),a=n.pop();t===a;)s=t,t=r.pop(),a=n.pop();return s}function Ae(){for(var t=this,a=[t];t=t.parent;)a.push(t);return a}function Pe(){return Array.from(this)}function Be(){var t=[];return this.eachBefore(function(a){a.children||t.push(a)}),t}function Re(){var t=this,a=[];return t.each(function(r){r!==t&&a.push({source:r.parent,target:r})}),a}function*We(){var t=this,a,r=[t],n,s,o;do for(a=r.reverse(),r=[];t=a.pop();)if(yield t,n=t.children)for(s=0,o=n.length;s<o;++s)r.push(n[s]);while(r.length)}function _(t,a){t instanceof Map?(t=[void 0,t],a===void 0&&(a=De)):a===void 0&&(a=Ve);for(var r=new Q(t),n,s=[r],o,d,h,u;n=s.pop();)if((d=a(n.data))&&(u=(d=Array.from(d)).length))for(n.children=d,h=u-1;h>=0;--h)s.push(o=d[h]=new Q(d[h])),o.parent=n,o.depth=n.depth+1;return r.eachBefore(He)}function Ie(){return _(this).eachBefore(Ee)}function Ve(t){return t.children}function De(t){return Array.isArray(t)?t[1]:null}function Ee(t){t.data.value!==void 0&&(t.value=t.data.value),t.data=t.data.data}function He(t){var a=0;do t.height=a;while((t=t.parent)&&t.height<++a)}function Q(t){this.data=t,this.depth=this.height=0,this.parent=null}Q.prototype=_.prototype={constructor:Q,count:$e,each:we,eachAfter:ke,eachBefore:Le,find:Me,sum:Te,sort:ze,path:Fe,ancestors:Ae,descendants:Pe,leaves:Be,links:Re,copy:Ie,[Symbol.iterator]:We};function je(t){if(typeof t!="function")throw new Error;return t}function H(){return 0}function j(t){return function(){return t}}function Ge(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function Oe(t,a,r,n,s){for(var o=t.children,d,h=-1,u=o.length,i=t.value&&(n-a)/t.value;++h<u;)d=o[h],d.y0=r,d.y1=s,d.x0=a,d.x1=a+=d.value*i}function qe(t,a,r,n,s){for(var o=t.children,d,h=-1,u=o.length,i=t.value&&(s-r)/t.value;++h<u;)d=o[h],d.x0=a,d.x1=n,d.y0=r,d.y1=r+=d.value*i}var Ke=(1+Math.sqrt(5))/2;function Ye(t,a,r,n,s,o){for(var d=[],h=a.children,u,i,p=0,C=0,l=h.length,b,y,x=a.value,f,m,N,T,P,W,k;p<l;){b=s-r,y=o-n;do f=h[C++].value;while(!f&&C<l);for(m=N=f,W=Math.max(y/b,b/y)/(x*t),k=f*f*W,P=Math.max(N/k,k/m);C<l;++C){if(f+=i=h[C].value,i<m&&(m=i),i>N&&(N=i),k=f*f*W,T=Math.max(N/k,k/m),T>P){f-=i;break}P=T}d.push(u={value:f,dice:b<y,children:h.slice(p,C)}),u.dice?Oe(u,r,n,s,x?n+=y*f/x:o):qe(u,r,n,x?r+=b*f/x:s,o),x-=f,p=C}return d}const Ze=function t(a){function r(n,s,o,d,h){Ye(a,n,s,o,d,h)}return r.ratio=function(n){return t((n=+n)>1?n:1)},r}(Ke);function Je(){var t=Ze,a=!1,r=1,n=1,s=[0],o=H,d=H,h=H,u=H,i=H;function p(l){return l.x0=l.y0=0,l.x1=r,l.y1=n,l.eachBefore(C),s=[0],a&&l.eachBefore(Ge),l}function C(l){var b=s[l.depth],y=l.x0+b,x=l.y0+b,f=l.x1-b,m=l.y1-b;f<y&&(y=f=(y+f)/2),m<x&&(x=m=(x+m)/2),l.x0=y,l.y0=x,l.x1=f,l.y1=m,l.children&&(b=s[l.depth+1]=o(l)/2,y+=i(l)-b,x+=d(l)-b,f-=h(l)-b,m-=u(l)-b,f<y&&(y=f=(y+f)/2),m<x&&(x=m=(x+m)/2),t(l,y,x,f,m))}return p.round=function(l){return arguments.length?(a=!!l,p):a},p.size=function(l){return arguments.length?(r=+l[0],n=+l[1],p):[r,n]},p.tile=function(l){return arguments.length?(t=je(l),p):t},p.padding=function(l){return arguments.length?p.paddingInner(l).paddingOuter(l):p.paddingInner()},p.paddingInner=function(l){return arguments.length?(o=typeof l=="function"?l:j(+l),p):o},p.paddingOuter=function(l){return arguments.length?p.paddingTop(l).paddingRight(l).paddingBottom(l).paddingLeft(l):p.paddingTop()},p.paddingTop=function(l){return arguments.length?(d=typeof l=="function"?l:j(+l),p):d},p.paddingRight=function(l){return arguments.length?(h=typeof l=="function"?l:j(+l),p):h},p.paddingBottom=function(l){return arguments.length?(u=typeof l=="function"?l:j(+l),p):u},p.paddingLeft=function(l){return arguments.length?(i=typeof l=="function"?l:j(+l),p):i},p}var Qe={nodes:[],levels:new Map,outerNodes:[],classes:new Map},A=new ve(()=>structuredClone(Qe)),Ue=v(()=>{const t=xe,a=te();return ae({...t.treemap,...a.treemap??{}})},"getConfig"),Xe=v(()=>A.records.nodes,"getNodes"),_e=v((t,a)=>{const r=A.records;r.nodes.push(t),r.levels.set(t,a),a===0&&r.outerNodes.push(t),a===0&&!r.root&&(r.root=t)},"addNode"),et=v(()=>({name:"",children:A.records.outerNodes}),"getRoot"),tt=v((t,a)=>{const r=A.records.classes,n=r.get(t)??{id:t,styles:[],textStyles:[]};r.set(t,n);const s=a.replace(/\\,/g,"§§§").replace(/,/g,";").replace(/§§§/g,",").split(";");s&&s.forEach(o=>{ue(o)&&(n?.textStyles?n.textStyles.push(o):n.textStyles=[o]),n?.styles?n.styles.push(o):n.styles=[o]}),r.set(t,n)},"addClass"),at=v(()=>A.records.classes,"getClasses"),nt=v(t=>A.records.classes.get(t)?.styles??[],"getStylesForClass"),rt=v(()=>{me(),A.reset()},"clear"),O={getNodes:Xe,addNode:_e,getRoot:et,getConfig:Ue,clear:rt,setAccTitle:ie,getAccTitle:ce,setDiagramTitle:de,getDiagramTitle:pe,getAccDescription:he,setAccDescription:fe,addClass:tt,getClasses:at,getStylesForClass:nt};function ne(t){if(!t.length)return[];const a=[],r=[];return t.forEach(n=>{const s={name:n.name,children:n.type==="Leaf"?void 0:[]};for(s.classSelector=n?.classSelector,n?.cssCompiledStyles&&(s.cssCompiledStyles=[n.cssCompiledStyles]),n.type==="Leaf"&&n.value!==void 0&&(s.value=n.value);r.length>0&&r[r.length-1].level>=n.level;)r.pop();if(r.length===0)a.push(s);else{const o=r[r.length-1].node;o.children?o.children.push(s):o.children=[s]}n.type!=="Leaf"&&r.push({node:s,level:n.level})}),a}v(ne,"buildHierarchy");var lt=v(t=>{Se(t,O);const a=[];for(const s of t.TreemapRows??[])s.$type==="ClassDefStatement"&&O.addClass(s.className??"",s.styleText??"");for(const s of t.TreemapRows??[]){const o=s.item;if(!o)continue;const d=s.indent?parseInt(s.indent):0,h=ot(o),u=o.classSelector?O.getStylesForClass(o.classSelector):[],i=u.length>0?u.join(";"):void 0,p={level:d,name:h,type:o.$type,value:o.value,classSelector:o.classSelector,cssCompiledStyles:i};a.push(p)}const r=ne(a),n=v((s,o)=>{for(const d of s)O.addNode(d,o),d.children&&d.children.length>0&&n(d.children,o+1)},"addNodesRecursively");n(r,0)},"populate"),ot=v(t=>t.name?String(t.name):"","getItemName"),st={parse:v(async t=>{try{const a=await be("treemap",t);X.debug("Treemap AST:",a),lt(a)}catch(a){throw X.error("Error parsing treemap:",a),a}},"parse")},it=10,R=10,G=25,ct=v((t,a,r,n)=>{const s=n.db,o=s.getConfig(),d=o.padding??it,h=s.getDiagramTitle(),u=s.getRoot(),{themeVariables:i}=te();if(!u)return;const p=h?30:0,C=ge(a),l=o.nodeWidth?o.nodeWidth*R:960,b=o.nodeHeight?o.nodeHeight*R:500,y=l,x=b+p;C.attr("viewBox",`0 0 ${y} ${x}`),ye(C,x,y,o.useMaxWidth);let f;try{const e=o.valueFormat||",";if(e==="$0,0")f=v(c=>"$"+E(",")(c),"valueFormat");else if(e.startsWith("$")&&e.includes(",")){const c=/\.\d+/.exec(e),g=c?c[0]:"";f=v(w=>"$"+E(","+g)(w),"valueFormat")}else if(e.startsWith("$")){const c=e.substring(1);f=v(g=>"$"+E(c||"")(g),"valueFormat")}else f=E(e)}catch(e){X.error("Error creating format function:",e),f=E(",")}const m=U().range(["transparent",i.cScale0,i.cScale1,i.cScale2,i.cScale3,i.cScale4,i.cScale5,i.cScale6,i.cScale7,i.cScale8,i.cScale9,i.cScale10,i.cScale11]),N=U().range(["transparent",i.cScalePeer0,i.cScalePeer1,i.cScalePeer2,i.cScalePeer3,i.cScalePeer4,i.cScalePeer5,i.cScalePeer6,i.cScalePeer7,i.cScalePeer8,i.cScalePeer9,i.cScalePeer10,i.cScalePeer11]),T=U().range([i.cScaleLabel0,i.cScaleLabel1,i.cScaleLabel2,i.cScaleLabel3,i.cScaleLabel4,i.cScaleLabel5,i.cScaleLabel6,i.cScaleLabel7,i.cScaleLabel8,i.cScaleLabel9,i.cScaleLabel10,i.cScaleLabel11]);h&&C.append("text").attr("x",y/2).attr("y",p/2).attr("class","treemapTitle").attr("text-anchor","middle").attr("dominant-baseline","middle").text(h);const P=C.append("g").attr("transform",`translate(0, ${p})`).attr("class","treemapContainer"),W=_(u).sum(e=>e.value??0).sort((e,c)=>(c.value??0)-(e.value??0)),k=Je().size([l,b]).paddingTop(e=>e.children&&e.children.length>0?G+R:0).paddingInner(d).paddingLeft(e=>e.children&&e.children.length>0?R:0).paddingRight(e=>e.children&&e.children.length>0?R:0).paddingBottom(e=>e.children&&e.children.length>0?R:0).round(!0)(W),re=k.descendants().filter(e=>e.children&&e.children.length>0),I=P.selectAll(".treemapSection").data(re).enter().append("g").attr("class","treemapSection").attr("transform",e=>`translate(${e.x0},${e.y0})`);I.append("rect").attr("width",e=>e.x1-e.x0).attr("height",G).attr("class","treemapSectionHeader").attr("fill","none").attr("fill-opacity",.6).attr("stroke-width",.6).attr("style",e=>e.depth===0?"display: none;":""),I.append("clipPath").attr("id",(e,c)=>`clip-section-${a}-${c}`).append("rect").attr("width",e=>Math.max(0,e.x1-e.x0-12)).attr("height",G),I.append("rect").attr("width",e=>e.x1-e.x0).attr("height",e=>e.y1-e.y0).attr("class",(e,c)=>`treemapSection section${c}`).attr("fill",e=>m(e.data.name)).attr("fill-opacity",.6).attr("stroke",e=>N(e.data.name)).attr("stroke-width",2).attr("stroke-opacity",.4).attr("style",e=>{if(e.depth===0)return"display: none;";const c=B({cssCompiledStyles:e.data.cssCompiledStyles});return c.nodeStyles+";"+c.borderStyles.join(";")}),I.append("text").attr("class","treemapSectionLabel").attr("x",6).attr("y",G/2).attr("dominant-baseline","middle").text(e=>e.depth===0?"":e.data.name).attr("font-weight","bold").attr("style",e=>{if(e.depth===0)return"display: none;";const c="dominant-baseline: middle; font-size: 12px; fill:"+T(e.data.name)+"; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;",g=B({cssCompiledStyles:e.data.cssCompiledStyles});return c+g.labelStyles.replace("color:","fill:")}).each(function(e){if(e.depth===0)return;const c=J(this),g=e.data.name;c.text(g);const w=e.x1-e.x0,z=6;let F;o.showValues!==!1&&e.value?F=w-10-30-10-z:F=w-z-6;const M=Math.max(15,F),L=c.node();if(L.getComputedTextLength()>M){const S="...";let $=g;for(;$.length>0;){if($=g.substring(0,$.length-1),$.length===0){c.text(S),L.getComputedTextLength()>M&&c.text("");break}if(c.text($+S),L.getComputedTextLength()<=M)break}}}),o.showValues!==!1&&I.append("text").attr("class","treemapSectionValue").attr("x",e=>e.x1-e.x0-10).attr("y",G/2).attr("text-anchor","end").attr("dominant-baseline","middle").text(e=>e.value?f(e.value):"").attr("font-style","italic").attr("style",e=>{if(e.depth===0)return"display: none;";const c="text-anchor: end; dominant-baseline: middle; font-size: 10px; fill:"+T(e.data.name)+"; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;",g=B({cssCompiledStyles:e.data.cssCompiledStyles});return c+g.labelStyles.replace("color:","fill:")});const le=k.leaves(),q=P.selectAll(".treemapLeafGroup").data(le).enter().append("g").attr("class",(e,c)=>`treemapNode treemapLeafGroup leaf${c}${e.data.classSelector?` ${e.data.classSelector}`:""}x`).attr("transform",e=>`translate(${e.x0},${e.y0})`);q.append("rect").attr("width",e=>e.x1-e.x0).attr("height",e=>e.y1-e.y0).attr("class","treemapLeaf").attr("fill",e=>e.parent?m(e.parent.data.name):m(e.data.name)).attr("style",e=>B({cssCompiledStyles:e.data.cssCompiledStyles}).nodeStyles).attr("fill-opacity",.3).attr("stroke",e=>e.parent?m(e.parent.data.name):m(e.data.name)).attr("stroke-width",3),q.append("clipPath").attr("id",(e,c)=>`clip-${a}-${c}`).append("rect").attr("width",e=>Math.max(0,e.x1-e.x0-4)).attr("height",e=>Math.max(0,e.y1-e.y0-4)),q.append("text").attr("class","treemapLabel").attr("x",e=>(e.x1-e.x0)/2).attr("y",e=>(e.y1-e.y0)/2).attr("style",e=>{const c="text-anchor: middle; dominant-baseline: middle; font-size: 38px;fill:"+T(e.data.name)+";",g=B({cssCompiledStyles:e.data.cssCompiledStyles});return c+g.labelStyles.replace("color:","fill:")}).attr("clip-path",(e,c)=>`url(#clip-${a}-${c})`).text(e=>e.data.name).each(function(e){const c=J(this),g=e.x1-e.x0,w=e.y1-e.y0,z=c.node(),F=4,M=g-2*F,L=w-2*F;if(M<10||L<10){c.style("display","none");return}let S=parseInt(c.style("font-size"),10);const $=8,V=28,K=.6,D=6,Y=2;for(;z.getComputedTextLength()>M&&S>$;)S--,c.style("font-size",`${S}px`);let Z=Math.max(D,Math.min(V,Math.round(S*K))),ee=S+Y+Z;for(;ee>L&&S>$&&(S--,Z=Math.max(D,Math.min(V,Math.round(S*K))),!(Z<D&&S===$));)c.style("font-size",`${S}px`),ee=S+Y+Z;c.style("font-size",`${S}px`),(z.getComputedTextLength()>M||S<$||L<S)&&c.style("display","none")}),o.showValues!==!1&&q.append("text").attr("class","treemapValue").attr("x",e=>(e.x1-e.x0)/2).attr("y",function(e){return(e.y1-e.y0)/2}).attr("style",e=>{const c="text-anchor: middle; dominant-baseline: hanging; font-size: 28px;fill:"+T(e.data.name)+";",g=B({cssCompiledStyles:e.data.cssCompiledStyles});return c+g.labelStyles.replace("color:","fill:")}).attr("clip-path",(e,c)=>`url(#clip-${a}-${c})`).text(e=>e.value?f(e.value):"").each(function(e){const c=J(this),g=this.parentNode;if(!g){c.style("display","none");return}const w=J(g).select(".treemapLabel");if(w.empty()||w.style("display")==="none"){c.style("display","none");return}const z=parseFloat(w.style("font-size")),F=28,M=.6,L=6,S=2,$=Math.max(L,Math.min(F,Math.round(z*M)));c.style("font-size",`${$}px`);const V=(e.y1-e.y0)/2+z/2+S;c.attr("y",V);const K=e.x1-e.x0,D=e.y1-e.y0-4,Y=K-2*4;c.node().getComputedTextLength()>Y||V+$>D||$<L?c.style("display","none"):c.style("display",null)});const oe=o.diagramPadding??8;se(C,oe,"flowchart",o?.useMaxWidth||!1)},"draw"),dt=v(function(t,a){return a.db.getClasses()},"getClasses"),pt={draw:ct,getClasses:dt},ht={sectionStrokeColor:"black",sectionStrokeWidth:"1",sectionFillColor:"#efefef",leafStrokeColor:"black",leafStrokeWidth:"1",leafFillColor:"#efefef",labelColor:"black",labelFontSize:"12px",valueFontSize:"10px",valueColor:"black",titleColor:"black",titleFontSize:"14px"},ft=v(({treemap:t}={})=>{const a=ae(ht,t);return`
  .treemapNode.section {
    stroke: ${a.sectionStrokeColor};
    stroke-width: ${a.sectionStrokeWidth};
    fill: ${a.sectionFillColor};
  }
  .treemapNode.leaf {
    stroke: ${a.leafStrokeColor};
    stroke-width: ${a.leafStrokeWidth};
    fill: ${a.leafFillColor};
  }
  .treemapLabel {
    fill: ${a.labelColor};
    font-size: ${a.labelFontSize};
  }
  .treemapValue {
    fill: ${a.valueColor};
    font-size: ${a.valueFontSize};
  }
  .treemapTitle {
    fill: ${a.titleColor};
    font-size: ${a.titleFontSize};
  }
  `},"getStyles"),ut=ft,Ft={parser:st,db:O,renderer:pt,styles:ut};export{Ft as diagram};
//# sourceMappingURL=diagram-3EMPZRKU-DbvcGrmb.chunk.mjs.map
