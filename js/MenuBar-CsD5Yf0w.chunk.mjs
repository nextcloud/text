import{c as M,r as k,w as N,o as L,b as U,f as g}from"./vue.runtime.esm-BSiu2UOd.chunk.mjs";import{j as A,B as S,y as I,w as P,u as D,z as W,A as z,D as F,G as j,H as V,I as J,J as Q,q,T as G,K as Y,L as Z,Q as X,S as tt,U as et}from"./NcColorPicker-QtYUX0M1.chunk.mjs";import{n as p}from"./_plugin-vue2_normalizer-wd1ZAbRr.chunk.mjs";import{U as it,_ as nt}from"./index-C0-nO3LG.chunk.mjs";import{g as st}from"./emoji-picker-DlAAdvrL.chunk.mjs";import{d as ot,s as B}from"./index-BOsVt1qJ.chunk.mjs";import{l as rt}from"./index-DfiDB3im.chunk.mjs";import{a as at,t as ct,b as lt,i as dt}from"./index-BqoyqHyb.chunk.mjs";import{d as ht,c as ut}from"./public-DZjpO8Tq.chunk.mjs";import{e as _t}from"./modulepreload-polyfill-Pz2ckkzf.chunk.mjs";import{a as w}from"./NcLoadingIcon-BFPuXP3q.chunk.mjs";import{f as O,l as vt,j as bt,k as pt}from"./MediaHandler.provider-BE50DDzt.chunk.mjs";function y(e){var i;const n=ct(e);return(i=n?.$el)!=null?i:n}const T=dt?window:void 0;function yt(){const e=k(!1);return U()&&L(()=>{e.value=!0},void 0),e}function ft(e){const i=yt();return M(()=>(i.value,!!e()))}function mt(e,i,n={}){const{window:o=T,...a}=n;let c;const d=ft(()=>o&&"ResizeObserver"in o),_=()=>{c&&(c.disconnect(),c=void 0)},f=M(()=>Array.isArray(e)?e.map(s=>y(s)):[y(e)]),m=N(f,s=>{if(_(),d.value&&o){c=new ResizeObserver(i);for(const r of s)r&&c.observe(r,a)}},{immediate:!0,flush:"post"}),l=()=>{_(),m()};return lt(l),{isSupported:d,stop:l}}function xt(e,i={width:0,height:0},n={}){const{window:o=T,box:a="content-box"}=n,c=M(()=>{var s,r;return(r=(s=y(e))==null?void 0:s.namespaceURI)==null?void 0:r.includes("svg")}),d=k(i.width),_=k(i.height),{stop:f}=mt(e,([s])=>{const r=a==="border-box"?s.borderBoxSize:a==="content-box"?s.contentBoxSize:s.devicePixelContentBoxSize;if(o&&c.value){const u=y(e);if(u){const h=u.getBoundingClientRect();d.value=h.width,_.value=h.height}}else if(r){const u=Array.isArray(r)?r:[r];d.value=u.reduce((h,{inlineSize:v})=>h+v,0),_.value=u.reduce((h,{blockSize:v})=>h+v,0)}else d.value=s.contentRect.width,_.value=s.contentRect.height},n);at(()=>{const s=y(e);s&&(d.value="offsetWidth"in s?s.offsetWidth:i.width,_.value="offsetHeight"in s?s.offsetHeight:i.height)});const m=N(()=>y(e),s=>{d.value=s?i.width:0,_.value=s?i.height:0});function l(){f(),m()}return{width:d,height:_,stop:l}}const kt={name:"NcActionButton",components:{NextcloudVueNcActionButton:A},extends:S,mounted(){this.$editor.on("transaction",()=>this.updateState())},methods:{runAction(){const{actionEntry:e}=this;e.click?e.click(this):e.action(this.$editor.chain().focus(),this.$editor)?.run(),this.$nextTick(()=>{this.$emit("trigged",{...e})})}}};var gt=function(){var e=this,i=e._self._c;return i("NextcloudVueNcActionButton",e._g({staticClass:"entry-single-action entry-action entry-action-item",class:e.state.class,attrs:{title:e.listItemTooltip||void 0,disabled:e.state.disabled,"aria-keyshortcuts":e.keyshortcuts||void 0,"data-text-action-entry":e.actionEntry.key,type:e.state.type,"model-value":e.state.type!=="button"?e.state.active:void 0,"close-after-click":""},on:{click:e.runAction},scopedSlots:e._u([{key:"icon",fn:function(){return[i(e.icon,{tag:"component"})]},proxy:!0}])},e.$listeners),[e._v(" "+e._s(e.label)+" ")])},Ct=[],Et=p(kt,gt,Ct,!1,null,null);const Mt=Et.exports,At={name:"ActionList",components:{NcActions:ht,NcActionSeparator:I,ActionListItem:Mt},extends:S,mixins:[P,D,W],props:{forceEnabled:{type:Boolean,default:!1}},data:()=>({visible:!1,hasEnabledChild:!0}),computed:{currentChild(){const{state:e,$editor:i,actionEntry:{children:n}}=this;return e.active?n.find(o=>z(o,i)):null},icon(){return this.currentChild?this.currentChild.icon:this.actionEntry.icon},iconKey(){return`${this.actionEntry.key}/${this.activeKey}`},activeKey(){return this.currentChild?.key},children(){return this.actionEntry.children.filter(({visible:e})=>e===void 0?!0:typeof e=="function"?e(this):e)},labelWithSelected(){return this.currentChild?t("text",'{menuItemName}, "{selectedSubMenuItemName}" is selected',{menuItemName:this.actionEntry.label,selectedSubMenuItemName:this.currentChild.label}):this.actionEntry.label},isEnabled(){return this.forceEnabled||this.hasEnabledChild}},mounted(){this.$_updateState=ot(this.checkStateOfChildren.bind(this),50),this.$editor.on("update",this.$_updateState),this.$editor.on("selectionUpdate",this.$_updateState)},beforeDestroy(){this.$editor.off("update",this.$_updateState),this.$editor.off("selectionUpdate",this.$_updateState)},methods:{onOpenChange(e){this.visible=e},runAction(){},onTrigger(e){e?.click||(this.$editor.chain().focus().run(),this.$emit("trigged",e))},checkStateOfChildren(){this.hasEnabledChild=this.children.some(e=>this.isChildEnabled(e))},isChildEnabled(e){return!e.isSeparator&&!F(e,this.$editor).disabled}}};var St=function(){var e=this,i=e._self._c;return i("NcActions",e._b({staticClass:"entry-list-action entry-action",attrs:{title:e.tooltip,container:e.menuIDSelector,"aria-label":e.labelWithSelected,type:e.state.active?"primary":"tertiary","force-menu":!0,"data-text-action-entry":e.actionEntry.key,"data-text-action-active":e.activeKey,disabled:!e.isEnabled},on:{"update:open":e.onOpenChange},scopedSlots:e._u([{key:"icon",fn:function(){return[i(e.icon,{key:e.iconKey,tag:"component"})]},proxy:!0}])},"NcActions",e.state,!1),[e._l(e.children,function(n){return[n.isSeparator?i("NcActionSeparator",{key:`child-${n.key}`}):i("ActionListItem",e._g({key:`child-${n.key}`,attrs:{active:e.currentChild?.key===n.key,"is-item":"","action-entry":n},on:{trigged:e.onTrigger}},e.$listeners))]}),e._t("lastAction",null,null,{visible:e.visible})],2)},wt=[],$t=p(At,St,wt,!1,null,null);const H=$t.exports,Nt={name:"ActionSingle",components:{NcButton:ut},extends:S,props:{isItem:{type:Boolean,default:!1}},mounted(){this.$editor.on("transaction",()=>this.updateState())},methods:{runAction(){const{actionEntry:e}=this;e.click?e.click(this):e.action(this.$editor.chain().focus(),this.$editor)?.run(),this.$nextTick(()=>{this.$emit("trigged",{...e})})}}};var It=function(){var e=this,i=e._self._c;return i("NcButton",e._g({staticClass:"entry-single-action entry-action",class:e.state.class,attrs:{disabled:e.state.disabled,"aria-keyshortcuts":e.keyshortcuts||void 0,"data-text-action-entry":e.actionEntry.key,"aria-label":e.label,title:e.tooltip,type:"tertiary",pressed:e.state.type!=="button"?e.state.active:void 0},on:{click:e.runAction},scopedSlots:e._u([{key:"icon",fn:function(){return[i(e.icon,{tag:"component"})]},proxy:!0},e.actionEntry.forceLabel?{key:"default",fn:function(){return[e._v(" "+e._s(e.label)+" ")]},proxy:!0}:null],null,!0)},e.$listeners))},Bt=[],Ot=p(Nt,It,Bt,!1,null,null);const K=Ot.exports,R=g({data(){return{activeMenuEntry:0,entries:[]}},computed:{visibleEntries(){return this.entries}},watch:{visibleEntries(){this.$nextTick(()=>{(this.activeMenuEntry>this.visibleEntries.length||this.visibleEntries[this.activeMenuEntry]?.disabled)&&this.setNextMenuEntry()})}},methods:{disableMenuEntry(e,i){const n=this.visibleEntries.findIndex(({key:o})=>o===e);this.visibleEntries[n].disabled=i,i===!1&&this.activeMenuEntry===n&&this.$nextTick(()=>this.setNextMenuEntry())},setNextMenuEntry(){const e=this.visibleEntries.length+(this.$refs.remainingEntries?1:0);do this.activeMenuEntry=(this.activeMenuEntry+1)%e;while(this.activeMenuEntry<this.visibleEntries.length&&this.visibleEntries[this.activeMenuEntry].disabled)},setPreviousMenuEntry(){const e=this.visibleEntries.length+(this.$refs.remainingEntries?1:0);do{const i=this.activeMenuEntry-1;this.activeMenuEntry=(i%e+e)%e}while(this.activeMenuEntry<this.visibleEntries.length&&this.visibleEntries[this.activeMenuEntry].disabled)},handleToolbarNavigation(e){e.key==="ArrowRight"?this.setNextMenuEntry():e.key==="ArrowLeft"&&this.setPreviousMenuEntry(),this.activeMenuEntry===this.visibleEntries.length?this.$refs.remainingEntries?.focusButton?.():[...this.$refs.menuEntries].sort((i,n)=>this.visibleEntries.findIndex(({key:o})=>o===i.$vnode.data.key)-this.visibleEntries.findIndex(({key:o})=>o===n.$vnode.data.key))[this.activeMenuEntry].focusButton()}}}),Tt=g({name:"ReadonlyBar",components:{ActionList:H,ActionSingle:K},extends:R,data(){return{entries:j}}});var Ht=function(){var e=this,i=e._self._c;return e._self._setupProxy,i("div",{staticClass:"text-readonly-bar",attrs:{"data-text-el":"readonly-bar"}},[i("div",{ref:"menubar",staticClass:"text-readonly-bar__entries",attrs:{role:"toolbar","aria-label":e.t("text","Editor actions")}},e._l(e.visibleEntries,function(n,o){return i(n.component?n.component:n.children?"ActionList":"ActionSingle",{key:n.key,ref:"menuEntries",refInFor:!0,tag:"component",attrs:{"action-entry":n,"can-be-focussed":e.activeMenuEntry===o},on:{disabled:function(a){return e.disableMenuEntry(n.key,a)}}})}),1),i("div",{staticClass:"text-menubar__slot"},[e._t("default")],2)])},Kt=[],Rt=p(Tt,Ht,Kt,!1,null,"89c84877");const xe=Rt.exports;var E={exports:{}};(function(e,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;function n(l){"@babel/helpers - typeof";return n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},n(l)}var o=47,a=46,c=function(l){var s=n(l);if(s!=="string")throw new TypeError("Expected a string, got a ".concat(s))},d=function(l,s){for(var r="",u=0,h=-1,v=0,x,b=0;b<=l.length;++b){if(b<l.length)x=l.charCodeAt(b);else{if(x===o)break;x=o}if(x===o){if(!(h===b-1||v===1))if(h!==b-1&&v===2){if(r.length<2||u!==2||r.charCodeAt(r.length-1)!==a||r.charCodeAt(r.length-2)!==a){if(r.length>2){var C=r.lastIndexOf("/");if(C!==r.length-1){C===-1?(r="",u=0):(r=r.slice(0,C),u=r.length-1-r.lastIndexOf("/")),h=b,v=0;continue}}else if(r.length===2||r.length===1){r="",u=0,h=b,v=0;continue}}s&&(r.length>0?r+="/..":r="..",u=2)}else r.length>0?r+="/"+l.slice(h+1,b):r=l.slice(h+1,b),u=b-h-1;h=b,v=0}else x===a&&v!==-1?++v:v=-1}return r},_=function(l){try{return decodeURIComponent(l)}catch{return l}},f=function(l){c(l);var s=l;if(s.length===0)return".";var r=s.charCodeAt(0)===o,u=s.charCodeAt(s.length-1)===o;return s=_(s),s=d(s,!r),s.length===0&&!r&&(s="."),s.length>0&&u&&(s+="/"),r?"/"+s:s},m=f;i.default=m,e.exports=i.default})(E,E.exports);var Lt=E.exports;const Ut=st(Lt),Pt=e=>B.dispatch("text/setAttachmentList",e),$=B.getters["text/findAttachment"];class ke{#i;#t;#e;#n;#s;#o;constructor({session:i,user:n,shareToken:o,currentDirectory:a,fileId:c}){this.#i=i,this.#t=n,this.#e=o,this.#n=a,this.#s=c??i.documentId,this.#o=this.#r()}async#r(){return Pt({documentId:this.#s,session:this.#i,shareToken:this.#e})}async resolve(i,n=!0){let o;const a=/^\.attachments\.\d+\//;if(i.match(a)){const c=decodeURIComponent(i.replace(a,"").split("?")[0]);if(await this.#o,o=$(c),n&&!o&&(await this.#r(),o=$(c)),o)return o}return Dt(i)?{isImage:!0,name:this.#a(i),previewUrl:i,fullUrl:i}:{isImage:!0,name:this.#a(i),previewUrl:this.#c(i),fullUrl:this.#c(i)}}#a(i){return i.split("/").pop()}#c(i){if(this.#t){const c=this.#t.uid,d=this.#l(i).split("/").map(encodeURIComponent).join("/");return it(`dav/files/${c}${d}`)}const n=this.#l(i).split("/"),o=n.pop(),a=n.join("/");return nt("/s/{token}/download?path={dirname}&files={basename}",{token:this.#e,basename:o,dirname:a})}#d(i){return decodeURI(i.split("?")[0])}#l(i){const n=[this.#n,this.#d(i)].join("/");return Ut(n)}}function Dt(e){return e.startsWith("http://")||e.startsWith("https://")||e.startsWith("data:")}const Wt=g({name:"NcActionButton",components:{NextcloudVueNcActionButton:A,Help:V}});var zt=function(){var e=this,i=e._self._c;return e._self._setupProxy,i("NextcloudVueNcActionButton",e._g({attrs:{"close-after-click":"","data-text-action-entry":"formatting-help"},scopedSlots:e._u([{key:"icon",fn:function(){return[i("Help")]},proxy:!0}])},e.$listeners),[e._v(" "+e._s(e.t("text","Formatting help"))+" ")])},Ft=[],jt=p(Wt,zt,Ft,!1,null,null);const Vt=jt.exports,Jt=g({name:"CharacterCount",components:{AlphabeticalVariant:J,NcActionText:Q},mixins:[O],props:{visible:Boolean},data:()=>({wordCount:0,charCount:0}),computed:{countString(){return`${w("text","%n word","%n words",this.wordCount)}, ${w("text","%n char","%n chars",this.charCount)}`}},watch:{visible:"refresh"},created(){this.refresh()},methods:{refresh(){this.wordCount=this.$editor.storage.characterCount.words(),this.charCount=this.$editor.storage.characterCount.characters()}}});var Qt=function(){var e=this,i=e._self._c;return e._self._setupProxy,i("NcActionText",{attrs:{"data-text-action-entry":"character-count",name:e.countString},scopedSlots:e._u([{key:"icon",fn:function(){return[i("AlphabeticalVariant")]},proxy:!0}])})},qt=[],Gt=p(Jt,Qt,qt,!1,null,null);const Yt=Gt.exports;function Zt(){return navigator?.userAgentData?.mobile!==void 0?navigator.userAgentData.mobile:[/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/playbook/i,/silk/i,/BlackBerry/i,/Windows Phone/i].some(e=>navigator.userAgent.match(e))}const Xt={name:"HelpModal",components:{NcDialog:q},data(){return{formatted:{bold:!0,italic:!0,strikethrough:!0,heading1:!0,heading6:!0,unorderdList:!0,orderedList:!0,checkList:!0,blockQuote:!0,codeBlock:!0},ctrlOrModKey:G[Y.Mod]}},computed:{isFormatted(){return e=>this.formatted[e]},isMobileCached(){return this.isMobilePlatform()}},methods:{toggleFormatted(e){this.formatted[e]=!this.formatted[e]},isMobilePlatform:Zt}};var te=function(){var e=this,i=e._self._c;return i("NcDialog",{attrs:{size:"large","data-text-el":"formatting-help",name:e.t("text","Formatting and shortcuts"),"close-on-click-outside":!0},on:{closing:function(n){return e.$emit("close")}}},[i("h2",[e._v(e._s(e.t("text","Formatting and shortcuts")))]),i("p",[e._v(e._s(e.t("text","Speed up your writing with simple shortcuts.")))]),e.isMobileCached?i("p",[e._v(" "+e._s(e.t("text","Just type the Markdown syntax from below."))+" ")]):i("p",[e._v(" "+e._s(e.t("text","Just type the Markdown syntax or use keyboard shortcuts from below."))+" ")]),i("table",[i("thead",[i("tr",[i("th",[e._v(e._s(e.t("text","Style")))]),i("th",[e._v(e._s(e.t("text","Syntax")))]),e.isMobileCached?e._e():i("th",[e._v(" "+e._s(e.t("text","Keyboard shortcuts"))+" ")])])]),i("tbody",[i("tr",[i("td",[e._v(e._s(e.t("text","New paragraph")))]),i("td",[i("kbd",[e._v(e._s(e.t("text","Enter")))])]),e.isMobileCached?e._e():i("td")]),i("tr",[i("td",[e._v(e._s(e.t("text","Hard line break")))]),i("td",[i("kbd",[e._v(e._s(e.t("text","Enter")))]),e._v(" "+e._s(e.t("text","followed by"))+" "),i("kbd",[e._v(e._s(e.t("text","Backspace")))])]),e.isMobileCached?e._e():i("td",[i("kbd",[e._v(e._s(e.t("text","Shift")))]),e._v(" + "),i("kbd",[e._v(e._s(e.t("text","Enter")))])])]),i("tr",[i("td",[e._v(e._s(e.t("text","Bold")))]),i("td",[i("code",[e._v("**"+e._s(e.t("text","Bold text"))+"**")])]),e.isMobileCached?e._e():i("td",[i("kbd",[e._v(e._s(e.ctrlOrModKey))]),e._v(" + "),i("kbd",[e._v("B")])])]),i("tr",[i("td",[e._v(e._s(e.t("text","Italic")))]),i("td",[i("code",[e._v("*"+e._s(e.t("text","Italicized text"))+"*")])]),e.isMobileCached?e._e():i("td",[i("kbd",[e._v(e._s(e.ctrlOrModKey))]),e._v(" + "),i("kbd",[e._v("I")])])]),i("tr",[i("td",[e._v(e._s(e.t("text","Strikethrough")))]),i("td",[i("code",[e._v("~~"+e._s(e.t("text","Mistaken text"))+"~~")])]),e.isMobileCached?e._e():i("td",[i("kbd",[e._v(e._s(e.ctrlOrModKey))]),e._v(" + "),i("kbd",[e._v(e._s(e.t("text","Shift")))]),e._v(" + "),i("kbd",[e._v("S")])])]),i("tr",[i("td",[e._v(e._s(e.t("text","Underline")))]),i("td",[i("code",[e._v("__"+e._s(e.t("text","Underlined text"))+"__")])]),e.isMobileCached?e._e():i("td",[i("kbd",[e._v(e._s(e.ctrlOrModKey))]),e._v(" + "),i("kbd",[e._v("U")])])]),i("tr",[i("td",{staticClass:"ellipsis_top"},[e._v(" "+e._s(e.t("text","Heading 1"))+" ")]),i("td",{staticClass:"ellipsis_top"},[i("code",[e._v("# "+e._s(e.t("text","Heading level 1")))])]),e.isMobileCached?e._e():i("td",{staticClass:"ellipsis_top"},[i("kbd",[e._v(e._s(e.ctrlOrModKey))]),e._v(" + "),i("kbd",[e._v(e._s(e.t("text","Shift")))]),e._v(" + "),i("kbd",[e._v("1")])])]),i("tr",[i("td",{staticClass:"noborder ellipsis"},[e._v(" … ")]),i("td",{staticClass:"noborder ellipsis"},[e._v(" … ")]),e.isMobileCached?e._e():i("td",{staticClass:"ellipsis noborder"},[e._v(" … ")])]),i("tr",[i("td",{staticClass:"noborder ellipsis_bottom"},[e._v(" "+e._s(e.t("text","Heading 6"))+" ")]),i("td",{staticClass:"noborder ellipsis_bottom"},[i("code",[e._v("###### "+e._s(e.t("text","Heading level 6")))])]),e.isMobileCached?e._e():i("td",{staticClass:"noborder ellipsis_bottom"},[i("kbd",[e._v(e._s(e.ctrlOrModKey))]),e._v(" + "),i("kbd",[e._v(e._s(e.t("text","Shift")))]),e._v(" + "),i("kbd",[e._v("6")])])]),i("tr",[i("td",[e._v(e._s(e.t("text","Unordered list")))]),i("td",[i("code",[e._v("* "+e._s(e.t("text","An item")))])]),e.isMobileCached?e._e():i("td",[i("kbd",[e._v(e._s(e.ctrlOrModKey))]),e._v(" + "),i("kbd",[e._v(e._s(e.t("text","Shift")))]),e._v(" + "),i("kbd",[e._v("8")])])]),i("tr",[i("td",[e._v(e._s(e.t("text","Ordered list")))]),i("td",[i("code",[e._v("1. "+e._s(e.t("text","First item")))])]),e.isMobileCached?e._e():i("td",[i("kbd",[e._v(e._s(e.ctrlOrModKey))]),e._v(" + "),i("kbd",[e._v(e._s(e.t("text","Shift")))]),e._v(" + "),i("kbd",[e._v("7")])])]),i("tr",[i("td",[e._v(e._s(e.t("text","Checklist")))]),i("td",[i("code",[e._v("* [] "+e._s(e.t("text","To-Do item")))])]),e.isMobileCached?e._e():i("td",[i("kbd",[e._v(e._s(e.ctrlOrModKey))]),e._v(" + "),i("kbd",[e._v(e._s(e.t("text","Shift")))]),e._v(" + "),i("kbd",[e._v("9")])])]),i("tr",[i("td",[e._v(e._s(e.t("text","Blockquote")))]),i("td",[i("code",[e._v("> "+e._s(e.t("text","Quoted text")))])]),e.isMobileCached?e._e():i("td",[i("kbd",[e._v(e._s(e.ctrlOrModKey))]),e._v(" + "),i("kbd",[e._v(">")])])]),i("tr",[i("td",[e._v(e._s(e.t("text","Code block")))]),i("td",[i("code",[e._v("``` "+e._s(e.t("text","Some code")))])]),e.isMobileCached?e._e():i("td")]),i("tr",[i("td",[e._v(e._s(e.t("text","Link")))]),i("td",[i("code",[e._v("[Title](https://example.org)")])]),e.isMobileCached?e._e():i("td")]),i("tr",[i("td",[e._v(e._s(e.t("text","Insert emoji")))]),i("td",[i("code",[e._v(":"+e._s(e.t("text","emoji")))])]),e.isMobileCached?e._e():i("td")]),i("tr",[i("td",[e._v(e._s(e.t("text","Mention someone")))]),i("td",[i("code",[e._v("@"+e._s(e.t("text","name")))])]),e.isMobileCached?e._e():i("td")]),i("tr",[i("td",[e._v(e._s(e.t("text","Smart picker")))]),i("td",[i("code",[e._v("/"+e._s(e.t("text","something")))])]),e.isMobileCached?e._e():i("td")])])]),i("table",{attrs:{vif:"!isMobileCached"}},[i("thead",[i("tr",[i("th",[e._v(e._s(e.t("text","Action")))]),i("th",[e._v(e._s(e.t("text","Keyboard shortcuts")))])])]),i("tbody",[i("tr",[i("td",[e._v(e._s(e.t("text","Undo")))]),i("td",[i("kbd",[e._v(e._s(e.ctrlOrModKey))]),e._v(" + "),i("kbd",[e._v("Z")])])]),i("tr",[i("td",[e._v(e._s(e.t("text","Redo")))]),i("td",[i("kbd",[e._v(e._s(e.ctrlOrModKey))]),e._v(" + "),i("kbd",[e._v("Y")])])]),i("tr",[i("td",[e._v(e._s(e.t("text","Toggle outline")))]),i("td",[i("kbd",[e._v(e._s(e.ctrlOrModKey))]),e._v(" + "),i("kbd",[e._v(e._s(e.t("text","Alt")))]),e._v(" + "),i("kbd",[e._v("H")])])])])])])},ee=[],ie=p(Xt,te,ee,!1,null,"7749c84b");const ne=ie.exports,se={name:"MenuBar",components:{ActionFormattingHelp:Vt,ActionList:H,ActionSingle:K,HelpModal:ne,NcActionSeparator:I,NcActionButton:A,CharacterCount:Yt,TranslateVariant:Z},extends:R,mixins:[O,vt,bt,pt],provide(){const e={};return Object.defineProperties(e,{[et]:{get:()=>this.randomID}}),e},props:{isHidden:{type:Boolean,default:!1}},setup(){const e=k(),{width:i}=xt(e);return{menubar:e,width:i}},data(){return{entries:[...X],randomID:`menu-bar-${Math.ceil(Math.random()*1e4+500).toString(16)}`,displayHelp:!1,isReady:!1,canTranslate:rt("text","translation_languages",[]).length>0,resize:null}},computed:{visibleEntries(){return this.entries.filter(({priority:e})=>e===void 0||e<=this.iconsLimit)},hiddenEntries(){const e=this.entries.filter(({priority:n})=>n!==void 0&&n>this.iconsLimit),i=e.reduce((n,o,a)=>{const c=o.children??[o];if(c.length>1){const d=n.length&&!n.at(-1).isSeparator?[{key:`separator-before-${o.id}`,isSeparator:!0}]:[],_=a!==e.length-1?[{key:`separator-after-${o.id}`,isSeparator:!0}]:[];return[...n,...d,...c,..._]}return[...n,...c]},[]);return{key:"remain",label:this.t("text","Remaining actions"),icon:tt,children:i}},iconWidth(){const e=(this.menubar&&getComputedStyle(this.menubar))?.getPropertyValue("--default-clickable-area");return parseInt(e)||34},iconsLimit(){const e=this.width-4,i=this.$isMobile?this.iconWidth:this.iconWidth+2;return Math.floor(e/i)-1}},mounted(){this.$nextTick(()=>{this.isReady=!0,this.$emit("update:loaded",!0)})},methods:{showHelp(){this.displayHelp=!0},hideHelp(){this.displayHelp=!1},showTranslate(){const{from:e,to:i}=this.$editor.view.state.selection;let n=this.$editor.view.state.doc.textBetween(e,i," ");n.trim().length||(this.$editor.commands.selectAll(),n=this.$editor.view.state.doc.textContent),console.debug("translation click",this.$editor.view.state.selection,n),_t("text:translate-modal:show",{content:n})}}};var oe=function(){var e=this,i=e._self._c;return i("div",{staticClass:"text-menubar",class:{"text-menubar--ready":e.isReady,"text-menubar--hide":e.isHidden,"text-menubar--is-workspace":e.$isRichWorkspace},attrs:{id:e.randomID,"data-text-el":"menubar",role:"region","aria-label":e.t("text","Editor actions")}},[e.displayHelp?i("HelpModal",{on:{close:e.hideHelp}}):e._e(),e.$isRichEditor?i("div",{ref:"menubar",staticClass:"text-menubar__entries",attrs:{role:"toolbar","aria-label":e.t("text","Formatting menu bar")},on:{keydown:[function(n){return!n.type.indexOf("key")&&e._k(n.keyCode,"left",37,n.key,["Left","ArrowLeft"])||"button"in n&&n.button!==0?null:(n.stopPropagation(),e.handleToolbarNavigation.apply(null,arguments))},function(n){return!n.type.indexOf("key")&&e._k(n.keyCode,"right",39,n.key,["Right","ArrowRight"])||"button"in n&&n.button!==2?null:(n.stopPropagation(),e.handleToolbarNavigation.apply(null,arguments))}]}},[e._l(e.visibleEntries,function(n,o){return i(n.component?n.component:n.children?"ActionList":"ActionSingle",{key:n.key,ref:"menuEntries",refInFor:!0,tag:"component",attrs:{"action-entry":n,"can-be-focussed":e.activeMenuEntry===o},on:{disabled:function(a){return e.disableMenuEntry(n.key,a)},click:function(a){e.activeMenuEntry=o}}})}),i("ActionList",{ref:"remainingEntries",attrs:{"action-entry":e.hiddenEntries,"can-be-focussed":e.activeMenuEntry===e.visibleEntries.length,"force-enabled":!0},on:{click:function(n){e.activeMenuEntry="remain"}},scopedSlots:e._u([{key:"lastAction",fn:function({visible:n}){return[e.canTranslate?i("NcActionButton",{attrs:{"close-after-click":""},on:{click:e.showTranslate},scopedSlots:e._u([{key:"icon",fn:function(){return[i("TranslateVariant")]},proxy:!0}],null,!0)},[e._v(" "+e._s(e.t("text","Translate"))+" ")]):e._e(),i("ActionFormattingHelp",{on:{click:e.showHelp}}),i("NcActionSeparator"),i("CharacterCount",e._b({},"CharacterCount",{visible:n},!1))]}}],null,!1,2316723924)})],2):e._e(),i("div",{staticClass:"text-menubar__slot"},[e._t("default")],2)],1)},re=[],ae=p(se,oe,re,!1,null,"0eaf3e38");const ge=ae.exports;export{ke as A,ge as M,xe as R,xt as u};
//# sourceMappingURL=MenuBar-CsD5Yf0w.chunk.mjs.map
