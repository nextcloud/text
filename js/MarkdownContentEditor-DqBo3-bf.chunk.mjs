import{c as s,R as d,F as l,E as u,u as p,p as m,e as h}from"./EditorOutline-BACHwWz9.chunk.mjs";import{M as c,R as f,A as y}from"./MenuBar-Cng5yZ37.chunk.mjs";import{W as g,M as w,C as B}from"./Wrapper-_LD6Wa-k.chunk.mjs";import{a as C}from"./index-C-U7ohGa.chunk.mjs";import{H as O}from"./index-BPcsgVzS.chunk.mjs";import{w as a,p as M}from"./vue.runtime.esm-CU0zJ5AL.chunk.mjs";import{A as R}from"./MediaHandler.provider-CxKbS2cm.chunk.mjs";import{n as $}from"./_plugin-vue2_normalizer-wd1ZAbRr.chunk.mjs";import"./NcLoadingIcon-B1Im7aog.chunk.mjs";import"./emoji-picker-MDCGxHB0.chunk.mjs";import"./index-DxwFe63_.chunk.mjs";import"./logger-CNqRxEFx.chunk.mjs";import"./index-D3wiQe9-.chunk.mjs";import"./NcNoteCard-CwNXZ4vV-Dq8OU3M6.chunk.mjs";import"./NcCheckboxRadioSwitch-CX3HXCEk-C0RoW2-E.chunk.mjs";const v={name:"MarkdownContentEditor",components:{ContentContainer:B,ReadonlyBar:f,MenuBar:c,MainContainer:w,Wrapper:g},provide(){const t={};return Object.defineProperties(t,{[R]:{get:()=>this.$attachmentResolver??null}}),t},props:{fileId:{type:Number,default:null},content:{type:String,required:!0},readOnly:{type:Boolean,default:!1},relativePath:{type:String,default:""},shareToken:{type:String,default:null},showMenuBar:{type:Boolean,default:!0},showOutlineOutside:{type:Boolean,default:!1}},emits:["update:content"],setup(t){const e=[d.configure({extensions:[O]}),l],o=new u({extensions:e}),{setEditable:r,setContent:i}=p(o);return a(()=>t.content,n=>{i(n)}),r(!t.readOnly),a(()=>t.readOnly,n=>{r(!n)}),m(o),M(h,{isPublic:!1,isRichEditor:!0,isRichWorkspace:!1}),{editor:o,setContent:i}},created(){this.setContent(this.content,{addToHistory:!1}),this.editor.on("create",()=>{this.$emit("ready"),this.$parent.$emit("ready")}),this.editor.on("update",({editor:t})=>{const e=s(t.schema).serialize(t.state.doc);this.emit("update:content",{json:t.state.doc,markdown:e})}),this.fileId&&(this.$attachmentResolver=new y({currentDirectory:this.relativePath?.match(/.*\//),user:C(),shareToken:this.shareToken,fileId:this.fileId}))},beforeDestroy(){this.editor.destroy()},methods:{outlineToggled(t){this.emit("outline-toggled",t)},emit(t,e){this.$emit(t,e),this.$parent?.$emit(t,e)}}};var k=function(){var t=this,e=t._self._c;return e("Wrapper",{attrs:{"content-loaded":!0,"show-outline-outside":t.showOutlineOutside},on:{"outline-toggled":t.outlineToggled}},[e("MainContainer",[t.showMenuBar?[t.readOnly?t._t("readonlyBar",function(){return[e("ReadonlyBar")]}):e("MenuBar",{attrs:{autohide:!1}})]:t._e(),e("ContentContainer",{attrs:{"read-only":t.readOnly}})],2)],1)},T=[],b=$(v,k,T,!1,null,null);const G=b.exports;export{G as default};
//# sourceMappingURL=MarkdownContentEditor-DqBo3-bf.chunk.mjs.map
