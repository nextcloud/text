/*! For license information please see src_views_RichWorkspace_vue-node_modules_nextcloud_vue_dist_chunks_emoji-BY_D0V5K_mjs-node_mo-c8f763.js.LICENSE.txt */
"use strict";(self.webpackChunk_nextcloud_text=self.webpackChunk_nextcloud_text||[]).push([["src_views_RichWorkspace_vue-node_modules_nextcloud_vue_dist_chunks_emoji-BY_D0V5K_mjs-node_mo-c8f763"],{73590:(e,t,r)=>{r.d(t,{CB:()=>h,GH:()=>c,HE:()=>b,PW:()=>n,_S:()=>w,bk:()=>v,c9:()=>u,f_:()=>s,ir:()=>f,l5:()=>C,lV:()=>A,o:()=>d,pN:()=>g,qS:()=>i,wn:()=>l,yS:()=>a,yu:()=>m});var o=r(79843);const i=Symbol("tiptap:editor"),n=Symbol("editor:file"),s=Symbol("attachment:resolver"),a=Symbol("editor:is-mobile"),A=Symbol("editor:is-public"),l=Symbol("editor:is-rich-editor"),d=Symbol("editor:is-rich-woskapace"),c=Symbol("sync:service"),p=Symbol("editor:upload"),h=(Symbol("hook:mention-search"),Symbol("hook:mention-insert"),{inject:{$editor:{from:i,default:null}}}),C={inject:{$syncService:{from:c,default:null}}},f={inject:{$isPublic:{from:A,default:!1}}},u={inject:{$isRichWorkspace:{from:d,default:!1}}},m={inject:{$isRichEditor:{from:l,default:!1}}},v={inject:{$isMobile:{from:a,default:!1}}},g={inject:{$file:{from:n,default:()=>({fileId:0,relativePath:null,document:null})}}},b={inject:{$attachmentResolver:{from:s,default:{resolve:e=>(o.v.warn("No attachment resolver provided. Some attachment sources cannot be resolved."),[e])}}}},w={inject:{$editorUpload:{from:p,default:!0}}}},79843:(e,t,r)=>{r.d(t,{v:()=>o});const o=(0,r(53529).YK)().setApp("text").detectUser().build()},33909:(e,t,r)=>{r.d(t,{A:()=>a});var o=r(71354),i=r.n(o),n=r(76314),s=r.n(n)()(i());s.push([e.id,".editor__content[data-v-151c6c0d]{max-width:var(--text-editor-max-width);margin:auto;position:relative;width:100%}.text-editor__content-wrapper[data-v-151c6c0d]{--side-width: calc((100% - var(--text-editor-max-width)) / 2);display:grid;grid-template-columns:1fr auto}.text-editor__content-wrapper.--show-outline[data-v-151c6c0d]{grid-template-columns:var(--side-width) auto var(--side-width)}.text-editor__content-wrapper .text-editor__content-wrapper__left[data-v-151c6c0d],.text-editor__content-wrapper .text-editor__content-wrapper__right[data-v-151c6c0d]{height:100%;position:relative}","",{version:3,sources:["webpack://./src/components/BaseReader.vue"],names:[],mappings:"AACA,kCACC,sCAAA,CACA,WAAA,CACA,iBAAA,CACA,UAAA,CAGD,+CACC,6DAAA,CACA,YAAA,CACA,8BAAA,CACA,8DACC,8DAAA,CAED,uKAEC,WAAA,CACA,iBAAA",sourceRoot:""}]);const a=s},17142:(e,t,r)=>{r.d(t,{A:()=>p});var o=r(71354),i=r.n(o),n=r(76314),s=r.n(n),a=r(4417),A=r.n(a),l=new URL(r(19756),r.b),d=s()(i()),c=A()(l);d.push([e.id,`div.ProseMirror{height:100%;position:relative;word-wrap:break-word;white-space:pre-wrap;-webkit-font-variant-ligatures:none;font-variant-ligatures:none;padding:4px 8px 200px 14px;line-height:150%;font-size:var(--default-font-size);outline:none;--table-color-border: var(--color-border);--table-color-heading: var(--color-text-maxcontrast);--table-color-heading-border: var(--color-border-dark);--table-color-background: var(--color-main-background);--table-color-background-hover: var(--color-primary-element-light);--table-border-radius: var(--border-radius)}div.ProseMirror :target{scroll-margin-top:50px}div.ProseMirror[contenteditable=true],div.ProseMirror[contenteditable=false],div.ProseMirror [contenteditable=true],div.ProseMirror [contenteditable=false]{width:100%;background-color:rgba(0,0,0,0);color:var(--color-main-text);opacity:1;-webkit-user-select:text;user-select:text;font-size:var(--default-font-size)}div.ProseMirror[contenteditable=true]:not(.collaboration-cursor__caret),div.ProseMirror[contenteditable=false]:not(.collaboration-cursor__caret),div.ProseMirror [contenteditable=true]:not(.collaboration-cursor__caret),div.ProseMirror [contenteditable=false]:not(.collaboration-cursor__caret){border:none !important}div.ProseMirror[contenteditable=true]:focus,div.ProseMirror[contenteditable=true]:focus-visible,div.ProseMirror[contenteditable=false]:focus,div.ProseMirror[contenteditable=false]:focus-visible,div.ProseMirror [contenteditable=true]:focus,div.ProseMirror [contenteditable=true]:focus-visible,div.ProseMirror [contenteditable=false]:focus,div.ProseMirror [contenteditable=false]:focus-visible{box-shadow:none !important}div.ProseMirror .checkbox-item{display:flex;align-items:start;margin-left:-24px}div.ProseMirror .checkbox-item input[type=checkbox]{display:none}div.ProseMirror .checkbox-item:before{content:"";vertical-align:middle;margin:3px 6px 3px 2px;border:1px solid var(--color-text-maxcontrast);display:block;border-radius:var(--border-radius);height:14px;width:14px;box-shadow:none !important;background-position:center;cursor:pointer}div.ProseMirror .checkbox-item.checked:before{background-image:url(${c});background-color:var(--color-primary-element);border-color:var(--color-primary-element)}div.ProseMirror .checkbox-item.checked>label>p{color:var(--color-text-maxcontrast);text-decoration:line-through}div.ProseMirror .checkbox-item label{display:block;flex-grow:1;max-width:calc(100% - 28px)}div.ProseMirror>*:first-child{margin-top:10px}div.ProseMirror>h1,div.ProseMirror h2,div.ProseMirror h3,div.ProseMirror h4,div.ProseMirror h5,div.ProseMirror h6{position:relative}div.ProseMirror>h1:first-child,div.ProseMirror h2:first-child,div.ProseMirror h3:first-child,div.ProseMirror h4:first-child,div.ProseMirror h5:first-child,div.ProseMirror h6:first-child{margin-top:0}div.ProseMirror>h1 .heading-anchor[contenteditable=false],div.ProseMirror h2 .heading-anchor[contenteditable=false],div.ProseMirror h3 .heading-anchor[contenteditable=false],div.ProseMirror h4 .heading-anchor[contenteditable=false],div.ProseMirror h5 .heading-anchor[contenteditable=false],div.ProseMirror h6 .heading-anchor[contenteditable=false]{width:1em;opacity:0;padding:0;left:-1em;top:0;font-size:max(1em,16px);position:absolute;text-decoration:none;transition-duration:.15s;transition-property:opacity;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1)}div.ProseMirror>h1:hover .heading-anchor,div.ProseMirror h2:hover .heading-anchor,div.ProseMirror h3:hover .heading-anchor,div.ProseMirror h4:hover .heading-anchor,div.ProseMirror h5:hover .heading-anchor,div.ProseMirror h6:hover .heading-anchor{opacity:.5 !important}div.ProseMirror>h1:focus-visible,div.ProseMirror h2:focus-visible,div.ProseMirror h3:focus-visible,div.ProseMirror h4:focus-visible,div.ProseMirror h5:focus-visible,div.ProseMirror h6:focus-visible{outline:none}div.ProseMirror a{color:var(--color-primary-element);text-decoration:underline;padding:.5em 0}div.ProseMirror p{position:relative;margin-bottom:1em;line-height:150%}div.ProseMirror em{font-style:italic}div.ProseMirror h1,div.ProseMirror h2,div.ProseMirror h3,div.ProseMirror h4,div.ProseMirror h5,div.ProseMirror h6{font-weight:600;line-height:1.1em;margin-top:24px;margin-bottom:12px;color:var(--color-main-text)}div.ProseMirror h1{font-size:30px}div.ProseMirror h2{font-size:26px}div.ProseMirror h3{font-size:23px}div.ProseMirror h4{font-size:20px}div.ProseMirror h5{font-size:17px}div.ProseMirror h6{font-size:var(--default-font-size)}div.ProseMirror img{cursor:default;max-width:100%}div.ProseMirror hr{padding:2px 0;border:none;margin:2em 0;width:100%}div.ProseMirror hr:after{content:"";display:block;height:1px;background-color:var(--color-border-dark);line-height:2px}div.ProseMirror pre{white-space:pre-wrap;background-color:var(--color-background-dark);border-radius:var(--border-radius);padding:1em 1.3em;margin-bottom:1em}div.ProseMirror pre::before{content:attr(data-language);text-transform:uppercase;display:block;text-align:right;font-weight:bold;font-size:.6rem}div.ProseMirror pre code .hljs-comment,div.ProseMirror pre code .hljs-quote{color:#999}div.ProseMirror pre code .hljs-variable,div.ProseMirror pre code .hljs-template-variable,div.ProseMirror pre code .hljs-attribute,div.ProseMirror pre code .hljs-tag,div.ProseMirror pre code .hljs-name,div.ProseMirror pre code .hljs-regexp,div.ProseMirror pre code .hljs-link,div.ProseMirror pre code .hljs-selector-id,div.ProseMirror pre code .hljs-selector-class{color:#f2777a}div.ProseMirror pre code .hljs-number,div.ProseMirror pre code .hljs-meta,div.ProseMirror pre code .hljs-built_in,div.ProseMirror pre code .hljs-builtin-name,div.ProseMirror pre code .hljs-literal,div.ProseMirror pre code .hljs-type,div.ProseMirror pre code .hljs-params{color:#f99157}div.ProseMirror pre code .hljs-string,div.ProseMirror pre code .hljs-symbol,div.ProseMirror pre code .hljs-bullet{color:#9c9}div.ProseMirror pre code .hljs-title,div.ProseMirror pre code .hljs-section{color:#fc6}div.ProseMirror pre code .hljs-keyword,div.ProseMirror pre code .hljs-selector-tag{color:#69c}div.ProseMirror pre code .hljs-emphasis{font-style:italic}div.ProseMirror pre code .hljs-strong{font-weight:700}div.ProseMirror pre.frontmatter{margin-bottom:2em;border-left:4px solid var(--color-primary-element)}div.ProseMirror pre.frontmatter::before{display:block;content:attr(data-title);color:var(--color-text-maxcontrast);padding-bottom:.5em}div.ProseMirror p code{background-color:var(--color-background-dark);border-radius:var(--border-radius);padding:.1em .3em}div.ProseMirror li{position:relative;padding-left:3px}div.ProseMirror li p{position:relative;margin-bottom:.5em}div.ProseMirror ul,div.ProseMirror ol{padding-left:10px;margin-left:10px;margin-bottom:1em}div.ProseMirror ul>li{list-style-type:disc}div.ProseMirror li ul>li{list-style-type:circle}div.ProseMirror li li ul>li{list-style-type:square}div.ProseMirror blockquote{padding-left:1em;border-left:4px solid var(--color-primary-element);color:var(--color-text-maxcontrast);margin-left:0;margin-right:0}div.ProseMirror table{border-spacing:0;width:calc(100% - 50px);table-layout:auto;white-space:normal;margin-bottom:1em}div.ProseMirror table+*{margin-top:1em}div.ProseMirror table td,div.ProseMirror table th{border:1px solid var(--table-color-border);border-left:0;vertical-align:top;max-width:100%}div.ProseMirror table td:first-child,div.ProseMirror table th:first-child{border-left:1px solid var(--table-color-border)}div.ProseMirror table td{padding:.5em .75em;border-top:0;color:var(--color-main-text)}div.ProseMirror table th{padding:0 0 0 .75em;font-weight:normal;border-bottom-color:var(--table-color-heading-border);color:var(--table-color-heading)}div.ProseMirror table th>div{display:flex}div.ProseMirror table tr{background-color:var(--table-color-background)}div.ProseMirror table tr:hover,div.ProseMirror table tr:active,div.ProseMirror table tr:focus{background-color:var(--table-color-background-hover)}div.ProseMirror table tr:first-child th:first-child{border-top-left-radius:var(--table-border-radius)}div.ProseMirror table tr:first-child th:last-child{border-top-right-radius:var(--table-border-radius)}div.ProseMirror table tr:last-child td:first-child{border-bottom-left-radius:var(--table-border-radius)}div.ProseMirror table tr:last-child td:last-child{border-bottom-right-radius:var(--table-border-radius)}.ProseMirror-focused .ProseMirror-gapcursor{display:block}.editor__content p.is-empty:first-child::before{content:attr(data-placeholder);float:left;color:var(--color-text-maxcontrast);pointer-events:none;height:0}.editor__content{tab-size:4}.tippy-content div{visibility:visible !important}@media print{@page{size:A4;margin:2.5cm 2cm 2cm 2.5cm}body{position:absolute;overflow:visible !important}#header{display:none !important}#content{display:block !important;position:relative !important;border-radius:0;margin:0;width:100%;height:fit-content}footer{display:none !important}#viewer[data-handler=text]{border:none;width:100% !important;position:absolute !important}#viewer[data-handler=text] .modal-header{display:none !important}#viewer[data-handler=text] .modal-container{top:0px;height:fit-content}.text-editor{height:fit-content !important}.text-editor .text-menubar{display:none !important}.text-editor .action-item{display:none !important}.text-editor .editor__content{max-width:100%}.text-editor .text-editor__wrapper{height:fit-content;position:unset}.text-editor .text-editor__wrapper div.ProseMirror{margin-top:0;margin-bottom:0;padding-top:0;padding-bottom:0}.text-editor .text-editor__wrapper div.ProseMirror h1,.text-editor .text-editor__wrapper div.ProseMirror h2,.text-editor .text-editor__wrapper div.ProseMirror h3,.text-editor .text-editor__wrapper div.ProseMirror h4,.text-editor .text-editor__wrapper div.ProseMirror h5{break-after:avoid;page-break-after:avoid}.text-editor .text-editor__wrapper div.ProseMirror .image,.text-editor .text-editor__wrapper div.ProseMirror img,.text-editor .text-editor__wrapper div.ProseMirror table{break-inside:avoid-page;page-break-inside:avoid;max-width:90% !important;margin:5vw auto 5vw 5% !important}.text-editor .text-editor__wrapper div.ProseMirror th{color:#000 !important;font-weight:bold !important;border-width:0 1px 2px 0 !important;border-color:gray !important;border-style:none solid solid none !important}.text-editor .text-editor__wrapper div.ProseMirror th:last-of-type{border-width:0 0 2px 0 !important}.text-editor .text-editor__wrapper div.ProseMirror td{border-style:none solid none none !important;border-width:1px !important;border-color:gray !important}.text-editor .text-editor__wrapper div.ProseMirror td:last-of-type{border:none !important}.menubar-placeholder,.text-editor--readonly-bar{display:none}.text-editor__content-wrapper.--show-outline{display:block}.text-editor__content-wrapper .editor--outline{width:auto;height:auto;overflow:unset;position:relative}.text-editor__content-wrapper .editor--outline__btn-close{display:none}.collaboration-cursor__caret,.collaboration-cursor__label{display:none}}`,"",{version:3,sources:["webpack://./src/css/prosemirror.scss","webpack://./src/css/print.scss"],names:[],mappings:"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",sourceRoot:""}]);const p=d},5867:(e,t,r)=>{r.d(t,{A:()=>a});var o=r(71354),i=r.n(o),n=r(76314),s=r.n(n)()(i());s.push([e.id,'#rich-workspace[data-v-3cf545d8]{padding:0 50px;margin-bottom:-24px;text-align:left;max-height:0;transition:max-height .5s cubic-bezier(0, 1, 0, 1);z-index:61;position:relative}.rich-workspace--preview[data-v-3cf545d8]{margin-top:44px}.rich-workspace--preview[data-v-3cf545d8] div[contenteditable="false"]{margin:0}#rich-workspace[data-v-3cf545d8]:only-child{margin-bottom:0}.empty-workspace[data-v-3cf545d8]{cursor:pointer;display:block;padding-top:43px;color:var(--color-text-maxcontrast)}#rich-workspace[data-v-3cf545d8] div[contenteditable=false]{width:100%;padding:0px;background-color:var(--color-main-background);opacity:1;border:none}#rich-workspace[data-v-3cf545d8] .text-editor{height:100%;position:unset !important;top:auto !important}#rich-workspace[data-v-3cf545d8] .text-editor__wrapper{position:unset !important;overflow:visible}#rich-workspace[data-v-3cf545d8] .text-editor__main{overflow:visible !important}#rich-workspace[data-v-3cf545d8] .content-wrapper{overflow:scroll !important;max-height:calc(40vh - 50px);padding-left:10px;padding-bottom:10px}#rich-workspace[data-v-3cf545d8] .text-editor__wrapper .ProseMirror{padding:0px;margin:0}#rich-workspace[data-v-3cf545d8] .table-wrapper .content tr th,#rich-workspace[data-v-3cf545d8] .table-wrapper .content tr td{flex-grow:1}#rich-workspace[data-v-3cf545d8] .table-wrapper .content tr th div{width:100%}#rich-workspace[data-v-3cf545d8] .table-wrapper .content tr th .action-item div{display:flex;justify-content:flex-end}#rich-workspace[data-v-3cf545d8] .editor__content{margin:0}#rich-workspace.focus[data-v-3cf545d8]{max-height:50vh}#rich-workspace[data-v-3cf545d8]:not(.focus){max-height:30vh;position:relative;overflow:hidden}#rich-workspace[data-v-3cf545d8]:not(.focus):not(.empty):after{content:"";position:absolute;z-index:1;bottom:0;left:0;pointer-events:none;background-image:linear-gradient(to bottom, rgba(255, 255, 255, 0), var(--color-main-background));width:100%;height:4em}#rich-workspace.dark[data-v-3cf545d8]:not(.focus):after{background-image:linear-gradient(to bottom, rgba(0, 0, 0, 0), var(--color-main-background))}@media only screen and (max-width: 1024px){#rich-workspace[data-v-3cf545d8]:not(.focus){max-height:30vh}}',"",{version:3,sources:["webpack://./src/views/RichWorkspace.vue"],names:[],mappings:"AACA,iCACC,cAAA,CAEA,mBAAA,CACA,eAAA,CACA,YAAA,CACA,kDAAA,CACA,UAAA,CACA,iBAAA,CAGD,0CACC,eAAA,CAEA,uEACC,QAAA,CAKF,4CACC,eAAA,CAGD,kCACC,cAAA,CACA,aAAA,CACA,gBAAA,CACA,mCAAA,CAGD,4DACC,UAAA,CACA,WAAA,CACA,6CAAA,CACA,SAAA,CACA,WAAA,CAGD,8CACC,WAAA,CACA,yBAAA,CACA,mBAAA,CAGD,uDACC,yBAAA,CACA,gBAAA,CAGD,oDACC,2BAAA,CAGD,kDACC,0BAAA,CACA,4BAAA,CACA,iBAAA,CACA,mBAAA,CAGD,oEACC,WAAA,CACA,QAAA,CAKC,8HACC,WAAA,CAIA,mEACC,UAAA,CAGD,gFACC,YAAA,CACA,wBAAA,CAMJ,kDACC,QAAA,CAGD,uCACC,eAAA,CAGD,6CACC,eAAA,CACA,iBAAA,CACA,eAAA,CAGD,+DACC,UAAA,CACA,iBAAA,CACA,SAAA,CACA,QAAA,CACA,MAAA,CACA,mBAAA,CACA,iGAAA,CACA,UAAA,CACA,UAAA,CAGD,wDACC,2FAAA,CAGD,2CACC,6CACC,eAAA,CAAA",sourceRoot:""}]);const a=s},61395:(e,t,r)=>{r.d(t,{A:()=>k});var o=r(52781),i=r(58294),n=r(73590),s=r(51594),a=r(599);const A={name:"BaseReader",components:{EditorContent:i.$Z,EditorOutline:a.A},mixins:[s.yc,s.xU],provide(){const e={};return Object.defineProperties(e,{[n.qS]:{get:()=>this.$editor}}),e},inject:["renderHtml","extensions"],props:{content:{type:String,required:!0}},computed:{htmlContent(){return this.renderHtml(this.content)},showOutline(){return this.$outlineState.visible}},watch:{content(){this.updateContent()}},created(){this.$editor=this.createEditor(),this.$editor.setEditable(!1)},beforeDestroy(){this.$editor.destroy()},methods:{createEditor(){return new o.KE({content:this.htmlContent,extensions:this.extensions()})},updateContent(){this.$editor.commands.setContent(this.htmlContent,!0)}}};var l=r(85072),d=r.n(l),c=r(97825),p=r.n(c),h=r(77659),C=r.n(h),f=r(55056),u=r.n(f),m=r(10540),v=r.n(m),g=r(41113),b=r.n(g),w=r(33909),y={};y.styleTagTransform=b(),y.setAttributes=u(),y.insert=C().bind(null,"head"),y.domAPI=p(),y.insertStyleElement=v();d()(w.A,y);w.A&&w.A.locals&&w.A.locals;const k=(0,r(14486).A)(A,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"content-wrapper text-editor__content-wrapper",class:{"--show-outline":e.showOutline},attrs:{"data-text-el":"editor-content-wrapper"}},[e.showOutline?t("div",{staticClass:"text-editor__content-wrapper__left"},[t("EditorOutline")],1):e._e(),e._v(" "),e.$editor?t("EditorContent",{staticClass:"editor__content text-editor__content",attrs:{id:"read-only-editor",editor:e.$editor}}):e._e(),e._v(" "),t("div",{staticClass:"text-editor__content-wrapper__right"})],1)}),[],!1,null,"151c6c0d",null).exports},66104:(e,t,r)=>{r.d(t,{A:()=>w});var o=r(61395),i=r(78841),n=r(32931);const s={name:"RichTextReader",components:{BaseReader:o.A},provide:{renderHtml:e=>n.A.render(e),extensions:()=>[i.sD.configure({editing:!1})]},props:{content:{type:String,required:!0}}};var a=r(85072),A=r.n(a),l=r(97825),d=r.n(l),c=r(77659),p=r.n(c),h=r(55056),C=r.n(h),f=r(10540),u=r.n(f),m=r(41113),v=r.n(m),g=r(17142),b={};b.styleTagTransform=v(),b.setAttributes=C(),b.insert=p().bind(null,"head"),b.domAPI=d(),b.insertStyleElement=u();A()(g.A,b);g.A&&g.A.locals&&g.A.locals;const w=(0,r(14486).A)(s,(function(){var e=this;return(0,e._self._c)("BaseReader",{attrs:{content:e.content},on:{"click-link":(t,r)=>e.$emit("click-link",t,r)}})}),[],!1,null,null,null).exports},81075:(e,t,r)=>{r.d(t,{default:()=>M});var o=r(70715),i=r(63814),n=r(61338);var s=r(66104);const a=!!document.getElementById("isPublic"),A=(0,i.KT)("apps/text"+(a?"/public":"")+"/workspace",2),l=["Readme.md","README.md","readme.md"],d={name:"RichWorkspace",components:{RichTextReader:s.A,Editor:async function(){if(!window._nc_text_editor_instance){if(window._nc_text_editor_importing)return await new Promise((e=>{const t=setInterval((()=>{window._nc_text_editor_instance&&(e(window._nc_text_editor_instance),clearInterval(t))}),200)}));window._nc_text_editor_importing=!0;const e=await Promise.all([r.e("mermaid"),r.e("vendors-node_modules_nextcloud_vue_dist_index_mjs"),r.e("vendors-node_modules_braintree_sanitize-url_dist_index_js-node_modules_quartzy_markdown-it-me-60d959"),r.e("vendors-node_modules_node-polyfill-webpack-plugin_node_modules_path-browserify_index_js-node_-752ce4"),r.e("vendors-node_modules_nextcloud_logger_dist_index_js"),r.e("vendors-node_modules_path-normalize_lib_index_js-node_modules_proxy-polyfill_src_index_js-nod-9ba2e2"),r.e("src_extensions_index_js-src_components_Editor_EditorOutline_vue-data_image_svg_xml_3c_21--_20-ee52b2"),r.e("editor")]).then(r.bind(r,69278)),{default:t}=await Promise.resolve().then(r.bind(r,85471));t.prototype.t=window.t,t.prototype.OCA=window.OCA;const o=t.extend(e.default);window._nc_text_editor_instance=o}return window._nc_text_editor_instance}},props:{content:{type:String,default:""},path:{type:String,required:!0},active:{type:Boolean,default:!0},hasRichWorkspace:{type:Boolean,default:!1}},data:()=>({localHasRichWorkspace:!1,focus:!1,folder:null,file:null,loaded:!1,ready:!1,autofocus:!1,hideMenu:!0,darkTheme:OCA.Accessibility&&"dark"===OCA.Accessibility.theme,enabled:OCA.Text.RichWorkspaceEnabled}),computed:{shareToken:()=>document.getElementById("sharingToken")?.value},watch:{path(){this.getFileInfo()},focus(e){e||document.querySelector("#rich-workspace .text-editor__main").scrollTo(0,0)},hasRichWorkspace(e){this.localHasRichWorkspace=e}},mounted(){this.localHasRichWorkspace=this.hasRichWorkspace,this.enabled&&this.hasRichWorkspace&&this.getFileInfo(),(0,n.B1)("Text::showRichWorkspace",this.showRichWorkspace),(0,n.B1)("Text::hideRichWorkspace",this.hideRichWorkspace),(0,n.B1)("files:node:created",this.onFileCreated),(0,n.B1)("files:node:deleted",this.onFileDeleted),(0,n.B1)("files:node:renamed",this.onFileRenamed),this.listenKeydownEvents()},beforeDestroy(){(0,n.al)("Text::showRichWorkspace",this.showRichWorkspace),(0,n.al)("Text::hideRichWorkspace",this.hideRichWorkspace),(0,n.al)("files:node:created",this.onFileCreated),(0,n.al)("files:node:deleted",this.onFileDeleted),(0,n.al)("files:node:renamed",this.onFileRenamed),this.unlistenKeydownEvents()},methods:{onFocus(){this.focus=!0,this.hideMenu=!1,this.unlistenKeydownEvents()},reset(){this.localHasRichWorkspace=!1,this.file=null,this.focus=!1,this.$nextTick((()=>{this.creating=!1,this.getFileInfo()}))},getFileInfo(e){if(!this.enabled)return;this.file=null,this.ready=!1,this.loaded=!0,this.autofocus=!1;const t={path:this.path};return a&&(t.shareToken=this.shareToken),o.Ay.get(A,{params:t}).then((t=>{const r=t.data.ocs.data;return this.folder=r.folder||null,this.file=r.file,this.editing=!0,this.loaded=!0,this.autofocus=e||!1,this.localHasRichWorkspace=!0,!0})).catch((e=>(e.response.data.ocs&&e.response.data.ocs.data.folder?this.folder=e.response.data.ocs.data.folder:this.folder=null,this.file=null,this.loaded=!0,this.ready=!0,this.creating=!1,!1)))},showRichWorkspace(e){this.enabled=!0,this.getFileInfo(e?.autofocus||!1)},hideRichWorkspace(){this.enabled=!1},listenKeydownEvents(){window.addEventListener("keydown",this.onKeydown)},unlistenKeydownEvents(){window.removeEventListener("keydown",this.onKeydown)},onKeydown(e){"Tab"===e.key&&(this.hideMenu=!1)},onFileCreated(e){l.includes(e.basename)&&(this.localHasRichWorkspace=!0,this.getFileInfo(!0))},onFileDeleted(e){e.path===this.file?.path&&(this.localHasRichWorkspace=!1)},onFileRenamed(e){l.includes(e.basename)?this.localHasRichWorkspace=!0:e.fileid===this.file?.id&&e.path!==this.file?.path&&(this.localHasRichWorkspace=!1)}}};var c=r(85072),p=r.n(c),h=r(97825),C=r.n(h),f=r(77659),u=r.n(f),m=r(55056),v=r.n(m),g=r(10540),b=r.n(g),w=r(41113),y=r.n(w),k=r(5867),x={};x.styleTagTransform=y(),x.setAttributes=v(),x.insert=u().bind(null,"head"),x.domAPI=C(),x.insertStyleElement=b();p()(k.A,x);k.A&&k.A.locals&&k.A.locals;const M=(0,r(14486).A)(d,(function(){var e=this,t=e._self._c;return e.enabled&&e.localHasRichWorkspace?t("div",{class:{focus:e.focus,dark:e.darkTheme},attrs:{id:"rich-workspace"}},[e.loaded&&e.ready?e._e():t("RichTextReader",{staticClass:"rich-workspace--preview",attrs:{content:e.content}}),e._v(" "),e.file?t("Editor",{directives:[{name:"show",rawName:"v-show",value:e.ready,expression:"ready"}],key:e.file.path,attrs:{"file-id":e.file.id,"relative-path":e.file.path,"share-token":e.shareToken,mime:e.file.mimetype,autofocus:e.autofocus,"hide-menu":e.hideMenu,active:"","rich-workspace":""},on:{ready:function(t){e.ready=!0},focus:e.onFocus,error:e.reset}}):e._e()],1):e._e()}),[],!1,null,"3cf545d8",null).exports},16343:(e,t,r)=>{r.d(t,{a:()=>l,e:()=>A,g:()=>d,s:()=>c});var o=r(59097),i=r(43850),n=r(24715);const s=(0,o.getBuilder)("nextcloud-vue").persist(!0).build();let a;function A(e,t=10){a||(a=new i.EmojiIndex(n));const r=d();let o;return e?(o=a.search(`:${e}`,t),o.length<t&&(o=o.concat(a.search(e,t-o.length)))):o=i.frequently.get(t).map((e=>a.emoji(e)))||[],o.map((e=>e.getSkin(r)))}function l(e){i.frequently.add(e)}function d(){const e=Number.parseInt(s.getItem("NcEmojiPicker::currentSkinTone")??"1");return Math.min(Math.max(e,1),6)}function c(e){e=Math.min(Math.max(e,1),6),s.setItem("NcEmojiPicker::currentSkinTone",e.toString())}},38262:(e,t,r)=>{r.d(t,{$L:()=>R,Ln:()=>m,N0:()=>S,Um:()=>E,Wg:()=>v,dL:()=>U,jP:()=>y,n9:()=>P,oM:()=>k,zy:()=>B});var o=r(58903);const i=Math.pow(2,16);function n(e){return 65535&e}class s{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(8&this.delInfo)>0}get deletedBefore(){return(5&this.delInfo)>0}get deletedAfter(){return(6&this.delInfo)>0}get deletedAcross(){return(4&this.delInfo)>0}}class a{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&a.empty)return a.empty}recover(e){let t=0,r=n(e);if(!this.inverted)for(let e=0;e<r;e++)t+=this.ranges[3*e+2]-this.ranges[3*e+1];return this.ranges[3*r]+t+function(e){return(e-(65535&e))/i}(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let o=0,n=this.inverted?2:1,a=this.inverted?1:2;for(let A=0;A<this.ranges.length;A+=3){let l=this.ranges[A]-(this.inverted?o:0);if(l>e)break;let d=this.ranges[A+n],c=this.ranges[A+a],p=l+d;if(e<=p){let n=l+o+((d?e==l?-1:e==p?1:t:t)<0?0:c);if(r)return n;let a=e==(t<0?l:p)?null:A/3+(e-l)*i,h=e==l?2:e==p?1:4;return(t<0?e!=l:e!=p)&&(h|=8),new s(n,h,a)}o+=c-d}return r?e+o:new s(e+o,0,null)}touches(e,t){let r=0,o=n(t),i=this.inverted?2:1,s=this.inverted?1:2;for(let t=0;t<this.ranges.length;t+=3){let n=this.ranges[t]-(this.inverted?r:0);if(n>e)break;let a=this.ranges[t+i];if(e<=n+a&&t==3*o)return!0;r+=this.ranges[t+s]-a}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let o=0,i=0;o<this.ranges.length;o+=3){let n=this.ranges[o],s=n-(this.inverted?i:0),a=n+(this.inverted?0:i),A=this.ranges[o+t],l=this.ranges[o+r];e(s,s+A,a,a+l),i+=l-A}}invert(){return new a(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return 0==e?a.empty:new a(e<0?[0,-e,0]:[0,0,e])}}a.empty=new a([]);class A{constructor(e=[],t,r=0,o=e.length){this.maps=e,this.mirror=t,this.from=r,this.to=o}slice(e=0,t=this.maps.length){return new A(this.maps,this.mirror,e,t)}copy(){return new A(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(e,t){this.to=this.maps.push(e),null!=t&&this.setMirror(this.maps.length-1,t)}appendMapping(e){for(let t=0,r=this.maps.length;t<e.maps.length;t++){let o=e.getMirror(t);this.appendMap(e.maps[t],null!=o&&o<t?r+o:void 0)}}getMirror(e){if(this.mirror)for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,r=this.maps.length+e.maps.length;t>=0;t--){let o=e.getMirror(t);this.appendMap(e.maps[t].invert(),null!=o&&o>t?r-o-1:void 0)}}invert(){let e=new A;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let r=this.from;r<this.to;r++)e=this.maps[r].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,r){let o=0;for(let r=this.from;r<this.to;r++){let i=this.maps[r].mapResult(e,t);if(null!=i.recover){let t=this.getMirror(r);if(null!=t&&t>r&&t<this.to){r=t,e=this.maps[t].recover(i.recover);continue}}o|=i.delInfo,e=i.pos}return r?e:new s(e,o,null)}}const l=Object.create(null);class d{getMap(){return a.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=l[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in l)throw new RangeError("Duplicate use of step JSON ID "+e);return l[e]=t,t.prototype.jsonID=e,t}}class c{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new c(e,null)}static fail(e){return new c(null,e)}static fromReplace(e,t,r,i){try{return c.ok(e.replace(t,r,i))}catch(e){if(e instanceof o.vI)return c.fail(e.message);throw e}}}function p(e,t,r){let i=[];for(let o=0;o<e.childCount;o++){let n=e.child(o);n.content.size&&(n=n.copy(p(n.content,t,n))),n.isInline&&(n=t(n,r,o)),i.push(n)}return o.FK.fromArray(i)}class h extends d{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),n=new o.Ji(p(t.content,((e,t)=>e.isAtom&&t.type.allowsMarkType(this.mark.type)?e.mark(this.mark.addToSet(e.marks)):e),i),t.openStart,t.openEnd);return c.fromReplace(e,this.from,this.to,n)}invert(){return new C(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new h(t.pos,r.pos,this.mark)}merge(e){return e instanceof h&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new h(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new h(t.from,t.to,e.markFromJSON(t.mark))}}d.jsonID("addMark",h);class C extends d{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new o.Ji(p(t.content,(e=>e.mark(this.mark.removeFromSet(e.marks))),e),t.openStart,t.openEnd);return c.fromReplace(e,this.from,this.to,r)}invert(){return new h(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new C(t.pos,r.pos,this.mark)}merge(e){return e instanceof C&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new C(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new C(t.from,t.to,e.markFromJSON(t.mark))}}d.jsonID("removeMark",C);class f extends d{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return c.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return c.fromReplace(e,this.pos,this.pos+1,new o.Ji(o.FK.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let e=this.mark.addToSet(t.marks);if(e.length==t.marks.length){for(let r=0;r<t.marks.length;r++)if(!t.marks[r].isInSet(e))return new f(this.pos,t.marks[r]);return new f(this.pos,this.mark)}}return new u(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new f(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if("number"!=typeof t.pos)throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new f(t.pos,e.markFromJSON(t.mark))}}d.jsonID("addNodeMark",f);class u extends d{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return c.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return c.fromReplace(e,this.pos,this.pos+1,new o.Ji(o.FK.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return t&&this.mark.isInSet(t.marks)?new f(this.pos,this.mark):this}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new u(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if("number"!=typeof t.pos)throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new u(t.pos,e.markFromJSON(t.mark))}}d.jsonID("removeNodeMark",u);class m extends d{constructor(e,t,r,o=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=o}apply(e){return this.structure&&g(e,this.from,this.to)?c.fail("Structure replace would overwrite content"):c.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new a([this.from,this.to-this.from,this.slice.size])}invert(e){return new m(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new m(t.pos,Math.max(t.pos,r.pos),this.slice)}merge(e){if(!(e instanceof m)||e.structure||this.structure)return null;if(this.from+this.slice.size!=e.from||this.slice.openEnd||e.slice.openStart){if(e.to!=this.from||this.slice.openStart||e.slice.openEnd)return null;{let t=this.slice.size+e.slice.size==0?o.Ji.empty:new o.Ji(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new m(e.from,this.to,t,this.structure)}}{let t=this.slice.size+e.slice.size==0?o.Ji.empty:new o.Ji(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new m(this.from,this.to+(e.to-e.from),t,this.structure)}}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new m(t.from,t.to,o.Ji.fromJSON(e,t.slice),!!t.structure)}}d.jsonID("replace",m);class v extends d{constructor(e,t,r,o,i,n,s=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=o,this.slice=i,this.insert=n,this.structure=s}apply(e){if(this.structure&&(g(e,this.from,this.gapFrom)||g(e,this.gapTo,this.to)))return c.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return c.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?c.fromReplace(e,this.from,this.to,r):c.fail("Content does not fit in gap")}getMap(){return new a([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new v(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),o=this.from==this.gapFrom?t.pos:e.map(this.gapFrom,-1),i=this.to==this.gapTo?r.pos:e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||o<t.pos||i>r.pos?null:new v(t.pos,r.pos,o,i,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to||"number"!=typeof t.gapFrom||"number"!=typeof t.gapTo||"number"!=typeof t.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new v(t.from,t.to,t.gapFrom,t.gapTo,o.Ji.fromJSON(e,t.slice),t.insert,!!t.structure)}}function g(e,t,r){let o=e.resolve(t),i=r-t,n=o.depth;for(;i>0&&n>0&&o.indexAfter(n)==o.node(n).childCount;)n--,i--;if(i>0){let e=o.node(n).maybeChild(o.indexAfter(n));for(;i>0;){if(!e||e.isLeaf)return!0;e=e.firstChild,i--}}return!1}function b(e,t,r,i=r.contentMatch,n=!0){let s=e.doc.nodeAt(t),a=[],A=t+1;for(let t=0;t<s.childCount;t++){let l=s.child(t),d=A+l.nodeSize,c=i.matchType(l.type);if(c){i=c;for(let t=0;t<l.marks.length;t++)r.allowsMarkType(l.marks[t].type)||e.step(new C(A,d,l.marks[t]));if(n&&l.isText&&"pre"!=r.whitespace){let e,t,i=/\r?\n|\r/g;for(;e=i.exec(l.text);)t||(t=new o.Ji(o.FK.from(r.schema.text(" ",r.allowedMarks(l.marks))),0,0)),a.push(new m(A+e.index,A+e.index+e[0].length,t))}}else a.push(new m(A,d,o.Ji.empty));A=d}if(!i.validEnd){let t=i.fillBefore(o.FK.empty,!0);e.replace(A,A,new o.Ji(t,0,0))}for(let t=a.length-1;t>=0;t--)e.step(a[t])}function w(e,t,r){return(0==t||e.canReplace(t,e.childCount))&&(r==e.childCount||e.canReplace(0,r))}function y(e){let t=e.parent.content.cutByIndex(e.startIndex,e.endIndex);for(let r=e.depth;;--r){let o=e.$from.node(r),i=e.$from.index(r),n=e.$to.indexAfter(r);if(r<e.depth&&o.canReplace(i,n,t))return r;if(0==r||o.type.spec.isolating||!w(o,i,n))break}return null}function k(e,t,r=null,o=e){let i=function(e,t){let{parent:r,startIndex:o,endIndex:i}=e,n=r.contentMatchAt(o).findWrapping(t);if(!n)return null;let s=n.length?n[0]:t;return r.canReplaceWith(o,i,s)?n:null}(e,t),n=i&&function(e,t){let{parent:r,startIndex:o,endIndex:i}=e,n=r.child(o),s=t.contentMatch.findWrapping(n.type);if(!s)return null;let a=(s.length?s[s.length-1]:t).contentMatch;for(let e=o;a&&e<i;e++)a=a.matchType(r.child(e).type);return a&&a.validEnd?s:null}(o,t);return n?i.map(x).concat({type:t,attrs:r}).concat(n.map(x)):null}function x(e){return{type:e,attrs:null}}function M(e,t,r,o){t.forEach(((i,n)=>{if(i.isText){let s,a=/\r?\n|\r/g;for(;s=a.exec(i.text);){let i=e.mapping.slice(o).map(r+1+n+s.index);e.replaceWith(i,i+1,t.type.schema.linebreakReplacement.create())}}}))}function _(e,t,r,o){t.forEach(((i,n)=>{if(i.type==i.type.schema.linebreakReplacement){let i=e.mapping.slice(o).map(r+1+n);e.replaceWith(i,i+1,t.type.schema.text("\n"))}}))}function B(e,t,r=1,o){let i=e.resolve(t),n=i.depth-r,s=o&&o[o.length-1]||i.parent;if(n<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!s.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let e=i.depth-1,t=r-2;e>n;e--,t--){let r=i.node(e),n=i.index(e);if(r.type.spec.isolating)return!1;let s=r.content.cutByIndex(n,r.childCount),a=o&&o[t+1];a&&(s=s.replaceChild(0,a.type.create(a.attrs)));let A=o&&o[t]||r;if(!r.canReplace(n+1,r.childCount)||!A.type.validContent(s))return!1}let a=i.indexAfter(n),A=o&&o[0];return i.node(n).canReplaceWith(a,a,A?A.type:i.node(n+1).type)}function P(e,t){let r=e.resolve(t),o=r.index();return D(r.nodeBefore,r.nodeAfter)&&r.parent.canReplace(o,o+1)}function D(e,t){return!(!e||!t||e.isLeaf||!function(e,t){t.content.size||e.type.compatibleContent(t.type);let r=e.contentMatchAt(e.childCount),{linebreakReplacement:o}=e.type.schema;for(let i=0;i<t.childCount;i++){let n=t.child(i),s=n.type==o?e.type.schema.nodes.text:n.type;if(r=r.matchType(s),!r)return!1;if(!e.type.allowsMarks(n.marks))return!1}return r.validEnd}(e,t))}function S(e,t,r=-1){let o=e.resolve(t);for(let e=o.depth;;e--){let i,n,s=o.index(e);if(e==o.depth?(i=o.nodeBefore,n=o.nodeAfter):r>0?(i=o.node(e+1),s++,n=o.node(e).maybeChild(s)):(i=o.node(e).maybeChild(s-1),n=o.node(e+1)),i&&!i.isTextblock&&D(i,n)&&o.node(e).canReplace(s,s+1))return t;if(0==e)break;t=r<0?o.before(e):o.after(e)}}function E(e,t,r){let o=e.resolve(t);if(!r.content.size)return t;let i=r.content;for(let e=0;e<r.openStart;e++)i=i.firstChild.content;for(let e=1;e<=(0==r.openStart&&r.size?2:1);e++)for(let t=o.depth;t>=0;t--){let r=t==o.depth?0:o.pos<=(o.start(t+1)+o.end(t+1))/2?-1:1,n=o.index(t)+(r>0?1:0),s=o.node(t),a=!1;if(1==e)a=s.canReplace(n,n,i);else{let e=s.contentMatchAt(n).findWrapping(i.firstChild.type);a=e&&s.canReplaceWith(n,n,e[0])}if(a)return 0==r?o.pos:r<0?o.before(t+1):o.after(t+1)}return null}function R(e,t,r=t,i=o.Ji.empty){if(t==r&&!i.size)return null;let n=e.resolve(t),s=e.resolve(r);return F(n,s,i)?new m(t,r,i):new I(n,s,i).fit()}function F(e,t,r){return!r.openStart&&!r.openEnd&&e.start()==t.start()&&e.parent.canReplace(e.index(),t.index(),r.content)}d.jsonID("replaceAround",v);class I{constructor(e,t,r){this.$from=e,this.$to=t,this.unplaced=r,this.frontier=[],this.placed=o.FK.empty;for(let t=0;t<=e.depth;t++){let r=e.node(t);this.frontier.push({type:r.type,match:r.contentMatchAt(e.indexAfter(t))})}for(let t=e.depth;t>0;t--)this.placed=o.FK.from(e.node(t).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let e=this.findFittable();e?this.placeNodes(e):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(e<0?this.$to:r.doc.resolve(e));if(!i)return null;let n=this.placed,s=r.depth,a=i.depth;for(;s&&a&&1==n.childCount;)n=n.firstChild.content,s--,a--;let A=new o.Ji(n,s,a);return e>-1?new v(r.pos,e,this.$to.pos,this.$to.end(),A,t):A.size||r.pos!=this.$to.pos?new m(r.pos,i.pos,A):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,r=0,o=this.unplaced.openEnd;r<e;r++){let i=t.firstChild;if(t.childCount>1&&(o=0),i.type.spec.isolating&&o<=r){e=r;break}t=i.content}for(let t=1;t<=2;t++)for(let r=1==t?e:this.unplaced.openStart;r>=0;r--){let e,i=null;r?(i=N(this.unplaced.content,r-1).firstChild,e=i.content):e=this.unplaced.content;let n=e.firstChild;for(let e=this.depth;e>=0;e--){let s,{type:a,match:A}=this.frontier[e],l=null;if(1==t&&(n?A.matchType(n.type)||(l=A.fillBefore(o.FK.from(n),!1)):i&&a.compatibleContent(i.type)))return{sliceDepth:r,frontierDepth:e,parent:i,inject:l};if(2==t&&n&&(s=A.findWrapping(n.type)))return{sliceDepth:r,frontierDepth:e,parent:i,wrap:s};if(i&&A.matchType(i.type))break}}}openMore(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=N(e,t);return!(!i.childCount||i.firstChild.isLeaf)&&(this.unplaced=new o.Ji(e,t+1,Math.max(r,i.size+t>=e.size-r?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=N(e,t);if(i.childCount<=1&&t>0){let n=e.size-t<=t+i.size;this.unplaced=new o.Ji(T(e,t-1,1),t-1,n?t-1:r)}else this.unplaced=new o.Ji(T(e,t,1),t,r)}placeNodes({sliceDepth:e,frontierDepth:t,parent:r,inject:i,wrap:n}){for(;this.depth>t;)this.closeFrontierNode();if(n)for(let e=0;e<n.length;e++)this.openFrontierNode(n[e]);let s=this.unplaced,a=r?r.content:s.content,A=s.openStart-e,l=0,d=[],{match:c,type:p}=this.frontier[t];if(i){for(let e=0;e<i.childCount;e++)d.push(i.child(e));c=c.matchFragment(i)}let h=a.size+e-(s.content.size-s.openEnd);for(;l<a.childCount;){let e=a.child(l),t=c.matchType(e.type);if(!t)break;l++,(l>1||0==A||e.content.size)&&(c=t,d.push(j(e.mark(p.allowedMarks(e.marks)),1==l?A:0,l==a.childCount?h:-1)))}let C=l==a.childCount;C||(h=-1),this.placed=J(this.placed,t,o.FK.from(d)),this.frontier[t].match=c,C&&h<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let e=0,t=a;e<h;e++){let e=t.lastChild;this.frontier.push({type:e.type,match:e.contentMatchAt(e.childCount)}),t=e.content}this.unplaced=C?0==e?o.Ji.empty:new o.Ji(T(s.content,e-1,1),e-1,h<0?s.openEnd:e-1):new o.Ji(T(s.content,e,l),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e,t=this.frontier[this.depth];if(!t.type.isTextblock||!O(this.$to,this.$to.depth,t.type,t.match,!1)||this.$to.depth==this.depth&&(e=this.findCloseLevel(this.$to))&&e.depth==this.depth)return-1;let{depth:r}=this.$to,o=this.$to.after(r);for(;r>1&&o==this.$to.end(--r);)++o;return o}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:r,type:o}=this.frontier[t],i=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),n=O(e,t,o,r,i);if(n){for(let r=t-1;r>=0;r--){let{match:t,type:o}=this.frontier[r],i=O(e,r,o,t,!0);if(!i||i.childCount)continue e}return{depth:t,fit:n,move:i?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=J(this.placed,t.depth,t.fit)),e=t.move;for(let r=t.depth+1;r<=e.depth;r++){let t=e.node(r),o=t.type.contentMatch.fillBefore(t.content,!0,e.index(r));this.openFrontierNode(t.type,t.attrs,o)}return e}openFrontierNode(e,t=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=J(this.placed,this.depth,o.FK.from(e.create(t,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let e=this.frontier.pop().match.fillBefore(o.FK.empty,!0);e.childCount&&(this.placed=J(this.placed,this.frontier.length,e))}}function T(e,t,r){return 0==t?e.cutByIndex(r,e.childCount):e.replaceChild(0,e.firstChild.copy(T(e.firstChild.content,t-1,r)))}function J(e,t,r){return 0==t?e.append(r):e.replaceChild(e.childCount-1,e.lastChild.copy(J(e.lastChild.content,t-1,r)))}function N(e,t){for(let r=0;r<t;r++)e=e.firstChild.content;return e}function j(e,t,r){if(t<=0)return e;let i=e.content;return t>1&&(i=i.replaceChild(0,j(i.firstChild,t-1,1==i.childCount?r-1:0))),t>0&&(i=e.type.contentMatch.fillBefore(i).append(i),r<=0&&(i=i.append(e.type.contentMatch.matchFragment(i).fillBefore(o.FK.empty,!0)))),e.copy(i)}function O(e,t,r,o,i){let n=e.node(t),s=i?e.indexAfter(t):e.index(t);if(s==n.childCount&&!r.compatibleContent(n.type))return null;let a=o.fillBefore(n.content,!0,s);return a&&!function(e,t,r){for(let o=r;o<t.childCount;o++)if(!e.allowsMarks(t.child(o).marks))return!0;return!1}(r,n.content,s)?a:null}function W(e,t,r,i,n){if(t<r){let o=e.firstChild;e=e.replaceChild(0,o.copy(W(o.content,t+1,r,i,o)))}if(t>i){let t=n.contentMatchAt(0),r=t.fillBefore(e).append(e);e=r.append(t.matchFragment(r).fillBefore(o.FK.empty,!0))}return e}function z(e,t){let r=[];for(let o=Math.min(e.depth,t.depth);o>=0;o--){let i=e.start(o);if(i<e.pos-(e.depth-o)||t.end(o)>t.pos+(t.depth-o)||e.node(o).type.spec.isolating||t.node(o).type.spec.isolating)break;(i==t.start(o)||o==e.depth&&o==t.depth&&e.parent.inlineContent&&t.parent.inlineContent&&o&&t.start(o-1)==i-1)&&r.push(o)}return r}class G extends d{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return c.fail("No node at attribute step's position");let r=Object.create(null);for(let e in t.attrs)r[e]=t.attrs[e];r[this.attr]=this.value;let i=t.type.create(r,null,t.marks);return c.fromReplace(e,this.pos,this.pos+1,new o.Ji(o.FK.from(i),0,t.isLeaf?0:1))}getMap(){return a.empty}invert(e){return new G(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new G(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if("number"!=typeof t.pos||"string"!=typeof t.attr)throw new RangeError("Invalid input for AttrStep.fromJSON");return new G(t.pos,t.attr,t.value)}}d.jsonID("attr",G);class K extends d{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let r in e.attrs)t[r]=e.attrs[r];t[this.attr]=this.value;let r=e.type.create(t,e.content,e.marks);return c.ok(r)}getMap(){return a.empty}invert(e){return new K(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if("string"!=typeof t.attr)throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new K(t.attr,t.value)}}d.jsonID("docAttr",K);let $=class extends Error{};$=function e(t){let r=Error.call(this,t);return r.__proto__=e.prototype,r},($.prototype=Object.create(Error.prototype)).constructor=$,$.prototype.name="TransformError";class U{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new A}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new $(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,r=o.Ji.empty){let i=R(this.doc,e,t,r);return i&&this.step(i),this}replaceWith(e,t,r){return this.replace(e,t,new o.Ji(o.FK.from(r),0,0))}delete(e,t){return this.replace(e,t,o.Ji.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,r){return function(e,t,r,i){if(!i.size)return e.deleteRange(t,r);let n=e.doc.resolve(t),s=e.doc.resolve(r);if(F(n,s,i))return e.step(new m(t,r,i));let a=z(n,e.doc.resolve(r));0==a[a.length-1]&&a.pop();let A=-(n.depth+1);a.unshift(A);for(let e=n.depth,t=n.pos-1;e>0;e--,t--){let r=n.node(e).type.spec;if(r.defining||r.definingAsContext||r.isolating)break;a.indexOf(e)>-1?A=e:n.before(e)==t&&a.splice(1,0,-e)}let l=a.indexOf(A),d=[],c=i.openStart;for(let e=i.content,t=0;;t++){let r=e.firstChild;if(d.push(r),t==i.openStart)break;e=r.content}for(let e=c-1;e>=0;e--){let t=d[e],r=(p=t.type).spec.defining||p.spec.definingForContent;if(r&&!t.sameMarkup(n.node(Math.abs(A)-1)))c=e;else if(r||!t.type.isTextblock)break}var p;for(let t=i.openStart;t>=0;t--){let A=(t+c+1)%(i.openStart+1),p=d[A];if(p)for(let t=0;t<a.length;t++){let d=a[(t+l)%a.length],c=!0;d<0&&(c=!1,d=-d);let h=n.node(d-1),C=n.index(d-1);if(h.canReplaceWith(C,C,p.type,p.marks))return e.replace(n.before(d),c?s.after(d):r,new o.Ji(W(i.content,0,i.openStart,A),A,i.openEnd))}}let h=e.steps.length;for(let o=a.length-1;o>=0&&(e.replace(t,r,i),!(e.steps.length>h));o--){let e=a[o];e<0||(t=n.before(e),r=s.after(e))}}(this,e,t,r),this}replaceRangeWith(e,t,r){return function(e,t,r,i){if(!i.isInline&&t==r&&e.doc.resolve(t).parent.content.size){let o=function(e,t,r){let o=e.resolve(t);if(o.parent.canReplaceWith(o.index(),o.index(),r))return t;if(0==o.parentOffset)for(let e=o.depth-1;e>=0;e--){let t=o.index(e);if(o.node(e).canReplaceWith(t,t,r))return o.before(e+1);if(t>0)return null}if(o.parentOffset==o.parent.content.size)for(let e=o.depth-1;e>=0;e--){let t=o.indexAfter(e);if(o.node(e).canReplaceWith(t,t,r))return o.after(e+1);if(t<o.node(e).childCount)return null}return null}(e.doc,t,i.type);null!=o&&(t=r=o)}e.replaceRange(t,r,new o.Ji(o.FK.from(i),0,0))}(this,e,t,r),this}deleteRange(e,t){return function(e,t,r){let o=e.doc.resolve(t),i=e.doc.resolve(r),n=z(o,i);for(let t=0;t<n.length;t++){let r=n[t],s=t==n.length-1;if(s&&0==r||o.node(r).type.contentMatch.validEnd)return e.delete(o.start(r),i.end(r));if(r>0&&(s||o.node(r-1).canReplace(o.index(r-1),i.indexAfter(r-1))))return e.delete(o.before(r),i.after(r))}for(let n=1;n<=o.depth&&n<=i.depth;n++)if(t-o.start(n)==o.depth-n&&r>o.end(n)&&i.end(n)-r!=i.depth-n&&o.start(n-1)==i.start(n-1)&&o.node(n-1).canReplace(o.index(n-1),i.index(n-1)))return e.delete(o.before(n),r);e.delete(t,r)}(this,e,t),this}lift(e,t){return function(e,t,r){let{$from:i,$to:n,depth:s}=t,a=i.before(s+1),A=n.after(s+1),l=a,d=A,c=o.FK.empty,p=0;for(let e=s,t=!1;e>r;e--)t||i.index(e)>0?(t=!0,c=o.FK.from(i.node(e).copy(c)),p++):l--;let h=o.FK.empty,C=0;for(let e=s,t=!1;e>r;e--)t||n.after(e+1)<n.end(e)?(t=!0,h=o.FK.from(n.node(e).copy(h)),C++):d++;e.step(new v(l,d,a,A,new o.Ji(c.append(h),p,C),c.size-p,!0))}(this,e,t),this}join(e,t=1){return function(e,t,r){let i=null,{linebreakReplacement:n}=e.doc.type.schema,s=e.doc.resolve(t-r),a=s.node().type;if(n&&a.inlineContent){let e="pre"==a.whitespace,t=!!a.contentMatch.matchType(n);e&&!t?i=!1:!e&&t&&(i=!0)}let A=e.steps.length;if(!1===i){let o=e.doc.resolve(t+r);_(e,o.node(),o.before(),A)}a.inlineContent&&b(e,t+r-1,a,s.node().contentMatchAt(s.index()),null==i);let l=e.mapping.slice(A),d=l.map(t-r);if(e.step(new m(d,l.map(t+r,-1),o.Ji.empty,!0)),!0===i){let t=e.doc.resolve(d);M(e,t.node(),t.before(),e.steps.length)}}(this,e,t),this}wrap(e,t){return function(e,t,r){let i=o.FK.empty;for(let e=r.length-1;e>=0;e--){if(i.size){let t=r[e].type.contentMatch.matchFragment(i);if(!t||!t.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}i=o.FK.from(r[e].type.create(r[e].attrs,i))}let n=t.start,s=t.end;e.step(new v(n,s,n,s,new o.Ji(i,0,0),r.length,!0))}(this,e,t),this}setBlockType(e,t=e,r,i=null){return function(e,t,r,i,n){if(!i.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let s=e.steps.length;e.doc.nodesBetween(t,r,((t,r)=>{let a="function"==typeof n?n(t):n;if(t.isTextblock&&!t.hasMarkup(i,a)&&function(e,t,r){let o=e.resolve(t),i=o.index();return o.parent.canReplaceWith(i,i+1,r)}(e.doc,e.mapping.slice(s).map(r),i)){let n=null;if(i.schema.linebreakReplacement){let e="pre"==i.whitespace,t=!!i.contentMatch.matchType(i.schema.linebreakReplacement);e&&!t?n=!1:!e&&t&&(n=!0)}!1===n&&_(e,t,r,s),b(e,e.mapping.slice(s).map(r,1),i,void 0,null===n);let A=e.mapping.slice(s),l=A.map(r,1),d=A.map(r+t.nodeSize,1);return e.step(new v(l,d,l+1,d-1,new o.Ji(o.FK.from(i.create(a,null,t.marks)),0,0),1,!0)),!0===n&&M(e,t,r,s),!1}}))}(this,e,t,r,i),this}setNodeMarkup(e,t,r=null,i){return function(e,t,r,i,n){let s=e.doc.nodeAt(t);if(!s)throw new RangeError("No node at given position");r||(r=s.type);let a=r.create(i,null,n||s.marks);if(s.isLeaf)return e.replaceWith(t,t+s.nodeSize,a);if(!r.validContent(s.content))throw new RangeError("Invalid content for node type "+r.name);e.step(new v(t,t+s.nodeSize,t+1,t+s.nodeSize-1,new o.Ji(o.FK.from(a),0,0),1,!0))}(this,e,t,r,i),this}setNodeAttribute(e,t,r){return this.step(new G(e,t,r)),this}setDocAttribute(e,t){return this.step(new K(e,t)),this}addNodeMark(e,t){return this.step(new f(e,t)),this}removeNodeMark(e,t){if(!(t instanceof o.CU)){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(!(t=t.isInSet(r.marks)))return this}return this.step(new u(e,t)),this}split(e,t=1,r){return function(e,t,r=1,i){let n=e.doc.resolve(t),s=o.FK.empty,a=o.FK.empty;for(let e=n.depth,t=n.depth-r,A=r-1;e>t;e--,A--){s=o.FK.from(n.node(e).copy(s));let t=i&&i[A];a=o.FK.from(t?t.type.create(t.attrs,a):n.node(e).copy(a))}e.step(new m(t,t,new o.Ji(s.append(a),r,r),!0))}(this,e,t,r),this}addMark(e,t,r){return function(e,t,r,o){let i,n,s=[],a=[];e.doc.nodesBetween(t,r,((e,A,l)=>{if(!e.isInline)return;let d=e.marks;if(!o.isInSet(d)&&l.type.allowsMarkType(o.type)){let l=Math.max(A,t),c=Math.min(A+e.nodeSize,r),p=o.addToSet(d);for(let e=0;e<d.length;e++)d[e].isInSet(p)||(i&&i.to==l&&i.mark.eq(d[e])?i.to=c:s.push(i=new C(l,c,d[e])));n&&n.to==l?n.to=c:a.push(n=new h(l,c,o))}})),s.forEach((t=>e.step(t))),a.forEach((t=>e.step(t)))}(this,e,t,r),this}removeMark(e,t,r){return function(e,t,r,i){let n=[],s=0;e.doc.nodesBetween(t,r,((e,a)=>{if(!e.isInline)return;s++;let A=null;if(i instanceof o.sX){let t,r=e.marks;for(;t=i.isInSet(r);)(A||(A=[])).push(t),r=t.removeFromSet(r)}else i?i.isInSet(e.marks)&&(A=[i]):A=e.marks;if(A&&A.length){let o=Math.min(a+e.nodeSize,r);for(let e=0;e<A.length;e++){let r,i=A[e];for(let e=0;e<n.length;e++){let t=n[e];t.step==s-1&&i.eq(n[e].style)&&(r=t)}r?(r.to=o,r.step=s):n.push({style:i,from:Math.max(a,t),to:o,step:s})}}})),n.forEach((t=>e.step(new C(t.from,t.to,t.style))))}(this,e,t,r),this}clearIncompatible(e,t,r){return b(this,e,t,r),this}}}}]);
//# sourceMappingURL=src_views_RichWorkspace_vue-node_modules_nextcloud_vue_dist_chunks_emoji-BY_D0V5K_mjs-node_mo-c8f763.js.map?v=c335e4c77fb7792c0ba9