{"version":3,"file":"index-_QHNqdwt.chunk.mjs","sources":["../node_modules/@nextcloud/logger/dist/index.mjs"],"sourcesContent":["import { getCurrentUser } from \"@nextcloud/auth\";\nvar LogLevel = /* @__PURE__ */ ((LogLevel2) => {\n  LogLevel2[LogLevel2[\"Debug\"] = 0] = \"Debug\";\n  LogLevel2[LogLevel2[\"Info\"] = 1] = \"Info\";\n  LogLevel2[LogLevel2[\"Warn\"] = 2] = \"Warn\";\n  LogLevel2[LogLevel2[\"Error\"] = 3] = \"Error\";\n  LogLevel2[LogLevel2[\"Fatal\"] = 4] = \"Fatal\";\n  return LogLevel2;\n})(LogLevel || {});\nclass ConsoleLogger {\n  context;\n  constructor(context) {\n    this.context = context || {};\n  }\n  formatMessage(message, level, context) {\n    let msg = \"[\" + LogLevel[level].toUpperCase() + \"] \";\n    if (context && context.app) {\n      msg += context.app + \": \";\n    }\n    if (typeof message === \"string\") return msg + message;\n    msg += `Unexpected ${message.name}`;\n    if (message.message) msg += ` \"${message.message}\"`;\n    if (level === LogLevel.Debug && message.stack) msg += `\n\nStack trace:\n${message.stack}`;\n    return msg;\n  }\n  log(level, message, context) {\n    if (typeof this.context?.level === \"number\" && level < this.context?.level) {\n      return;\n    }\n    if (typeof message === \"object\" && context?.error === void 0) {\n      context.error = message;\n    }\n    switch (level) {\n      case LogLevel.Debug:\n        console.debug(this.formatMessage(message, LogLevel.Debug, context), context);\n        break;\n      case LogLevel.Info:\n        console.info(this.formatMessage(message, LogLevel.Info, context), context);\n        break;\n      case LogLevel.Warn:\n        console.warn(this.formatMessage(message, LogLevel.Warn, context), context);\n        break;\n      case LogLevel.Error:\n        console.error(this.formatMessage(message, LogLevel.Error, context), context);\n        break;\n      case LogLevel.Fatal:\n      default:\n        console.error(this.formatMessage(message, LogLevel.Fatal, context), context);\n        break;\n    }\n  }\n  debug(message, context) {\n    this.log(LogLevel.Debug, message, Object.assign({}, this.context, context));\n  }\n  info(message, context) {\n    this.log(LogLevel.Info, message, Object.assign({}, this.context, context));\n  }\n  warn(message, context) {\n    this.log(LogLevel.Warn, message, Object.assign({}, this.context, context));\n  }\n  error(message, context) {\n    this.log(LogLevel.Error, message, Object.assign({}, this.context, context));\n  }\n  fatal(message, context) {\n    this.log(LogLevel.Fatal, message, Object.assign({}, this.context, context));\n  }\n}\nfunction buildConsoleLogger(context) {\n  return new ConsoleLogger(context);\n}\nclass LoggerBuilder {\n  context;\n  factory;\n  constructor(factory) {\n    this.context = {};\n    this.factory = factory;\n  }\n  /**\n   * Set the app name within the logging context\n   *\n   * @param appId App name\n   */\n  setApp(appId) {\n    this.context.app = appId;\n    return this;\n  }\n  /**\n   * Set the logging level within the logging context\n   *\n   * @param level Logging level\n   */\n  setLogLevel(level) {\n    this.context.level = level;\n    return this;\n  }\n  /* eslint-disable jsdoc/no-undefined-types */\n  /**\n   * Set the user id within the logging context\n   * @param uid User ID\n   * @see {@link detectUser}\n   */\n  /* eslint-enable jsdoc/no-undefined-types */\n  setUid(uid) {\n    this.context.uid = uid;\n    return this;\n  }\n  /**\n   * Detect the currently logged in user and set the user id within the logging context\n   */\n  detectUser() {\n    const user = getCurrentUser();\n    if (user !== null) {\n      this.context.uid = user.uid;\n    }\n    return this;\n  }\n  /**\n   * Detect and use logging level configured in nextcloud config\n   */\n  detectLogLevel() {\n    const self = this;\n    const onLoaded = () => {\n      if (document.readyState === \"complete\" || document.readyState === \"interactive\") {\n        self.context.level = window._oc_config?.loglevel ?? LogLevel.Warn;\n        if (window._oc_debug) {\n          self.context.level = LogLevel.Debug;\n        }\n        document.removeEventListener(\"readystatechange\", onLoaded);\n      } else {\n        document.addEventListener(\"readystatechange\", onLoaded);\n      }\n    };\n    onLoaded();\n    return this;\n  }\n  /** Build a logger using the logging context and factory */\n  build() {\n    if (this.context.level === void 0) {\n      this.detectLogLevel();\n    }\n    return this.factory(this.context);\n  }\n}\nfunction getLoggerBuilder() {\n  return new LoggerBuilder(buildConsoleLogger);\n}\nfunction getLogger() {\n  return getLoggerBuilder().build();\n}\nexport {\n  LogLevel,\n  getLogger,\n  getLoggerBuilder\n};\n//# sourceMappingURL=index.mjs.map\n"],"names":["LogLevel","LogLevel2","ConsoleLogger","context","message","level","msg","buildConsoleLogger","LoggerBuilder","factory","appId","uid","user","getCurrentUser","self","onLoaded","getLoggerBuilder"],"mappings":"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","x_google_ignoreList":[0]}