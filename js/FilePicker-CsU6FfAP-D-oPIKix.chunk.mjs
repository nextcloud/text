var Te=Object.defineProperty,je=Object.defineProperties;var We=Object.getOwnPropertyDescriptors;var fe=Object.getOwnPropertySymbols;var Ze=Object.prototype.hasOwnProperty,Ue=Object.prototype.propertyIsEnumerable;var me=(e,r,t)=>r in e?Te(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,z=(e,r)=>{for(var t in r||(r={}))Ze.call(r,t)&&me(e,t,r[t]);if(fe)for(var t of fe(r))Ue.call(r,t)&&me(e,t,r[t]);return e},j=(e,r)=>je(e,We(r));import{V as W,c as m,t as U,f as I,r as g,s as J,w as Fe,o as E,n as qe,b as Ge,h as Ke}from"./vue.runtime.esm-Ci2e5rf_.chunk.mjs";import{N as X,d as Y,n as C,t as _,s as ee,p as q,e as Le,f as M}from"./NcNoteCard-Dz5-u2BY-DEDsgEwb.chunk.mjs";import{s as Je,f as Qe}from"./index-Cqe8I0z9.chunk.mjs";import{N as Be}from"./NcCheckboxRadioSwitch-ezquUuPz-BfX8XV6z.chunk.mjs";import{_ as te}from"./index-DUrHmx5a.chunk.mjs";import{n as T,c as Ve}from"./NcLoadingIcon-V-QWbD5-.chunk.mjs";import{w as Xe,x as Ye,y as et,z as tt,A as rt,B as it,D as nt,G as at,H as st,I as ot,J as lt,K as ct}from"./EditorOutline-W-PsPCnJ.chunk.mjs";import{u as ut,s as dt,e as pt,g as ft}from"./index-CkfhUZfI.chunk.mjs";import{N as mt}from"./MenuBar-fjQ-xRtl.chunk.mjs";import{g as ht,b as vt,d as re,c as O,C as He,e as gt,f as ie,h as Pe}from"./dav-CQDyL7M_-CH-BFZ4c.chunk.mjs";import"./emoji-picker-DJyM6asK.chunk.mjs";import"./index-ti_56SXG.chunk.mjs";import"./logger-Btaw2hdC.chunk.mjs";import"./index-B64e8dYD.chunk.mjs";import"./preload-helper-Dlt9bAsw.chunk.mjs";import"./MediaHandler.provider-B8o03yiD.chunk.mjs";var yt=Object.defineProperty,he=Object.getOwnPropertySymbols,_t=Object.prototype.hasOwnProperty,bt=Object.prototype.propertyIsEnumerable,ve=(e,r,t)=>r in e?yt(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,ge=(e,r)=>{for(var t in r||(r={}))_t.call(r,t)&&ve(e,t,r[t]);if(he)for(var t of he(r))bt.call(r,t)&&ve(e,t,r[t]);return e};const wt={name:"ChevronRightIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Ct=function(){var e=this,r=e._self._c;return r("span",e._b({staticClass:"material-design-icon chevron-right-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[r("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[r("path",{attrs:{d:"M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"}},[e.title?r("title",[e._v(e._s(e.title))]):e._e()])])])},kt=[],St=T(wt,Ct,kt,!1,null,null);const Nt=St.exports,xt={name:"NcBreadcrumb",components:{NcActions:Y,ChevronRight:Nt,NcButton:X},inheritAttrs:!1,props:{name:{type:String,required:!0},title:{type:String,default:null},to:{type:[String,Object],default:void 0},exact:{type:Boolean,default:!1},href:{type:String,default:void 0},icon:{type:String,default:""},forceIconText:{type:Boolean,default:!1},disableDrop:{type:Boolean,default:!1},forceMenu:{type:Boolean,default:!1},open:{type:Boolean,default:!1}},emits:["update:open","dropped"],setup(){const e=Xe();return{actionsContainer:'.vue-crumb[data-crumb-id="'.concat(e,'"]'),crumbId:e}},data(){return{hovering:!1}},computed:{linkAttributes(){return this.to?ge({to:this.to,exact:this.exact},this.$attrs):this.href?ge({href:this.href},this.$attrs):this.$attrs}},methods:{onOpenChange(e){this.$emit("update:open",e)},dropped(e){return this.disableDrop||(this.$emit("dropped",e,this.to||this.href),this.$parent.$emit("dropped",e,this.to||this.href),this.hovering=!1),!1},dragEnter(){this.disableDrop||(this.hovering=!0)},dragLeave(e){this.disableDrop||e.target.contains(e.relatedTarget)||this.$refs.crumb.contains(e.relatedTarget)||(this.hovering=!1)}}};var Ft=function(){var e=this,r=e._self._c;return r("li",{ref:"crumb",staticClass:"vue-crumb",class:{"vue-crumb--hovered":e.hovering},attrs:{"data-crumb-id":e.crumbId,draggable:"false"},on:{dragstart:function(t){return t.preventDefault(),(()=>{}).apply(null,arguments)},drop:function(t){return t.preventDefault(),e.dropped.apply(null,arguments)},dragover:function(t){return t.preventDefault(),(()=>{}).apply(null,arguments)},dragenter:e.dragEnter,dragleave:e.dragLeave}},[(e.name||e.icon||e.$slots.icon)&&!e.$slots.default?r("NcButton",e._g(e._b({attrs:{"aria-label":e.icon?e.name:void 0,title:e.title,variant:"tertiary"},scopedSlots:e._u([e.$slots.icon||e.icon?{key:"icon",fn:function(){return[e._t("icon",function(){return[r("span",{staticClass:"icon",class:e.icon})]})]},proxy:!0}:null,!(e.$slots.icon||e.icon)||e.forceIconText?{key:"default",fn:function(){return[e._v(" "+e._s(e.name)+" ")]},proxy:!0}:null],null,!0)},"NcButton",e.linkAttributes,!1),e.$listeners)):e._e(),e.$slots.default?r("NcActions",{ref:"actions",attrs:{"force-menu":e.forceMenu,open:e.open,"menu-name":e.name,title:e.title,"force-name":!0,container:e.actionsContainer,variant:"tertiary"},on:{"update:open":e.onOpenChange},scopedSlots:e._u([{key:"icon",fn:function(){return[e._t("menu-icon")]},proxy:!0}],null,!0)},[e._t("default")],2):e._e(),r("ChevronRight",{staticClass:"vue-crumb__separator",attrs:{size:20}})],1)},Lt=[],Bt=T(xt,Ft,Lt,!1,null,"bc2f0c21");const Ie=Bt.exports;var G=Symbol(),$=Symbol(),ye=Symbol(),_e=Symbol(),ne=function(e){return"frag"in e},Vt={get:function(){return this[$]||this.parentElement},configurable:!0},R=function(e,r){$ in e||(e[$]=r,Object.defineProperty(e,"parentNode",Vt))},Ht={get:function(){var e=this.parentNode.childNodes,r=e.indexOf(this);return r>-1&&e[r+1]||null}},Z=function(e){ye in e||(e[ye]=!0,Object.defineProperty(e,"nextSibling",Ht))},Pt=function(e,r){for(;e.parentNode!==r;){var t=e,i=t.parentNode;i&&(e=i)}return e},K,ze=function(e){if(!K){var r=Object.getOwnPropertyDescriptor(Node.prototype,"childNodes");K=r.get}var t=K.apply(e),i=Array.from(t).map(function(n){return Pt(n,e)});return i.filter(function(n,a){return n!==i[a-1]})},It={get:function(){return this.frag||ze(this)}},zt={get:function(){return this.childNodes[0]||null}};function At(){return this.childNodes.length>0}var be=function(e){_e in e||(e[_e]=!0,Object.defineProperties(e,{childNodes:It,firstChild:zt}),e.hasChildNodes=At)};function Dt(){var e;(e=this.frag[0]).before.apply(e,arguments)}function Mt(){var e=this.frag,r=e.splice(0,e.length);r.forEach(function(t){t.remove()})}var Ot=function e(r){var t;return(t=Array.prototype).concat.apply(t,r.map(function(i){return ne(i)?e(i.frag):i}))},$t=function(e,r){var t=e[G];r.before(t),R(t,e),e.frag.unshift(t)};function we(e){if(ne(this)){var r=this.frag.indexOf(e);if(r>-1){var t=this.frag.splice(r,1),i=t[0];this.frag.length===0&&$t(this,i),e.remove()}}else{var n=ze(this),a=n.indexOf(e);a>-1&&e.remove()}return e}function Ce(e,r){var t=this,i=e.frag||[e];if(ne(this)){if(e[$]===this&&e.parentElement)return e;var n=this.frag;if(r){var a=n.indexOf(r);a>-1&&(n.splice.apply(n,[a,0].concat(i)),r.before.apply(r,i))}else{var s=n[n.length-1];n.push.apply(n,i),s.after.apply(s,i)}Ae(this)}else r?this.childNodes.includes(r)&&r.before.apply(r,i):this.append.apply(this,i);i.forEach(function(c){R(c,t)});var o=i[i.length-1];return Z(o),e}function Rt(e){if(e[$]===this&&e.parentElement)return e;var r=this.frag,t=r[r.length-1];return t.after(e),R(e,this),Ae(this),r.push(e),e}var Ae=function(e){var r=e[G];e.frag[0]===r&&(e.frag.shift(),r.remove())},Et={set:function(e){var r=this;if(this.frag[0]!==this[G]&&this.frag.slice().forEach(function(i){return r.removeChild(i)}),e){var t=document.createElement("div");t.innerHTML=e,Array.from(t.childNodes).forEach(function(i){r.appendChild(i)})}},get:function(){return""}},Tt={inserted:function(e){var r=e.parentNode,t=e.nextSibling,i=e.previousSibling,n=Array.from(e.childNodes),a=document.createComment("");n.length===0&&n.push(a),e.frag=n,e[G]=a;var s=document.createDocumentFragment();s.append.apply(s,Ot(n)),e.replaceWith(s),n.forEach(function(o){R(o,e),Z(o)}),be(e),Object.assign(e,{remove:Mt,appendChild:Rt,insertBefore:Ce,removeChild:we,before:Dt}),Object.defineProperty(e,"innerHTML",Et),r&&(Object.assign(r,{removeChild:we,insertBefore:Ce}),R(e,r),be(r)),t&&Z(e),i&&Z(i)},unbind:function(e){e.remove()}},De={name:"Fragment",directives:{frag:Tt},render:function(e){return e("div",{directives:[{name:"frag"}]},this.$slots.default)}},jt=Object.defineProperty,ke=Object.getOwnPropertySymbols,Wt=Object.prototype.hasOwnProperty,Zt=Object.prototype.propertyIsEnumerable,Se=(e,r,t)=>r in e?jt(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,Ut=(e,r)=>{for(var t in r||(r={}))Wt.call(r,t)&&Se(e,t,r[t]);if(ke)for(var t of ke(r))Zt.call(r,t)&&Se(e,t,r[t]);return e};const qt={name:"FolderIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Gt=function(){var e=this,r=e._self._c;return r("span",e._b({staticClass:"material-design-icon folder-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[r("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[r("path",{attrs:{d:"M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z"}},[e.title?r("title",[e._v(e._s(e.title))]):e._e()])])])},Kt=[],Jt=T(qt,Gt,Kt,!1,null,null);const Qt=Jt.exports;function Ne(e,r,t){if(e!==void 0)for(let i=e.length-1;i>=0;i--){const n=e[i],a=!n.componentOptions&&n.tag&&r.indexOf(n.tag)===-1,s=!!n.componentOptions&&typeof n.componentOptions.tag=="string",o=s&&r.indexOf(n.componentOptions.tag)===-1;(a||!s||o)&&((a||o)&&W.util.warn("".concat(a?n.tag:n.componentOptions.tag," is not allowed inside the ").concat(t.$options.name," component"),t),e.splice(i,1))}}const w="vue-crumb",Xt={name:"NcBreadcrumbs",components:{NcActions:Y,NcActionButton:tt,NcActionRouter:et,NcActionLink:Ye,NcBreadcrumb:Ie,IconFolder:Qt},props:{rootIcon:{type:String,default:"icon-home"},ariaLabel:{type:String,default:null}},emits:["dropped"],data(){return{hiddenIndices:[],menuBreadcrumbProps:{name:"",forceMenu:!0,disableDrop:!0,open:!1},breadcrumbsRefs:{}}},beforeMount(){Ne(this.$slots.default,["NcBreadcrumb"],this)},beforeUpdate(){Ne(this.$slots.default,["NcBreadcrumb"],this)},created(){window.addEventListener("resize",rt(()=>{this.handleWindowResize()},100)),dt("navigation-toggled",this.delayedResize)},mounted(){this.handleWindowResize()},updated(){this.delayedResize(),this.$nextTick(()=>{this.hideCrumbs()})},beforeDestroy(){window.removeEventListener("resize",this.handleWindowResize),ut("navigation-toggled",this.delayedResize)},methods:{closeActions(e){this.$refs.actionsBreadcrumb.$el.contains(e.relatedTarget)||(this.menuBreadcrumbProps.open=!1)},async delayedResize(){await this.$nextTick(),this.handleWindowResize()},handleWindowResize(){var e;if(!this.$refs.container)return;const r=Object.values(this.breadcrumbsRefs),t=r.length,i=[],n=this.$refs.container.offsetWidth;let a=this.getTotalWidth(r);this.$refs.breadcrumb__actions&&(a+=this.$refs.breadcrumb__actions.offsetWidth);let s=a-n;s+=s>0?64:0;let o=0;const c=Math.floor(t/2);for(;s>0&&o<t-2;){const l=c+(o%2?o+1:o)/2*Math.pow(-1,o+t%2);s-=this.getWidth((e=r[l])==null?void 0:e.elm,l===r.length-1),i.push(l),o++}this.arraysEqual(this.hiddenIndices,i.sort((l,u)=>l-u))||(this.hiddenIndices=i)},arraysEqual(e,r){if(e.length!==r.length)return!1;if(e===r)return!0;if(e===null||r===null)return!1;for(let t=0;t<e.length;++t)if(e[t]!==r[t])return!1;return!0},getTotalWidth(e){return e.reduce((r,t,i)=>r+this.getWidth(t==null?void 0:t.elm,i===e.length-1),0)},getWidth(e,r){if(!(e!=null&&e.classList))return 0;const t=e.classList.contains("".concat(w,"--hidden"));e.style.minWidth="auto",r&&(e.style.maxWidth="210px"),e.classList.remove("".concat(w,"--hidden"));const i=e.offsetWidth;return t&&e.classList.add("".concat(w,"--hidden")),e.style.minWidth="",e.style.maxWidth="",i},preventDefault(e){return e.preventDefault&&e.preventDefault(),!1},dragStart(e){return this.preventDefault(e)},dropped(e,r,t){return t||this.$emit("dropped",e,r),this.menuBreadcrumbProps.open=!1,document.querySelectorAll(".".concat(w)).forEach(i=>{i.classList.remove("".concat(w,"--hovered"))}),this.preventDefault(e)},dragOver(e){return this.preventDefault(e)},dragEnter(e,r){if(!r&&e.target.closest){const t=e.target.closest(".".concat(w));t.classList&&t.classList.contains(w)&&(document.querySelectorAll(".".concat(w)).forEach(i=>{i.classList.remove("".concat(w,"--hovered"))}),t.classList.add("".concat(w,"--hovered")))}},dragLeave(e,r){if(!r&&!e.target.contains(e.relatedTarget)&&e.target.closest){const t=e.target.closest(".".concat(w));if(t.contains(e.relatedTarget))return;t.classList&&t.classList.contains(w)&&t.classList.remove("".concat(w,"--hovered"))}},hideCrumbs(){Object.values(this.breadcrumbsRefs).forEach((e,r)=>{var t;(t=e==null?void 0:e.elm)!=null&&t.classList&&(this.hiddenIndices.includes(r)?e.elm.classList.add("".concat(w,"--hidden")):e.elm.classList.remove("".concat(w,"--hidden")))})},isBreadcrumb(e){var r;return(((r=e==null?void 0:e.componentOptions)==null?void 0:r.tag)||(e==null?void 0:e.tag)||"").includes("NcBreadcrumb")}},render(e){const r=[];if(this.$slots.default.forEach(a=>{var s,o;if(this.isBreadcrumb(a)){r.push(a);return}(a==null?void 0:a.type)===De&&((o=(s=a==null?void 0:a.children)==null?void 0:s.forEach)==null||o.call(s,c=>{this.isBreadcrumb(c)&&r.push(c)}))}),r.length===0)return;W.set(r[0].componentOptions.propsData,"icon",this.rootIcon),W.set(r[0].componentOptions.propsData,"ref","breadcrumbs");const t={};r.forEach((a,s)=>{W.set(a,"ref","crumb-".concat(s)),t[s]=a});let i=[];if(!this.hiddenIndices.length)i=r;else{i=r.slice(0,Math.round(r.length/2)),i.push(e("NcBreadcrumb",{class:"dropdown",props:this.menuBreadcrumbProps,attrs:{"aria-hidden":!0},ref:"actionsBreadcrumb",key:"actions-breadcrumb-1",nativeOn:{dragstart:this.dragStart,dragenter:()=>{this.menuBreadcrumbProps.open=!0},dragleave:this.closeActions},on:{"update:open":s=>{this.menuBreadcrumbProps.open=s}}},this.hiddenIndices.filter(s=>s<=r.length-1).map(s=>{const o=r[s],c=o.componentOptions.propsData.to,l=o.componentOptions.propsData.href,u=o.componentOptions.propsData.disableDrop,d=o.componentOptions.propsData.title,b=o.componentOptions.propsData.name;let p="NcActionButton",k="";l&&(p="NcActionLink",k=l),c&&(p="NcActionRouter",k=c);const N=e("IconFolder",{props:{size:20},slot:"icon"});return e(p,{class:w,props:{href:l||null,title:d,to:c||null},attrs:{draggable:!1},on:Ut({},o.componentOptions.listeners),nativeOn:{dragstart:this.dragStart,drop:S=>this.dropped(S,k,u),dragover:this.dragOver,dragenter:S=>this.dragEnter(S,u),dragleave:S=>this.dragLeave(S,u)}},[N,b])})));const a=r.slice(Math.round(r.length/2));i=i.concat(a)}const n=[e("nav",{attrs:{"aria-label":this.ariaLabel}},[e("ul",{class:"breadcrumb__crumbs"},[i])])];return this.$slots.actions&&n.push(e("div",{class:"breadcrumb__actions",ref:"breadcrumb__actions"},this.$slots.actions)),this.breadcrumbsRefs=t,e("div",{class:["breadcrumb",{"breadcrumb--collapsed":this.hiddenIndices.length===r.length-2}],ref:"container"},n)}},Yt=null,er=null;var tr=T(Xt,Yt,er,!1,null,"daf14f2f");const rr=tr.exports,ir={name:"NcDateTime",props:{timestamp:{type:[Date,Number],required:!0},format:{type:Object,default:()=>({timeStyle:"medium",dateStyle:"short"})},relativeTime:{type:[Boolean,String],default:"long",validator:e=>e===!1||["long","short","narrow"].includes(e)},ignoreSeconds:{type:Boolean,default:!1}},setup(e){const r=m(()=>({format:e.format})),t=m(()=>({ignoreSeconds:e.ignoreSeconds,relativeTime:e.relativeTime||"long",update:e.relativeTime!==!1})),i=it(U(e,"timestamp"),r),n=nt(U(e,"timestamp"),t);return{formattedTime:m(()=>e.relativeTime?n.value:i.value),title:i}}};var nr=function(){var e=this,r=e._self._c;return r("span",{staticClass:"nc-datetime",attrs:{dir:"auto","data-timestamp":e.timestamp,title:e.title},domProps:{textContent:e._s(e.formattedTime)}})},ar=[],sr=T(ir,nr,ar,!1,null,null);const or=sr.exports;function ae(e,r,t){const i=document.querySelector("#initial-state-".concat(e,"-").concat(r));if(i===null)return t;try{return JSON.parse(atob(i.value))}catch(n){throw new Error("Could not parse initial state ".concat(r," of ").concat(e))}}function Me(){var e;return(e=ae("files_sharing","isPublic",null))!=null?e:document.querySelector('input#isPublic[type="hidden"][name="isPublic"][value="1"]')!==null}var xe="M15,14C12.33,14 7,15.33 7,18V20H23V18C23,15.33 17.67,14 15,14M6,10V7H4V10H1V12H4V15H6V12H9V10M15,12A4,4 0 0,0 19,8A4,4 0 0,0 15,4A4,4 0 0,0 11,8A4,4 0 0,0 15,12Z",lr="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M16.2,16.2L11,13V7H12.5V12.2L17,14.9L16.2,16.2Z",cr="M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z",ur="M1,1V5H2V19H1V23H5V22H19V23H23V19H22V5H23V1H19V2H5V1M5,4H19V5H20V19H19V20H5V19H4V5H5M6,6V14H9V18H18V9H14V6M8,8H12V12H8M14,11H16V16H11V14H14",dr="M3.9,12C3.9,10.29 5.29,8.9 7,8.9H11V7H7A5,5 0 0,0 2,12A5,5 0 0,0 7,17H11V15.1H7C5.29,15.1 3.9,13.71 3.9,12M8,13H16V11H8V13M17,7H13V8.9H17C18.71,8.9 20.1,10.29 20.1,12C20.1,13.71 18.71,15.1 17,15.1H13V17H17A5,5 0 0,0 22,12A5,5 0 0,0 17,7Z",pr="M12,17A2,2 0 0,0 14,15C14,13.89 13.1,13 12,13A2,2 0 0,0 10,15A2,2 0 0,0 12,17M18,8A2,2 0 0,1 20,10V20A2,2 0 0,1 18,22H6A2,2 0 0,1 4,20V10C4,8.89 4.9,8 6,8H7V6A5,5 0 0,1 12,1A5,5 0 0,1 17,6V8H18M12,3A3,3 0 0,0 9,6V8H15V6A3,3 0 0,0 12,3Z",fr="M17,3A2,2 0 0,1 19,5V15A2,2 0 0,1 17,17H13V19H14A1,1 0 0,1 15,20H22V22H15A1,1 0 0,1 14,23H10A1,1 0 0,1 9,22H2V20H9A1,1 0 0,1 10,19H11V17H7C5.89,17 5,16.1 5,15V5A2,2 0 0,1 7,3H17Z",mr="M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z",hr="M5.5,7A1.5,1.5 0 0,1 4,5.5A1.5,1.5 0 0,1 5.5,4A1.5,1.5 0 0,1 7,5.5A1.5,1.5 0 0,1 5.5,7M21.41,11.58L12.41,2.58C12.05,2.22 11.55,2 11,2H4C2.89,2 2,2.89 2,4V11C2,11.55 2.22,12.05 2.59,12.41L11.58,21.41C11.95,21.77 12.45,22 13,22C13.55,22 14.05,21.77 14.41,21.41L21.41,14.41C21.78,14.05 22,13.55 22,13C22,12.44 21.77,11.94 21.41,11.58Z",Q=(e=>(e[e.User=0]="User",e[e.Group=1]="Group",e[e.Link=3]="Link",e[e.Email=4]="Email",e[e.Remote=6]="Remote",e[e.Team=7]="Team",e[e.Guest=8]="Guest",e[e.RemoteGroup=9]="RemoteGroup",e[e.Room=10]="Room",e[e.Deck=12]="Deck",e[e.FederatedGroup=14]="FederatedGroup",e[e.ScienceMesh=15]="ScienceMesh",e))(Q||{});const vr={name:"FileIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var gr=function(){var e=this,r=e._self._c;return r("span",e._b({staticClass:"material-design-icon file-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[r("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[r("path",{attrs:{d:"M13,9V3.5L18.5,9M6,2C4.89,2 4,2.89 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2H6Z"}},[e.title?r("title",[e._v(e._s(e.title))]):e._e()])])])},yr=[],_r=C(vr,gr,yr,!1,null,null);const Oe=_r.exports,$e=()=>{var n,a,s;const e=ae("files","config",null),r=g((n=e==null?void 0:e.show_hidden)!=null?n:!0),t=g((a=e==null?void 0:e.sort_favorites_first)!=null?a:!0),i=g((s=e==null?void 0:e.crop_image_previews)!=null?s:!0);return E(async()=>{var o,c,l,u,d,b;if(Me())console.debug("Skip loading files settings - currently on public share");else try{const{data:p}=await Ve.get(te("/apps/files/api/v1/configs"));r.value=(c=(o=p==null?void 0:p.data)==null?void 0:o.show_hidden)!=null?c:!1,t.value=(u=(l=p==null?void 0:p.data)==null?void 0:l.sort_favorites_first)!=null?u:!0,i.value=(b=(d=p==null?void 0:p.data)==null?void 0:d.crop_image_previews)!=null?b:!0}catch(p){console.error("Could not load files settings",p),ee(_("Could not load files settings"))}}),{showHiddenFiles:r,sortFavoritesFirst:t,cropImagePreviews:i}},br=e=>{var l,u,d,b,p,k,N,S,B,L,F,v;const r=x=>x==="asc"?"ascending":x==="desc"?"descending":"none",t=ae("files","viewConfigs",null),i=g({sortBy:(u=(l=t==null?void 0:t.files)==null?void 0:l.sorting_mode)!=null?u:"basename",order:r((b=(d=t==null?void 0:t.files)==null?void 0:d.sorting_direction)!=null?b:"asc")}),n=g({sortBy:(k=(p=t==null?void 0:t.recent)==null?void 0:p.sorting_mode)!=null?k:"basename",order:r((S=(N=t==null?void 0:t.recent)==null?void 0:N.sorting_direction)!=null?S:"asc")}),a=g({sortBy:(L=(B=t==null?void 0:t.favorites)==null?void 0:B.sorting_mode)!=null?L:"basename",order:r((v=(F=t==null?void 0:t.favorites)==null?void 0:F.sorting_direction)!=null?v:"asc")});E(async()=>{var x,V,f,h,H,A,D,P,se,oe,le,ce,ue,de,pe;if(Me())console.debug("Skip loading files views - currently on public share");else try{const{data:y}=await Ve.get(te("/apps/files/api/v1/views"));i.value={sortBy:(f=(V=(x=y==null?void 0:y.data)==null?void 0:x.files)==null?void 0:V.sorting_mode)!=null?f:"basename",order:r((H=(h=y==null?void 0:y.data)==null?void 0:h.files)==null?void 0:H.sorting_direction)},a.value={sortBy:(P=(D=(A=y==null?void 0:y.data)==null?void 0:A.favorites)==null?void 0:D.sorting_mode)!=null?P:"basename",order:r((oe=(se=y==null?void 0:y.data)==null?void 0:se.favorites)==null?void 0:oe.sorting_direction)},n.value={sortBy:(ue=(ce=(le=y==null?void 0:y.data)==null?void 0:le.recent)==null?void 0:ce.sorting_mode)!=null?ue:"basename",order:r((pe=(de=y==null?void 0:y.data)==null?void 0:de.recent)==null?void 0:pe.sorting_direction)}}catch(y){console.error("Could not load files views",y),ee(_("Could not load files views"))}});const s=m(()=>M(e||"files")==="files"?i.value:M(e)==="recent"?n.value:a.value),o=m(()=>s.value.sortBy),c=m(()=>s.value.order);return{filesViewConfig:i,favoritesViewConfig:a,recentViewConfig:n,currentConfig:s,sortBy:o,order:c}},wr={name:"MenuUpIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Cr=function(){var e=this,r=e._self._c;return r("span",e._b({staticClass:"material-design-icon menu-up-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[r("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[r("path",{attrs:{d:"M7,15L12,10L17,15H7Z"}},[e.title?r("title",[e._v(e._s(e.title))]):e._e()])])])},kr=[],Sr=C(wr,Cr,kr,!1,null,null);const Nr=Sr.exports,xr={name:"MenuDownIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Fr=function(){var e=this,r=e._self._c;return r("span",e._b({staticClass:"material-design-icon menu-down-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[r("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[r("path",{attrs:{d:"M7,10L12,15L17,10H7Z"}},[e.title?r("title",[e._v(e._s(e.title))]):e._e()])])])},Lr=[],Br=C(xr,Fr,Lr,!1,null,null);const Vr=Br.exports,Re={"file-picker__file-icon":"_file-picker__file-icon_3v9zx_9","file-picker__file-icon--primary":"_file-picker__file-icon--primary_3v9zx_21","file-picker__file-icon-overlay":"_file-picker__file-icon-overlay_3v9zx_25"},Hr=I({__name:"LoadingTableRow",props:{showCheckbox:{type:Boolean}},setup(e){return{__sfc:!0,fileListIconStyles:Re}}});var Pr=function(){var e=this,r=e._self._c,t=e._self._setupProxy;return r("tr",{staticClass:"file-picker__row loading-row",attrs:{"aria-hidden":"true"}},[e.showCheckbox?r("td",{staticClass:"row-checkbox"},[r("span")]):e._e(),r("td",{staticClass:"row-name"},[r("div",{staticClass:"row-wrapper"},[r("span",{class:t.fileListIconStyles["file-picker__file-icon"]}),r("span")])]),e._m(0),e._m(1)])},Ir=[function(){var e=this,r=e._self._c;return e._self._setupProxy,r("td",{staticClass:"row-size"},[r("span")])},function(){var e=this,r=e._self._c;return e._self._setupProxy,r("td",{staticClass:"row-modified"},[r("span")])}],zr=C(Hr,Pr,Ir,!1,null,"15187afc");const Ar=zr.exports,Dr=new at({concurrency:5});function Mr(e){const{resolve:r,promise:t}=Promise.withResolvers();return Dr.add(()=>{const i=new Image;return i.onerror=()=>r(!1),i.onload=()=>r(!0),i.src=e,t}),t}function Or(e,r={}){var t;r=z({size:32,cropPreview:!1,mimeFallback:!0},r);try{const i=((t=e.attributes)==null?void 0:t.previewUrl)||te("/core/preview?fileId={fileid}",{fileid:e.fileid});let n;try{n=new URL(i)}catch(a){n=new URL(i,window.location.origin)}return n.searchParams.set("x","".concat(r.size)),n.searchParams.set("y","".concat(r.size)),n.searchParams.set("mimeFallback","".concat(r.mimeFallback)),n.searchParams.set("a",r.cropPreview===!0?"0":"1"),n.searchParams.set("c","".concat(e.attributes.etag)),n}catch(i){return null}}const $r=(e,r)=>{const t=g(null),i=g(!1);return Ke(()=>{i.value=!1,t.value=Or(M(e),M(r||{})),t.value&&M(e).type===O.File&&Mr(t.value.href).then(n=>{i.value=n})}),{previewURL:t,previewLoaded:i}},Rr={name:"FolderIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Er=function(){var e=this,r=e._self._c;return r("span",e._b({staticClass:"material-design-icon folder-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[r("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[r("path",{attrs:{d:"M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z"}},[e.title?r("title",[e._v(e._s(e.title))]):e._e()])])])},Tr=[],jr=C(Rr,Er,Tr,!1,null,null);const Ee=jr.exports,Wr={name:"FilePreview"},Zr=I(j(z({},Wr),{props:{node:null,cropImagePreviews:{type:Boolean}},setup(e){const r=e,t=g(Re),{previewURL:i,previewLoaded:n}=$r(U(r,"node"),m(()=>({cropPreview:r.cropImagePreviews}))),a=m(()=>r.node.type===O.File),s=m(()=>{var c,l,u,d;if(r.node.type!==O.Folder)return null;if(((c=r.node.attributes)==null?void 0:c["is-encrypted"])===1)return pr;if((l=r.node.attributes)!=null&&l["is-tag"])return hr;const o=Object.values(((u=r.node.attributes)==null?void 0:u["share-types"])||{}).flat();if(o.some(b=>b===Q.Link||b===Q.Email))return dr;if(o.length>0)return xe;switch((d=r.node.attributes)==null?void 0:d["mount-type"]){case"external":case"external-session":return fr;case"group":return ur;case"shared":return xe}return null});return{__sfc:!0,fileListIconStyles:t,props:r,previewURL:i,previewLoaded:n,isFile:a,folderDecorationIcon:s,NcIconSvgWrapper:Le,IconFile:Oe,IconFolder:Ee}}}));var Ur=function(){var e=this,r=e._self._c,t=e._self._setupProxy;return r("div",{class:t.fileListIconStyles["file-picker__file-icon"],style:t.previewLoaded?{backgroundImage:"url(".concat(t.previewURL,")")}:void 0},[t.previewLoaded?e._e():[t.isFile?r(t.IconFile,{attrs:{size:32}}):[t.folderDecorationIcon?r(t.NcIconSvgWrapper,{class:t.fileListIconStyles["file-picker__file-icon-overlay"],attrs:{inline:"",path:t.folderDecorationIcon,size:16}}):e._e(),r(t.IconFolder,{class:t.fileListIconStyles["file-picker__file-icon--primary"],attrs:{size:32}})]]],2)},qr=[],Gr=C(Zr,Ur,qr,!1,null,null);const Kr=Gr.exports,Jr=I({__name:"FileListRow",props:{allowPickDirectory:{type:Boolean},selected:{type:Boolean},showCheckbox:{type:Boolean},canPick:{type:Boolean},node:null,cropImagePreviews:{type:Boolean}},emits:["update:selected","enter-directory"],setup(e,{emit:r}){const t=e,i=m(()=>{var u;return((u=t.node.attributes)==null?void 0:u.displayName)||t.node.basename.slice(0,t.node.extension?-t.node.extension.length:void 0)}),n=m(()=>t.node.extension),a=m(()=>t.node.type===O.Folder),s=m(()=>t.canPick&&(t.allowPickDirectory||!a.value));function o(){r("update:selected",!t.selected)}function c(){a.value?r("enter-directory",t.node):o()}function l(u){u.key==="Enter"&&c()}return{__sfc:!0,props:t,emit:r,displayName:i,fileExtension:n,isDirectory:a,isPickable:s,toggleSelected:o,handleClick:c,handleKeyDown:l,formatFileSize:Qe,NcCheckboxRadioSwitch:Be,NcDateTime:or,t:_,FilePreview:Kr}}});var Qr=function(){var e=this,r=e._self._c,t=e._self._setupProxy;return r("tr",e._g({class:["file-picker__row",{"file-picker__row--selected":e.selected&&!e.showCheckbox}],attrs:{tabindex:e.showCheckbox&&!t.isDirectory?void 0:0,"aria-selected":t.isPickable?e.selected:void 0,"data-filename":e.node.basename,"data-testid":"file-list-row"}},z({click:t.handleClick},!e.showCheckbox||t.isDirectory?{keydown:t.handleKeyDown}:{})),[e.showCheckbox?r("td",{staticClass:"row-checkbox",on:{click:function(i){return i.stopPropagation(),(()=>{}).apply(null,arguments)}}},[r(t.NcCheckboxRadioSwitch,{attrs:{"aria-label":t.t("Select the row for {nodename}",{nodename:t.displayName}),disabled:!t.isPickable,"data-testid":"row-checkbox","model-value":e.selected},on:{"update:model-value":t.toggleSelected}})],1):e._e(),r("td",{staticClass:"row-name"},[r("div",{staticClass:"file-picker__name-container",attrs:{"data-testid":"row-name"}},[r(t.FilePreview,{attrs:{node:e.node,"crop-image-previews":e.cropImagePreviews}}),r("div",{staticClass:"file-picker__file-name",attrs:{title:t.displayName},domProps:{textContent:e._s(t.displayName)}}),r("div",{staticClass:"file-picker__file-extension",domProps:{textContent:e._s(t.fileExtension)}})],1)]),r("td",{staticClass:"row-size"},[e._v(" "+e._s(t.formatFileSize(e.node.size||0))+" ")]),r("td",{staticClass:"row-modified"},[r(t.NcDateTime,{attrs:{timestamp:e.node.mtime,"ignore-seconds":!0}})],1)])},Xr=[],Yr=C(Jr,Qr,Xr,!1,null,"4892c2a0");const ei=Yr.exports,ti=I({__name:"FileList",props:{currentView:null,multiselect:{type:Boolean},allowPickDirectory:{type:Boolean},loading:{type:Boolean},files:null,selectedFiles:null,path:null},emits:["update:path","update:selectedFiles"],setup(e,{emit:r}){const t=e,i=g(),{currentConfig:n}=br(t.currentView),a=m(()=>{var v;return(v=i.value)!=null?v:n.value}),s=m(()=>a.value.sortBy==="basename"?a.value.order==="none"?void 0:a.value.order:void 0),o=m(()=>a.value.sortBy==="size"?a.value.order==="none"?void 0:a.value.order:void 0),c=m(()=>a.value.sortBy==="mtime"?a.value.order==="none"?void 0:a.value.order:void 0),l=v=>{a.value.sortBy===v?a.value.order==="ascending"?i.value={sortBy:a.value.sortBy,order:"descending"}:i.value={sortBy:a.value.sortBy,order:"ascending"}:i.value={sortBy:v,order:"ascending"}},{sortFavoritesFirst:u,cropImagePreviews:d}=$e(),b=m(()=>Je(t.files,{sortFoldersFirst:!0,sortFavoritesFirst:u.value,sortingOrder:a.value.order==="descending"?"desc":"asc",sortingMode:a.value.sortBy})),p=m(()=>t.files.filter(v=>t.allowPickDirectory||v.type!==O.Folder)),k=m(()=>!t.loading&&t.selectedFiles.length>0&&t.selectedFiles.length>=p.value.length);function N(){t.selectedFiles.length<p.value.length?r("update:selectedFiles",p.value):r("update:selectedFiles",[])}function S(v){t.selectedFiles.includes(v)?r("update:selectedFiles",t.selectedFiles.filter(x=>x.path!==v.path)):t.multiselect?r("update:selectedFiles",[...t.selectedFiles,v]):r("update:selectedFiles",[v])}function B(v){r("update:path",v.path)}const L=g(4),F=g();{const v=()=>qe(()=>{var f,h,H,A,D;const x=((h=(f=F.value)==null?void 0:f.parentElement)==null?void 0:h.children)||[];let V=((A=(H=F.value)==null?void 0:H.parentElement)==null?void 0:A.clientHeight)||450;for(let P=0;P<x.length;P++)(D=F.value)!=null&&D.isSameNode(x[P])||(V-=x[P].clientHeight);L.value=Math.max(1,Math.floor((V-50)/50))});E(()=>{window.addEventListener("resize",v),v()}),Ge(()=>{window.removeEventListener("resize",v)})}return{__sfc:!0,props:t,emit:r,customSortingConfig:i,filesAppSorting:n,sortingConfig:a,sortByName:s,sortBySize:o,sortByModified:c,toggleSorting:l,sortFavoritesFirst:u,cropImagePreviews:d,sortedFiles:b,selectableFiles:p,allSelected:k,onSelectAll:N,onNodeSelected:S,onChangeDirectory:B,skeletonNumber:L,fileContainer:F,NcButton:X,NcCheckboxRadioSwitch:Be,t:_,IconSortAscending:Nr,IconSortDescending:Vr,LoadingTableRow:Ar,FileListRow:ei}}});var ri=function(){var e=this,r=e._self._c,t=e._self._setupProxy;return r("div",{ref:"fileContainer",staticClass:"file-picker__files"},[r("table",[r("thead",[r("tr",[e.multiselect?r("th",{staticClass:"row-checkbox"},[r("span",{staticClass:"hidden-visually"},[e._v(" "+e._s(t.t("Select entry"))+" ")]),e.multiselect?r(t.NcCheckboxRadioSwitch,{attrs:{"aria-label":t.t("Select all entries"),"data-testid":"select-all-checkbox","model-value":t.allSelected},on:{"update:model-value":t.onSelectAll}}):e._e()],1):e._e(),r("th",{staticClass:"row-name",attrs:{"aria-sort":t.sortByName}},[r("div",{staticClass:"header-wrapper"},[r("span",{staticClass:"file-picker__header-preview"}),r(t.NcButton,{attrs:{wide:!0,type:"tertiary","data-test":"file-picker_sort-name"},on:{click:function(i){return t.toggleSorting("basename")}},scopedSlots:e._u([{key:"icon",fn:function(){return[t.sortByName==="ascending"?r(t.IconSortAscending,{attrs:{size:20}}):t.sortByName==="descending"?r(t.IconSortDescending,{attrs:{size:20}}):r("span",{staticStyle:{width:"44px"}})]},proxy:!0}])},[e._v(" "+e._s(t.t("Name"))+" ")])],1)]),r("th",{staticClass:"row-size",attrs:{"aria-sort":t.sortBySize}},[r(t.NcButton,{attrs:{wide:!0,type:"tertiary"},on:{click:function(i){return t.toggleSorting("size")}},scopedSlots:e._u([{key:"icon",fn:function(){return[t.sortBySize==="ascending"?r(t.IconSortAscending,{attrs:{size:20}}):t.sortBySize==="descending"?r(t.IconSortDescending,{attrs:{size:20}}):r("span",{staticStyle:{width:"44px"}})]},proxy:!0}])},[e._v(" "+e._s(t.t("Size"))+" ")])],1),r("th",{staticClass:"row-modified",attrs:{"aria-sort":t.sortByModified}},[r(t.NcButton,{attrs:{wide:!0,type:"tertiary"},on:{click:function(i){return t.toggleSorting("mtime")}},scopedSlots:e._u([{key:"icon",fn:function(){return[t.sortByModified==="ascending"?r(t.IconSortAscending,{attrs:{size:20}}):t.sortByModified==="descending"?r(t.IconSortDescending,{attrs:{size:20}}):r("span",{staticStyle:{width:"44px"}})]},proxy:!0}])},[e._v(" "+e._s(t.t("Modified"))+" ")])],1)])]),r("tbody",[e.loading?e._l(t.skeletonNumber,function(i){return r(t.LoadingTableRow,{key:i,attrs:{"show-checkbox":e.multiselect}})}):e._l(t.sortedFiles,function(i){return r(t.FileListRow,{key:i.fileid||i.path,attrs:{"allow-pick-directory":e.allowPickDirectory,"show-checkbox":e.multiselect,"can-pick":e.multiselect||e.selectedFiles.length===0||e.selectedFiles.includes(i),selected:e.selectedFiles.includes(i),node:i,"crop-image-previews":t.cropImagePreviews},on:{"update:selected":function(n){return t.onNodeSelected(i)},"enter-directory":t.onChangeDirectory}})})],2)])])},ii=[],ni=C(ti,ri,ii,!1,null,"4f5d2a56");const ai=ni.exports,si={name:"HomeIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var oi=function(){var e=this,r=e._self._c;return r("span",e._b({staticClass:"material-design-icon home-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[r("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[r("path",{attrs:{d:"M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z"}},[e.title?r("title",[e._v(e._s(e.title))]):e._e()])])])},li=[],ci=C(si,oi,li,!1,null,null);const ui=ci.exports,di={name:"PlusIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var pi=function(){var e=this,r=e._self._c;return r("span",e._b({staticClass:"material-design-icon plus-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[r("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[r("path",{attrs:{d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"}},[e.title?r("title",[e._v(e._s(e.title))]):e._e()])])])},fi=[],mi=C(di,pi,fi,!1,null,null);const hi=mi.exports,vi=I({__name:"FilePickerBreadcrumbs",props:{path:null,showMenu:{type:Boolean}},emits:["update:path","create-node"],setup(e,{emit:r}){const t=e,i=g(!1),n=g(""),a=g();function s(){var b,p,k,N;const l=n.value.trim(),u=(p=(b=a.value)==null?void 0:b.$el)==null?void 0:p.querySelector("input");let d="";return l.length===0?d=_("Folder name cannot be empty."):l.includes("/")?d=_('"/" is not allowed inside a folder name.'):["..","."].includes(l)?d=_('"{name}" is an invalid folder name.',{name:l}):(k=window.OC.config)!=null&&k.blacklist_files_regex&&l.match((N=window.OC.config)==null?void 0:N.blacklist_files_regex)&&(d=_('"{name}" is not an allowed folder name',{name:l})),u&&u.setCustomValidity(d),d===""}const o=function(){const l=n.value.trim();s()&&(i.value=!1,r("create-node",l),n.value="")},c=m(()=>t.path.split("/").filter(l=>l!=="").map((l,u,d)=>({name:l,path:"/"+d.slice(0,u+1).join("/")})));return{__sfc:!0,props:t,emit:r,actionsOpen:i,newNodeName:n,nameInput:a,validateInput:s,onSubmit:o,pathElements:c,IconFolder:Ee,IconHome:ui,IconPlus:hi,NcActions:Y,NcActionInput:ct,NcBreadcrumbs:rr,NcBreadcrumb:Ie,t:_}}});var gi=function(){var e=this,r=e._self._c,t=e._self._setupProxy;return r(t.NcBreadcrumbs,{staticClass:"file-picker__breadcrumbs",scopedSlots:e._u([{key:"default",fn:function(){return[r(t.NcBreadcrumb,{attrs:{name:t.t("All files"),title:t.t("Home")},on:{click:function(i){return t.emit("update:path","/")}},scopedSlots:e._u([{key:"icon",fn:function(){return[r(t.IconHome,{attrs:{size:20}})]},proxy:!0}])}),e._l(t.pathElements,function(i){return r(t.NcBreadcrumb,{key:i.path,attrs:{name:i.name,title:i.path},on:{click:function(n){return t.emit("update:path",i.path)}}})})]},proxy:!0},e.showMenu?{key:"actions",fn:function(){return[r(t.NcActions,{attrs:{open:t.actionsOpen,"aria-label":t.t("Create directory"),"force-menu":!0,"force-name":!0,"menu-name":t.t("New"),type:"secondary"},on:{"update:open":function(i){t.actionsOpen=i},close:function(i){t.newNodeName=""}},scopedSlots:e._u([{key:"icon",fn:function(){return[r(t.IconPlus,{attrs:{size:20}})]},proxy:!0}],null,!1,2971667417)},[r(t.NcActionInput,{ref:"nameInput",attrs:{value:t.newNodeName,label:t.t("New folder"),placeholder:t.t("New folder name")},on:{"update:value":function(i){t.newNodeName=i},submit:t.onSubmit,"update:model-value":t.validateInput},scopedSlots:e._u([{key:"icon",fn:function(){return[r(t.IconFolder,{attrs:{size:20}})]},proxy:!0}],null,!1,1614167509)})],1)]},proxy:!0}:null],null,!0)})},yi=[],_i=C(vi,gi,yi,!1,null,"ec4d392b");const bi=_i.exports,wi={name:"CloseIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Ci=function(){var e=this,r=e._self._c;return r("span",e._b({staticClass:"material-design-icon close-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[r("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[r("path",{attrs:{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"}},[e.title?r("title",[e._v(e._s(e.title))]):e._e()])])])},ki=[],Si=C(wi,Ci,ki,!1,null,null);const Ni=Si.exports,xi={name:"MagnifyIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Fi=function(){var e=this,r=e._self._c;return r("span",e._b({staticClass:"material-design-icon magnify-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[r("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[r("path",{attrs:{d:"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"}},[e.title?r("title",[e._v(e._s(e.title))]):e._e()])])])},Li=[],Bi=C(xi,Fi,Li,!1,null,null);const Vi=Bi.exports,Hi=e=>{const r=[{id:"files",label:_("All files"),icon:cr},{id:"recent",label:_("Recent"),icon:lr},{id:"favorites",label:_("Favorites"),icon:mr}],t=e.value?r.filter(({id:i})=>i==="files"):r;return{allViews:r,availableViews:t}},Pi=I({__name:"FilePickerNavigation",props:{currentView:null,filterString:null,isCollapsed:{type:Boolean},disabledNavigation:{type:Boolean}},emits:["update:currentView","update:filterString"],setup(e,{emit:r}){const t=e,{availableViews:i}=Hi(g(ft()===null)),n=m(()=>{var a;return(a=i.filter(s=>s.id===t.currentView)[0])!=null?a:i[0]});return{__sfc:!0,props:t,emit:r,availableViews:i,currentViewObject:n,updateFilterValue:a=>r("update:filterString",a),IconClose:Ni,IconMagnify:Vi,NcButton:X,NcIconSvgWrapper:Le,NcSelect:lt,NcTextField:ot,Fragment:De,t:_}}});var Ii=function(){var e=this,r=e._self._c,t=e._self._setupProxy;return r(t.Fragment,[r(t.NcTextField,{staticClass:"file-picker__filter-input",attrs:{label:t.t("Filter file list"),"show-trailing-button":!!e.filterString,"model-value":e.filterString},on:{"update:model-value":t.updateFilterValue,"trailing-button-click":function(i){return t.updateFilterValue("")}},scopedSlots:e._u([{key:"trailing-button-icon",fn:function(){return[r(t.IconClose,{attrs:{size:16}})]},proxy:!0}])},[r(t.IconMagnify,{attrs:{size:16}})],1),t.availableViews.length>1&&!e.disabledNavigation?[e.isCollapsed?r(t.NcSelect,{attrs:{"aria-label":t.t("Current view selector"),clearable:!1,searchable:!1,options:t.availableViews,"model-value":t.currentViewObject},on:{"update:model-value":function(i){return t.emit("update:currentView",i.id)}}}):r("ul",{staticClass:"file-picker__side"},e._l(t.availableViews,function(i){return r("li",{key:i.id},[r(t.NcButton,{attrs:{type:e.currentView===i.id?"primary":"tertiary",wide:!0},on:{click:function(n){return e.$emit("update:currentView",i.id)}},scopedSlots:e._u([{key:"icon",fn:function(){return[r(t.NcIconSvgWrapper,{attrs:{path:i.icon,size:20}})]},proxy:!0}],null,!0)},[e._v(" "+e._s(i.label)+" ")])],1)}),0)]:e._e()],2)},zi=[],Ai=C(Pi,Ii,zi,!1,null,"f5975252");const Di=Ai.exports;function Mi(e){const r=new AbortController,t=Math.round(Date.now()/1e3)-60*60*24*14;return new He(async(i,n,a)=>{a(()=>r.abort());try{const{data:s}=await e.search("/",{signal:r.signal,details:!0,data:gt(t)}),o=s.results.map(c=>ie(c));i(o)}catch(s){n(s)}})}function Oi(e,r){const t=new AbortController;return new He(async(i,n,a)=>{a(()=>t.abort());try{const s=(await e.getDirectoryContents(q.join(re,r),{signal:t.signal,details:!0,includeSelf:!0,data:Pe()})).data.map(o=>ie(o));i({contents:s.filter(({path:o})=>o!==r),folder:s.find(({path:o})=>o===r)})}catch(s){n(s)}})}async function $i(e,r){const{data:t}=await e.stat(q.join(re,r),{details:!0,data:Pe()});return ie(t)}const Ri=function(e,r){const t=ht(),i=J([]),n=J(null),a=g(!0),s=g(null);async function o(l){const u=q.join(r.value,l);await t.createDirectory(q.join(re,u));const d=await $i(t,u);return i.value=[...i.value,d],d}async function c(){s.value&&s.value.cancel(),a.value=!0,e.value==="favorites"?s.value=vt(t,r.value):e.value==="recent"?s.value=Mi(t):s.value=Oi(t,r.value);const l=await s.value;"folder"in l?(n.value=l.folder,i.value=l.contents):(n.value=null,i.value=l),s.value=null,a.value=!1}return Fe([e,r],()=>c()),E(()=>c()),{isLoading:a,files:i,folder:n,loadFiles:c,createDirectory:o}},Ei=function(e){const r=m(()=>e.value.map(t=>t.split("/")));return{isSupportedMimeType:t=>{const i=t.split("/");return r.value.some(([n,a])=>(i[0]===n||n==="*")&&(i[1]===a||a==="*"))}}},Ti={name:"FilePicker"},ji=I(j(z({},Ti),{props:{buttons:null,name:null,allowPickDirectory:{type:Boolean,default:!1},disabledNavigation:{type:Boolean,default:!1},container:{default:"body"},filterFn:{default:void 0},mimetypeFilter:{default:()=>[]},multiselect:{type:Boolean,default:!0},path:{default:void 0}},emits:["close"],setup(e,{emit:r}){const t=e,i=g(!0),n=m(()=>{const f=l.value.length===0&&t.allowPickDirectory&&S.value?[S.value]:l.value;return(typeof t.buttons=="function"?t.buttons(f,b.value,o.value):t.buttons).map(h=>j(z({},h),{disabled:h.disabled||B.value,callback:()=>{a=!0,s(h.callback,f)}}))});let a=!1;const s=async(f,h)=>{f(h),r("close",h),a=!1},o=g("files"),c=m(()=>o.value==="favorites"?_("Favorites"):o.value==="recent"?_("Recent"):""),l=J([]),u=g((window==null?void 0:window.sessionStorage.getItem("NC.FilePicker.LastPath"))||"/"),d=g("");Fe([d],()=>{t.path===void 0&&d.value&&window.sessionStorage.setItem("NC.FilePicker.LastPath",d.value),l.value=[]});const b=m({get:()=>o.value==="files"?d.value||t.path||u.value:"/",set:f=>{d.value=f}}),p=g(""),{isSupportedMimeType:k}=Ei(U(t,"mimetypeFilter")),{files:N,folder:S,isLoading:B,loadFiles:L,createDirectory:F}=Ri(o,b);E(()=>L());const{showHiddenFiles:v}=$e(),x=m(()=>{let f=N.value;return v.value||(f=f.filter(h=>!h.basename.startsWith("."))),t.mimetypeFilter.length>0&&(f=f.filter(h=>h.type==="folder"||h.mime&&k(h.mime))),p.value&&(f=f.filter(h=>h.basename.toLowerCase().includes(p.value.toLowerCase()))),t.filterFn&&(f=f.filter(h=>t.filterFn(h))),f}),V=m(()=>o.value==="files"?_("Upload some content or sync with your devices!"):o.value==="recent"?_("Files and folders you recently modified will show up here."):_("Files and folders you mark as favorite will show up here."));return{__sfc:!0,props:t,emit:r,isOpen:i,dialogButtons:n,isHandlingCallback:a,handleButtonClick:s,currentView:o,viewHeadline:c,selectedFiles:l,savedPath:u,navigatedPath:d,currentPath:b,filterString:p,isSupportedMimeType:k,files:N,currentFolder:S,isLoading:B,loadFiles:L,createDirectory:F,showHiddenFiles:v,filteredFiles:x,noFilesDescription:V,onCreateFolder:async f=>{try{const h=await F(f);d.value=h.path,pt("files:node:created",N.value.filter(H=>H.basename===f)[0])}catch(h){console.warn("Could not create new folder",{name:f,error:h}),ee(_("Could not create the new folder"))}},handleClose:f=>{!f&&!a&&r("close")},IconFile:Oe,FileList:ai,FilePickerBreadcrumbs:bi,FilePickerNavigation:Di,NcDialog:mt,NcEmptyContent:st,t:_}}}));var Wi=function(){var e=this,r=e._self._c,t=e._self._setupProxy;return r(t.NcDialog,{attrs:{open:t.isOpen,container:e.container,buttons:t.dialogButtons,name:e.name,size:"large","content-classes":"file-picker__content","dialog-classes":"file-picker","navigation-classes":"file-picker__navigation"},on:{"update:open":[function(i){t.isOpen=i},t.handleClose]},scopedSlots:e._u([{key:"navigation",fn:function({isCollapsed:i}){return[r(t.FilePickerNavigation,{attrs:{"current-view":t.currentView,"filter-string":t.filterString,"is-collapsed":i,"disabled-navigation":e.disabledNavigation},on:{"update:currentView":function(n){t.currentView=n},"update:current-view":function(n){t.currentView=n},"update:filterString":function(n){t.filterString=n},"update:filter-string":function(n){t.filterString=n}}})]}}])},[r("div",{staticClass:"file-picker__main"},[t.currentView==="files"?r(t.FilePickerBreadcrumbs,{attrs:{path:t.currentPath,"show-menu":e.allowPickDirectory},on:{"update:path":function(i){t.currentPath=i},"create-node":t.onCreateFolder}}):r("div",{staticClass:"file-picker__view"},[r("h3",[e._v(e._s(t.viewHeadline))])]),t.isLoading||t.filteredFiles.length>0?r(t.FileList,{attrs:{path:t.currentPath,"selected-files":t.selectedFiles,"allow-pick-directory":e.allowPickDirectory,"current-view":t.currentView,files:t.filteredFiles,multiselect:e.multiselect,loading:t.isLoading,name:t.viewHeadline},on:{"update:path":[function(i){t.currentPath=i},function(i){t.currentView="files"}],"update:selectedFiles":function(i){t.selectedFiles=i},"update:selected-files":function(i){t.selectedFiles=i}}}):t.filterString?r(t.NcEmptyContent,{attrs:{name:t.t("No matching files"),description:t.t("No files matching your filter were found.")},scopedSlots:e._u([{key:"icon",fn:function(){return[r(t.IconFile)]},proxy:!0}])}):r(t.NcEmptyContent,{attrs:{name:t.t("No files in here"),description:t.noFilesDescription},scopedSlots:e._u([{key:"icon",fn:function(){return[r(t.IconFile)]},proxy:!0}])})],1)])},Zi=[],Ui=C(ji,Wi,Zi,!1,null,"552cc2f5");const dn=Ui.exports;export{dn as default};
//# sourceMappingURL=FilePicker-CsU6FfAP-D-oPIKix.chunk.mjs.map
