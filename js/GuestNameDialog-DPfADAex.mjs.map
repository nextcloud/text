{"version":3,"file":"GuestNameDialog-DPfADAex.mjs","sources":["../src/components/Editor/GuestNameDialog.vue"],"sourcesContent":["<!--\n  - @copyright Copyright (c) 2019 Julius Härtl <jus@bitgrid.net>\n  -\n  - @author Julius Härtl <jus@bitgrid.net>\n  -\n  - @license GNU AGPL version 3 or any later version\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\n  -\n  -->\n\n<template>\n\t<form :title=\"t('text', 'Enter your name so other people can see who is editing')\" class=\"guest-name-dialog\" @submit.prevent=\"setGuestName()\">\n\t\t<label><AvatarWrapper :session=\"session\" :size=\"32\" /></label>\n\t\t<input v-model=\"guestName\"\n\t\t\ttype=\"text\"\n\t\t\t:aria-label=\"t('text', 'Edit guest name')\"\n\t\t\t:placeholder=\"t('text', 'Guest')\">\n\t\t<input type=\"submit\"\n\t\t\tclass=\"icon-confirm\"\n\t\t\t:aria-label=\"t('text', 'Save guest name')\"\n\t\t\tvalue=\"\">\n\t</form>\n</template>\n\n<script>\nimport { generateUrl } from '@nextcloud/router'\nimport AvatarWrapper from './AvatarWrapper.vue'\nimport { useSyncServiceMixin } from '../Editor.provider.js'\n\nexport default {\n\tname: 'GuestNameDialog',\n\tcomponents: {\n\t\tAvatarWrapper,\n\t},\n\tmixins: [\n\t\tuseSyncServiceMixin,\n\t],\n\tprops: {\n\t\tsession: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tguestName: '',\n\t\t\tguestNameBuffered: '',\n\t\t}\n\t},\n\tcomputed: {\n\t\tavatarUrl() {\n\t\t\tconst size = 32\n\t\t\tconst avatarUrl = generateUrl(\n\t\t\t\t'/avatar/guest/{user}/{size}',\n\t\t\t\t{\n\t\t\t\t\tuser: this.guestNameBuffered,\n\t\t\t\t\tsize,\n\t\t\t\t})\n\t\t\treturn window.location.protocol + '//' + window.location.host + avatarUrl\n\t\t},\n\t},\n\tbeforeMount() {\n\t\tthis.guestName = this.$syncService.connection.session.guestName\n\t\tthis.updateBufferedGuestName()\n\t},\n\tmethods: {\n\t\tsetGuestName() {\n\t\t\tconst previousGuestName = this.$syncService.connection.session.guestName\n\t\t\tthis.$syncService.updateSession(this.guestName).then(() => {\n\t\t\t\tlocalStorage.setItem('nick', this.guestName)\n\t\t\t\tthis.updateBufferedGuestName()\n\t\t\t}).catch((e) => {\n\t\t\t\tthis.guestName = previousGuestName\n\t\t\t})\n\t\t},\n\t\tupdateBufferedGuestName() {\n\t\t\tthis.guestNameBuffered = this.guestName\n\t\t},\n\t},\n}\n</script>\n\n<style scoped lang=\"scss\">\n\tform.guest-name-dialog {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tpadding: 6px;\n\n\t\t&:deep(img) {\n\t\t\tmargin: 0 !important;\n\t\t}\n\n\t\tinput[type=text] {\n\t\t\tflex-grow: 1;\n\t\t}\n\t\tlabel {\n\t\t\tpadding-right: 3px;\n\t\t\theight: 32px;\n\t\t}\n\t}\n</style>\n"],"names":["_sfc_main","AvatarWrapper","useSyncServiceMixin","avatarUrl","generateUrl","previousGuestName","e"],"mappings":";+iBAyCA,MAAAA,EAAA,CACA,KAAA,kBACA,WAAA,CACA,cAAAC,CACA,EACA,OAAA,CACAC,CACA,EACA,MAAA,CACA,QAAA,CACA,KAAA,OACA,SAAA,EACA,CACA,EACA,MAAA,CACA,MAAA,CACA,UAAA,GACA,kBAAA,EACA,CACA,EACA,SAAA,CACA,WAAA,CAEA,MAAAC,EAAAC,EACA,8BACA,CACA,KAAA,KAAA,kBACA,KAAA,EACA,CAAA,EACA,OAAA,OAAA,SAAA,SAAA,KAAA,OAAA,SAAA,KAAAD,CACA,CACA,EACA,aAAA,CACA,KAAA,UAAA,KAAA,aAAA,WAAA,QAAA,UACA,KAAA,wBAAA,CACA,EACA,QAAA,CACA,cAAA,CACA,MAAAE,EAAA,KAAA,aAAA,WAAA,QAAA,UACA,KAAA,aAAA,cAAA,KAAA,SAAA,EAAA,KAAA,IAAA,CACA,aAAA,QAAA,OAAA,KAAA,SAAA,EACA,KAAA,wBAAA,CACA,CAAA,EAAA,MAAAC,GAAA,CACA,KAAA,UAAAD,CACA,CAAA,CACA,EACA,yBAAA,CACA,KAAA,kBAAA,KAAA,SACA,CACA,CACA"}