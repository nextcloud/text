import{V as T,d as $,r as k,c as C,x as W,w as ye,t as _e,o as V,q as $e,n as Oe,h as De}from"./vue.runtime.esm-DO2cz8pp.chunk.mjs";import{b as L,t as S,s as q,p as ae}from"./_plugin-vue2_normalizer-CQ6iBklL-C2xaZ2hl.chunk.mjs";import{f as Ee,g as oe,c as le,h as Ae,s as Ve,i as Z,d as Te,e as Me,C as ce,j as He,k as Re}from"./index-BdNd3WSV.chunk.mjs";import{c as je,z as We,k as qe,g as Ze,B as Ue,N as be,j as Ye,e as Ke,t as Ge,D as Je}from"./_plugin-vue2_normalizer-khdWz7r2.chunk.mjs";import{a as Qe,c as we,_ as U,U as Xe}from"./index-BGFdrNqh.chunk.mjs";import{n as Y,N as K,C as et,a as G,G as tt,i as J,y as it}from"./public-BSZ20KYR.chunk.mjs";import{s as rt,u as nt,e as st,g as at}from"./modulepreload-polyfill-DE-oIJqv.chunk.mjs";import{l as Ce}from"./index-DfiDB3im.chunk.mjs";import{g as ot}from"./emoji-picker-KVqjnXYv.chunk.mjs";import{a as H}from"./index-C4crf4p_.chunk.mjs";import"./index-Bc2S5k6V.chunk.mjs";const lt={name:"NcBreadcrumb",components:{NcActions:K,ChevronRight:et,NcButton:G},inheritAttrs:!1,props:{name:{type:String,required:!0},title:{type:String,default:null},to:{type:[String,Object],default:void 0},exact:{type:Boolean,default:!1},href:{type:String,default:void 0},icon:{type:String,default:""},forceIconText:{type:Boolean,default:!1},disableDrop:{type:Boolean,default:!1},forceMenu:{type:Boolean,default:!1},open:{type:Boolean,default:!1}},emits:["update:open","dropped"],data(){return{hovering:!1,crumbId:`crumb-id-${tt()}`}},computed:{linkAttributes(){return this.to?{to:this.to,exact:this.exact,...this.$attrs}:this.href?{href:this.href,...this.$attrs}:this.$attrs}},methods:{onOpenChange(e){this.$emit("update:open",e)},dropped(e){return this.disableDrop||(this.$emit("dropped",e,this.to||this.href),this.$parent.$emit("dropped",e,this.to||this.href),this.hovering=!1),!1},dragEnter(e){this.disableDrop||(this.hovering=!0)},dragLeave(e){this.disableDrop||e.target.contains(e.relatedTarget)||this.$refs.crumb.contains(e.relatedTarget)||(this.hovering=!1)}}};var ct=function(){var e=this,i=e._self._c;return i("li",e._b({ref:"crumb",staticClass:"vue-crumb",class:{"vue-crumb--hovered":e.hovering},attrs:{draggable:"false"},on:{dragstart:function(t){return t.preventDefault(),(()=>{}).apply(null,arguments)},drop:function(t){return t.preventDefault(),e.dropped.apply(null,arguments)},dragover:function(t){return t.preventDefault(),(()=>{}).apply(null,arguments)},dragenter:e.dragEnter,dragleave:e.dragLeave}},"li",e._d({},[e.crumbId,""])),[(e.name||e.icon||e.$slots.icon)&&!e.$slots.default?i("NcButton",e._g(e._b({attrs:{title:e.title,"aria-label":e.icon?e.name:void 0,type:"tertiary"},scopedSlots:e._u([e.$slots.icon||e.icon?{key:"icon",fn:function(){return[e._t("icon",function(){return[i("span",{staticClass:"icon",class:e.icon})]})]},proxy:!0}:null,!(e.$slots.icon||e.icon)||e.forceIconText?{key:"default",fn:function(){return[e._v(" "+e._s(e.name)+" ")]},proxy:!0}:null],null,!0)},"NcButton",e.linkAttributes,!1),e.$listeners)):e._e(),e.$slots.default?i("NcActions",{ref:"actions",attrs:{type:"tertiary","force-menu":e.forceMenu,open:e.open,"menu-name":e.name,title:e.title,"force-name":!0,container:`.vue-crumb[${e.crumbId}]`},on:{"update:open":e.onOpenChange},scopedSlots:e._u([{key:"icon",fn:function(){return[e._t("menu-icon")]},proxy:!0}],null,!0)},[e._t("default")],2):e._e(),i("ChevronRight",{staticClass:"vue-crumb__separator",attrs:{size:20}})],1)},ut=[],dt=Y(lt,ct,ut,!1,null,"cfe13af3");const ke=dt.exports;var R=Symbol(),E=Symbol(),ue=Symbol(),de=Symbol(),Q=function(e){return"frag"in e},pt={get:function(){return this[E]||this.parentElement},configurable:!0},A=function(e,i){E in e||(e[E]=i,Object.defineProperty(e,"parentNode",pt))},ft={get:function(){var e=this.parentNode.childNodes,i=e.indexOf(this);return i>-1&&e[i+1]||null}},M=function(e){ue in e||(e[ue]=!0,Object.defineProperty(e,"nextSibling",ft))},ht=function(e,i){for(;e.parentNode!==i;){var t=e,r=t.parentNode;r&&(e=r)}return e},j,xe=function(e){if(!j){var i=Object.getOwnPropertyDescriptor(Node.prototype,"childNodes");j=i.get}var t=j.apply(e),r=Array.from(t).map(function(n){return ht(n,e)});return r.filter(function(n,s){return n!==r[s-1]})},vt={get:function(){return this.frag||xe(this)}},mt={get:function(){return this.childNodes[0]||null}};function gt(){return this.childNodes.length>0}var pe=function(e){de in e||(e[de]=!0,Object.defineProperties(e,{childNodes:vt,firstChild:mt}),e.hasChildNodes=gt)};function yt(){var e;(e=this.frag[0]).before.apply(e,arguments)}function _t(){var e=this.frag,i=e.splice(0,e.length);i.forEach(function(t){t.remove()})}var bt=function e(i){var t;return(t=Array.prototype).concat.apply(t,i.map(function(r){return Q(r)?e(r.frag):r}))},wt=function(e,i){var t=e[R];i.before(t),A(t,e),e.frag.unshift(t)};function fe(e){if(Q(this)){var i=this.frag.indexOf(e);if(i>-1){var t=this.frag.splice(i,1),r=t[0];this.frag.length===0&&wt(this,r),e.remove()}}else{var n=xe(this),s=n.indexOf(e);s>-1&&e.remove()}return e}function he(e,i){var t=this,r=e.frag||[e];if(Q(this)){if(e[E]===this&&e.parentElement)return e;var n=this.frag;if(i){var s=n.indexOf(i);s>-1&&(n.splice.apply(n,[s,0].concat(r)),i.before.apply(i,r))}else{var c=n[n.length-1];n.push.apply(n,r),c.after.apply(c,r)}Se(this)}else i?this.childNodes.includes(i)&&i.before.apply(i,r):this.append.apply(this,r);r.forEach(function(o){A(o,t)});var u=r[r.length-1];return M(u),e}function Ct(e){if(e[E]===this&&e.parentElement)return e;var i=this.frag,t=i[i.length-1];return t.after(e),A(e,this),Se(this),i.push(e),e}var Se=function(e){var i=e[R];e.frag[0]===i&&(e.frag.shift(),i.remove())},kt={set:function(e){var i=this;if(this.frag[0]!==this[R]&&this.frag.slice().forEach(function(r){return i.removeChild(r)}),e){var t=document.createElement("div");t.innerHTML=e,Array.from(t.childNodes).forEach(function(r){i.appendChild(r)})}},get:function(){return""}},xt={inserted:function(e){var i=e.parentNode,t=e.nextSibling,r=e.previousSibling,n=Array.from(e.childNodes),s=document.createComment("");n.length===0&&n.push(s),e.frag=n,e[R]=s;var c=document.createDocumentFragment();c.append.apply(c,bt(n)),e.replaceWith(c),n.forEach(function(u){A(u,e),M(u)}),pe(e),Object.assign(e,{remove:_t,appendChild:Ct,insertBefore:he,removeChild:fe,before:yt}),Object.defineProperty(e,"innerHTML",kt),i&&(Object.assign(i,{removeChild:fe,insertBefore:he}),A(e,i),pe(i)),t&&M(e),r&&M(r)},unbind:function(e){e.remove()}},Ne={name:"Fragment",directives:{frag:xt},render:function(e){return e("div",{directives:[{name:"frag"}]},this.$slots.default)}};const ve=(e,i,t)=>{if(e!==void 0)for(let r=e.length-1;r>=0;r--){const n=e[r],s=!n.componentOptions&&n.tag&&i.indexOf(n.tag)===-1,c=!!n.componentOptions&&typeof n.componentOptions.tag=="string",u=c&&i.indexOf(n.componentOptions.tag)===-1;(s||!c||u)&&((s||u)&&T.util.warn(`${s?n.tag:n.componentOptions.tag} is not allowed inside the ${t.$options.name} component`,t),e.splice(r,1))}},St={name:"FolderIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Nt=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon folder-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Ft=[],Lt=Y(St,Nt,Ft,!1,null,null);const Bt=Lt.exports,N="vue-crumb",It={name:"NcBreadcrumbs",components:{NcActions:K,NcActionButton:je,NcActionRouter:We,NcActionLink:qe,NcBreadcrumb:ke,IconFolder:Bt},props:{rootIcon:{type:String,default:"icon-home"},ariaLabel:{type:String,default:null}},emits:["dropped"],data(){return{hiddenIndices:[],menuBreadcrumbProps:{name:"",forceMenu:!0,disableDrop:!0,open:!1},breadcrumbsRefs:{}}},beforeMount(){ve(this.$slots.default,["NcBreadcrumb"],this)},beforeUpdate(){ve(this.$slots.default,["NcBreadcrumb"],this)},created(){window.addEventListener("resize",Qe(()=>{this.handleWindowResize()},100)),rt("navigation-toggled",this.delayedResize)},mounted(){this.handleWindowResize()},updated(){this.delayedResize(),this.$nextTick(()=>{this.hideCrumbs()})},beforeDestroy(){window.removeEventListener("resize",this.handleWindowResize),nt("navigation-toggled",this.delayedResize)},methods:{closeActions(e){this.$refs.actionsBreadcrumb.$el.contains(e.relatedTarget)||(this.menuBreadcrumbProps.open=!1)},async delayedResize(){await this.$nextTick(),this.handleWindowResize()},handleWindowResize(){if(!this.$refs.container)return;const e=Object.values(this.breadcrumbsRefs),i=e.length,t=[],r=this.$refs.container.offsetWidth;let n=this.getTotalWidth(e);this.$refs.breadcrumb__actions&&(n+=this.$refs.breadcrumb__actions.offsetWidth);let s=n-r;s+=s>0?64:0;let c=0;const u=Math.floor(i/2);for(;s>0&&c<i-2;){const o=u+(c%2?c+1:c)/2*Math.pow(-1,c+i%2);s-=this.getWidth(e[o]?.elm,o===e.length-1),t.push(o),c++}this.arraysEqual(this.hiddenIndices,t.sort((o,a)=>o-a))||(this.hiddenIndices=t)},arraysEqual(e,i){if(e.length!==i.length)return!1;if(e===i)return!0;if(e===null||i===null)return!1;for(let t=0;t<e.length;++t)if(e[t]!==i[t])return!1;return!0},getTotalWidth(e){return e.reduce((i,t,r)=>i+this.getWidth(t?.elm,r===e.length-1),0)},getWidth(e,i){if(!e?.classList)return 0;const t=e.classList.contains(`${N}--hidden`);e.style.minWidth="auto",i&&(e.style.maxWidth="210px"),e.classList.remove(`${N}--hidden`);const r=e.offsetWidth;return t&&e.classList.add(`${N}--hidden`),e.style.minWidth="",e.style.maxWidth="",r},preventDefault(e){return e.preventDefault&&e.preventDefault(),!1},dragStart(e){return this.preventDefault(e)},dropped(e,i,t){return t||this.$emit("dropped",e,i),this.menuBreadcrumbProps.open=!1,document.querySelectorAll(`.${N}`).forEach(r=>{r.classList.remove(`${N}--hovered`)}),this.preventDefault(e)},dragOver(e){return this.preventDefault(e)},dragEnter(e,i){if(!i&&e.target.closest){const t=e.target.closest(`.${N}`);t.classList&&t.classList.contains(N)&&(document.querySelectorAll(`.${N}`).forEach(r=>{r.classList.remove(`${N}--hovered`)}),t.classList.add(`${N}--hovered`))}},dragLeave(e,i){if(!i&&!e.target.contains(e.relatedTarget)&&e.target.closest){const t=e.target.closest(`.${N}`);if(t.contains(e.relatedTarget))return;t.classList&&t.classList.contains(N)&&t.classList.remove(`${N}--hovered`)}},hideCrumbs(){Object.values(this.breadcrumbsRefs).forEach((e,i)=>{e?.elm?.classList&&(this.hiddenIndices.includes(i)?e.elm.classList.add(`${N}--hidden`):e.elm.classList.remove(`${N}--hidden`))})},isBreadcrumb(e){return(e?.componentOptions?.tag||e?.tag||"").includes("NcBreadcrumb")}},render(e){const i=[];if(this.$slots.default.forEach(s=>{if(this.isBreadcrumb(s)){i.push(s);return}s?.type===Ne&&s?.children?.forEach?.(c=>{this.isBreadcrumb(c)&&i.push(c)})}),i.length===0)return;T.set(i[0].componentOptions.propsData,"icon",this.rootIcon),T.set(i[0].componentOptions.propsData,"ref","breadcrumbs");const t={};i.forEach((s,c)=>{T.set(s,"ref",`crumb-${c}`),t[c]=s});let r=[];if(!this.hiddenIndices.length)r=i;else{r=i.slice(0,Math.round(i.length/2)),r.push(e("NcBreadcrumb",{class:"dropdown",props:this.menuBreadcrumbProps,attrs:{"aria-hidden":!0},ref:"actionsBreadcrumb",key:"actions-breadcrumb-1",nativeOn:{dragstart:this.dragStart,dragenter:()=>{this.menuBreadcrumbProps.open=!0},dragleave:this.closeActions},on:{"update:open":c=>{this.menuBreadcrumbProps.open=c}}},this.hiddenIndices.filter(c=>c<=i.length-1).map(c=>{const u=i[c],o=u.componentOptions.propsData.to,a=u.componentOptions.propsData.href,l=u.componentOptions.propsData.disableDrop,f=u.componentOptions.propsData.title,v=u.componentOptions.propsData.name;let p="NcActionButton",g="";a&&(p="NcActionLink",g=a),o&&(p="NcActionRouter",g=o);const d=e("IconFolder",{props:{size:20},slot:"icon"});return e(p,{class:N,props:{href:a||null,title:f,to:o||null},attrs:{draggable:!1},on:{...u.componentOptions.listeners},nativeOn:{dragstart:this.dragStart,drop:h=>this.dropped(h,g,l),dragover:this.dragOver,dragenter:h=>this.dragEnter(h,l),dragleave:h=>this.dragLeave(h,l)}},[d,v])})));const s=i.slice(Math.round(i.length/2));r=r.concat(s)}const n=[e("nav",{attrs:{"aria-label":this.ariaLabel}},[e("ul",{class:"breadcrumb__crumbs"},[r])])];return this.$slots.actions&&n.push(e("div",{class:"breadcrumb__actions",ref:"breadcrumb__actions"},this.$slots.actions)),this.breadcrumbsRefs=t,e("div",{class:["breadcrumb",{"breadcrumb--collapsed":this.hiddenIndices.length===i.length-2}],ref:"container"},n)}},Pt=null,zt=null;var $t=Y(It,Pt,zt,!1,null,"629bf30f");const Ot=$t.exports;var Fe={exports:{}};(function(e){var i=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function n(o,a,l){this.fn=o,this.context=a,this.once=l||!1}function s(o,a,l,f,v){if(typeof l!="function")throw new TypeError("The listener must be a function");var p=new n(l,f||o,v),g=t?t+a:a;return o._events[g]?o._events[g].fn?o._events[g]=[o._events[g],p]:o._events[g].push(p):(o._events[g]=p,o._eventsCount++),o}function c(o,a){--o._eventsCount===0?o._events=new r:delete o._events[a]}function u(){this._events=new r,this._eventsCount=0}u.prototype.eventNames=function(){var o=[],a,l;if(this._eventsCount===0)return o;for(l in a=this._events)i.call(a,l)&&o.push(t?l.slice(1):l);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(a)):o},u.prototype.listeners=function(o){var a=t?t+o:o,l=this._events[a];if(!l)return[];if(l.fn)return[l.fn];for(var f=0,v=l.length,p=new Array(v);f<v;f++)p[f]=l[f].fn;return p},u.prototype.listenerCount=function(o){var a=t?t+o:o,l=this._events[a];return l?l.fn?1:l.length:0},u.prototype.emit=function(o,a,l,f,v,p){var g=t?t+o:o;if(!this._events[g])return!1;var d=this._events[g],h=arguments.length,_,m;if(d.fn){switch(d.once&&this.removeListener(o,d.fn,void 0,!0),h){case 1:return d.fn.call(d.context),!0;case 2:return d.fn.call(d.context,a),!0;case 3:return d.fn.call(d.context,a,l),!0;case 4:return d.fn.call(d.context,a,l,f),!0;case 5:return d.fn.call(d.context,a,l,f,v),!0;case 6:return d.fn.call(d.context,a,l,f,v,p),!0}for(m=1,_=new Array(h-1);m<h;m++)_[m-1]=arguments[m];d.fn.apply(d.context,_)}else{var F=d.length,y;for(m=0;m<F;m++)switch(d[m].once&&this.removeListener(o,d[m].fn,void 0,!0),h){case 1:d[m].fn.call(d[m].context);break;case 2:d[m].fn.call(d[m].context,a);break;case 3:d[m].fn.call(d[m].context,a,l);break;case 4:d[m].fn.call(d[m].context,a,l,f);break;default:if(!_)for(y=1,_=new Array(h-1);y<h;y++)_[y-1]=arguments[y];d[m].fn.apply(d[m].context,_)}}return!0},u.prototype.on=function(o,a,l){return s(this,o,a,l,!1)},u.prototype.once=function(o,a,l){return s(this,o,a,l,!0)},u.prototype.removeListener=function(o,a,l,f){var v=t?t+o:o;if(!this._events[v])return this;if(!a)return c(this,v),this;var p=this._events[v];if(p.fn)p.fn===a&&(!f||p.once)&&(!l||p.context===l)&&c(this,v);else{for(var g=0,d=[],h=p.length;g<h;g++)(p[g].fn!==a||f&&!p[g].once||l&&p[g].context!==l)&&d.push(p[g]);d.length?this._events[v]=d.length===1?d[0]:d:c(this,v)}return this},u.prototype.removeAllListeners=function(o){var a;return o?(a=t?t+o:o,this._events[a]&&c(this,a)):(this._events=new r,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=t,u.EventEmitter=u,e.exports=u})(Fe);var Dt=Fe.exports;const Et=ot(Dt);class Le extends Error{constructor(i){super(i),this.name="TimeoutError"}}class At extends Error{constructor(i){super(),this.name="AbortError",this.message=i}}const me=e=>globalThis.DOMException===void 0?new At(e):new DOMException(e),ge=e=>{const i=e.reason===void 0?me("This operation was aborted."):e.reason;return i instanceof Error?i:me(i)};function Vt(e,i){const{milliseconds:t,fallback:r,message:n,customTimers:s={setTimeout,clearTimeout}}=i;let c;const u=new Promise((o,a)=>{if(typeof t!="number"||Math.sign(t)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${t}\``);if(i.signal){const{signal:f}=i;f.aborted&&a(ge(f));const v=()=>{a(ge(f))};f.addEventListener("abort",v,{once:!0}),e.finally(()=>{f.removeEventListener("abort",v)})}if(t===Number.POSITIVE_INFINITY){e.then(o,a);return}const l=new Le;c=s.setTimeout.call(void 0,()=>{if(r){try{o(r())}catch(f){a(f)}return}typeof e.cancel=="function"&&e.cancel(),n===!1?o():n instanceof Error?a(n):(l.message=n??`Promise timed out after ${t} milliseconds`,a(l))},t),(async()=>{try{o(await e)}catch(f){a(f)}})()}).finally(()=>{u.clear()});return u.clear=()=>{s.clearTimeout.call(void 0,c),c=void 0},u}function Tt(e,i,t){let r=0,n=e.length;for(;n>0;){const s=Math.trunc(n/2);let c=r+s;t(e[c],i)<=0?(r=++c,n-=s+1):n=s}return r}class Mt{#e=[];enqueue(i,t){t={priority:0,...t};const r={priority:t.priority,run:i};if(this.size&&this.#e[this.size-1].priority>=t.priority){this.#e.push(r);return}const n=Tt(this.#e,r,(s,c)=>c.priority-s.priority);this.#e.splice(n,0,r)}dequeue(){return this.#e.shift()?.run}filter(i){return this.#e.filter(t=>t.priority===i.priority).map(t=>t.run)}get size(){return this.#e.length}}class Ht extends Et{#e;#a;#s=0;#f;#o;#h=0;#i;#l;#t;#v;#r=0;#c;#n;#m;timeout;constructor(i){if(super(),i={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:Mt,...i},!(typeof i.intervalCap=="number"&&i.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${i.intervalCap?.toString()??""}\` (${typeof i.intervalCap})`);if(i.interval===void 0||!(Number.isFinite(i.interval)&&i.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${i.interval?.toString()??""}\` (${typeof i.interval})`);this.#e=i.carryoverConcurrencyCount,this.#a=i.intervalCap===Number.POSITIVE_INFINITY||i.interval===0,this.#f=i.intervalCap,this.#o=i.interval,this.#t=new i.queueClass,this.#v=i.queueClass,this.concurrency=i.concurrency,this.timeout=i.timeout,this.#m=i.throwOnTimeout===!0,this.#n=i.autoStart===!1}get#_(){return this.#a||this.#s<this.#f}get#b(){return this.#r<this.#c}#w(){this.#r--,this.#u(),this.emit("next")}#C(){this.#y(),this.#g(),this.#l=void 0}get#k(){const i=Date.now();if(this.#i===void 0){const t=this.#h-i;if(t<0)this.#s=this.#e?this.#r:0;else return this.#l===void 0&&(this.#l=setTimeout(()=>{this.#C()},t)),!0}return!1}#u(){if(this.#t.size===0)return this.#i&&clearInterval(this.#i),this.#i=void 0,this.emit("empty"),this.#r===0&&this.emit("idle"),!1;if(!this.#n){const i=!this.#k;if(this.#_&&this.#b){const t=this.#t.dequeue();return t?(this.emit("active"),t(),i&&this.#g(),!0):!1}}return!1}#g(){this.#a||this.#i!==void 0||(this.#i=setInterval(()=>{this.#y()},this.#o),this.#h=Date.now()+this.#o)}#y(){this.#s===0&&this.#r===0&&this.#i&&(clearInterval(this.#i),this.#i=void 0),this.#s=this.#e?this.#r:0,this.#d()}#d(){for(;this.#u(););}get concurrency(){return this.#c}set concurrency(i){if(!(typeof i=="number"&&i>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${i}\` (${typeof i})`);this.#c=i,this.#d()}async#x(i){return new Promise((t,r)=>{i.addEventListener("abort",()=>{r(i.reason)},{once:!0})})}async add(i,t={}){return t={timeout:this.timeout,throwOnTimeout:this.#m,...t},new Promise((r,n)=>{this.#t.enqueue(async()=>{this.#r++,this.#s++;try{t.signal?.throwIfAborted();let s=i({signal:t.signal});t.timeout&&(s=Vt(Promise.resolve(s),{milliseconds:t.timeout})),t.signal&&(s=Promise.race([s,this.#x(t.signal)]));const c=await s;r(c),this.emit("completed",c)}catch(s){if(s instanceof Le&&!t.throwOnTimeout){r();return}n(s),this.emit("error",s)}finally{this.#w()}},t),this.emit("add"),this.#u()})}async addAll(i,t){return Promise.all(i.map(async r=>this.add(r,t)))}start(){return this.#n?(this.#n=!1,this.#d(),this):this}pause(){this.#n=!0}clear(){this.#t=new this.#v}async onEmpty(){this.#t.size!==0&&await this.#p("empty")}async onSizeLessThan(i){this.#t.size<i||await this.#p("next",()=>this.#t.size<i)}async onIdle(){this.#r===0&&this.#t.size===0||await this.#p("idle")}async#p(i,t){return new Promise(r=>{const n=()=>{t&&!t()||(this.off(i,n),r())};this.on(i,n)})}get size(){return this.#t.size}sizeBy(i){return this.#t.filter(i).length}get pending(){return this.#r}get isPaused(){return this.#n}}var Rt="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M16.2,16.2L11,13V7H12.5V12.2L17,14.9L16.2,16.2Z",jt="M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z",Wt="M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z";const qt={name:"FileIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Zt=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon file-icon",attrs:{"aria-hidden":e.title?null:!0,"aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M13,9V3.5L18.5,9M6,2C4.89,2 4,2.89 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2H6Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Ut=[],Yt=L(qt,Zt,Ut,!1,null,null);const Be=Yt.exports,Ie=()=>{var e,i,t;const r=Ce("files","config",null),n=k((e=r?.show_hidden)!=null?e:!0),s=k((i=r?.sort_favorites_first)!=null?i:!0),c=k((t=r?.crop_image_previews)!=null?t:!0);return V(async()=>{var u,o,a,l,f,v;if(J())console.debug("Skip loading files settings - currently on public share");else try{const{data:p}=await we.get(U("/apps/files/api/v1/configs"));n.value=(o=(u=p?.data)==null?void 0:u.show_hidden)!=null?o:!1,s.value=(l=(a=p?.data)==null?void 0:a.sort_favorites_first)!=null?l:!0,c.value=(v=(f=p?.data)==null?void 0:f.crop_image_previews)!=null?v:!0}catch(p){console.error("Could not load files settings",p),q(S("Could not load files settings"))}}),{showHiddenFiles:n,sortFavoritesFirst:s,cropImagePreviews:c}},Kt=e=>{var i,t,r,n,s,c,u,o,a,l,f,v;const p=x=>x==="asc"?"ascending":x==="desc"?"descending":"none",g=Ce("files","viewConfigs",null),d=k({sortBy:(t=(i=g?.files)==null?void 0:i.sorting_mode)!=null?t:"basename",order:p((n=(r=g?.files)==null?void 0:r.sorting_direction)!=null?n:"asc")}),h=k({sortBy:(c=(s=g?.recent)==null?void 0:s.sorting_mode)!=null?c:"basename",order:p((o=(u=g?.recent)==null?void 0:u.sorting_direction)!=null?o:"asc")}),_=k({sortBy:(l=(a=g?.favorites)==null?void 0:a.sorting_mode)!=null?l:"basename",order:p((v=(f=g?.favorites)==null?void 0:f.sorting_direction)!=null?v:"asc")});V(async()=>{var x,B,b,w,P,O,D,z,X,ee,te,ie,re,ne,se;if(J())console.debug("Skip loading files views - currently on public share");else try{const{data:I}=await we.get(U("/apps/files/api/v1/views"));d.value={sortBy:(b=(B=(x=I?.data)==null?void 0:x.files)==null?void 0:B.sorting_mode)!=null?b:"basename",order:p((P=(w=I?.data)==null?void 0:w.files)==null?void 0:P.sorting_direction)},_.value={sortBy:(z=(D=(O=I?.data)==null?void 0:O.favorites)==null?void 0:D.sorting_mode)!=null?z:"basename",order:p((ee=(X=I?.data)==null?void 0:X.favorites)==null?void 0:ee.sorting_direction)},h.value={sortBy:(re=(ie=(te=I?.data)==null?void 0:te.recent)==null?void 0:ie.sorting_mode)!=null?re:"basename",order:p((se=(ne=I?.data)==null?void 0:ne.recent)==null?void 0:se.sorting_direction)}}catch(I){console.error("Could not load files views",I),q(S("Could not load files views"))}});const m=C(()=>H(e||"files")==="files"?d.value:H(e)==="recent"?h.value:_.value),F=C(()=>m.value.sortBy),y=C(()=>m.value.order);return{filesViewConfig:d,favoritesViewConfig:_,recentViewConfig:h,currentConfig:m,sortBy:F,order:y}},Gt={name:"MenuUpIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Jt=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon menu-up-icon",attrs:{"aria-hidden":e.title?null:!0,"aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M7,15L12,10L17,15H7Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Qt=[],Xt=L(Gt,Jt,Qt,!1,null,null);const ei=Xt.exports,ti={name:"MenuDownIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var ii=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon menu-down-icon",attrs:{"aria-hidden":e.title?null:!0,"aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M7,10L12,15L17,10H7Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},ri=[],ni=L(ti,ii,ri,!1,null,null);const si=ni.exports,Pe={"file-picker__file-icon":"_file-picker__file-icon_19mjt_9"},ai=$({__name:"LoadingTableRow",props:{showCheckbox:{type:Boolean}},setup(e){return{__sfc:!0,fileListIconStyles:Pe}}});var oi=function(){var e=this,i=e._self._c,t=e._self._setupProxy;return i("tr",{staticClass:"file-picker__row loading-row",attrs:{"aria-hidden":"true"}},[e.showCheckbox?i("td",{staticClass:"row-checkbox"},[i("span")]):e._e(),i("td",{staticClass:"row-name"},[i("div",{staticClass:"row-wrapper"},[i("span",{class:t.fileListIconStyles["file-picker__file-icon"]}),i("span")])]),e._m(0),e._m(1)])},li=[function(){var e=this,i=e._self._c;return e._self._setupProxy,i("td",{staticClass:"row-size"},[i("span")])},function(){var e=this,i=e._self._c;return e._self._setupProxy,i("td",{staticClass:"row-modified"},[i("span")])}],ci=L(ai,oi,li,!1,null,"15187afc");const ui=ci.exports,di=new Ht({concurrency:5});function pi(e){const{resolve:i,promise:t}=Promise.withResolvers();return di.add(()=>{const r=new Image;return r.onerror=()=>i(!1),r.onload=()=>i(!0),r.src=e,t}),t}function fi(e,i={}){var t;i={size:32,cropPreview:!1,mimeFallback:!0,...i};try{const r=((t=e.attributes)==null?void 0:t.previewUrl)||U("/core/preview?fileId={fileid}",{fileid:e.fileid});let n;try{n=new URL(r)}catch{n=new URL(r,window.location.origin)}return n.searchParams.set("x","".concat(i.size)),n.searchParams.set("y","".concat(i.size)),n.searchParams.set("mimeFallback","".concat(i.mimeFallback)),n.searchParams.set("a",i.cropPreview===!0?"0":"1"),n.searchParams.set("c","".concat(e.attributes.etag)),n}catch{return null}}const hi=(e,i)=>{const t=k(null),r=k(!1);return De(()=>{r.value=!1,t.value=fi(H(e),H(i||{})),t.value&&pi(t.value.href).then(n=>{r.value=n})}),{previewURL:t,previewLoaded:r}},vi={name:"FolderIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var mi=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon folder-icon",attrs:{"aria-hidden":e.title?null:!0,"aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},gi=[],yi=L(vi,mi,gi,!1,null,null);const ze=yi.exports,_i={name:"FilePreview"},bi=$({..._i,props:{node:null,cropImagePreviews:{type:Boolean}},setup(e){const i=e,t=k(Pe),{previewURL:r,previewLoaded:n}=hi(_e(i,"node"),C(()=>({cropPreview:i.cropImagePreviews}))),s=C(()=>i.node.type===Z.File);return{__sfc:!0,fileListIconStyles:t,props:i,previewURL:r,previewLoaded:n,isFile:s,IconFile:Be,IconFolder:ze}}});var wi=function(){var e=this,i=e._self._c,t=e._self._setupProxy;return i("div",{class:t.fileListIconStyles["file-picker__file-icon"],style:t.previewLoaded?{backgroundImage:"url(".concat(t.previewURL,")")}:void 0},[t.previewLoaded?e._e():[t.isFile?i(t.IconFile,{attrs:{size:20}}):i(t.IconFolder,{attrs:{size:20}})]],2)},Ci=[],ki=L(bi,wi,Ci,!1,null,null);const xi=ki.exports,Si=$({__name:"FileListRow",props:{allowPickDirectory:{type:Boolean},selected:{type:Boolean},showCheckbox:{type:Boolean},canPick:{type:Boolean},node:null,cropImagePreviews:{type:Boolean}},emits:["update:selected","enter-directory"],setup(e,{emit:i}){const t=e,r=C(()=>{var l;return((l=t.node.attributes)==null?void 0:l.displayName)||t.node.basename.slice(0,t.node.extension?-t.node.extension.length:void 0)}),n=C(()=>t.node.extension),s=C(()=>t.node.type===Z.Folder),c=C(()=>t.canPick&&(t.allowPickDirectory||!s.value));function u(){i("update:selected",!t.selected)}function o(){s.value?i("enter-directory",t.node):u()}function a(l){l.key==="Enter"&&o()}return{__sfc:!0,props:t,emit:i,displayName:r,fileExtension:n,isDirectory:s,isPickable:c,toggleSelected:u,handleClick:o,handleKeyDown:a,formatFileSize:Re,NcCheckboxRadioSwitch:be,NcDateTime:Je,t:S,FilePreview:xi}}});var Ni=function(){var e=this,i=e._self._c,t=e._self._setupProxy;return i("tr",e._g({class:["file-picker__row",{"file-picker__row--selected":e.selected&&!e.showCheckbox}],attrs:{tabindex:e.showCheckbox&&!t.isDirectory?void 0:0,"aria-selected":t.isPickable?e.selected:void 0,"data-filename":e.node.basename,"data-testid":"file-list-row"}},{click:t.handleClick,...!e.showCheckbox||t.isDirectory?{keydown:t.handleKeyDown}:{}}),[e.showCheckbox?i("td",{staticClass:"row-checkbox",on:{click:function(r){return r.stopPropagation(),(()=>{}).apply(null,arguments)}}},[i(t.NcCheckboxRadioSwitch,{attrs:{"aria-label":t.t("Select the row for {nodename}",{nodename:t.displayName}),checked:e.selected,disabled:!t.isPickable,"data-testid":"row-checkbox"},on:{"update:checked":t.toggleSelected}})],1):e._e(),i("td",{staticClass:"row-name"},[i("div",{staticClass:"file-picker__name-container",attrs:{"data-testid":"row-name"}},[i(t.FilePreview,{attrs:{node:e.node,"crop-image-previews":e.cropImagePreviews}}),i("div",{staticClass:"file-picker__file-name",attrs:{title:t.displayName},domProps:{textContent:e._s(t.displayName)}}),i("div",{staticClass:"file-picker__file-extension",domProps:{textContent:e._s(t.fileExtension)}})],1)]),i("td",{staticClass:"row-size"},[e._v(" "+e._s(t.formatFileSize(e.node.size||0))+" ")]),i("td",{staticClass:"row-modified"},[i(t.NcDateTime,{attrs:{timestamp:e.node.mtime,"ignore-seconds":!0}})],1)])},Fi=[],Li=L(Si,Ni,Fi,!1,null,"cb12dccb");const Bi=Li.exports,Ii=$({__name:"FileList",props:{currentView:null,multiselect:{type:Boolean},allowPickDirectory:{type:Boolean},loading:{type:Boolean},files:null,selectedFiles:null,path:null},emits:["update:path","update:selectedFiles"],setup(e,{emit:i}){const t=e,r=k(),{currentConfig:n}=Kt(t.currentView),s=C(()=>{var y;return(y=r.value)!=null?y:n.value}),c=C(()=>s.value.sortBy==="basename"?s.value.order==="none"?void 0:s.value.order:void 0),u=C(()=>s.value.sortBy==="size"?s.value.order==="none"?void 0:s.value.order:void 0),o=C(()=>s.value.sortBy==="mtime"?s.value.order==="none"?void 0:s.value.order:void 0),a=y=>{s.value.sortBy===y?s.value.order==="ascending"?r.value={sortBy:s.value.sortBy,order:"descending"}:r.value={sortBy:s.value.sortBy,order:"ascending"}:r.value={sortBy:y,order:"ascending"}},{sortFavoritesFirst:l,cropImagePreviews:f}=Ie(),v=C(()=>Ve(t.files,{sortFoldersFirst:!0,sortFavoritesFirst:l.value,sortingOrder:s.value.order==="descending"?"desc":"asc",sortingMode:s.value.sortBy})),p=C(()=>t.files.filter(y=>t.allowPickDirectory||y.type!==Z.Folder)),g=C(()=>!t.loading&&t.selectedFiles.length>0&&t.selectedFiles.length>=p.value.length);function d(){t.selectedFiles.length<p.value.length?i("update:selectedFiles",p.value):i("update:selectedFiles",[])}function h(y){t.selectedFiles.includes(y)?i("update:selectedFiles",t.selectedFiles.filter(x=>x.path!==y.path)):t.multiselect?i("update:selectedFiles",[...t.selectedFiles,y]):i("update:selectedFiles",[y])}function _(y){i("update:path",y.path)}const m=k(4),F=k();{const y=()=>Oe(()=>{var x,B,b,w,P;const O=((B=(x=F.value)==null?void 0:x.parentElement)==null?void 0:B.children)||[];let D=((w=(b=F.value)==null?void 0:b.parentElement)==null?void 0:w.clientHeight)||450;for(let z=0;z<O.length;z++)(P=F.value)!=null&&P.isSameNode(O[z])||(D-=O[z].clientHeight);m.value=Math.max(1,Math.floor((D-50)/50))});V(()=>{window.addEventListener("resize",y),y()}),$e(()=>{window.removeEventListener("resize",y)})}return{__sfc:!0,props:t,emit:i,customSortingConfig:r,filesAppSorting:n,sortingConfig:s,sortByName:c,sortBySize:u,sortByModified:o,toggleSorting:a,sortFavoritesFirst:l,cropImagePreviews:f,sortedFiles:v,selectableFiles:p,allSelected:g,onSelectAll:d,onNodeSelected:h,onChangeDirectory:_,skeletonNumber:m,fileContainer:F,NcButton:G,NcCheckboxRadioSwitch:be,t:S,IconSortAscending:ei,IconSortDescending:si,LoadingTableRow:ui,FileListRow:Bi}}});var Pi=function(){var e=this,i=e._self._c,t=e._self._setupProxy;return i("div",{ref:"fileContainer",staticClass:"file-picker__files"},[i("table",[i("thead",[i("tr",[e.multiselect?i("th",{staticClass:"row-checkbox"},[i("span",{staticClass:"hidden-visually"},[e._v(" "+e._s(t.t("Select entry"))+" ")]),e.multiselect?i(t.NcCheckboxRadioSwitch,{attrs:{"aria-label":t.t("Select all entries"),checked:t.allSelected,"data-testid":"select-all-checkbox"},on:{"update:checked":t.onSelectAll}}):e._e()],1):e._e(),i("th",{staticClass:"row-name",attrs:{"aria-sort":t.sortByName}},[i("div",{staticClass:"header-wrapper"},[i("span",{staticClass:"file-picker__header-preview"}),i(t.NcButton,{attrs:{wide:!0,type:"tertiary","data-test":"file-picker_sort-name"},on:{click:function(r){return t.toggleSorting("basename")}},scopedSlots:e._u([{key:"icon",fn:function(){return[t.sortByName==="ascending"?i(t.IconSortAscending,{attrs:{size:20}}):t.sortByName==="descending"?i(t.IconSortDescending,{attrs:{size:20}}):i("span",{staticStyle:{width:"44px"}})]},proxy:!0}])},[e._v(" "+e._s(t.t("Name"))+" ")])],1)]),i("th",{staticClass:"row-size",attrs:{"aria-sort":t.sortBySize}},[i(t.NcButton,{attrs:{wide:!0,type:"tertiary"},on:{click:function(r){return t.toggleSorting("size")}},scopedSlots:e._u([{key:"icon",fn:function(){return[t.sortBySize==="ascending"?i(t.IconSortAscending,{attrs:{size:20}}):t.sortBySize==="descending"?i(t.IconSortDescending,{attrs:{size:20}}):i("span",{staticStyle:{width:"44px"}})]},proxy:!0}])},[e._v(" "+e._s(t.t("Size"))+" ")])],1),i("th",{staticClass:"row-modified",attrs:{"aria-sort":t.sortByModified}},[i(t.NcButton,{attrs:{wide:!0,type:"tertiary"},on:{click:function(r){return t.toggleSorting("mtime")}},scopedSlots:e._u([{key:"icon",fn:function(){return[t.sortByModified==="ascending"?i(t.IconSortAscending,{attrs:{size:20}}):t.sortByModified==="descending"?i(t.IconSortDescending,{attrs:{size:20}}):i("span",{staticStyle:{width:"44px"}})]},proxy:!0}])},[e._v(" "+e._s(t.t("Modified"))+" ")])],1)])]),i("tbody",[e.loading?e._l(t.skeletonNumber,function(r){return i(t.LoadingTableRow,{key:r,attrs:{"show-checkbox":e.multiselect}})}):e._l(t.sortedFiles,function(r){return i(t.FileListRow,{key:r.fileid||r.path,attrs:{"allow-pick-directory":e.allowPickDirectory,"show-checkbox":e.multiselect,"can-pick":e.multiselect||e.selectedFiles.length===0||e.selectedFiles.includes(r),selected:e.selectedFiles.includes(r),node:r,"crop-image-previews":t.cropImagePreviews},on:{"update:selected":function(n){return t.onNodeSelected(r)},"enter-directory":t.onChangeDirectory}})})],2)])])},zi=[],$i=L(Ii,Pi,zi,!1,null,"006fdbd0");const Oi=$i.exports,Di={name:"HomeIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Ei=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon home-icon",attrs:{"aria-hidden":e.title?null:!0,"aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Ai=[],Vi=L(Di,Ei,Ai,!1,null,null);const Ti=Vi.exports,Mi={name:"PlusIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Hi=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon plus-icon",attrs:{"aria-hidden":e.title?null:!0,"aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Ri=[],ji=L(Mi,Hi,Ri,!1,null,null);const Wi=ji.exports,qi=$({__name:"FilePickerBreadcrumbs",props:{path:null,showMenu:{type:Boolean}},emits:["update:path","create-node"],setup(e,{emit:i}){const t=e,r=k(!1),n=k(""),s=k();function c(){var a,l,f,v;const p=n.value.trim(),g=(l=(a=s.value)==null?void 0:a.$el)==null?void 0:l.querySelector("input");let d="";return p.length===0?d=S("Folder name cannot be empty."):p.includes("/")?d=S('"/" is not allowed inside a folder name.'):["..","."].includes(p)?d=S('"{name}" is an invalid folder name.',{name:p}):(f=window.OC.config)!=null&&f.blacklist_files_regex&&p.match((v=window.OC.config)==null?void 0:v.blacklist_files_regex)&&(d=S('"{name}" is not an allowed folder name',{name:p})),g&&g.setCustomValidity(d),d===""}const u=function(){const a=n.value.trim();c()&&(r.value=!1,i("create-node",a),n.value="")},o=C(()=>t.path.split("/").filter(a=>a!=="").map((a,l,f)=>({name:a,path:"/"+f.slice(0,l+1).join("/")})));return{__sfc:!0,props:t,emit:i,actionsOpen:r,newNodeName:n,nameInput:s,validateInput:c,onSubmit:u,pathElements:o,IconFolder:ze,IconHome:Ti,IconPlus:Wi,NcActions:K,NcActionInput:Ye,NcBreadcrumbs:Ot,NcBreadcrumb:ke,t:S}}});var Zi=function(){var e=this,i=e._self._c,t=e._self._setupProxy;return i(t.NcBreadcrumbs,{staticClass:"file-picker__breadcrumbs",scopedSlots:e._u([{key:"default",fn:function(){return[i(t.NcBreadcrumb,{attrs:{name:t.t("All files"),title:t.t("Home")},on:{click:function(r){return t.emit("update:path","/")}},scopedSlots:e._u([{key:"icon",fn:function(){return[i(t.IconHome,{attrs:{size:20}})]},proxy:!0}])}),e._l(t.pathElements,function(r){return i(t.NcBreadcrumb,{key:r.path,attrs:{name:r.name,title:r.path},on:{click:function(n){return t.emit("update:path",r.path)}}})})]},proxy:!0},e.showMenu?{key:"actions",fn:function(){return[i(t.NcActions,{attrs:{"aria-label":t.t("Create directory"),"force-menu":!0,"force-name":!0,"menu-name":t.t("New"),open:t.actionsOpen,type:"secondary"},on:{"update:open":function(r){t.actionsOpen=r},close:function(r){t.newNodeName=""}},scopedSlots:e._u([{key:"icon",fn:function(){return[i(t.IconPlus,{attrs:{size:20}})]},proxy:!0}],null,!1,2971667417)},[i(t.NcActionInput,{ref:"nameInput",attrs:{value:t.newNodeName,label:t.t("New folder"),placeholder:t.t("New folder name")},on:{"update:value":function(r){t.newNodeName=r},submit:t.onSubmit,input:t.validateInput},scopedSlots:e._u([{key:"icon",fn:function(){return[i(t.IconFolder,{attrs:{size:20}})]},proxy:!0}],null,!1,1614167509)})],1)]},proxy:!0}:null],null,!0)})},Ui=[],Yi=L(qi,Zi,Ui,!1,null,"b357227a");const Ki=Yi.exports,Gi={name:"CloseIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Ji=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon close-icon",attrs:{"aria-hidden":e.title?null:!0,"aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Qi=[],Xi=L(Gi,Ji,Qi,!1,null,null);const er=Xi.exports,tr={name:"MagnifyIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var ir=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon magnify-icon",attrs:{"aria-hidden":e.title?null:!0,"aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},rr=[],nr=L(tr,ir,rr,!1,null,null);const sr=nr.exports,ar=e=>{const i=[{id:"files",label:S("All files"),icon:jt},{id:"recent",label:S("Recent"),icon:Rt},{id:"favorites",label:S("Favorites"),icon:Wt}],t=e.value?i.filter(({id:r})=>r==="files"):i;return{allViews:i,availableViews:t}},or=$({__name:"FilePickerNavigation",props:{currentView:null,filterString:null,isCollapsed:{type:Boolean},disabledNavigation:{type:Boolean}},emits:["update:currentView","update:filterString"],setup(e,{emit:i}){const t=e,{availableViews:r}=ar(k(at()===null)),n=C(()=>{var s;return(s=r.filter(c=>c.id===t.currentView)[0])!=null?s:r[0]});return{__sfc:!0,props:t,emit:i,availableViews:r,currentViewObject:n,updateFilterValue:s=>i("update:filterString",s),IconClose:er,IconMagnify:sr,NcButton:G,NcIconSvgWrapper:it,NcSelect:Ke,NcTextField:Ge,Fragment:Ne,t:S}}});var lr=function(){var e=this,i=e._self._c,t=e._self._setupProxy;return i(t.Fragment,[i(t.NcTextField,{staticClass:"file-picker__filter-input",attrs:{value:e.filterString,label:t.t("Filter file list"),"show-trailing-button":!!e.filterString},on:{"update:value":t.updateFilterValue,"trailing-button-click":function(r){return t.updateFilterValue("")}},scopedSlots:e._u([{key:"trailing-button-icon",fn:function(){return[i(t.IconClose,{attrs:{size:16}})]},proxy:!0}])},[i(t.IconMagnify,{attrs:{size:16}})],1),t.availableViews.length>1&&!e.disabledNavigation?[e.isCollapsed?i(t.NcSelect,{attrs:{"aria-label":t.t("Current view selector"),clearable:!1,searchable:!1,options:t.availableViews,value:t.currentViewObject},on:{input:r=>t.emit("update:currentView",r.id)}}):i("ul",{staticClass:"file-picker__side"},e._l(t.availableViews,function(r){return i("li",{key:r.id},[i(t.NcButton,{attrs:{type:e.currentView===r.id?"primary":"tertiary",wide:!0},on:{click:function(n){return e.$emit("update:currentView",r.id)}},scopedSlots:e._u([{key:"icon",fn:function(){return[i(t.NcIconSvgWrapper,{attrs:{path:r.icon,size:20}})]},proxy:!0}],null,!0)},[e._v(" "+e._s(r.label)+" ")])],1)}),0)]:e._e()],2)},cr=[],ur=L(or,lr,cr,!1,null,"b42054b8");const dr=ur.exports,pr=function(e,i){const t=J(),r=t?"/":Te,n=C(()=>t?Xe("webdav").replace("/remote.php","/public.php"):Ee),s=C(()=>{if(t){const h=document.getElementById("sharingToken").value,_=btoa("".concat(h,":null"));return oe(n.value,{Authorization:"Basic ".concat(_)})}return oe()}),c=h=>Me(h,r,n.value),u=()=>{const h=new AbortController,_=Math.round(Date.now()/1e3)-60*60*24*14;return new ce(async(m,F,y)=>{y(()=>h.abort());try{const{data:x}=await s.value.search("/",{signal:h.signal,details:!0,data:He(_)}),B=x.results.map(c);m(B)}catch(x){F(x)}})},o=()=>{const h=new AbortController;return new ce(async(_,m,F)=>{F(()=>h.abort());try{const y=(await s.value.getDirectoryContents("".concat(r).concat(i.value),{signal:h.signal,details:!0,includeSelf:!0,data:le()})).data.map(c);_({folder:y.find(x=>x.path===i.value),contents:y.filter(x=>x.path!==i.value)})}catch(y){m(y)}})},a=W([]),l=W(null),f=k(!0),v=k(null);async function p(h){const _=ae.join(i.value,h);await s.value.createDirectory(ae.join(r,_));const m=await g(_);return a.value=[...a.value,m],m}async function g(h,_=void 0){_=_??r;const{data:m}=await s.value.stat("".concat(_).concat(h),{details:!0,data:le()});return c(m)}async function d(){v.value&&v.value.cancel(),f.value=!0,e.value==="favorites"?v.value=Ae(s.value,i.value,r):e.value==="recent"?v.value=u():v.value=o();const h=await v.value;"folder"in h?(l.value=h.folder,a.value=h.contents):(l.value=null,a.value=h),v.value=null,f.value=!1}return ye([e,i],()=>d()),V(()=>d()),{isLoading:f,files:a,folder:l,loadFiles:d,createDirectory:p}},fr=function(e){const i=C(()=>e.value.map(t=>t.split("/")));return{isSupportedMimeType:t=>{const r=t.split("/");return i.value.some(([n,s])=>(r[0]===n||n==="*")&&(r[1]===s||s==="*"))}}},hr={name:"FilePicker"},vr=$({...hr,props:{buttons:null,name:null,allowPickDirectory:{type:Boolean,default:!1},disabledNavigation:{type:Boolean,default:!1},container:{default:"body"},filterFn:{default:void 0},mimetypeFilter:{default:()=>[]},multiselect:{type:Boolean,default:!0},path:{default:void 0}},emits:["close"],setup(e,{emit:i}){const t=e,r=k(!0),n=C(()=>{const b=a.value.length===0&&t.allowPickDirectory&&h.value?[h.value]:a.value;return(typeof t.buttons=="function"?t.buttons(b,v.value,u.value):t.buttons).map(w=>({...w,disabled:w.disabled||_.value,callback:()=>{s=!0,c(w.callback,b)}}))});let s=!1;const c=async(b,w)=>{b(w),i("close",w),s=!1},u=k("files"),o=C(()=>u.value==="favorites"?S("Favorites"):u.value==="recent"?S("Recent"):""),a=W([]),l=k(window?.sessionStorage.getItem("NC.FilePicker.LastPath")||"/"),f=k("");ye([f],()=>{t.path===void 0&&f.value&&window.sessionStorage.setItem("NC.FilePicker.LastPath",f.value),a.value=[]});const v=C({get:()=>u.value==="files"?f.value||t.path||l.value:"/",set:b=>{f.value=b}}),p=k(""),{isSupportedMimeType:g}=fr(_e(t,"mimetypeFilter")),{files:d,folder:h,isLoading:_,loadFiles:m,createDirectory:F}=pr(u,v);V(()=>m());const{showHiddenFiles:y}=Ie(),x=C(()=>{let b=d.value;return y.value||(b=b.filter(w=>!w.basename.startsWith("."))),t.mimetypeFilter.length>0&&(b=b.filter(w=>w.type==="folder"||w.mime&&g(w.mime))),p.value&&(b=b.filter(w=>w.basename.toLowerCase().includes(p.value.toLowerCase()))),t.filterFn&&(b=b.filter(w=>t.filterFn(w))),b}),B=C(()=>u.value==="files"?S("Upload some content or sync with your devices!"):u.value==="recent"?S("Files and folders you recently modified will show up here."):S("Files and folders you mark as favorite will show up here."));return{__sfc:!0,props:t,emit:i,isOpen:r,dialogButtons:n,isHandlingCallback:s,handleButtonClick:c,currentView:u,viewHeadline:o,selectedFiles:a,savedPath:l,navigatedPath:f,currentPath:v,filterString:p,isSupportedMimeType:g,files:d,currentFolder:h,isLoading:_,loadFiles:m,createDirectory:F,showHiddenFiles:y,filteredFiles:x,noFilesDescription:B,onCreateFolder:async b=>{try{const w=await F(b);f.value=w.path,st("files:node:created",d.value.filter(P=>P.basename===b)[0])}catch(w){console.warn("Could not create new folder",{name:b,error:w}),q(S("Could not create the new folder"))}},handleClose:b=>{!b&&!s&&i("close")},IconFile:Be,FileList:Oi,FilePickerBreadcrumbs:Ki,FilePickerNavigation:dr,NcDialog:Ze,NcEmptyContent:Ue,t:S}}});var mr=function(){var e=this,i=e._self._c,t=e._self._setupProxy;return i(t.NcDialog,{attrs:{container:e.container,buttons:t.dialogButtons,name:e.name,size:"large","content-classes":"file-picker__content","dialog-classes":"file-picker","navigation-classes":"file-picker__navigation",open:t.isOpen},on:{"update:open":[function(r){t.isOpen=r},t.handleClose]},scopedSlots:e._u([{key:"navigation",fn:function({isCollapsed:r}){return[i(t.FilePickerNavigation,{attrs:{"is-collapsed":r,"current-view":t.currentView,"filter-string":t.filterString,"disabled-navigation":e.disabledNavigation},on:{"update:currentView":function(n){t.currentView=n},"update:current-view":function(n){t.currentView=n},"update:filterString":function(n){t.filterString=n},"update:filter-string":function(n){t.filterString=n}}})]}}])},[i("div",{staticClass:"file-picker__main"},[t.currentView==="files"?i(t.FilePickerBreadcrumbs,{attrs:{path:t.currentPath,"show-menu":e.allowPickDirectory},on:{"update:path":function(r){t.currentPath=r},"create-node":t.onCreateFolder}}):i("div",{staticClass:"file-picker__view"},[i("h3",[e._v(e._s(t.viewHeadline))])]),t.isLoading||t.filteredFiles.length>0?i(t.FileList,{attrs:{"allow-pick-directory":e.allowPickDirectory,"current-view":t.currentView,files:t.filteredFiles,multiselect:e.multiselect,loading:t.isLoading,path:t.currentPath,"selected-files":t.selectedFiles,name:t.viewHeadline},on:{"update:path":[function(r){t.currentPath=r},function(r){t.currentView="files"}],"update:selectedFiles":function(r){t.selectedFiles=r},"update:selected-files":function(r){t.selectedFiles=r}}}):t.filterString?i(t.NcEmptyContent,{attrs:{name:t.t("No matching files"),description:t.t("No files matching your filter were found.")},scopedSlots:e._u([{key:"icon",fn:function(){return[i(t.IconFile)]},proxy:!0}])}):i(t.NcEmptyContent,{attrs:{name:t.t("No files in here"),description:t.noFilesDescription},scopedSlots:e._u([{key:"icon",fn:function(){return[i(t.IconFile)]},proxy:!0}])})],1)])},gr=[],yr=L(vr,mr,gr,!1,null,"20b719ba");const Ir=yr.exports;export{Ir as default};
//# sourceMappingURL=FilePicker-ajWx2Snh-B2Uw3iD8.chunk.mjs.map
