/*! third party licenses: js/vendor.LICENSE.txt */
var ht=Object.defineProperty;var Ee=e=>{throw TypeError(e)};var mt=(e,i,t)=>i in e?ht(e,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[i]=t;var Oe=(e,i,t)=>mt(e,typeof i!="symbol"?i+"":i,t),fe=(e,i,t)=>i.has(e)||Ee("Cannot "+t);var f=(e,i,t)=>(fe(e,i,"read from private field"),t?t.call(e):i.get(e)),L=(e,i,t)=>i.has(e)?Ee("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(e):i.set(e,t),N=(e,i,t,n)=>(fe(e,i,"write to private field"),n?n.call(e,t):i.set(e,t),t),P=(e,i,t)=>(fe(e,i,"access private method"),t);var se=(e,i,t,n)=>({set _(r){N(e,i,r,t)},get _(){return f(e,i,n)}});import{V as oe,d as W,r as S,c as x,x as me,w as Ue,t as Ye,o as re,p as vt,n as gt,h as yt}from"./vue.runtime.esm-fZsuJKoo.chunk.mjs";import{b as O,t as I,i as ye,s as _e,p as De}from"./public-CGgcn6nh.chunk.mjs";import{d as _t,c as Ae,e as Ve,g as bt,s as wt,f as be,h as Ct,i as kt,C as $e,j as xt,k as St}from"./index-G0jI7Qgm.chunk.mjs";import{a as Nt,B as Ft,m as Bt,D as It,h as Lt,E as Pt,l as zt,c as Et,v as Ot,F as Dt}from"./_plugin-vue2_normalizer-vDfjP4mA.chunk.mjs";import{n as we,a as Ce,C as At,N as ke,G as Vt,k as $t}from"./NcNoteCard-CImn6F9p-BDmi1x49.chunk.mjs";import{s as Tt,u as Mt,e as Ht,g as Rt}from"./modulepreload-polyfill-DMTabKmO.chunk.mjs";import{N as Ke}from"./NcCheckboxRadioSwitch-CvMEEI9x-oY7M5s9M.chunk.mjs";import{c as Ge,_ as xe,U as jt}from"./index-DNrwaJYp.chunk.mjs";import{l as Je}from"./index-Ubm2itxG.chunk.mjs";import{g as Wt}from"./emoji-picker-SoWZqoso.chunk.mjs";import{a as de}from"./index-BLf3Qy6l.chunk.mjs";import"./index-DkzhscpN.chunk.mjs";const qt={name:"NcBreadcrumb",components:{NcActions:Ce,ChevronRight:At,NcButton:ke},inheritAttrs:!1,props:{name:{type:String,required:!0},title:{type:String,default:null},to:{type:[String,Object],default:void 0},exact:{type:Boolean,default:!1},href:{type:String,default:void 0},icon:{type:String,default:""},forceIconText:{type:Boolean,default:!1},disableDrop:{type:Boolean,default:!1},forceMenu:{type:Boolean,default:!1},open:{type:Boolean,default:!1}},emits:["update:open","dropped"],data(){return{hovering:!1,crumbId:"crumb-id-".concat(Vt())}},computed:{linkAttributes(){return this.to?{to:this.to,exact:this.exact,...this.$attrs}:this.href?{href:this.href,...this.$attrs}:this.$attrs}},methods:{onOpenChange(e){this.$emit("update:open",e)},dropped(e){return this.disableDrop||(this.$emit("dropped",e,this.to||this.href),this.$parent.$emit("dropped",e,this.to||this.href),this.hovering=!1),!1},dragEnter(e){this.disableDrop||(this.hovering=!0)},dragLeave(e){this.disableDrop||e.target.contains(e.relatedTarget)||this.$refs.crumb.contains(e.relatedTarget)||(this.hovering=!1)}}};var Zt=function(){var e=this,i=e._self._c;return i("li",e._b({ref:"crumb",staticClass:"vue-crumb",class:{"vue-crumb--hovered":e.hovering},attrs:{draggable:"false"},on:{dragstart:function(t){return t.preventDefault(),(()=>{}).apply(null,arguments)},drop:function(t){return t.preventDefault(),e.dropped.apply(null,arguments)},dragover:function(t){return t.preventDefault(),(()=>{}).apply(null,arguments)},dragenter:e.dragEnter,dragleave:e.dragLeave}},"li",e._d({},[e.crumbId,""])),[(e.name||e.icon||e.$slots.icon)&&!e.$slots.default?i("NcButton",e._g(e._b({attrs:{title:e.title,"aria-label":e.icon?e.name:void 0,type:"tertiary"},scopedSlots:e._u([e.$slots.icon||e.icon?{key:"icon",fn:function(){return[e._t("icon",function(){return[i("span",{staticClass:"icon",class:e.icon})]})]},proxy:!0}:null,!(e.$slots.icon||e.icon)||e.forceIconText?{key:"default",fn:function(){return[e._v(" "+e._s(e.name)+" ")]},proxy:!0}:null],null,!0)},"NcButton",e.linkAttributes,!1),e.$listeners)):e._e(),e.$slots.default?i("NcActions",{ref:"actions",attrs:{type:"tertiary","force-menu":e.forceMenu,open:e.open,"menu-name":e.name,title:e.title,"force-name":!0,container:".vue-crumb[".concat(e.crumbId,"]")},on:{"update:open":e.onOpenChange},scopedSlots:e._u([{key:"icon",fn:function(){return[e._t("menu-icon")]},proxy:!0}],null,!0)},[e._t("default")],2):e._e(),i("ChevronRight",{staticClass:"vue-crumb__separator",attrs:{size:20}})],1)},Ut=[],Yt=we(qt,Zt,Ut,!1,null,"cfe13af3");const Qe=Yt.exports;var pe=Symbol(),Q=Symbol(),Te=Symbol(),Me=Symbol(),Se=function(e){return"frag"in e},Kt={get:function(){return this[Q]||this.parentElement},configurable:!0},X=function(e,i){Q in e||(e[Q]=i,Object.defineProperty(e,"parentNode",Kt))},Gt={get:function(){var e=this.parentNode.childNodes,i=e.indexOf(this);return i>-1&&e[i+1]||null}},ae=function(e){Te in e||(e[Te]=!0,Object.defineProperty(e,"nextSibling",Gt))},Jt=function(e,i){for(;e.parentNode!==i;){var t=e,n=t.parentNode;n&&(e=n)}return e},he,Xe=function(e){if(!he){var i=Object.getOwnPropertyDescriptor(Node.prototype,"childNodes");he=i.get}var t=he.apply(e),n=Array.from(t).map(function(r){return Jt(r,e)});return n.filter(function(r,s){return r!==n[s-1]})},Qt={get:function(){return this.frag||Xe(this)}},Xt={get:function(){return this.childNodes[0]||null}};function ei(){return this.childNodes.length>0}var He=function(e){Me in e||(e[Me]=!0,Object.defineProperties(e,{childNodes:Qt,firstChild:Xt}),e.hasChildNodes=ei)};function ti(){var e;(e=this.frag[0]).before.apply(e,arguments)}function ii(){var e=this.frag,i=e.splice(0,e.length);i.forEach(function(t){t.remove()})}var ni=function e(i){var t;return(t=Array.prototype).concat.apply(t,i.map(function(n){return Se(n)?e(n.frag):n}))},ri=function(e,i){var t=e[pe];i.before(t),X(t,e),e.frag.unshift(t)};function Re(e){if(Se(this)){var i=this.frag.indexOf(e);if(i>-1){var t=this.frag.splice(i,1),n=t[0];this.frag.length===0&&ri(this,n),e.remove()}}else{var r=Xe(this),s=r.indexOf(e);s>-1&&e.remove()}return e}function je(e,i){var t=this,n=e.frag||[e];if(Se(this)){if(e[Q]===this&&e.parentElement)return e;var r=this.frag;if(i){var s=r.indexOf(i);s>-1&&(r.splice.apply(r,[s,0].concat(n)),i.before.apply(i,n))}else{var u=r[r.length-1];r.push.apply(r,n),u.after.apply(u,n)}et(this)}else i?this.childNodes.includes(i)&&i.before.apply(i,n):this.append.apply(this,n);n.forEach(function(l){X(l,t)});var a=n[n.length-1];return ae(a),e}function si(e){if(e[Q]===this&&e.parentElement)return e;var i=this.frag,t=i[i.length-1];return t.after(e),X(e,this),et(this),i.push(e),e}var et=function(e){var i=e[pe];e.frag[0]===i&&(e.frag.shift(),i.remove())},oi={set:function(e){var i=this;if(this.frag[0]!==this[pe]&&this.frag.slice().forEach(function(n){return i.removeChild(n)}),e){var t=document.createElement("div");t.innerHTML=e,Array.from(t.childNodes).forEach(function(n){i.appendChild(n)})}},get:function(){return""}},ai={inserted:function(e){var i=e.parentNode,t=e.nextSibling,n=e.previousSibling,r=Array.from(e.childNodes),s=document.createComment("");r.length===0&&r.push(s),e.frag=r,e[pe]=s;var u=document.createDocumentFragment();u.append.apply(u,ni(r)),e.replaceWith(u),r.forEach(function(a){X(a,e),ae(a)}),He(e),Object.assign(e,{remove:ii,appendChild:si,insertBefore:je,removeChild:Re,before:ti}),Object.defineProperty(e,"innerHTML",oi),i&&(Object.assign(i,{removeChild:Re,insertBefore:je}),X(e,i),He(i)),t&&ae(e),n&&ae(n)},unbind:function(e){e.remove()}},tt={name:"Fragment",directives:{frag:ai},render:function(e){return e("div",{directives:[{name:"frag"}]},this.$slots.default)}};const We=(e,i,t)=>{if(e!==void 0)for(let n=e.length-1;n>=0;n--){const r=e[n],s=!r.componentOptions&&r.tag&&i.indexOf(r.tag)===-1,u=!!r.componentOptions&&typeof r.componentOptions.tag=="string",a=u&&i.indexOf(r.componentOptions.tag)===-1;(s||!u||a)&&((s||a)&&oe.util.warn("".concat(s?r.tag:r.componentOptions.tag," is not allowed inside the ").concat(t.$options.name," component"),t),e.splice(n,1))}},li={name:"FolderIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var ci=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon folder-icon",attrs:{"aria-hidden":e.title?null:!0,"aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},ui=[],di=we(li,ci,ui,!1,null,null);const pi=di.exports,z="vue-crumb",fi={name:"NcBreadcrumbs",components:{NcActions:Ce,NcActionButton:Nt,NcActionRouter:Ft,NcActionLink:Bt,NcBreadcrumb:Qe,IconFolder:pi},props:{rootIcon:{type:String,default:"icon-home"},ariaLabel:{type:String,default:null}},emits:["dropped"],data(){return{hiddenIndices:[],menuBreadcrumbProps:{name:"",forceMenu:!0,disableDrop:!0,open:!1},breadcrumbsRefs:{}}},beforeMount(){We(this.$slots.default,["NcBreadcrumb"],this)},beforeUpdate(){We(this.$slots.default,["NcBreadcrumb"],this)},created(){window.addEventListener("resize",It(()=>{this.handleWindowResize()},100)),Tt("navigation-toggled",this.delayedResize)},mounted(){this.handleWindowResize()},updated(){this.delayedResize(),this.$nextTick(()=>{this.hideCrumbs()})},beforeDestroy(){window.removeEventListener("resize",this.handleWindowResize),Mt("navigation-toggled",this.delayedResize)},methods:{closeActions(e){this.$refs.actionsBreadcrumb.$el.contains(e.relatedTarget)||(this.menuBreadcrumbProps.open=!1)},async delayedResize(){await this.$nextTick(),this.handleWindowResize()},handleWindowResize(){var e;if(!this.$refs.container)return;const i=Object.values(this.breadcrumbsRefs),t=i.length,n=[],r=this.$refs.container.offsetWidth;let s=this.getTotalWidth(i);this.$refs.breadcrumb__actions&&(s+=this.$refs.breadcrumb__actions.offsetWidth);let u=s-r;u+=u>0?64:0;let a=0;const l=Math.floor(t/2);for(;u>0&&a<t-2;){const o=l+(a%2?a+1:a)/2*Math.pow(-1,a+t%2);u-=this.getWidth((e=i[o])==null?void 0:e.elm,o===i.length-1),n.push(o),a++}this.arraysEqual(this.hiddenIndices,n.sort((o,c)=>o-c))||(this.hiddenIndices=n)},arraysEqual(e,i){if(e.length!==i.length)return!1;if(e===i)return!0;if(e===null||i===null)return!1;for(let t=0;t<e.length;++t)if(e[t]!==i[t])return!1;return!0},getTotalWidth(e){return e.reduce((i,t,n)=>i+this.getWidth(t==null?void 0:t.elm,n===e.length-1),0)},getWidth(e,i){if(!(e!=null&&e.classList))return 0;const t=e.classList.contains("".concat(z,"--hidden"));e.style.minWidth="auto",i&&(e.style.maxWidth="210px"),e.classList.remove("".concat(z,"--hidden"));const n=e.offsetWidth;return t&&e.classList.add("".concat(z,"--hidden")),e.style.minWidth="",e.style.maxWidth="",n},preventDefault(e){return e.preventDefault&&e.preventDefault(),!1},dragStart(e){return this.preventDefault(e)},dropped(e,i,t){return t||this.$emit("dropped",e,i),this.menuBreadcrumbProps.open=!1,document.querySelectorAll(".".concat(z)).forEach(n=>{n.classList.remove("".concat(z,"--hovered"))}),this.preventDefault(e)},dragOver(e){return this.preventDefault(e)},dragEnter(e,i){if(!i&&e.target.closest){const t=e.target.closest(".".concat(z));t.classList&&t.classList.contains(z)&&(document.querySelectorAll(".".concat(z)).forEach(n=>{n.classList.remove("".concat(z,"--hovered"))}),t.classList.add("".concat(z,"--hovered")))}},dragLeave(e,i){if(!i&&!e.target.contains(e.relatedTarget)&&e.target.closest){const t=e.target.closest(".".concat(z));if(t.contains(e.relatedTarget))return;t.classList&&t.classList.contains(z)&&t.classList.remove("".concat(z,"--hovered"))}},hideCrumbs(){Object.values(this.breadcrumbsRefs).forEach((e,i)=>{var t;(t=e==null?void 0:e.elm)!=null&&t.classList&&(this.hiddenIndices.includes(i)?e.elm.classList.add("".concat(z,"--hidden")):e.elm.classList.remove("".concat(z,"--hidden")))})},isBreadcrumb(e){var i;return(((i=e==null?void 0:e.componentOptions)==null?void 0:i.tag)||(e==null?void 0:e.tag)||"").includes("NcBreadcrumb")}},render(e){const i=[];if(this.$slots.default.forEach(s=>{var u,a;if(this.isBreadcrumb(s)){i.push(s);return}(s==null?void 0:s.type)===tt&&((a=(u=s==null?void 0:s.children)==null?void 0:u.forEach)==null||a.call(u,l=>{this.isBreadcrumb(l)&&i.push(l)}))}),i.length===0)return;oe.set(i[0].componentOptions.propsData,"icon",this.rootIcon),oe.set(i[0].componentOptions.propsData,"ref","breadcrumbs");const t={};i.forEach((s,u)=>{oe.set(s,"ref","crumb-".concat(u)),t[u]=s});let n=[];if(!this.hiddenIndices.length)n=i;else{n=i.slice(0,Math.round(i.length/2)),n.push(e("NcBreadcrumb",{class:"dropdown",props:this.menuBreadcrumbProps,attrs:{"aria-hidden":!0},ref:"actionsBreadcrumb",key:"actions-breadcrumb-1",nativeOn:{dragstart:this.dragStart,dragenter:()=>{this.menuBreadcrumbProps.open=!0},dragleave:this.closeActions},on:{"update:open":u=>{this.menuBreadcrumbProps.open=u}}},this.hiddenIndices.filter(u=>u<=i.length-1).map(u=>{const a=i[u],l=a.componentOptions.propsData.to,o=a.componentOptions.propsData.href,c=a.componentOptions.propsData.disableDrop,h=a.componentOptions.propsData.title,g=a.componentOptions.propsData.name;let d="NcActionButton",m="";o&&(d="NcActionLink",m=o),l&&(d="NcActionRouter",m=l);const p=e("IconFolder",{props:{size:20},slot:"icon"});return e(d,{class:z,props:{href:o||null,title:h,to:l||null},attrs:{draggable:!1},on:{...a.componentOptions.listeners},nativeOn:{dragstart:this.dragStart,drop:v=>this.dropped(v,m,c),dragover:this.dragOver,dragenter:v=>this.dragEnter(v,c),dragleave:v=>this.dragLeave(v,c)}},[p,g])})));const s=i.slice(Math.round(i.length/2));n=n.concat(s)}const r=[e("nav",{attrs:{"aria-label":this.ariaLabel}},[e("ul",{class:"breadcrumb__crumbs"},[n])])];return this.$slots.actions&&r.push(e("div",{class:"breadcrumb__actions",ref:"breadcrumb__actions"},this.$slots.actions)),this.breadcrumbsRefs=t,e("div",{class:["breadcrumb",{"breadcrumb--collapsed":this.hiddenIndices.length===i.length-2}],ref:"container"},r)}},hi=null,mi=null;var vi=we(fi,hi,mi,!1,null,"629bf30f");const gi=vi.exports;var it={exports:{}};(function(e){var i=Object.prototype.hasOwnProperty,t="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(t=!1));function r(l,o,c){this.fn=l,this.context=o,this.once=c||!1}function s(l,o,c,h,g){if(typeof c!="function")throw new TypeError("The listener must be a function");var d=new r(c,h||l,g),m=t?t+o:o;return l._events[m]?l._events[m].fn?l._events[m]=[l._events[m],d]:l._events[m].push(d):(l._events[m]=d,l._eventsCount++),l}function u(l,o){--l._eventsCount===0?l._events=new n:delete l._events[o]}function a(){this._events=new n,this._eventsCount=0}a.prototype.eventNames=function(){var l=[],o,c;if(this._eventsCount===0)return l;for(c in o=this._events)i.call(o,c)&&l.push(t?c.slice(1):c);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(o)):l},a.prototype.listeners=function(l){var o=t?t+l:l,c=this._events[o];if(!c)return[];if(c.fn)return[c.fn];for(var h=0,g=c.length,d=new Array(g);h<g;h++)d[h]=c[h].fn;return d},a.prototype.listenerCount=function(l){var o=t?t+l:l,c=this._events[o];return c?c.fn?1:c.length:0},a.prototype.emit=function(l,o,c,h,g,d){var m=t?t+l:l;if(!this._events[m])return!1;var p=this._events[m],v=arguments.length,w,y;if(p.fn){switch(p.once&&this.removeListener(l,p.fn,void 0,!0),v){case 1:return p.fn.call(p.context),!0;case 2:return p.fn.call(p.context,o),!0;case 3:return p.fn.call(p.context,o,c),!0;case 4:return p.fn.call(p.context,o,c,h),!0;case 5:return p.fn.call(p.context,o,c,h,g),!0;case 6:return p.fn.call(p.context,o,c,h,g,d),!0}for(y=1,w=new Array(v-1);y<v;y++)w[y-1]=arguments[y];p.fn.apply(p.context,w)}else{var E=p.length,_;for(y=0;y<E;y++)switch(p[y].once&&this.removeListener(l,p[y].fn,void 0,!0),v){case 1:p[y].fn.call(p[y].context);break;case 2:p[y].fn.call(p[y].context,o);break;case 3:p[y].fn.call(p[y].context,o,c);break;case 4:p[y].fn.call(p[y].context,o,c,h);break;default:if(!w)for(_=1,w=new Array(v-1);_<v;_++)w[_-1]=arguments[_];p[y].fn.apply(p[y].context,w)}}return!0},a.prototype.on=function(l,o,c){return s(this,l,o,c,!1)},a.prototype.once=function(l,o,c){return s(this,l,o,c,!0)},a.prototype.removeListener=function(l,o,c,h){var g=t?t+l:l;if(!this._events[g])return this;if(!o)return u(this,g),this;var d=this._events[g];if(d.fn)d.fn===o&&(!h||d.once)&&(!c||d.context===c)&&u(this,g);else{for(var m=0,p=[],v=d.length;m<v;m++)(d[m].fn!==o||h&&!d[m].once||c&&d[m].context!==c)&&p.push(d[m]);p.length?this._events[g]=p.length===1?p[0]:p:u(this,g)}return this},a.prototype.removeAllListeners=function(l){var o;return l?(o=t?t+l:l,this._events[o]&&u(this,o)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=t,a.EventEmitter=a,e.exports=a})(it);var yi=it.exports;const _i=Wt(yi);class nt extends Error{constructor(i){super(i),this.name="TimeoutError"}}class bi extends Error{constructor(i){super(),this.name="AbortError",this.message=i}}const qe=e=>globalThis.DOMException===void 0?new bi(e):new DOMException(e),Ze=e=>{const i=e.reason===void 0?qe("This operation was aborted."):e.reason;return i instanceof Error?i:qe(i)};function wi(e,i){const{milliseconds:t,fallback:n,message:r,customTimers:s={setTimeout,clearTimeout}}=i;let u;const a=new Promise((l,o)=>{if(typeof t!="number"||Math.sign(t)!==1)throw new TypeError("Expected `milliseconds` to be a positive number, got `".concat(t,"`"));if(i.signal){const{signal:h}=i;h.aborted&&o(Ze(h));const g=()=>{o(Ze(h))};h.addEventListener("abort",g,{once:!0}),e.finally(()=>{h.removeEventListener("abort",g)})}if(t===Number.POSITIVE_INFINITY){e.then(l,o);return}const c=new nt;u=s.setTimeout.call(void 0,()=>{if(n){try{l(n())}catch(h){o(h)}return}typeof e.cancel=="function"&&e.cancel(),r===!1?l():r instanceof Error?o(r):(c.message=r!=null?r:"Promise timed out after ".concat(t," milliseconds"),o(c))},t),(async()=>{try{l(await e)}catch(h){o(h)}})()}).finally(()=>{a.clear()});return a.clear=()=>{s.clearTimeout.call(void 0,u),u=void 0},a}function Ci(e,i,t){let n=0,r=e.length;for(;r>0;){const s=Math.trunc(r/2);let u=n+s;t(e[u],i)<=0?(n=++u,r-=s+1):r=s}return n}var $;class ki{constructor(){L(this,$,[])}enqueue(i,t){t={priority:0,...t};const n={priority:t.priority,run:i};if(this.size&&f(this,$)[this.size-1].priority>=t.priority){f(this,$).push(n);return}const r=Ci(f(this,$),n,(s,u)=>u.priority-s.priority);f(this,$).splice(r,0,n)}dequeue(){var i;return(i=f(this,$).shift())==null?void 0:i.run}filter(i){return f(this,$).filter(t=>t.priority===i.priority).map(t=>t.run)}get size(){return f(this,$).length}}$=new WeakMap;var Z,U,H,ee,Y,te,A,K,D,ie,V,G,M,ne,b,rt,st,ot,at,lt,le,ve,ge,ce,ct,ue;class xi extends _i{constructor(t){var n,r,s,u;super();L(this,b);L(this,Z);L(this,U);L(this,H,0);L(this,ee);L(this,Y);L(this,te,0);L(this,A);L(this,K);L(this,D);L(this,ie);L(this,V,0);L(this,G);L(this,M);L(this,ne);Oe(this,"timeout");if(t={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:ki,...t},!(typeof t.intervalCap=="number"&&t.intervalCap>=1))throw new TypeError("Expected `intervalCap` to be a number from 1 and up, got `".concat((r=(n=t.intervalCap)==null?void 0:n.toString())!=null?r:"","` (").concat(typeof t.intervalCap,")"));if(t.interval===void 0||!(Number.isFinite(t.interval)&&t.interval>=0))throw new TypeError("Expected `interval` to be a finite number >= 0, got `".concat((u=(s=t.interval)==null?void 0:s.toString())!=null?u:"","` (").concat(typeof t.interval,")"));N(this,Z,t.carryoverConcurrencyCount),N(this,U,t.intervalCap===Number.POSITIVE_INFINITY||t.interval===0),N(this,ee,t.intervalCap),N(this,Y,t.interval),N(this,D,new t.queueClass),N(this,ie,t.queueClass),this.concurrency=t.concurrency,this.timeout=t.timeout,N(this,ne,t.throwOnTimeout===!0),N(this,M,t.autoStart===!1)}get concurrency(){return f(this,G)}set concurrency(t){if(!(typeof t=="number"&&t>=1))throw new TypeError("Expected `concurrency` to be a number from 1 and up, got `".concat(t,"` (").concat(typeof t,")"));N(this,G,t),P(this,b,ce).call(this)}async add(t,n={}){return n={timeout:this.timeout,throwOnTimeout:f(this,ne),...n},new Promise((r,s)=>{f(this,D).enqueue(async()=>{var u;se(this,V)._++,se(this,H)._++;try{(u=n.signal)==null||u.throwIfAborted();let a=t({signal:n.signal});n.timeout&&(a=wi(Promise.resolve(a),{milliseconds:n.timeout})),n.signal&&(a=Promise.race([a,P(this,b,ct).call(this,n.signal)]));const l=await a;r(l),this.emit("completed",l)}catch(a){if(a instanceof nt&&!n.throwOnTimeout){r();return}s(a),this.emit("error",a)}finally{P(this,b,ot).call(this)}},n),this.emit("add"),P(this,b,le).call(this)})}async addAll(t,n){return Promise.all(t.map(async r=>this.add(r,n)))}start(){return f(this,M)?(N(this,M,!1),P(this,b,ce).call(this),this):this}pause(){N(this,M,!0)}clear(){N(this,D,new(f(this,ie)))}async onEmpty(){f(this,D).size!==0&&await P(this,b,ue).call(this,"empty")}async onSizeLessThan(t){f(this,D).size<t||await P(this,b,ue).call(this,"next",()=>f(this,D).size<t)}async onIdle(){f(this,V)===0&&f(this,D).size===0||await P(this,b,ue).call(this,"idle")}get size(){return f(this,D).size}sizeBy(t){return f(this,D).filter(t).length}get pending(){return f(this,V)}get isPaused(){return f(this,M)}}Z=new WeakMap,U=new WeakMap,H=new WeakMap,ee=new WeakMap,Y=new WeakMap,te=new WeakMap,A=new WeakMap,K=new WeakMap,D=new WeakMap,ie=new WeakMap,V=new WeakMap,G=new WeakMap,M=new WeakMap,ne=new WeakMap,b=new WeakSet,rt=function(){return f(this,U)||f(this,H)<f(this,ee)},st=function(){return f(this,V)<f(this,G)},ot=function(){se(this,V)._--,P(this,b,le).call(this),this.emit("next")},at=function(){P(this,b,ge).call(this),P(this,b,ve).call(this),N(this,K,void 0)},lt=function(){const t=Date.now();if(f(this,A)===void 0){const n=f(this,te)-t;if(n<0)N(this,H,f(this,Z)?f(this,V):0);else return f(this,K)===void 0&&N(this,K,setTimeout(()=>{P(this,b,at).call(this)},n)),!0}return!1},le=function(){if(f(this,D).size===0)return f(this,A)&&clearInterval(f(this,A)),N(this,A,void 0),this.emit("empty"),f(this,V)===0&&this.emit("idle"),!1;if(!f(this,M)){const t=!f(this,b,lt);if(f(this,b,rt)&&f(this,b,st)){const n=f(this,D).dequeue();return n?(this.emit("active"),n(),t&&P(this,b,ve).call(this),!0):!1}}return!1},ve=function(){f(this,U)||f(this,A)!==void 0||(N(this,A,setInterval(()=>{P(this,b,ge).call(this)},f(this,Y))),N(this,te,Date.now()+f(this,Y)))},ge=function(){f(this,H)===0&&f(this,V)===0&&f(this,A)&&(clearInterval(f(this,A)),N(this,A,void 0)),N(this,H,f(this,Z)?f(this,V):0),P(this,b,ce).call(this)},ce=function(){for(;P(this,b,le).call(this););},ct=async function(t){return new Promise((n,r)=>{t.addEventListener("abort",()=>{r(t.reason)},{once:!0})})},ue=async function(t,n){return new Promise(r=>{const s=()=>{n&&!n()||(this.off(t,s),r())};this.on(t,s)})};var Si="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M16.2,16.2L11,13V7H12.5V12.2L17,14.9L16.2,16.2Z",Ni="M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z",Fi="M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z";const Bi={name:"FileIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Ii=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon file-icon",attrs:{"aria-hidden":e.title?null:!0,"aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M13,9V3.5L18.5,9M6,2C4.89,2 4,2.89 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2H6Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Li=[],Pi=O(Bi,Ii,Li,!1,null,null);const ut=Pi.exports,dt=()=>{var e,i,t;const n=Je("files","config",null),r=S((e=n==null?void 0:n.show_hidden)!=null?e:!0),s=S((i=n==null?void 0:n.sort_favorites_first)!=null?i:!0),u=S((t=n==null?void 0:n.crop_image_previews)!=null?t:!0);return re(async()=>{var a,l,o,c,h,g;if(ye())console.debug("Skip loading files settings - currently on public share");else try{const{data:d}=await Ge.get(xe("/apps/files/api/v1/configs"));r.value=(l=(a=d==null?void 0:d.data)==null?void 0:a.show_hidden)!=null?l:!1,s.value=(c=(o=d==null?void 0:d.data)==null?void 0:o.sort_favorites_first)!=null?c:!0,u.value=(g=(h=d==null?void 0:d.data)==null?void 0:h.crop_image_previews)!=null?g:!0}catch(d){console.error("Could not load files settings",d),_e(I("Could not load files settings"))}}),{showHiddenFiles:r,sortFavoritesFirst:s,cropImagePreviews:u}},zi=e=>{var i,t,n,r,s,u,a,l,o,c,h,g;const d=F=>F==="asc"?"ascending":F==="desc"?"descending":"none",m=Je("files","viewConfigs",null),p=S({sortBy:(t=(i=m==null?void 0:m.files)==null?void 0:i.sorting_mode)!=null?t:"basename",order:d((r=(n=m==null?void 0:m.files)==null?void 0:n.sorting_direction)!=null?r:"asc")}),v=S({sortBy:(u=(s=m==null?void 0:m.recent)==null?void 0:s.sorting_mode)!=null?u:"basename",order:d((l=(a=m==null?void 0:m.recent)==null?void 0:a.sorting_direction)!=null?l:"asc")}),w=S({sortBy:(c=(o=m==null?void 0:m.favorites)==null?void 0:o.sorting_mode)!=null?c:"basename",order:d((g=(h=m==null?void 0:m.favorites)==null?void 0:h.sorting_direction)!=null?g:"asc")});re(async()=>{var F,T,C,k,R,q,J,j,Ne,Fe,Be,Ie,Le,Pe,ze;if(ye())console.debug("Skip loading files views - currently on public share");else try{const{data:B}=await Ge.get(xe("/apps/files/api/v1/views"));p.value={sortBy:(C=(T=(F=B==null?void 0:B.data)==null?void 0:F.files)==null?void 0:T.sorting_mode)!=null?C:"basename",order:d((R=(k=B==null?void 0:B.data)==null?void 0:k.files)==null?void 0:R.sorting_direction)},w.value={sortBy:(j=(J=(q=B==null?void 0:B.data)==null?void 0:q.favorites)==null?void 0:J.sorting_mode)!=null?j:"basename",order:d((Fe=(Ne=B==null?void 0:B.data)==null?void 0:Ne.favorites)==null?void 0:Fe.sorting_direction)},v.value={sortBy:(Le=(Ie=(Be=B==null?void 0:B.data)==null?void 0:Be.recent)==null?void 0:Ie.sorting_mode)!=null?Le:"basename",order:d((ze=(Pe=B==null?void 0:B.data)==null?void 0:Pe.recent)==null?void 0:ze.sorting_direction)}}catch(B){console.error("Could not load files views",B),_e(I("Could not load files views"))}});const y=x(()=>de(e||"files")==="files"?p.value:de(e)==="recent"?v.value:w.value),E=x(()=>y.value.sortBy),_=x(()=>y.value.order);return{filesViewConfig:p,favoritesViewConfig:w,recentViewConfig:v,currentConfig:y,sortBy:E,order:_}},Ei={name:"MenuUpIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Oi=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon menu-up-icon",attrs:{"aria-hidden":e.title?null:!0,"aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M7,15L12,10L17,15H7Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Di=[],Ai=O(Ei,Oi,Di,!1,null,null);const Vi=Ai.exports,$i={name:"MenuDownIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Ti=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon menu-down-icon",attrs:{"aria-hidden":e.title?null:!0,"aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M7,10L12,15L17,10H7Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Mi=[],Hi=O($i,Ti,Mi,!1,null,null);const Ri=Hi.exports,pt={"file-picker__file-icon":"_file-picker__file-icon_19mjt_9"},ji=W({__name:"LoadingTableRow",props:{showCheckbox:{type:Boolean}},setup(e){return{__sfc:!0,fileListIconStyles:pt}}});var Wi=function(){var e=this,i=e._self._c,t=e._self._setupProxy;return i("tr",{staticClass:"file-picker__row loading-row",attrs:{"aria-hidden":"true"}},[e.showCheckbox?i("td",{staticClass:"row-checkbox"},[i("span")]):e._e(),i("td",{staticClass:"row-name"},[i("div",{staticClass:"row-wrapper"},[i("span",{class:t.fileListIconStyles["file-picker__file-icon"]}),i("span")])]),e._m(0),e._m(1)])},qi=[function(){var e=this,i=e._self._c;return e._self._setupProxy,i("td",{staticClass:"row-size"},[i("span")])},function(){var e=this,i=e._self._c;return e._self._setupProxy,i("td",{staticClass:"row-modified"},[i("span")])}],Zi=O(ji,Wi,qi,!1,null,"15187afc");const Ui=Zi.exports,Yi=new xi({concurrency:5});function Ki(e){const{resolve:i,promise:t}=Promise.withResolvers();return Yi.add(()=>{const n=new Image;return n.onerror=()=>i(!1),n.onload=()=>i(!0),n.src=e,t}),t}function Gi(e,i={}){var t;i={size:32,cropPreview:!1,mimeFallback:!0,...i};try{const n=((t=e.attributes)==null?void 0:t.previewUrl)||xe("/core/preview?fileId={fileid}",{fileid:e.fileid});let r;try{r=new URL(n)}catch{r=new URL(n,window.location.origin)}return r.searchParams.set("x","".concat(i.size)),r.searchParams.set("y","".concat(i.size)),r.searchParams.set("mimeFallback","".concat(i.mimeFallback)),r.searchParams.set("a",i.cropPreview===!0?"0":"1"),r.searchParams.set("c","".concat(e.attributes.etag)),r}catch{return null}}const Ji=(e,i)=>{const t=S(null),n=S(!1);return yt(()=>{n.value=!1,t.value=Gi(de(e),de(i||{})),t.value&&Ki(t.value.href).then(r=>{n.value=r})}),{previewURL:t,previewLoaded:n}},Qi={name:"FolderIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Xi=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon folder-icon",attrs:{"aria-hidden":e.title?null:!0,"aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},en=[],tn=O(Qi,Xi,en,!1,null,null);const ft=tn.exports,nn={name:"FilePreview"},rn=W({...nn,props:{node:null,cropImagePreviews:{type:Boolean}},setup(e){const i=e,t=S(pt),{previewURL:n,previewLoaded:r}=Ji(Ye(i,"node"),x(()=>({cropPreview:i.cropImagePreviews}))),s=x(()=>i.node.type===be.File);return{__sfc:!0,fileListIconStyles:t,props:i,previewURL:n,previewLoaded:r,isFile:s,IconFile:ut,IconFolder:ft}}});var sn=function(){var e=this,i=e._self._c,t=e._self._setupProxy;return i("div",{class:t.fileListIconStyles["file-picker__file-icon"],style:t.previewLoaded?{backgroundImage:"url(".concat(t.previewURL,")")}:void 0},[t.previewLoaded?e._e():[t.isFile?i(t.IconFile,{attrs:{size:20}}):i(t.IconFolder,{attrs:{size:20}})]],2)},on=[],an=O(rn,sn,on,!1,null,null);const ln=an.exports,cn=W({__name:"FileListRow",props:{allowPickDirectory:{type:Boolean},selected:{type:Boolean},showCheckbox:{type:Boolean},canPick:{type:Boolean},node:null,cropImagePreviews:{type:Boolean}},emits:["update:selected","enter-directory"],setup(e,{emit:i}){const t=e,n=x(()=>{var c;return((c=t.node.attributes)==null?void 0:c.displayName)||t.node.basename.slice(0,t.node.extension?-t.node.extension.length:void 0)}),r=x(()=>t.node.extension),s=x(()=>t.node.type===be.Folder),u=x(()=>t.canPick&&(t.allowPickDirectory||!s.value));function a(){i("update:selected",!t.selected)}function l(){s.value?i("enter-directory",t.node):a()}function o(c){c.key==="Enter"&&l()}return{__sfc:!0,props:t,emit:i,displayName:n,fileExtension:r,isDirectory:s,isPickable:u,toggleSelected:a,handleClick:l,handleKeyDown:o,formatFileSize:St,NcCheckboxRadioSwitch:Ke,NcDateTime:Dt,t:I,FilePreview:ln}}});var un=function(){var e=this,i=e._self._c,t=e._self._setupProxy;return i("tr",e._g({class:["file-picker__row",{"file-picker__row--selected":e.selected&&!e.showCheckbox}],attrs:{tabindex:e.showCheckbox&&!t.isDirectory?void 0:0,"aria-selected":t.isPickable?e.selected:void 0,"data-filename":e.node.basename,"data-testid":"file-list-row"}},{click:t.handleClick,...!e.showCheckbox||t.isDirectory?{keydown:t.handleKeyDown}:{}}),[e.showCheckbox?i("td",{staticClass:"row-checkbox",on:{click:function(n){return n.stopPropagation(),(()=>{}).apply(null,arguments)}}},[i(t.NcCheckboxRadioSwitch,{attrs:{"aria-label":t.t("Select the row for {nodename}",{nodename:t.displayName}),checked:e.selected,disabled:!t.isPickable,"data-testid":"row-checkbox"},on:{"update:checked":t.toggleSelected}})],1):e._e(),i("td",{staticClass:"row-name"},[i("div",{staticClass:"file-picker__name-container",attrs:{"data-testid":"row-name"}},[i(t.FilePreview,{attrs:{node:e.node,"crop-image-previews":e.cropImagePreviews}}),i("div",{staticClass:"file-picker__file-name",attrs:{title:t.displayName},domProps:{textContent:e._s(t.displayName)}}),i("div",{staticClass:"file-picker__file-extension",domProps:{textContent:e._s(t.fileExtension)}})],1)]),i("td",{staticClass:"row-size"},[e._v(" "+e._s(t.formatFileSize(e.node.size||0))+" ")]),i("td",{staticClass:"row-modified"},[i(t.NcDateTime,{attrs:{timestamp:e.node.mtime,"ignore-seconds":!0}})],1)])},dn=[],pn=O(cn,un,dn,!1,null,"cb12dccb");const fn=pn.exports,hn=W({__name:"FileList",props:{currentView:null,multiselect:{type:Boolean},allowPickDirectory:{type:Boolean},loading:{type:Boolean},files:null,selectedFiles:null,path:null},emits:["update:path","update:selectedFiles"],setup(e,{emit:i}){const t=e,n=S(),{currentConfig:r}=zi(t.currentView),s=x(()=>{var _;return(_=n.value)!=null?_:r.value}),u=x(()=>s.value.sortBy==="basename"?s.value.order==="none"?void 0:s.value.order:void 0),a=x(()=>s.value.sortBy==="size"?s.value.order==="none"?void 0:s.value.order:void 0),l=x(()=>s.value.sortBy==="mtime"?s.value.order==="none"?void 0:s.value.order:void 0),o=_=>{s.value.sortBy===_?s.value.order==="ascending"?n.value={sortBy:s.value.sortBy,order:"descending"}:n.value={sortBy:s.value.sortBy,order:"ascending"}:n.value={sortBy:_,order:"ascending"}},{sortFavoritesFirst:c,cropImagePreviews:h}=dt(),g=x(()=>wt(t.files,{sortFoldersFirst:!0,sortFavoritesFirst:c.value,sortingOrder:s.value.order==="descending"?"desc":"asc",sortingMode:s.value.sortBy})),d=x(()=>t.files.filter(_=>t.allowPickDirectory||_.type!==be.Folder)),m=x(()=>!t.loading&&t.selectedFiles.length>0&&t.selectedFiles.length>=d.value.length);function p(){t.selectedFiles.length<d.value.length?i("update:selectedFiles",d.value):i("update:selectedFiles",[])}function v(_){t.selectedFiles.includes(_)?i("update:selectedFiles",t.selectedFiles.filter(F=>F.path!==_.path)):t.multiselect?i("update:selectedFiles",[...t.selectedFiles,_]):i("update:selectedFiles",[_])}function w(_){i("update:path",_.path)}const y=S(4),E=S();{const _=()=>gt(()=>{var F,T,C,k,R;const q=((T=(F=E.value)==null?void 0:F.parentElement)==null?void 0:T.children)||[];let J=((k=(C=E.value)==null?void 0:C.parentElement)==null?void 0:k.clientHeight)||450;for(let j=0;j<q.length;j++)(R=E.value)!=null&&R.isSameNode(q[j])||(J-=q[j].clientHeight);y.value=Math.max(1,Math.floor((J-50)/50))});re(()=>{window.addEventListener("resize",_),_()}),vt(()=>{window.removeEventListener("resize",_)})}return{__sfc:!0,props:t,emit:i,customSortingConfig:n,filesAppSorting:r,sortingConfig:s,sortByName:u,sortBySize:a,sortByModified:l,toggleSorting:o,sortFavoritesFirst:c,cropImagePreviews:h,sortedFiles:g,selectableFiles:d,allSelected:m,onSelectAll:p,onNodeSelected:v,onChangeDirectory:w,skeletonNumber:y,fileContainer:E,NcButton:ke,NcCheckboxRadioSwitch:Ke,t:I,IconSortAscending:Vi,IconSortDescending:Ri,LoadingTableRow:Ui,FileListRow:fn}}});var mn=function(){var e=this,i=e._self._c,t=e._self._setupProxy;return i("div",{ref:"fileContainer",staticClass:"file-picker__files"},[i("table",[i("thead",[i("tr",[e.multiselect?i("th",{staticClass:"row-checkbox"},[i("span",{staticClass:"hidden-visually"},[e._v(" "+e._s(t.t("Select entry"))+" ")]),e.multiselect?i(t.NcCheckboxRadioSwitch,{attrs:{"aria-label":t.t("Select all entries"),checked:t.allSelected,"data-testid":"select-all-checkbox"},on:{"update:checked":t.onSelectAll}}):e._e()],1):e._e(),i("th",{staticClass:"row-name",attrs:{"aria-sort":t.sortByName}},[i("div",{staticClass:"header-wrapper"},[i("span",{staticClass:"file-picker__header-preview"}),i(t.NcButton,{attrs:{wide:!0,type:"tertiary","data-test":"file-picker_sort-name"},on:{click:function(n){return t.toggleSorting("basename")}},scopedSlots:e._u([{key:"icon",fn:function(){return[t.sortByName==="ascending"?i(t.IconSortAscending,{attrs:{size:20}}):t.sortByName==="descending"?i(t.IconSortDescending,{attrs:{size:20}}):i("span",{staticStyle:{width:"44px"}})]},proxy:!0}])},[e._v(" "+e._s(t.t("Name"))+" ")])],1)]),i("th",{staticClass:"row-size",attrs:{"aria-sort":t.sortBySize}},[i(t.NcButton,{attrs:{wide:!0,type:"tertiary"},on:{click:function(n){return t.toggleSorting("size")}},scopedSlots:e._u([{key:"icon",fn:function(){return[t.sortBySize==="ascending"?i(t.IconSortAscending,{attrs:{size:20}}):t.sortBySize==="descending"?i(t.IconSortDescending,{attrs:{size:20}}):i("span",{staticStyle:{width:"44px"}})]},proxy:!0}])},[e._v(" "+e._s(t.t("Size"))+" ")])],1),i("th",{staticClass:"row-modified",attrs:{"aria-sort":t.sortByModified}},[i(t.NcButton,{attrs:{wide:!0,type:"tertiary"},on:{click:function(n){return t.toggleSorting("mtime")}},scopedSlots:e._u([{key:"icon",fn:function(){return[t.sortByModified==="ascending"?i(t.IconSortAscending,{attrs:{size:20}}):t.sortByModified==="descending"?i(t.IconSortDescending,{attrs:{size:20}}):i("span",{staticStyle:{width:"44px"}})]},proxy:!0}])},[e._v(" "+e._s(t.t("Modified"))+" ")])],1)])]),i("tbody",[e.loading?e._l(t.skeletonNumber,function(n){return i(t.LoadingTableRow,{key:n,attrs:{"show-checkbox":e.multiselect}})}):e._l(t.sortedFiles,function(n){return i(t.FileListRow,{key:n.fileid||n.path,attrs:{"allow-pick-directory":e.allowPickDirectory,"show-checkbox":e.multiselect,"can-pick":e.multiselect||e.selectedFiles.length===0||e.selectedFiles.includes(n),selected:e.selectedFiles.includes(n),node:n,"crop-image-previews":t.cropImagePreviews},on:{"update:selected":function(r){return t.onNodeSelected(n)},"enter-directory":t.onChangeDirectory}})})],2)])])},vn=[],gn=O(hn,mn,vn,!1,null,"006fdbd0");const yn=gn.exports,_n={name:"HomeIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var bn=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon home-icon",attrs:{"aria-hidden":e.title?null:!0,"aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},wn=[],Cn=O(_n,bn,wn,!1,null,null);const kn=Cn.exports,xn={name:"PlusIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Sn=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon plus-icon",attrs:{"aria-hidden":e.title?null:!0,"aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Nn=[],Fn=O(xn,Sn,Nn,!1,null,null);const Bn=Fn.exports,In=W({__name:"FilePickerBreadcrumbs",props:{path:null,showMenu:{type:Boolean}},emits:["update:path","create-node"],setup(e,{emit:i}){const t=e,n=S(!1),r=S(""),s=S();function u(){var o,c,h,g;const d=r.value.trim(),m=(c=(o=s.value)==null?void 0:o.$el)==null?void 0:c.querySelector("input");let p="";return d.length===0?p=I("Folder name cannot be empty."):d.includes("/")?p=I('"/" is not allowed inside a folder name.'):["..","."].includes(d)?p=I('"{name}" is an invalid folder name.',{name:d}):(h=window.OC.config)!=null&&h.blacklist_files_regex&&d.match((g=window.OC.config)==null?void 0:g.blacklist_files_regex)&&(p=I('"{name}" is not an allowed folder name',{name:d})),m&&m.setCustomValidity(p),p===""}const a=function(){const o=r.value.trim();u()&&(n.value=!1,i("create-node",o),r.value="")},l=x(()=>t.path.split("/").filter(o=>o!=="").map((o,c,h)=>({name:o,path:"/"+h.slice(0,c+1).join("/")})));return{__sfc:!0,props:t,emit:i,actionsOpen:n,newNodeName:r,nameInput:s,validateInput:u,onSubmit:a,pathElements:l,IconFolder:ft,IconHome:kn,IconPlus:Bn,NcActions:Ce,NcActionInput:zt,NcBreadcrumbs:gi,NcBreadcrumb:Qe,t:I}}});var Ln=function(){var e=this,i=e._self._c,t=e._self._setupProxy;return i(t.NcBreadcrumbs,{staticClass:"file-picker__breadcrumbs",scopedSlots:e._u([{key:"default",fn:function(){return[i(t.NcBreadcrumb,{attrs:{name:t.t("All files"),title:t.t("Home")},on:{click:function(n){return t.emit("update:path","/")}},scopedSlots:e._u([{key:"icon",fn:function(){return[i(t.IconHome,{attrs:{size:20}})]},proxy:!0}])}),e._l(t.pathElements,function(n){return i(t.NcBreadcrumb,{key:n.path,attrs:{name:n.name,title:n.path},on:{click:function(r){return t.emit("update:path",n.path)}}})})]},proxy:!0},e.showMenu?{key:"actions",fn:function(){return[i(t.NcActions,{attrs:{"aria-label":t.t("Create directory"),"force-menu":!0,"force-name":!0,"menu-name":t.t("New"),open:t.actionsOpen,type:"secondary"},on:{"update:open":function(n){t.actionsOpen=n},close:function(n){t.newNodeName=""}},scopedSlots:e._u([{key:"icon",fn:function(){return[i(t.IconPlus,{attrs:{size:20}})]},proxy:!0}],null,!1,2971667417)},[i(t.NcActionInput,{ref:"nameInput",attrs:{value:t.newNodeName,label:t.t("New folder"),placeholder:t.t("New folder name")},on:{"update:value":function(n){t.newNodeName=n},submit:t.onSubmit,input:t.validateInput},scopedSlots:e._u([{key:"icon",fn:function(){return[i(t.IconFolder,{attrs:{size:20}})]},proxy:!0}],null,!1,1614167509)})],1)]},proxy:!0}:null],null,!0)})},Pn=[],zn=O(In,Ln,Pn,!1,null,"b357227a");const En=zn.exports,On={name:"CloseIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Dn=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon close-icon",attrs:{"aria-hidden":e.title?null:!0,"aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},An=[],Vn=O(On,Dn,An,!1,null,null);const $n=Vn.exports,Tn={name:"MagnifyIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Mn=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon magnify-icon",attrs:{"aria-hidden":e.title?null:!0,"aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Hn=[],Rn=O(Tn,Mn,Hn,!1,null,null);const jn=Rn.exports,Wn=e=>{const i=[{id:"files",label:I("All files"),icon:Ni},{id:"recent",label:I("Recent"),icon:Si},{id:"favorites",label:I("Favorites"),icon:Fi}],t=e.value?i.filter(({id:n})=>n==="files"):i;return{allViews:i,availableViews:t}},qn=W({__name:"FilePickerNavigation",props:{currentView:null,filterString:null,isCollapsed:{type:Boolean},disabledNavigation:{type:Boolean}},emits:["update:currentView","update:filterString"],setup(e,{emit:i}){const t=e,{availableViews:n}=Wn(S(Rt()===null)),r=x(()=>{var s;return(s=n.filter(u=>u.id===t.currentView)[0])!=null?s:n[0]});return{__sfc:!0,props:t,emit:i,availableViews:n,currentViewObject:r,updateFilterValue:s=>i("update:filterString",s),IconClose:$n,IconMagnify:jn,NcButton:ke,NcIconSvgWrapper:$t,NcSelect:Et,NcTextField:Ot,Fragment:tt,t:I}}});var Zn=function(){var e=this,i=e._self._c,t=e._self._setupProxy;return i(t.Fragment,[i(t.NcTextField,{staticClass:"file-picker__filter-input",attrs:{value:e.filterString,label:t.t("Filter file list"),"show-trailing-button":!!e.filterString},on:{"update:value":t.updateFilterValue,"trailing-button-click":function(n){return t.updateFilterValue("")}},scopedSlots:e._u([{key:"trailing-button-icon",fn:function(){return[i(t.IconClose,{attrs:{size:16}})]},proxy:!0}])},[i(t.IconMagnify,{attrs:{size:16}})],1),t.availableViews.length>1&&!e.disabledNavigation?[e.isCollapsed?i(t.NcSelect,{attrs:{"aria-label":t.t("Current view selector"),clearable:!1,searchable:!1,options:t.availableViews,value:t.currentViewObject},on:{input:n=>t.emit("update:currentView",n.id)}}):i("ul",{staticClass:"file-picker__side"},e._l(t.availableViews,function(n){return i("li",{key:n.id},[i(t.NcButton,{attrs:{type:e.currentView===n.id?"primary":"tertiary",wide:!0},on:{click:function(r){return e.$emit("update:currentView",n.id)}},scopedSlots:e._u([{key:"icon",fn:function(){return[i(t.NcIconSvgWrapper,{attrs:{path:n.icon,size:20}})]},proxy:!0}],null,!0)},[e._v(" "+e._s(n.label)+" ")])],1)}),0)]:e._e()],2)},Un=[],Yn=O(qn,Zn,Un,!1,null,"b42054b8");const Kn=Yn.exports,Gn=function(e,i){const t=ye(),n=t?"/":Ct,r=x(()=>t?jt("webdav").replace("/remote.php","/public.php"):_t),s=x(()=>{if(t){const v=document.getElementById("sharingToken").value,w=btoa("".concat(v,":null"));return Ae(r.value,{Authorization:"Basic ".concat(w)})}return Ae()}),u=v=>kt(v,n,r.value),a=()=>{const v=new AbortController,w=Math.round(Date.now()/1e3)-60*60*24*14;return new $e(async(y,E,_)=>{_(()=>v.abort());try{const{data:F}=await s.value.search("/",{signal:v.signal,details:!0,data:xt(w)}),T=F.results.map(u);y(T)}catch(F){E(F)}})},l=()=>{const v=new AbortController;return new $e(async(w,y,E)=>{E(()=>v.abort());try{const _=(await s.value.getDirectoryContents("".concat(n).concat(i.value),{signal:v.signal,details:!0,includeSelf:!0,data:Ve()})).data.map(u);w({folder:_.find(F=>F.path===i.value),contents:_.filter(F=>F.path!==i.value)})}catch(_){y(_)}})},o=me([]),c=me(null),h=S(!0),g=S(null);async function d(v){const w=De.join(i.value,v);await s.value.createDirectory(De.join(n,w));const y=await m(w);return o.value=[...o.value,y],y}async function m(v,w=void 0){w=w!=null?w:n;const{data:y}=await s.value.stat("".concat(w).concat(v),{details:!0,data:Ve()});return u(y)}async function p(){g.value&&g.value.cancel(),h.value=!0,e.value==="favorites"?g.value=bt(s.value,i.value,n):e.value==="recent"?g.value=a():g.value=l();const v=await g.value;"folder"in v?(c.value=v.folder,o.value=v.contents):(c.value=null,o.value=v),g.value=null,h.value=!1}return Ue([e,i],()=>p()),re(()=>p()),{isLoading:h,files:o,folder:c,loadFiles:p,createDirectory:d}},Jn=function(e){const i=x(()=>e.value.map(t=>t.split("/")));return{isSupportedMimeType:t=>{const n=t.split("/");return i.value.some(([r,s])=>(n[0]===r||r==="*")&&(n[1]===s||s==="*"))}}},Qn={name:"FilePicker"},Xn=W({...Qn,props:{buttons:null,name:null,allowPickDirectory:{type:Boolean,default:!1},disabledNavigation:{type:Boolean,default:!1},container:{default:"body"},filterFn:{default:void 0},mimetypeFilter:{default:()=>[]},multiselect:{type:Boolean,default:!0},path:{default:void 0}},emits:["close"],setup(e,{emit:i}){const t=e,n=S(!0),r=x(()=>{const C=o.value.length===0&&t.allowPickDirectory&&v.value?[v.value]:o.value;return(typeof t.buttons=="function"?t.buttons(C,g.value,a.value):t.buttons).map(k=>({...k,disabled:k.disabled||w.value,callback:()=>{s=!0,u(k.callback,C)}}))});let s=!1;const u=async(C,k)=>{C(k),i("close",k),s=!1},a=S("files"),l=x(()=>a.value==="favorites"?I("Favorites"):a.value==="recent"?I("Recent"):""),o=me([]),c=S((window==null?void 0:window.sessionStorage.getItem("NC.FilePicker.LastPath"))||"/"),h=S("");Ue([h],()=>{t.path===void 0&&h.value&&window.sessionStorage.setItem("NC.FilePicker.LastPath",h.value),o.value=[]});const g=x({get:()=>a.value==="files"?h.value||t.path||c.value:"/",set:C=>{h.value=C}}),d=S(""),{isSupportedMimeType:m}=Jn(Ye(t,"mimetypeFilter")),{files:p,folder:v,isLoading:w,loadFiles:y,createDirectory:E}=Gn(a,g);re(()=>y());const{showHiddenFiles:_}=dt(),F=x(()=>{let C=p.value;return _.value||(C=C.filter(k=>!k.basename.startsWith("."))),t.mimetypeFilter.length>0&&(C=C.filter(k=>k.type==="folder"||k.mime&&m(k.mime))),d.value&&(C=C.filter(k=>k.basename.toLowerCase().includes(d.value.toLowerCase()))),t.filterFn&&(C=C.filter(k=>t.filterFn(k))),C}),T=x(()=>a.value==="files"?I("Upload some content or sync with your devices!"):a.value==="recent"?I("Files and folders you recently modified will show up here."):I("Files and folders you mark as favorite will show up here."));return{__sfc:!0,props:t,emit:i,isOpen:n,dialogButtons:r,isHandlingCallback:s,handleButtonClick:u,currentView:a,viewHeadline:l,selectedFiles:o,savedPath:c,navigatedPath:h,currentPath:g,filterString:d,isSupportedMimeType:m,files:p,currentFolder:v,isLoading:w,loadFiles:y,createDirectory:E,showHiddenFiles:_,filteredFiles:F,noFilesDescription:T,onCreateFolder:async C=>{try{const k=await E(C);h.value=k.path,Ht("files:node:created",p.value.filter(R=>R.basename===C)[0])}catch(k){console.warn("Could not create new folder",{name:C,error:k}),_e(I("Could not create the new folder"))}},handleClose:C=>{!C&&!s&&i("close")},IconFile:ut,FileList:yn,FilePickerBreadcrumbs:En,FilePickerNavigation:Kn,NcDialog:Lt,NcEmptyContent:Pt,t:I}}});var er=function(){var e=this,i=e._self._c,t=e._self._setupProxy;return i(t.NcDialog,{attrs:{container:e.container,buttons:t.dialogButtons,name:e.name,size:"large","content-classes":"file-picker__content","dialog-classes":"file-picker","navigation-classes":"file-picker__navigation",open:t.isOpen},on:{"update:open":[function(n){t.isOpen=n},t.handleClose]},scopedSlots:e._u([{key:"navigation",fn:function({isCollapsed:n}){return[i(t.FilePickerNavigation,{attrs:{"is-collapsed":n,"current-view":t.currentView,"filter-string":t.filterString,"disabled-navigation":e.disabledNavigation},on:{"update:currentView":function(r){t.currentView=r},"update:current-view":function(r){t.currentView=r},"update:filterString":function(r){t.filterString=r},"update:filter-string":function(r){t.filterString=r}}})]}}])},[i("div",{staticClass:"file-picker__main"},[t.currentView==="files"?i(t.FilePickerBreadcrumbs,{attrs:{path:t.currentPath,"show-menu":e.allowPickDirectory},on:{"update:path":function(n){t.currentPath=n},"create-node":t.onCreateFolder}}):i("div",{staticClass:"file-picker__view"},[i("h3",[e._v(e._s(t.viewHeadline))])]),t.isLoading||t.filteredFiles.length>0?i(t.FileList,{attrs:{"allow-pick-directory":e.allowPickDirectory,"current-view":t.currentView,files:t.filteredFiles,multiselect:e.multiselect,loading:t.isLoading,path:t.currentPath,"selected-files":t.selectedFiles,name:t.viewHeadline},on:{"update:path":[function(n){t.currentPath=n},function(n){t.currentView="files"}],"update:selectedFiles":function(n){t.selectedFiles=n},"update:selected-files":function(n){t.selectedFiles=n}}}):t.filterString?i(t.NcEmptyContent,{attrs:{name:t.t("No matching files"),description:t.t("No files matching your filter were found.")},scopedSlots:e._u([{key:"icon",fn:function(){return[i(t.IconFile)]},proxy:!0}])}):i(t.NcEmptyContent,{attrs:{name:t.t("No files in here"),description:t.noFilesDescription},scopedSlots:e._u([{key:"icon",fn:function(){return[i(t.IconFile)]},proxy:!0}])})],1)])},tr=[],ir=O(Xn,er,tr,!1,null,"20b719ba");const vr=ir.exports;export{vr as default};
