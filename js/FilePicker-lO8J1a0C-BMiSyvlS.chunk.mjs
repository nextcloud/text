import{V as D,c as d,t as M,f as L,r as h,s as Z,w as le,o as z,n as Ne,b as xe,h as Le}from"./vue.runtime.esm-CmyF5LTP.chunk.mjs";import{N as q,d as j,n as _,t as v,s as U,i as ce,p as T,e as ue,f as V}from"./NcNoteCard-CwNXZ4vV-Ca_1Tsre.chunk.mjs";import{s as Fe,f as Ve}from"./index-CjE13L7b.chunk.mjs";import{N as de}from"./NcCheckboxRadioSwitch-CX3HXCEk-qnG5ZcLO.chunk.mjs";import{l as pe}from"./index-D3wiQe9-.chunk.mjs";import{g as G}from"./index-DCzdQJ7L.chunk.mjs";import{n as $,c as fe}from"./NcLoadingIcon-DAvEVuxu.chunk.mjs";import{o as Be,q as Ie,r as Pe,s as ze,t as $e,v as He,w as Ae,x as De,y as Ee,z as Me,A as Te,B as Oe,D as Re}from"./TocContainer-Br8W5riM.chunk.mjs";import{u as We,s as Ze,e as qe,g as je}from"./index-CdM8BgQf.chunk.mjs";import{g as Ue,c as Ge,d as Y,b as B,C as he,e as Ye,f as K,h as me,P as X}from"./dav-CQDyL7M_-BUEyzEJ7.chunk.mjs";import"./emoji-picker-hi3Hwbeu.chunk.mjs";import"./index-Bnw2WuIx.chunk.mjs";import"./logger-DS8A9d_w.chunk.mjs";import"./preload-helper-BorfeO-5.chunk.mjs";import"./MediaHandler.provider-bE4nrOxZ.chunk.mjs";const Ke={name:"ChevronRightIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Je=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon chevron-right-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Qe=[],Xe=$(Ke,Je,Qe,!1,null,null);const et=Xe.exports,tt={name:"NcBreadcrumb",components:{NcActions:j,ChevronRight:et,NcButton:q},inheritAttrs:!1,props:{name:{type:String,required:!0},title:{type:String,default:null},to:{type:[String,Object],default:void 0},exact:{type:Boolean,default:!1},href:{type:String,default:void 0},icon:{type:String,default:""},forceIconText:{type:Boolean,default:!1},disableDrop:{type:Boolean,default:!1},forceMenu:{type:Boolean,default:!1},open:{type:Boolean,default:!1}},emits:["update:open","dropped"],setup(){const e=Be();return{actionsContainer:`.vue-crumb[data-crumb-id="${e}"]`,crumbId:e}},data(){return{hovering:!1}},computed:{linkAttributes(){return this.to?{to:this.to,exact:this.exact,...this.$attrs}:this.href?{href:this.href,...this.$attrs}:this.$attrs}},methods:{onOpenChange(e){this.$emit("update:open",e)},dropped(e){return this.disableDrop||(this.$emit("dropped",e,this.to||this.href),this.$parent.$emit("dropped",e,this.to||this.href),this.hovering=!1),!1},dragEnter(){this.disableDrop||(this.hovering=!0)},dragLeave(e){this.disableDrop||e.target.contains(e.relatedTarget)||this.$refs.crumb.contains(e.relatedTarget)||(this.hovering=!1)}}};var it=function(){var e=this,i=e._self._c;return i("li",{ref:"crumb",staticClass:"vue-crumb",class:{"vue-crumb--hovered":e.hovering},attrs:{"data-crumb-id":e.crumbId,draggable:"false"},on:{dragstart:function(t){return t.preventDefault(),(()=>{}).apply(null,arguments)},drop:function(t){return t.preventDefault(),e.dropped.apply(null,arguments)},dragover:function(t){return t.preventDefault(),(()=>{}).apply(null,arguments)},dragenter:e.dragEnter,dragleave:e.dragLeave}},[(e.name||e.icon||e.$slots.icon)&&!e.$slots.default?i("NcButton",e._g(e._b({attrs:{"aria-label":e.icon?e.name:void 0,title:e.title,variant:"tertiary"},scopedSlots:e._u([e.$slots.icon||e.icon?{key:"icon",fn:function(){return[e._t("icon",function(){return[i("span",{staticClass:"icon",class:e.icon})]})]},proxy:!0}:null,!(e.$slots.icon||e.icon)||e.forceIconText?{key:"default",fn:function(){return[e._v(" "+e._s(e.name)+" ")]},proxy:!0}:null],null,!0)},"NcButton",e.linkAttributes,!1),e.$listeners)):e._e(),e.$slots.default?i("NcActions",{ref:"actions",attrs:{"force-menu":e.forceMenu,open:e.open,"menu-name":e.name,title:e.title,"force-name":!0,container:e.actionsContainer,variant:"tertiary"},on:{"update:open":e.onOpenChange},scopedSlots:e._u([{key:"icon",fn:function(){return[e._t("menu-icon")]},proxy:!0}],null,!0)},[e._t("default")],2):e._e(),i("ChevronRight",{staticClass:"vue-crumb__separator",attrs:{size:20}})],1)},nt=[],rt=$(tt,it,nt,!1,null,"bc2f0c21");const ve=rt.exports;var R=Symbol(),I=Symbol(),ee=Symbol(),te=Symbol(),J=function(e){return"frag"in e},st={get:function(){return this[I]||this.parentElement},configurable:!0},P=function(e,i){I in e||(e[I]=i,Object.defineProperty(e,"parentNode",st))},at={get:function(){var e=this.parentNode.childNodes,i=e.indexOf(this);return i>-1&&e[i+1]||null}},E=function(e){ee in e||(e[ee]=!0,Object.defineProperty(e,"nextSibling",at))},ot=function(e,i){for(;e.parentNode!==i;){var t=e,n=t.parentNode;n&&(e=n)}return e},W,ge=function(e){if(!W){var i=Object.getOwnPropertyDescriptor(Node.prototype,"childNodes");W=i.get}var t=W.apply(e),n=Array.from(t).map((function(r){return ot(r,e)}));return n.filter((function(r,s){return r!==n[s-1]}))},lt={get:function(){return this.frag||ge(this)}},ct={get:function(){return this.childNodes[0]||null}};function ut(){return this.childNodes.length>0}var ie=function(e){te in e||(e[te]=!0,Object.defineProperties(e,{childNodes:lt,firstChild:ct}),e.hasChildNodes=ut)};function dt(){var e;(e=this.frag[0]).before.apply(e,arguments)}function pt(){var e=this.frag,i=e.splice(0,e.length);i.forEach((function(t){t.remove()}))}var ft=function e(i){var t;return(t=Array.prototype).concat.apply(t,i.map((function(n){return J(n)?e(n.frag):n})))},ht=function(e,i){var t=e[R];i.before(t),P(t,e),e.frag.unshift(t)};function ne(e){if(J(this)){var i=this.frag.indexOf(e);if(i>-1){var t=this.frag.splice(i,1),n=t[0];this.frag.length===0&&ht(this,n),e.remove()}}else{var r=ge(this),s=r.indexOf(e);s>-1&&e.remove()}return e}function re(e,i){var t=this,n=e.frag||[e];if(J(this)){if(e[I]===this&&e.parentElement)return e;var r=this.frag;if(i){var s=r.indexOf(i);s>-1&&(r.splice.apply(r,[s,0].concat(n)),i.before.apply(i,n))}else{var a=r[r.length-1];r.push.apply(r,n),a.after.apply(a,n)}ye(this)}else i?this.childNodes.includes(i)&&i.before.apply(i,n):this.append.apply(this,n);n.forEach((function(c){P(c,t)}));var o=n[n.length-1];return E(o),e}function mt(e){if(e[I]===this&&e.parentElement)return e;var i=this.frag,t=i[i.length-1];return t.after(e),P(e,this),ye(this),i.push(e),e}var ye=function(e){var i=e[R];e.frag[0]===i&&(e.frag.shift(),i.remove())},vt={set:function(e){var i=this;if(this.frag[0]!==this[R]&&this.frag.slice().forEach((function(n){return i.removeChild(n)})),e){var t=document.createElement("div");t.innerHTML=e,Array.from(t.childNodes).forEach((function(n){i.appendChild(n)}))}},get:function(){return""}},gt={inserted:function(e){var i=e.parentNode,t=e.nextSibling,n=e.previousSibling,r=Array.from(e.childNodes),s=document.createComment("");r.length===0&&r.push(s),e.frag=r,e[R]=s;var a=document.createDocumentFragment();a.append.apply(a,ft(r)),e.replaceWith(a),r.forEach((function(o){P(o,e),E(o)})),ie(e),Object.assign(e,{remove:pt,appendChild:mt,insertBefore:re,removeChild:ne,before:dt}),Object.defineProperty(e,"innerHTML",vt),i&&(Object.assign(i,{removeChild:ne,insertBefore:re}),P(e,i),ie(i)),t&&E(e),n&&E(n)},unbind:function(e){e.remove()}},_e={name:"Fragment",directives:{frag:gt},render:function(e){return e("div",{directives:[{name:"frag"}]},this.$slots.default)}};const yt={name:"FolderIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var _t=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon folder-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},bt=[],wt=$(yt,_t,bt,!1,null,null);const Ct=wt.exports;function se(e,i,t){if(e!==void 0)for(let n=e.length-1;n>=0;n--){const r=e[n],s=!r.componentOptions&&r.tag&&i.indexOf(r.tag)===-1,a=!!r.componentOptions&&typeof r.componentOptions.tag=="string",o=a&&i.indexOf(r.componentOptions.tag)===-1;(s||!a||o)&&((s||o)&&D.util.warn(`${s?r.tag:r.componentOptions.tag} is not allowed inside the ${t.$options.name} component`,t),e.splice(n,1))}}const y="vue-crumb",kt={name:"NcBreadcrumbs",components:{NcActions:j,NcActionButton:ze,NcActionRouter:Pe,NcActionLink:Ie,NcBreadcrumb:ve,IconFolder:Ct},props:{rootIcon:{type:String,default:"icon-home"},ariaLabel:{type:String,default:null}},emits:["dropped"],data(){return{hiddenIndices:[],menuBreadcrumbProps:{name:"",forceMenu:!0,disableDrop:!0,open:!1},breadcrumbsRefs:{}}},beforeMount(){se(this.$slots.default,["NcBreadcrumb"],this)},beforeUpdate(){se(this.$slots.default,["NcBreadcrumb"],this)},created(){window.addEventListener("resize",$e(()=>{this.handleWindowResize()},100)),Ze("navigation-toggled",this.delayedResize)},mounted(){this.handleWindowResize()},updated(){this.delayedResize(),this.$nextTick(()=>{this.hideCrumbs()})},beforeDestroy(){window.removeEventListener("resize",this.handleWindowResize),We("navigation-toggled",this.delayedResize)},methods:{closeActions(e){this.$refs.actionsBreadcrumb.$el.contains(e.relatedTarget)||(this.menuBreadcrumbProps.open=!1)},async delayedResize(){await this.$nextTick(),this.handleWindowResize()},handleWindowResize(){if(!this.$refs.container)return;const e=Object.values(this.breadcrumbsRefs),i=e.length,t=[],n=this.$refs.container.offsetWidth;let r=this.getTotalWidth(e);this.$refs.breadcrumb__actions&&(r+=this.$refs.breadcrumb__actions.offsetWidth);let s=r-n;s+=s>0?64:0;let a=0;const o=Math.floor(i/2);for(;s>0&&a<i-2;){const c=o+(a%2?a+1:a)/2*Math.pow(-1,a+i%2);s-=this.getWidth(e[c]?.elm,c===e.length-1),t.push(c),a++}this.arraysEqual(this.hiddenIndices,t.sort((c,l)=>c-l))||(this.hiddenIndices=t)},arraysEqual(e,i){if(e.length!==i.length)return!1;if(e===i)return!0;if(e===null||i===null)return!1;for(let t=0;t<e.length;++t)if(e[t]!==i[t])return!1;return!0},getTotalWidth(e){return e.reduce((i,t,n)=>i+this.getWidth(t?.elm,n===e.length-1),0)},getWidth(e,i){if(!e?.classList)return 0;const t=e.classList.contains(`${y}--hidden`);e.style.minWidth="auto",i&&(e.style.maxWidth="210px"),e.classList.remove(`${y}--hidden`);const n=e.offsetWidth;return t&&e.classList.add(`${y}--hidden`),e.style.minWidth="",e.style.maxWidth="",n},preventDefault(e){return e.preventDefault&&e.preventDefault(),!1},dragStart(e){return this.preventDefault(e)},dropped(e,i,t){return t||this.$emit("dropped",e,i),this.menuBreadcrumbProps.open=!1,document.querySelectorAll(`.${y}`).forEach(n=>{n.classList.remove(`${y}--hovered`)}),this.preventDefault(e)},dragOver(e){return this.preventDefault(e)},dragEnter(e,i){if(!i&&e.target.closest){const t=e.target.closest(`.${y}`);t.classList&&t.classList.contains(y)&&(document.querySelectorAll(`.${y}`).forEach(n=>{n.classList.remove(`${y}--hovered`)}),t.classList.add(`${y}--hovered`))}},dragLeave(e,i){if(!i&&!e.target.contains(e.relatedTarget)&&e.target.closest){const t=e.target.closest(`.${y}`);if(t.contains(e.relatedTarget))return;t.classList&&t.classList.contains(y)&&t.classList.remove(`${y}--hovered`)}},hideCrumbs(){Object.values(this.breadcrumbsRefs).forEach((e,i)=>{e?.elm?.classList&&(this.hiddenIndices.includes(i)?e.elm.classList.add(`${y}--hidden`):e.elm.classList.remove(`${y}--hidden`))})},isBreadcrumb(e){return(e?.componentOptions?.tag||e?.tag||"").includes("NcBreadcrumb")}},render(e){const i=[];if(this.$slots.default.forEach(s=>{if(this.isBreadcrumb(s)){i.push(s);return}s?.type===_e&&s?.children?.forEach?.(a=>{this.isBreadcrumb(a)&&i.push(a)})}),i.length===0)return;D.set(i[0].componentOptions.propsData,"icon",this.rootIcon),D.set(i[0].componentOptions.propsData,"ref","breadcrumbs");const t={};i.forEach((s,a)=>{D.set(s,"ref",`crumb-${a}`),t[a]=s});let n=[];if(!this.hiddenIndices.length)n=i;else{n=i.slice(0,Math.round(i.length/2)),n.push(e("NcBreadcrumb",{class:"dropdown",props:this.menuBreadcrumbProps,attrs:{"aria-hidden":!0},ref:"actionsBreadcrumb",key:"actions-breadcrumb-1",nativeOn:{dragstart:this.dragStart,dragenter:()=>{this.menuBreadcrumbProps.open=!0},dragleave:this.closeActions},on:{"update:open":a=>{this.menuBreadcrumbProps.open=a}}},this.hiddenIndices.filter(a=>a<=i.length-1).map(a=>{const o=i[a],c=o.componentOptions.propsData.to,l=o.componentOptions.propsData.href,f=o.componentOptions.propsData.disableDrop,u=o.componentOptions.propsData.title,C=o.componentOptions.propsData.name;let b="NcActionButton",k="";l&&(b="NcActionLink",k=l),c&&(b="NcActionRouter",k=c);const S=e("IconFolder",{props:{size:20},slot:"icon"});return e(b,{class:y,props:{href:l||null,title:u,to:c||null},attrs:{draggable:!1},on:{...o.componentOptions.listeners},nativeOn:{dragstart:this.dragStart,drop:w=>this.dropped(w,k,f),dragover:this.dragOver,dragenter:w=>this.dragEnter(w,f),dragleave:w=>this.dragLeave(w,f)}},[S,C])})));const s=i.slice(Math.round(i.length/2));n=n.concat(s)}const r=[e("nav",{attrs:{"aria-label":this.ariaLabel}},[e("ul",{class:"breadcrumb__crumbs"},[n])])];return this.$slots.actions&&r.push(e("div",{class:"breadcrumb__actions",ref:"breadcrumb__actions"},this.$slots.actions)),this.breadcrumbsRefs=t,e("div",{class:["breadcrumb",{"breadcrumb--collapsed":this.hiddenIndices.length===i.length-2}],ref:"container"},r)}},St=null,Nt=null;var xt=$(kt,St,Nt,!1,null,"daf14f2f");const Lt=xt.exports,Ft={name:"NcDateTime",props:{timestamp:{type:[Date,Number],required:!0},format:{type:Object,default:()=>({timeStyle:"medium",dateStyle:"short"})},relativeTime:{type:[Boolean,String],default:"long",validator:e=>e===!1||["long","short","narrow"].includes(e)},ignoreSeconds:{type:Boolean,default:!1}},setup(e){const i=d(()=>({format:e.format})),t=d(()=>({ignoreSeconds:e.ignoreSeconds,relativeTime:e.relativeTime||"long",update:e.relativeTime!==!1})),n=He(M(e,"timestamp"),i),r=Ae(M(e,"timestamp"),t);return{formattedTime:d(()=>e.relativeTime?r.value:n.value),title:n}}};var Vt=function(){var e=this,i=e._self._c;return i("span",{staticClass:"nc-datetime",attrs:{dir:"auto","data-timestamp":e.timestamp,title:e.title},domProps:{textContent:e._s(e.formattedTime)}})},Bt=[],It=$(Ft,Vt,Bt,!1,null,null);const Pt=It.exports;var ae="M15,14C12.33,14 7,15.33 7,18V20H23V18C23,15.33 17.67,14 15,14M6,10V7H4V10H1V12H4V15H6V12H9V10M15,12A4,4 0 0,0 19,8A4,4 0 0,0 15,4A4,4 0 0,0 11,8A4,4 0 0,0 15,12Z",zt="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M16.2,16.2L11,13V7H12.5V12.2L17,14.9L16.2,16.2Z",$t="M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z",Ht="M1,1V5H2V19H1V23H5V22H19V23H23V19H22V5H23V1H19V2H5V1M5,4H19V5H20V19H19V20H5V19H4V5H5M6,6V14H9V18H18V9H14V6M8,8H12V12H8M14,11H16V16H11V14H14",At="M3.9,12C3.9,10.29 5.29,8.9 7,8.9H11V7H7A5,5 0 0,0 2,12A5,5 0 0,0 7,17H11V15.1H7C5.29,15.1 3.9,13.71 3.9,12M8,13H16V11H8V13M17,7H13V8.9H17C18.71,8.9 20.1,10.29 20.1,12C20.1,13.71 18.71,15.1 17,15.1H13V17H17A5,5 0 0,0 22,12A5,5 0 0,0 17,7Z",Dt="M12,17A2,2 0 0,0 14,15C14,13.89 13.1,13 12,13A2,2 0 0,0 10,15A2,2 0 0,0 12,17M18,8A2,2 0 0,1 20,10V20A2,2 0 0,1 18,22H6A2,2 0 0,1 4,20V10C4,8.89 4.9,8 6,8H7V6A5,5 0 0,1 12,1A5,5 0 0,1 17,6V8H18M12,3A3,3 0 0,0 9,6V8H15V6A3,3 0 0,0 12,3Z",Et="M17,3A2,2 0 0,1 19,5V15A2,2 0 0,1 17,17H13V19H14A1,1 0 0,1 15,20H22V22H15A1,1 0 0,1 14,23H10A1,1 0 0,1 9,22H2V20H9A1,1 0 0,1 10,19H11V17H7C5.89,17 5,16.1 5,15V5A2,2 0 0,1 7,3H17Z",Mt="M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z",Tt="M5.5,7A1.5,1.5 0 0,1 4,5.5A1.5,1.5 0 0,1 5.5,4A1.5,1.5 0 0,1 7,5.5A1.5,1.5 0 0,1 5.5,7M21.41,11.58L12.41,2.58C12.05,2.22 11.55,2 11,2H4C2.89,2 2,2.89 2,4V11C2,11.55 2.22,12.05 2.59,12.41L11.58,21.41C11.95,21.77 12.45,22 13,22C13.55,22 14.05,21.77 14.41,21.41L21.41,14.41C21.78,14.05 22,13.55 22,13C22,12.44 21.77,11.94 21.41,11.58Z",O;(function(e){e[e.User=0]="User",e[e.Group=1]="Group",e[e.Link=3]="Link",e[e.Email=4]="Email",e[e.Remote=6]="Remote",e[e.Team=7]="Team",e[e.Guest=8]="Guest",e[e.RemoteGroup=9]="RemoteGroup",e[e.Room=10]="Room",e[e.Deck=12]="Deck",e[e.FederatedGroup=14]="FederatedGroup",e[e.ScienceMesh=15]="ScienceMesh"})(O||(O={}));class Q extends Error{name="TimeoutError";constructor(i,t){super(i,t),Error.captureStackTrace?.(this,Q)}}const oe=e=>e.reason??new DOMException("This operation was aborted.","AbortError");function Ot(e,i){const{milliseconds:t,fallback:n,message:r,customTimers:s={setTimeout,clearTimeout},signal:a}=i;let o,c;const l=new Promise((f,u)=>{if(typeof t!="number"||Math.sign(t)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${t}\``);if(a?.aborted){u(oe(a));return}if(a&&(c=()=>{u(oe(a))},a.addEventListener("abort",c,{once:!0})),e.then(f,u),t===Number.POSITIVE_INFINITY)return;const C=new Q;o=s.setTimeout.call(void 0,()=>{if(n){try{f(n())}catch(b){u(b)}return}typeof e.cancel=="function"&&e.cancel(),r===!1?f():r instanceof Error?u(r):(C.message=r??`Promise timed out after ${t} milliseconds`,u(C))},t)}).finally(()=>{l.clear(),c&&a&&a.removeEventListener("abort",c)});return l.clear=()=>{s.clearTimeout.call(void 0,o),o=void 0},l}function Rt(e,i,t){let n=0,r=e.length;for(;r>0;){const s=Math.trunc(r/2);let a=n+s;t(e[a],i)<=0?(n=++a,r-=s+1):r=s}return n}class Wt{#t=[];enqueue(i,t){const{priority:n=0,id:r}=t??{},s={priority:n,id:r,run:i};if(this.size===0||this.#t[this.size-1].priority>=n){this.#t.push(s);return}const a=Rt(this.#t,s,(o,c)=>c.priority-o.priority);this.#t.splice(a,0,s)}setPriority(i,t){const n=this.#t.findIndex(s=>s.id===i);if(n===-1)throw new ReferenceError(`No promise function with the id "${i}" exists in the queue.`);const[r]=this.#t.splice(n,1);this.enqueue(r.run,{priority:t,id:i})}dequeue(){return this.#t.shift()?.run}filter(i){return this.#t.filter(t=>t.priority===i.priority).map(t=>t.run)}get size(){return this.#t.length}}class Zt extends De{#t;#n;#r=0;#f;#h=!1;#m=!1;#c;#_=0;#v=0;#s;#a;#e;#b;#i=0;#u;#o;#x=1n;#d=new Map;timeout;constructor(i){if(super(),i={carryoverIntervalCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:Wt,...i},!(typeof i.intervalCap=="number"&&i.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${i.intervalCap?.toString()??""}\` (${typeof i.intervalCap})`);if(i.interval===void 0||!(Number.isFinite(i.interval)&&i.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${i.interval?.toString()??""}\` (${typeof i.interval})`);if(this.#t=i.carryoverIntervalCount??i.carryoverConcurrencyCount??!1,this.#n=i.intervalCap===Number.POSITIVE_INFINITY||i.interval===0,this.#f=i.intervalCap,this.#c=i.interval,this.#e=new i.queueClass,this.#b=i.queueClass,this.concurrency=i.concurrency,i.timeout!==void 0&&!(Number.isFinite(i.timeout)&&i.timeout>0))throw new TypeError(`Expected \`timeout\` to be a positive finite number, got \`${i.timeout}\` (${typeof i.timeout})`);this.timeout=i.timeout,this.#o=i.autoStart===!1,this.#z()}get#L(){return this.#n||this.#r<this.#f}get#F(){return this.#i<this.#u}#V(){this.#i--,this.#i===0&&this.emit("pendingZero"),this.#g(),this.emit("next")}#B(){this.#S(),this.#k(),this.#a=void 0}get#I(){const i=Date.now();if(this.#s===void 0){const t=this.#_-i;if(t<0){if(this.#v>0){const n=i-this.#v;if(n<this.#c)return this.#w(this.#c-n),!0}this.#r=this.#t?this.#i:0}else return this.#w(t),!0}return!1}#w(i){this.#a===void 0&&(this.#a=setTimeout(()=>{this.#B()},i))}#C(){this.#s&&(clearInterval(this.#s),this.#s=void 0)}#P(){this.#a&&(clearTimeout(this.#a),this.#a=void 0)}#g(){if(this.#e.size===0)return this.#C(),this.emit("empty"),this.#i===0&&(this.#P(),this.emit("idle")),!1;let i=!1;if(!this.#o){const t=!this.#I;if(this.#L&&this.#F){const n=this.#e.dequeue();this.#n||(this.#r++,this.#p()),this.emit("active"),this.#v=Date.now(),n(),t&&this.#k(),i=!0}}return i}#k(){this.#n||this.#s!==void 0||(this.#s=setInterval(()=>{this.#S()},this.#c),this.#_=Date.now()+this.#c)}#S(){this.#r===0&&this.#i===0&&this.#s&&this.#C(),this.#r=this.#t?this.#i:0,this.#y(),this.#p()}#y(){for(;this.#g(););}get concurrency(){return this.#u}set concurrency(i){if(!(typeof i=="number"&&i>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${i}\` (${typeof i})`);this.#u=i,this.#y()}setPriority(i,t){if(typeof t!="number"||!Number.isFinite(t))throw new TypeError(`Expected \`priority\` to be a finite number, got \`${t}\` (${typeof t})`);this.#e.setPriority(i,t)}async add(i,t={}){return t.id??=(this.#x++).toString(),t={timeout:this.timeout,...t},new Promise((n,r)=>{const s=Symbol(`task-${t.id}`);this.#e.enqueue(async()=>{this.#i++,this.#d.set(s,{id:t.id,priority:t.priority??0,startTime:Date.now(),timeout:t.timeout});let a;try{try{t.signal?.throwIfAborted()}catch(l){throw this.#n||this.#r--,this.#d.delete(s),l}let o=i({signal:t.signal});if(t.timeout&&(o=Ot(Promise.resolve(o),{milliseconds:t.timeout,message:`Task timed out after ${t.timeout}ms (queue has ${this.#i} running, ${this.#e.size} waiting)`})),t.signal){const{signal:l}=t;o=Promise.race([o,new Promise((f,u)=>{a=()=>{u(l.reason)},l.addEventListener("abort",a,{once:!0})})])}const c=await o;n(c),this.emit("completed",c)}catch(o){r(o),this.emit("error",o)}finally{a&&t.signal?.removeEventListener("abort",a),this.#d.delete(s),queueMicrotask(()=>{this.#V()})}},t),this.emit("add"),this.#g()})}async addAll(i,t){return Promise.all(i.map(async n=>this.add(n,t)))}start(){return this.#o?(this.#o=!1,this.#y(),this):this}pause(){this.#o=!0}clear(){this.#e=new this.#b,this.#N()}async onEmpty(){this.#e.size!==0&&await this.#l("empty")}async onSizeLessThan(i){this.#e.size<i||await this.#l("next",()=>this.#e.size<i)}async onIdle(){this.#i===0&&this.#e.size===0||await this.#l("idle")}async onPendingZero(){this.#i!==0&&await this.#l("pendingZero")}async onRateLimit(){this.isRateLimited||await this.#l("rateLimit")}async onRateLimitCleared(){this.isRateLimited&&await this.#l("rateLimitCleared")}async onError(){return new Promise((i,t)=>{const n=r=>{this.off("error",n),t(r)};this.on("error",n)})}async#l(i,t){return new Promise(n=>{const r=()=>{t&&!t()||(this.off(i,r),n())};this.on(i,r)})}get size(){return this.#e.size}sizeBy(i){return this.#e.filter(i).length}get pending(){return this.#i}get isPaused(){return this.#o}#z(){this.#n||(this.on("add",()=>{this.#e.size>0&&this.#p()}),this.on("next",()=>{this.#p()}))}#p(){this.#n||this.#m||(this.#m=!0,queueMicrotask(()=>{this.#m=!1,this.#N()}))}#N(){const i=this.#h,t=!this.#n&&this.#r>=this.#f&&this.#e.size>0;t!==i&&(this.#h=t,this.emit(t?"rateLimit":"rateLimitCleared"))}get isRateLimited(){return this.#h}get isSaturated(){return this.#i===this.#u&&this.#e.size>0||this.isRateLimited&&this.#e.size>0}get runningTasks(){return[...this.#d.values()].map(i=>({...i}))}}const qt={name:"FileIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var jt=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon file-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M13,9V3.5L18.5,9M6,2C4.89,2 4,2.89 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2H6Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Ut=[],Gt=_(qt,jt,Ut,!1,null,null);const be=Gt.exports,we=()=>{const e=pe("files","config",null),i=h(e?.show_hidden??!0),t=h(e?.sort_favorites_first??!0),n=h(e?.crop_image_previews??!0);return z(async()=>{if(ce())console.debug("Skip loading files settings - currently on public share");else try{const{data:r}=await fe.get(G("/apps/files/api/v1/configs"));i.value=r?.data?.show_hidden??!1,t.value=r?.data?.sort_favorites_first??!0,n.value=r?.data?.crop_image_previews??!0}catch(r){console.error("Could not load files settings",r),U(v("Could not load files settings"))}}),{showHiddenFiles:i,sortFavoritesFirst:t,cropImagePreviews:n}},Yt=e=>{const i=l=>l==="asc"?"ascending":l==="desc"?"descending":"none",t=pe("files","viewConfigs",null),n=h({sortBy:t?.files?.sorting_mode??"basename",order:i(t?.files?.sorting_direction??"asc")}),r=h({sortBy:t?.recent?.sorting_mode??"basename",order:i(t?.recent?.sorting_direction??"asc")}),s=h({sortBy:t?.favorites?.sorting_mode??"basename",order:i(t?.favorites?.sorting_direction??"asc")});z(async()=>{if(ce())console.debug("Skip loading files views - currently on public share");else try{const{data:l}=await fe.get(G("/apps/files/api/v1/views"));n.value={sortBy:l?.data?.files?.sorting_mode??"basename",order:i(l?.data?.files?.sorting_direction)},s.value={sortBy:l?.data?.favorites?.sorting_mode??"basename",order:i(l?.data?.favorites?.sorting_direction)},r.value={sortBy:l?.data?.recent?.sorting_mode??"basename",order:i(l?.data?.recent?.sorting_direction)}}catch(l){console.error("Could not load files views",l),U(v("Could not load files views"))}});const a=d(()=>V(e||"files")==="files"?n.value:V(e)==="recent"?r.value:s.value),o=d(()=>a.value.sortBy),c=d(()=>a.value.order);return{filesViewConfig:n,favoritesViewConfig:s,recentViewConfig:r,currentConfig:a,sortBy:o,order:c}},Kt={name:"MenuUpIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Jt=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon menu-up-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M7,15L12,10L17,15H7Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Qt=[],Xt=_(Kt,Jt,Qt,!1,null,null);const ei=Xt.exports,ti={name:"MenuDownIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var ii=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon menu-down-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M7,10L12,15L17,10H7Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},ni=[],ri=_(ti,ii,ni,!1,null,null);const si=ri.exports,Ce={"file-picker__file-icon":"_file-picker__file-icon_3v9zx_9","file-picker__file-icon--primary":"_file-picker__file-icon--primary_3v9zx_21","file-picker__file-icon-overlay":"_file-picker__file-icon-overlay_3v9zx_25"},ai=L({__name:"LoadingTableRow",props:{showCheckbox:{type:Boolean}},setup(e){return{__sfc:!0,fileListIconStyles:Ce}}});var oi=function(){var e=this,i=e._self._c,t=e._self._setupProxy;return i("tr",{staticClass:"file-picker__row loading-row",attrs:{"aria-hidden":"true"}},[e.showCheckbox?i("td",{staticClass:"row-checkbox"},[i("span")]):e._e(),i("td",{staticClass:"row-name"},[i("div",{staticClass:"row-wrapper"},[i("span",{class:t.fileListIconStyles["file-picker__file-icon"]}),i("span")])]),e._m(0),e._m(1)])},li=[function(){var e=this,i=e._self._c;return e._self._setupProxy,i("td",{staticClass:"row-size"},[i("span")])},function(){var e=this,i=e._self._c;return e._self._setupProxy,i("td",{staticClass:"row-modified"},[i("span")])}],ci=_(ai,oi,li,!1,null,"15187afc");const ui=ci.exports,di=new Zt({concurrency:5});function pi(e){const{resolve:i,promise:t}=Promise.withResolvers();return di.add(()=>{const n=new Image;return n.onerror=()=>i(!1),n.onload=()=>i(!0),n.src=e,t}),t}function fi(e,i={}){i={size:32,cropPreview:!1,mimeFallback:!0,...i};try{const t=e.attributes?.previewUrl||G("/core/preview?fileId={fileid}",{fileid:e.fileid});let n;try{n=new URL(t)}catch{n=new URL(t,window.location.origin)}return n.searchParams.set("x",`${i.size}`),n.searchParams.set("y",`${i.size}`),n.searchParams.set("mimeFallback",`${i.mimeFallback}`),n.searchParams.set("a",i.cropPreview===!0?"0":"1"),n.searchParams.set("c",`${e.attributes.etag}`),n}catch{return null}}const hi=(e,i)=>{const t=h(null),n=h(!1);return Le(()=>{n.value=!1,t.value=fi(V(e),V(i||{})),t.value&&V(e).type===B.File&&pi(t.value.href).then(r=>{n.value=r})}),{previewURL:t,previewLoaded:n}},mi={name:"FolderIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var vi=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon folder-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},gi=[],yi=_(mi,vi,gi,!1,null,null);const ke=yi.exports,_i={name:"FilePreview"},bi=L({..._i,props:{node:null,cropImagePreviews:{type:Boolean}},setup(e){const i=e,t=h(Ce),{previewURL:n,previewLoaded:r}=hi(M(i,"node"),d(()=>({cropPreview:i.cropImagePreviews}))),s=d(()=>i.node.type===B.File),a=d(()=>{if(i.node.type!==B.Folder)return null;if(i.node.attributes?.["is-encrypted"]===1)return Dt;if(i.node.attributes?.["is-tag"])return Tt;const o=Object.values(i.node.attributes?.["share-types"]||{}).flat();if(o.some(c=>c===O.Link||c===O.Email))return At;if(o.length>0)return ae;switch(i.node.attributes?.["mount-type"]){case"external":case"external-session":return Et;case"group":return Ht;case"shared":return ae}return null});return{__sfc:!0,fileListIconStyles:t,props:i,previewURL:n,previewLoaded:r,isFile:s,folderDecorationIcon:a,NcIconSvgWrapper:ue,IconFile:be,IconFolder:ke}}});var wi=function(){var e=this,i=e._self._c,t=e._self._setupProxy;return i("div",{class:t.fileListIconStyles["file-picker__file-icon"],style:t.previewLoaded?{backgroundImage:`url(${t.previewURL})`}:void 0},[t.previewLoaded?e._e():[t.isFile?i(t.IconFile,{attrs:{size:32}}):[t.folderDecorationIcon?i(t.NcIconSvgWrapper,{class:t.fileListIconStyles["file-picker__file-icon-overlay"],attrs:{inline:"",path:t.folderDecorationIcon,size:16}}):e._e(),i(t.IconFolder,{class:t.fileListIconStyles["file-picker__file-icon--primary"],attrs:{size:32}})]]],2)},Ci=[],ki=_(bi,wi,Ci,!1,null,null);const Si=ki.exports,Ni=L({__name:"FileListRow",props:{allowPickDirectory:{type:Boolean},selected:{type:Boolean},showCheckbox:{type:Boolean},canPick:{type:Boolean},node:null,cropImagePreviews:{type:Boolean}},emits:["update:selected","enter-directory"],setup(e,{emit:i}){const t=e,n=d(()=>t.node.attributes?.displayName||t.node.basename.slice(0,t.node.extension?-t.node.extension.length:void 0)),r=d(()=>t.node.extension),s=d(()=>t.node.type===B.Folder),a=d(()=>t.canPick&&(t.allowPickDirectory||!s.value)),o=d(()=>(t.node.permissions&X.READ)===X.READ);function c(){a.value&&i("update:selected",!t.selected)}function l(){s.value?o.value&&i("enter-directory",t.node):c()}function f(u){u.key==="Enter"&&l()}return{__sfc:!0,props:t,emit:i,displayName:n,fileExtension:r,isDirectory:s,isPickable:a,isNavigatable:o,toggleSelected:c,handleClick:l,handleKeyDown:f,formatFileSize:Ve,NcCheckboxRadioSwitch:de,NcDateTime:Pt,t:v,FilePreview:Si}}});var xi=function(){var e=this,i=e._self._c,t=e._self._setupProxy;return i("tr",e._g({class:["file-picker__row",{"file-picker__row--selected":e.selected&&!e.showCheckbox,"file-picker__row--not-navigatable":t.isDirectory&&!t.isNavigatable,"file-picker__row--not-pickable":!t.isPickable}],attrs:{tabindex:e.showCheckbox&&!t.isDirectory?void 0:0,"aria-selected":t.isPickable?e.selected:void 0,"data-filename":e.node.basename,"data-testid":"file-list-row"}},{click:t.handleClick,...!e.showCheckbox||t.isDirectory?{keydown:t.handleKeyDown}:{}}),[e.showCheckbox?i("td",{staticClass:"row-checkbox",on:{click:function(n){return n.stopPropagation(),(()=>{}).apply(null,arguments)}}},[i(t.NcCheckboxRadioSwitch,{attrs:{"aria-label":t.t("Select the row for {nodename}",{nodename:t.displayName}),disabled:!t.isPickable,"data-testid":"row-checkbox","model-value":e.selected},on:{"update:model-value":t.toggleSelected}})],1):e._e(),i("td",{staticClass:"row-name"},[i("div",{staticClass:"file-picker__name-container",attrs:{"data-testid":"row-name"}},[i(t.FilePreview,{attrs:{node:e.node,"crop-image-previews":e.cropImagePreviews}}),i("div",{staticClass:"file-picker__file-name",attrs:{title:t.displayName},domProps:{textContent:e._s(t.displayName)}}),i("div",{staticClass:"file-picker__file-extension",domProps:{textContent:e._s(t.fileExtension)}})],1)]),i("td",{staticClass:"row-size"},[e._v(" "+e._s(t.formatFileSize(e.node.size||0))+" ")]),i("td",{staticClass:"row-modified"},[i(t.NcDateTime,{attrs:{timestamp:e.node.mtime,"ignore-seconds":!0}})],1)])},Li=[],Fi=_(Ni,xi,Li,!1,null,"ba4db9f8");const Vi=Fi.exports,Bi=L({__name:"FileList",props:{currentView:null,multiselect:{type:Boolean},allowPickDirectory:{type:Boolean},loading:{type:Boolean},files:null,canPick:null,selectedFiles:null,path:null},emits:["update:path","update:selectedFiles"],setup(e,{emit:i}){const t=e,n=h(),{currentConfig:r}=Yt(t.currentView),s=d(()=>n.value??r.value),a=d(()=>s.value.sortBy==="basename"?s.value.order==="none"?void 0:s.value.order:void 0),o=d(()=>s.value.sortBy==="size"?s.value.order==="none"?void 0:s.value.order:void 0),c=d(()=>s.value.sortBy==="mtime"?s.value.order==="none"?void 0:s.value.order:void 0),l=g=>{s.value.sortBy===g?s.value.order==="ascending"?n.value={sortBy:s.value.sortBy,order:"descending"}:n.value={sortBy:s.value.sortBy,order:"ascending"}:n.value={sortBy:g,order:"ascending"}},{sortFavoritesFirst:f,cropImagePreviews:u}=we(),C=d(()=>Fe(t.files,{sortFoldersFirst:!0,sortFavoritesFirst:f.value,sortingOrder:s.value.order==="descending"?"desc":"asc",sortingMode:s.value.sortBy})),b=d(()=>t.files.filter(g=>t.allowPickDirectory||g.type!==B.Folder)),k=d(()=>!t.loading&&t.selectedFiles.length>0&&t.selectedFiles.length>=b.value.length);function S(){t.selectedFiles.length<b.value.length?i("update:selectedFiles",b.value):i("update:selectedFiles",[])}function w(g){t.selectedFiles.includes(g)?i("update:selectedFiles",t.selectedFiles.filter(x=>x.path!==g.path)):t.multiselect?i("update:selectedFiles",[...t.selectedFiles,g]):i("update:selectedFiles",[g])}function H(g){i("update:path",g.path)}const F=h(4),N=h();{const g=()=>Ne(()=>{const x=N.value?.parentElement?.children||[];let A=N.value?.parentElement?.clientHeight||450;for(let p=0;p<x.length;p++)N.value?.isSameNode(x[p])||(A-=x[p].clientHeight);F.value=Math.max(1,Math.floor((A-50)/50))});z(()=>{window.addEventListener("resize",g),g()}),xe(()=>{window.removeEventListener("resize",g)})}return{__sfc:!0,props:t,emit:i,customSortingConfig:n,filesAppSorting:r,sortingConfig:s,sortByName:a,sortBySize:o,sortByModified:c,toggleSorting:l,sortFavoritesFirst:f,cropImagePreviews:u,sortedFiles:C,selectableFiles:b,allSelected:k,onSelectAll:S,onNodeSelected:w,onChangeDirectory:H,skeletonNumber:F,fileContainer:N,NcButton:q,NcCheckboxRadioSwitch:de,t:v,IconSortAscending:ei,IconSortDescending:si,LoadingTableRow:ui,FileListRow:Vi}}});var Ii=function(){var e=this,i=e._self._c,t=e._self._setupProxy;return i("div",{ref:"fileContainer",staticClass:"file-picker__files"},[i("table",[i("thead",[i("tr",[e.multiselect?i("th",{staticClass:"row-checkbox"},[i("span",{staticClass:"hidden-visually"},[e._v(" "+e._s(t.t("Select entry"))+" ")]),e.multiselect?i(t.NcCheckboxRadioSwitch,{attrs:{"aria-label":t.t("Select all entries"),"data-testid":"select-all-checkbox","model-value":t.allSelected},on:{"update:model-value":t.onSelectAll}}):e._e()],1):e._e(),i("th",{staticClass:"row-name",attrs:{"aria-sort":t.sortByName}},[i("div",{staticClass:"header-wrapper"},[i("span",{staticClass:"file-picker__header-preview"}),i(t.NcButton,{attrs:{wide:!0,type:"tertiary","data-test":"file-picker_sort-name"},on:{click:function(n){return t.toggleSorting("basename")}},scopedSlots:e._u([{key:"icon",fn:function(){return[t.sortByName==="ascending"?i(t.IconSortAscending,{attrs:{size:20}}):t.sortByName==="descending"?i(t.IconSortDescending,{attrs:{size:20}}):i("span",{staticStyle:{width:"44px"}})]},proxy:!0}])},[e._v(" "+e._s(t.t("Name"))+" ")])],1)]),i("th",{staticClass:"row-size",attrs:{"aria-sort":t.sortBySize}},[i(t.NcButton,{attrs:{wide:!0,type:"tertiary"},on:{click:function(n){return t.toggleSorting("size")}},scopedSlots:e._u([{key:"icon",fn:function(){return[t.sortBySize==="ascending"?i(t.IconSortAscending,{attrs:{size:20}}):t.sortBySize==="descending"?i(t.IconSortDescending,{attrs:{size:20}}):i("span",{staticStyle:{width:"44px"}})]},proxy:!0}])},[e._v(" "+e._s(t.t("Size"))+" ")])],1),i("th",{staticClass:"row-modified",attrs:{"aria-sort":t.sortByModified}},[i(t.NcButton,{attrs:{wide:!0,type:"tertiary"},on:{click:function(n){return t.toggleSorting("mtime")}},scopedSlots:e._u([{key:"icon",fn:function(){return[t.sortByModified==="ascending"?i(t.IconSortAscending,{attrs:{size:20}}):t.sortByModified==="descending"?i(t.IconSortDescending,{attrs:{size:20}}):i("span",{staticStyle:{width:"44px"}})]},proxy:!0}])},[e._v(" "+e._s(t.t("Modified"))+" ")])],1)])]),i("tbody",[e.loading?e._l(t.skeletonNumber,function(n){return i(t.LoadingTableRow,{key:n,attrs:{"show-checkbox":e.multiselect}})}):e._l(t.sortedFiles,function(n){return i(t.FileListRow,{key:n.fileid||n.path,attrs:{"allow-pick-directory":e.allowPickDirectory,"show-checkbox":e.multiselect,"can-pick":(e.multiselect||e.selectedFiles.length===0||e.selectedFiles.includes(n))&&(e.canPick===void 0||e.canPick(n)),selected:e.selectedFiles.includes(n),node:n,"crop-image-previews":t.cropImagePreviews},on:{"update:selected":function(r){return t.onNodeSelected(n)},"enter-directory":t.onChangeDirectory}})})],2)])])},Pi=[],zi=_(Bi,Ii,Pi,!1,null,"6503afab");const $i=zi.exports,Hi={name:"HomeIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Ai=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon home-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Di=[],Ei=_(Hi,Ai,Di,!1,null,null);const Mi=Ei.exports,Ti={name:"PlusIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Oi=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon plus-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Ri=[],Wi=_(Ti,Oi,Ri,!1,null,null);const Zi=Wi.exports,qi=L({__name:"FilePickerBreadcrumbs",props:{path:null,showMenu:{type:Boolean}},emits:["update:path","create-node"],setup(e,{emit:i}){const t=e,n=h(!1),r=h(""),s=h();function a(){const l=r.value.trim(),f=s.value?.$el?.querySelector("input");let u="";return l.length===0?u=v("Folder name cannot be empty."):l.includes("/")?u=v('"/" is not allowed inside a folder name.'):["..","."].includes(l)?u=v('"{name}" is an invalid folder name.',{name:l}):window.OC.config?.blacklist_files_regex&&l.match(window.OC.config?.blacklist_files_regex)&&(u=v('"{name}" is not an allowed folder name',{name:l})),f&&f.setCustomValidity(u),u===""}const o=function(){const l=r.value.trim();a()&&(n.value=!1,i("create-node",l),r.value="")},c=d(()=>t.path.split("/").filter(l=>l!=="").map((l,f,u)=>({name:l,path:"/"+u.slice(0,f+1).join("/")})));return{__sfc:!0,props:t,emit:i,actionsOpen:n,newNodeName:r,nameInput:s,validateInput:a,onSubmit:o,pathElements:c,IconFolder:ke,IconHome:Mi,IconPlus:Zi,NcActions:j,NcActionInput:Re,NcBreadcrumbs:Lt,NcBreadcrumb:ve,t:v}}});var ji=function(){var e=this,i=e._self._c,t=e._self._setupProxy;return i(t.NcBreadcrumbs,{staticClass:"file-picker__breadcrumbs",scopedSlots:e._u([{key:"default",fn:function(){return[i(t.NcBreadcrumb,{attrs:{name:t.t("All files"),title:t.t("Home")},on:{click:function(n){return t.emit("update:path","/")}},scopedSlots:e._u([{key:"icon",fn:function(){return[i(t.IconHome,{attrs:{size:20}})]},proxy:!0}])}),e._l(t.pathElements,function(n){return i(t.NcBreadcrumb,{key:n.path,attrs:{name:n.name,title:n.path},on:{click:function(r){return t.emit("update:path",n.path)}}})})]},proxy:!0},e.showMenu?{key:"actions",fn:function(){return[i(t.NcActions,{attrs:{open:t.actionsOpen,"aria-label":t.t("Create directory"),"force-menu":!0,"force-name":!0,"menu-name":t.t("New"),type:"secondary"},on:{"update:open":function(n){t.actionsOpen=n},close:function(n){t.newNodeName=""}},scopedSlots:e._u([{key:"icon",fn:function(){return[i(t.IconPlus,{attrs:{size:20}})]},proxy:!0}],null,!1,2971667417)},[i(t.NcActionInput,{ref:"nameInput",attrs:{value:t.newNodeName,label:t.t("New folder"),placeholder:t.t("New folder name")},on:{"update:value":function(n){t.newNodeName=n},submit:t.onSubmit,"update:model-value":t.validateInput},scopedSlots:e._u([{key:"icon",fn:function(){return[i(t.IconFolder,{attrs:{size:20}})]},proxy:!0}],null,!1,1614167509)})],1)]},proxy:!0}:null],null,!0)})},Ui=[],Gi=_(qi,ji,Ui,!1,null,"ec4d392b");const Yi=Gi.exports,Ki={name:"CloseIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Ji=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon close-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Qi=[],Xi=_(Ki,Ji,Qi,!1,null,null);const en=Xi.exports,tn={name:"MagnifyIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var nn=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon magnify-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},rn=[],sn=_(tn,nn,rn,!1,null,null);const an=sn.exports,on=e=>{const i=[{id:"files",label:v("All files"),icon:$t},{id:"recent",label:v("Recent"),icon:zt},{id:"favorites",label:v("Favorites"),icon:Mt}],t=e.value?i.filter(({id:n})=>n==="files"):i;return{allViews:i,availableViews:t}},ln=L({__name:"FilePickerNavigation",props:{currentView:null,filterString:null,isCollapsed:{type:Boolean},disabledNavigation:{type:Boolean}},emits:["update:currentView","update:filterString"],setup(e,{emit:i}){const t=e,{availableViews:n}=on(h(je()===null)),r=d(()=>n.filter(s=>s.id===t.currentView)[0]??n[0]);return{__sfc:!0,props:t,emit:i,availableViews:n,currentViewObject:r,updateFilterValue:s=>i("update:filterString",s),IconClose:en,IconMagnify:an,NcButton:q,NcIconSvgWrapper:ue,NcSelect:Oe,NcTextField:Te,Fragment:_e,t:v}}});var cn=function(){var e=this,i=e._self._c,t=e._self._setupProxy;return i(t.Fragment,[i(t.NcTextField,{staticClass:"file-picker__filter-input",attrs:{label:t.t("Filter file list"),"show-trailing-button":!!e.filterString,"model-value":e.filterString},on:{"update:model-value":t.updateFilterValue,"trailing-button-click":function(n){return t.updateFilterValue("")}},scopedSlots:e._u([{key:"trailing-button-icon",fn:function(){return[i(t.IconClose,{attrs:{size:16}})]},proxy:!0}])},[i(t.IconMagnify,{attrs:{size:16}})],1),t.availableViews.length>1&&!e.disabledNavigation?[e.isCollapsed?i(t.NcSelect,{attrs:{"aria-label":t.t("Current view selector"),clearable:!1,searchable:!1,options:t.availableViews,"model-value":t.currentViewObject},on:{"update:model-value":function(n){return t.emit("update:currentView",n.id)}}}):i("ul",{staticClass:"file-picker__side"},e._l(t.availableViews,function(n){return i("li",{key:n.id},[i(t.NcButton,{attrs:{type:e.currentView===n.id?"primary":"tertiary",wide:!0},on:{click:function(r){return e.$emit("update:currentView",n.id)}},scopedSlots:e._u([{key:"icon",fn:function(){return[i(t.NcIconSvgWrapper,{attrs:{path:n.icon,size:20}})]},proxy:!0}],null,!0)},[e._v(" "+e._s(n.label)+" ")])],1)}),0)]:e._e()],2)},un=[],dn=_(ln,cn,un,!1,null,"f5975252");const pn=dn.exports;function fn(e){const i=new AbortController,t=Math.round(Date.now()/1e3)-3600*24*14;return new he(async(n,r,s)=>{s(()=>i.abort());try{const{data:a}=await e.search("/",{signal:i.signal,details:!0,data:Ye(t)}),o=a.results.map(c=>K(c));n(o)}catch(a){r(a)}})}function hn(e,i){const t=new AbortController;return new he(async(n,r,s)=>{s(()=>t.abort());try{const a=(await e.getDirectoryContents(T.join(Y,i),{signal:t.signal,details:!0,includeSelf:!0,data:me()})).data.map(o=>K(o));n({contents:a.filter(({path:o})=>o!==i),folder:a.find(({path:o})=>o===i)})}catch(a){r(a)}})}async function mn(e,i){const{data:t}=await e.stat(T.join(Y,i),{details:!0,data:me()});return K(t)}const vn=function(e,i){const t=Ue(),n=Z([]),r=Z(null),s=h(!0),a=h(null);async function o(l){const f=T.join(i.value,l);await t.createDirectory(T.join(Y,f));const u=await mn(t,f);return n.value=[...n.value,u],u}async function c(){a.value&&a.value.cancel(),s.value=!0,e.value==="favorites"?a.value=Ge(t,i.value):e.value==="recent"?a.value=fn(t):a.value=hn(t,i.value);const l=await a.value;"folder"in l?(r.value=l.folder,n.value=l.contents):(r.value=null,n.value=l),a.value=null,s.value=!1}return le([e,i],()=>c()),z(()=>c()),{isLoading:s,files:n,folder:r,loadFiles:c,createDirectory:o}},gn=function(e){const i=d(()=>e.value.map(t=>t.split("/")));return{isSupportedMimeType:t=>{const n=t.split("/");return i.value.some(([r,s])=>(n[0]===r||r==="*")&&(n[1]===s||s==="*"))}}},yn={name:"FilePicker"},_n=L({...yn,props:{buttons:null,name:null,allowPickDirectory:{type:Boolean,default:!1},disabledNavigation:{type:Boolean,default:!1},container:{default:"body"},filterFn:{default:void 0},canPickFn:{default:void 0},mimetypeFilter:{default:()=>[]},multiselect:{type:Boolean,default:!0},path:{default:void 0}},emits:["close"],setup(e,{emit:i}){const t=e,n=h(!0),r=d(()=>{const p=l.value.length===0&&t.allowPickDirectory&&w.value?[w.value]:l.value;return(typeof t.buttons=="function"?t.buttons(p,C.value,o.value):t.buttons).map(m=>({...m,disabled:m.disabled||H.value,callback:()=>{s=!0,a(m.callback,p)}}))});let s=!1;const a=async(p,m)=>{p(m),i("close",m),s=!1},o=h("files"),c=d(()=>o.value==="favorites"?v("Favorites"):o.value==="recent"?v("Recent"):""),l=Z([]),f=h(window?.sessionStorage.getItem("NC.FilePicker.LastPath")||"/"),u=h("");le([u],()=>{t.path===void 0&&u.value&&window.sessionStorage.setItem("NC.FilePicker.LastPath",u.value),l.value=[]});const C=d({get:()=>o.value==="files"?u.value||t.path||f.value:"/",set:p=>{u.value=p}}),b=h(""),{isSupportedMimeType:k}=gn(M(t,"mimetypeFilter")),{files:S,folder:w,isLoading:H,loadFiles:F,createDirectory:N}=vn(o,C);z(()=>F());const{showHiddenFiles:g}=we(),x=d(()=>{let p=S.value;return g.value||(p=p.filter(m=>!m.basename.startsWith("."))),t.mimetypeFilter.length>0&&(p=p.filter(m=>m.type==="folder"||m.mime&&k(m.mime))),b.value&&(p=p.filter(m=>m.basename.toLowerCase().includes(b.value.toLowerCase()))),t.filterFn&&(p=p.filter(m=>t.filterFn(m))),p}),A=d(()=>o.value==="files"?v("Upload some content or sync with your devices!"):o.value==="recent"?v("Files and folders you recently modified will show up here."):v("Files and folders you mark as favorite will show up here."));return{__sfc:!0,props:t,emit:i,isOpen:n,dialogButtons:r,isHandlingCallback:s,handleButtonClick:a,currentView:o,viewHeadline:c,selectedFiles:l,savedPath:f,navigatedPath:u,currentPath:C,filterString:b,isSupportedMimeType:k,files:S,currentFolder:w,isLoading:H,loadFiles:F,createDirectory:N,showHiddenFiles:g,filteredFiles:x,noFilesDescription:A,onCreateFolder:async p=>{try{const m=await N(p);u.value=m.path,qe("files:node:created",S.value.filter(Se=>Se.basename===p)[0])}catch(m){console.warn("Could not create new folder",{name:p,error:m}),U(v("Could not create the new folder"))}},handleClose:p=>{!p&&!s&&i("close")},IconFile:be,FileList:$i,FilePickerBreadcrumbs:Yi,FilePickerNavigation:pn,NcDialog:Me,NcEmptyContent:Ee,t:v}}});var bn=function(){var e=this,i=e._self._c,t=e._self._setupProxy;return i(t.NcDialog,{attrs:{open:t.isOpen,container:e.container,buttons:t.dialogButtons,name:e.name,size:"large","content-classes":"file-picker__content","dialog-classes":"file-picker","navigation-classes":"file-picker__navigation"},on:{"update:open":[function(n){t.isOpen=n},t.handleClose]},scopedSlots:e._u([{key:"navigation",fn:function({isCollapsed:n}){return[i(t.FilePickerNavigation,{attrs:{"current-view":t.currentView,"filter-string":t.filterString,"is-collapsed":n,"disabled-navigation":e.disabledNavigation},on:{"update:currentView":function(r){t.currentView=r},"update:current-view":function(r){t.currentView=r},"update:filterString":function(r){t.filterString=r},"update:filter-string":function(r){t.filterString=r}}})]}}])},[i("div",{staticClass:"file-picker__main"},[t.currentView==="files"?i(t.FilePickerBreadcrumbs,{attrs:{path:t.currentPath,"show-menu":e.allowPickDirectory},on:{"update:path":function(n){t.currentPath=n},"create-node":t.onCreateFolder}}):i("div",{staticClass:"file-picker__view"},[i("h3",[e._v(e._s(t.viewHeadline))])]),t.isLoading||t.filteredFiles.length>0?i(t.FileList,{attrs:{path:t.currentPath,"selected-files":t.selectedFiles,"allow-pick-directory":e.allowPickDirectory,"current-view":t.currentView,files:t.filteredFiles,multiselect:e.multiselect,loading:t.isLoading,name:t.viewHeadline,"can-pick":e.canPickFn},on:{"update:path":[function(n){t.currentPath=n},function(n){t.currentView="files"}],"update:selectedFiles":function(n){t.selectedFiles=n},"update:selected-files":function(n){t.selectedFiles=n}}}):t.filterString?i(t.NcEmptyContent,{attrs:{name:t.t("No matching files"),description:t.t("No files matching your filter were found.")},scopedSlots:e._u([{key:"icon",fn:function(){return[i(t.IconFile)]},proxy:!0}])}):i(t.NcEmptyContent,{attrs:{name:t.t("No files in here"),description:t.noFilesDescription},scopedSlots:e._u([{key:"icon",fn:function(){return[i(t.IconFile)]},proxy:!0}])})],1)])},wn=[],Cn=_(_n,bn,wn,!1,null,"dda9b42b");const En=Cn.exports;export{En as default};
//# sourceMappingURL=FilePicker-lO8J1a0C-BMiSyvlS.chunk.mjs.map
